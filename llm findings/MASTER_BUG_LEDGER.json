[
  {
    "cid": "CF-001",
    "fingerprint": "adaptive-cwnd_avail-scheduler-underflow|net/tquic/multipath/tquic_scheduler.c|tquic_scheduler|correctness",
    "title": "Adaptive Scheduler cwnd_avail Underflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 12 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_scheduler. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 5 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_scheduler",
        "tquic_redundant_is_duplicate",
        "tquic_adaptive_calc_score",
        "tquic_adaptive_update_alpha"
      ],
      "line_ranges": [],
      "snippets": [
        "if (path->cc.cwnd == 0)\n    cwnd_score = 0;\nelse {\n    cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight;\n    cwnd_score = (cwnd_avail * 1000) / path->cc.cwnd;\n}",
        "list_for_each_entry_rcu(path, &conn->paths, list) {\n    if (idx == path_idx) {\n        pd = &wd->path_data[path_idx];\n        pd->deficit += ...;",
        "idx = conn->num_paths - 1;\nif (idx >= 0 && idx < TQUIC_MAX_PATHS) {",
        "seq_byte = (u8)(seq & 0xFF);\n\nfor (i = 0; i < 256; i++) {\n    if (rd->dedup_window[i] == seq_byte)\n        return true;  /* False positive: seq 0 and seq 256 both map to 0 */\n}",
        "if (path->cc.cwnd == 0)\n    cwnd_score = 0;\nelse {\n    cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight;  // u32 underflow!\n    cwnd_score = (cwnd_avail * 1000) / path->cc.cwnd;        // garbage\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other.",
      "Severity disagreement across reports: S0, S1, S2, S3."
    ],
    "verification_commands": [
      "rg -n \"tquic_scheduler\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"adaptive\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add an explicit check: `cwnd_avail = (path->cc.cwnd > path->cc.bytes_in_flight) ? path->cc.cwnd - path->cc.bytes_in_flight : 0;` / ** Use a proper bitmap or hash table keyed on the full 64-bit sequence number, or at minimum use a larger hash with a rolling window.\n\n--- / ** Check `if (path->cc.bytes_in_flight >= path->cc.cwnd) cwnd_score = 0;` before the subtraction.\n\n---",
    "tests_to_add": [
      "Add regression test for: Adaptive Scheduler cwnd_avail Underflow (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-002",
    "fingerprint": "buffer-build-clienthello-extension-overflow|net/tquic/crypto/handshake.c|enabled|memory",
    "title": "Buffer Overflow in ClientHello Extension Building",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: enabled. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "enabled",
        "negotiated",
        "tquic_hs_build_ch_extensions"
      ],
      "line_ranges": [],
      "snippets": [
        "// Extensions are written sequentially without cumulative bounds checking\n  // Each individual write may check, but total is not validated"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"enabled\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"buffer\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a running `offset` tracker and validate `offset + needed_bytes <= buf_len` before every write operation. Return `-ENOSPC` if insufficient space.",
    "tests_to_add": [
      "Add regression test for: Buffer Overflow in ClientHello Extension Building (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-003",
    "fingerprint": "certificate-client-logic-server-verification|net/tquic/crypto/cert_verify.c|tquic_hs_verify_client_cert|security",
    "title": "Client Certificate Verification Uses Server Logic",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: tquic_hs_verify_client_cert. Category=security, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_hs_verify_client_cert",
        "tquic_hs_verify_server_cert",
        "verify_chain",
        "tquic_handshake",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2450-2450",
        "net/tquic/crypto/cert_verify.c:2243-2243"
      ],
      "snippets": [
        "int tquic_hs_verify_client_cert(struct tquic_handshake *hs,\n                                struct tquic_connection *conn)\n{\n    /* Client certificate verification uses same logic\n     * but checks for client auth EKU instead of server auth\n     */\n    return tquic_hs_verify_server_cert(hs, conn);\n}",
        "int tquic_hs_verify_client_cert(struct tquic_handshake *hs,\n                                  struct tquic_connection *conn)\n  {\n      return tquic_hs_verify_server_cert(hs, conn);\n  }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_verify_client_cert\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"client\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a `bool is_server` parameter to the internal `verify_chain()` call path, or refactor so that client cert verification passes `is_server=false`.",
    "tests_to_add": [
      "Add regression test for: Client Certificate Verification Uses Server Logic (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-004",
    "fingerprint": "call-connection-destroy-function-sleep-spinlock|net/tquic/http3/http3_stream.c|h3_connection_destroy|concurrency",
    "title": "Connection Destroy Calls Sleeping Function Under Spinlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_stream.c :: h3_connection_destroy. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "h3_connection_destroy",
        "panic",
        "tquic_stream_close"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"h3_connection_destroy\" \"net/tquic/http3/http3_stream.c\"",
      "rg -n \"connection\" \"net/tquic/http3/http3_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Collect stream pointers into a local list under the spinlock, release the spinlock, then close each stream outside the lock.",
    "tests_to_add": [
      "Add regression test for: Connection Destroy Calls Sleeping Function Under Spinlock (net/tquic/http3/http3_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-005",
    "fingerprint": "acces-fragile-hardcod-key-offset-state|net/tquic/crypto/key_update.c|change|security",
    "title": "Fragile Hardcoded Offset for Key Update State Access",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: change. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "change",
        "container_of",
        "offset",
        "tquic_crypto_get_key_update_state",
        "tquic_key_update_state",
        "tquic_crypto_get_key_update",
        "layout",
        "tquic_crypto_state_ku_accessor",
        "tquic_crypto_state"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_crypto_state_ku_accessor {\n    char _before_key_update[304];    /* Approximate offset */\n    struct tquic_key_update_state *key_update;\n} *accessor;\n\nif (!crypto_state)\n    return NULL;\n\nif (header->cipher_suite == 0)\n    return NULL;\n\naccessor = crypto_state;\nreturn accessor->key_updat",
        "/* In tls.c, where tquic_crypto_state is fully defined: */\nstruct tquic_key_update_state *tquic_crypto_get_key_update_state(\n    struct tquic_crypto_state *crypto)\n{\n    return crypto ? crypto->key_update : NULL;\n}",
        "struct tquic_key_update_state *tquic_crypto_get_key_update_state(void *crypto_state)\n  {\n      // Hardcoded offset 304 bytes into opaque structure\n      return *(struct tquic_key_update_state **)((u8 *)crypto_state + 304);\n  }",
        "struct tquic_crypto_state_ku_accessor {\n    char _before_key_update[304];    /* Approximate offset */\n    struct tquic_key_update_state *key_update;\n} *accessor;\n\nif (!crypto_state)\n    return NULL;\n\nif (header->cipher_suite == 0)\n    return NULL;\n\naccessor = crypto_state;\nreturn accessor->key_update;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"change\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"fragile\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a proper typed structure with a named field, or use `container_of()` macro. Never use raw byte offsets to access structure members. Define a proper interface header that both the crypto state creator and this function share. / ** Export a proper accessor function from `tls.c` that has visibility into\nthe actual `tquic_crypto_state` definition:\n```c\n/* In tls.c, where tquic_crypto_state is fully defined: */\nstruct tquic_key_update_state *tquic_crypto_get_key_update_state(\n    struct tquic_crypto_state *crypto)\n{\n    return crypto ? crypto->key_update : NULL;\n}\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Fragile Hardcoded Offset for Key Update State Access (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-006",
    "fingerprint": "free-http-lookup-stream-use|net/tquic/http3/http3_stream.c|h3_stream_lookup|memory",
    "title": "HTTP/3 Stream Lookup: Use-After-Free",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_stream.c :: h3_stream_lookup. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "free",
        "h3_stream_lookup",
        "h3_stream_put",
        "refcount_inc",
        "h3_stream"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"h3_stream_lookup\" \"net/tquic/http3/http3_stream.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `refcount_inc(&stream->refcount)` in `h3_stream_lookup()` and require all callers to call a corresponding `h3_stream_put()` when done.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Stream Lookup: Use-After-Free (net/tquic/http3/http3_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-007",
    "fingerprint": "accept-any-ocsp-response-stapl-verification|net/tquic/crypto/cert_verify.c|pr_debug|security",
    "title": "OCSP Stapling Response Accepted Without Any Verification",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: pr_debug. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "pr_debug",
        "present",
        "tquic_cert",
        "tquic_check_revocation",
        "tquic_cert_verify_ctx",
        "tquic_x509_cert"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_check_revocation(struct tquic_cert_verify_ctx *ctx,\n                           const struct tquic_x509_cert *cert)\n{\n    ...\n    /* Check OCSP stapling data if provided */\n    if (ctx->ocsp_stapling && ctx->ocsp_stapling_len > 0) {\n        /*\n         * OCSP response parsing would go here.\n         * For now, accept stapled responses as valid.\n         */\n        pr_debug(\"tquic_cert: OCSP stapling present (%u bytes)\\n\",\n                 ctx->ocsp_stapling_len);\n        return 0;  // <-- ACCEPTS ANY DATA AS VALID OCSP\n    }\n    ...\n}",
        "if (ctx->ocsp_stapling && ctx->ocsp_stapling_len > 0) {\n      /* OCSP response parsing would go here. */\n      pr_debug(\"tquic_cert: OCSP stapling present (%u bytes)\\n\",\n               ctx->ocsp_stapling_len);\n      return 0;  // Accepts without verification!\n  }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"pr_debug\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"ocsp\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either implement OCSP response verification or remove the early return so that the \"no OCSP available\" path is taken, which at least logs warnings in hard-fail mode. / ** The OCSP response must be fully parsed per RFC 6960: verify the signature against the issuer CA or a designated OCSP responder, check the response status (good/revoked/unknown), validate thisUpdate/nextUpdate timestamps, and match the certificate serial number.\n\n---",
    "tests_to_add": [
      "Add regression test for: OCSP Stapling Response Accepted Without Any Verification (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-008",
    "fingerprint": "allocation-attacker-influenc-metric-netlink-path|net/tquic/diag/path_metrics.c|allocation|security",
    "title": "Path Metrics Netlink: Unbounded Allocation from Attacker-Influenced Value",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/path_metrics.c :: allocation. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [
        "allocation",
        "connection",
        "maximum",
        "min",
        "nlmsg_new",
        "tquic_nl_get_all_paths"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, perf, security."
    ],
    "verification_commands": [
      "rg -n \"allocation\" \"net/tquic/diag/path_metrics.c\"",
      "rg -n \"path\" \"net/tquic/diag/path_metrics.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Cap the allocation at a fixed reasonable maximum (e.g., `min(conn->num_paths, TQUIC_MAX_PATHS) * NLMSG_DEFAULT_SIZE`), and add the CAP_NET_ADMIN check from H1.",
    "tests_to_add": [
      "Add regression test for: Path Metrics Netlink: Unbounded Allocation from Attacker-Influenced Value (net/tquic/diag/path_metrics.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-009",
    "fingerprint": "drop-duplicate-dynamic-free-lock-qpack|net/tquic/http3/qpack_dynamic.c|either|memory",
    "title": "QPACK Dynamic Table Duplicate: Use-After-Free via Lock Drop",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack_dynamic.c :: either. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_dynamic.c"
      ],
      "symbols": [
        "either",
        "lock",
        "processing",
        "qpack_dynamic_table_duplicate",
        "qpack_dynamic"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"either\" \"net/tquic/http3/qpack_dynamic.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack_dynamic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either (a) increment the entry's refcount before dropping the lock, or (b) copy the name/value data into a local buffer before dropping the lock, or (c) use `GFP_ATOMIC` allocation under the lock (acceptable for small allocations).",
    "tests_to_add": [
      "Add regression test for: QPACK Dynamic Table Duplicate: Use-After-Free via Lock Drop (net/tquic/http3/qpack_dynamic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-010",
    "fingerprint": "certificate-comparison-constant-memcmp-non-self|net/tquic/crypto/cert_verify.c|comparison|security",
    "title": "Self-Signed Certificate Comparison Uses Non-Constant-Time memcmp in One Path",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: comparison. Category=security, severity=S0.\nEvidence union: 1 file(s), 4 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "comparison",
        "crypto_memneq",
        "memcmp",
        "tquic_x509_cert_parse",
        "tquic_x509_verify_signature",
        "tquic_x509_verify",
        "tquic_x509_cert"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:1628-1628",
        "net/tquic/crypto/cert_verify.c:1626-1628",
        "net/tquic/crypto/cert_verify.c:1926-1928",
        "net/tquic/crypto/cert_verify.c:1929-1929"
      ],
      "snippets": [
        "if (cert->issuer_raw && cert->subject_raw &&\n        cert->issuer_raw_len == cert->subject_raw_len &&\n        !crypto_memneq(cert->issuer_raw, cert->subject_raw, cert->issuer_raw_len)) {\n        cert->self_signed = true;\n    }",
        "if (cert->issuer_raw && cert->subject_raw &&\n        cert->issuer_raw_len == cert->subject_raw_len &&\n        memcmp(cert->issuer_raw, cert->subject_raw, cert->issuer_raw_len) == 0) {\n        ((struct tquic_x509_cert *)cert)->self_signed = true;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security.",
      "Severity disagreement across reports: S0, S1, S2."
    ],
    "verification_commands": [
      "rg -n \"comparison\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"self\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `crypto_memneq()` consistently for all comparisons, or use `memcmp()` consistently for non-secret data. The key point is to be consistent and use constant-time comparison for any data whose equality/inequality should not leak timing information. / ** Use `crypto_memneq` consistently. Remove the const-cast by refactoring to set `self_signed` during parse, not during verification.\n\n---",
    "tests_to_add": [
      "Add regression test for: Self-Signed Certificate Comparison Uses Non-Constant-Time memcmp in One Path (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-011",
    "fingerprint": "buffer-expand-hkdf-label-overflow-stack|net/tquic/crypto/handshake.c|tquic_hs_hkdf_expand_label|memory",
    "title": "Stack Buffer Overflow in HKDF-Expand-Label",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_hkdf_expand_label. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "label",
        "check",
        "tquic_hs_hkdf_expand_label"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:238-238"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_hkdf_expand_label\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"stack\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add explicit bounds check: `if (label_len + context_len + 10 > sizeof(hkdf_label)) return -EINVAL;` before any writes to the buffer. Note: the zero_rtt.c implementation at line ~238 correctly has this check (`if (label_len > 245 || context_len > 245 || (10 + label_len + context_len) > sizeof(hkdf_label)) return -EINVAL;`).",
    "tests_to_add": [
      "Add regression test for: Stack Buffer Overflow in HKDF-Expand-Label (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-012",
    "fingerprint": "check-data-queu-stream-validation|net/tquic/tquic_input.c|dispatcher|correctness",
    "title": "Stream Data Queued Before Validation Check",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 30 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_input.c :: dispatcher. Category=correctness, severity=S0.\nEvidence union: 4 file(s), 8 line range(s), 12 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c",
        "net/tquic/tquic_input.c:2303-2310",
        "net/tquic/tquic_input.c:944-948",
        "net/tquic/tquic_input.c:2585-2590"
      ],
      "symbols": [
        "dispatcher",
        "tquic_rx_ctx",
        "overhead",
        "__skb_dequeue",
        "deliver",
        "alloc_skb",
        "directly",
        "skb_put_data",
        "kmem_cache_alloc",
        "likely",
        "buffer",
        "skb_clone",
        "area",
        "get_page",
        "skb_copy_bits",
        "skb_fill_page_desc",
        "tquic_input",
        "tquic_rx_buf_cache",
        "tquic_gro_flush",
        "tquic_sent_packet"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2303-2310",
        "net/tquic/tquic_input.c:944-948",
        "net/tquic/tquic_input.c:2585-2590",
        "net/tquic/tquic_input.c:912-912",
        "net/tquic/tquic_input.c:1248-1248",
        "net/tquic/tquic_input.c:971-971",
        "net/tquic/tquic_input.c:980-980",
        "net/tquic/tquic_input.c:982-982"
      ],
      "snippets": [
        "} else {\n    /* Length extends to end of packet */\n    length = ctx->len - ctx->offset;\n}",
        "if (length > 65535)\n    return -EINVAL;",
        "while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n    spin_unlock(&gro->lock);\n    deliver(skb);\n    flushed++;\n    spin_lock(&gro->lock);\n}",
        "data_skb = alloc_skb(length, GFP_ATOMIC);\nif (!data_skb)\n    return -ENOMEM;\nskb_put_data(data_skb, ctx->data + ctx->offset, length);",
        "if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) {\n    decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC);\n    decrypted_from_slab = true;\n} else {\n    decrypted = kmalloc(payload_len, GFP_ATOMIC);\n}",
        "data_skb = alloc_skb(length, GFP_ATOMIC);\nif (!data_skb)\n    return -ENOMEM;\n\nskb_put_data(data_skb, ctx->data + ctx->offset, length);",
        "data_skb = alloc_skb(length, GFP_ATOMIC);\n...\nskb_put_data(data_skb, ctx->data + ctx->offset, length);",
        "rtt_us = ktime_us_delta(now, ctx->path->last_activity);\nif (rtt_us > ack_delay_us)\n    rtt_us -= ack_delay_us;",
        "u64 ack_delay_us = ack_delay * 8;  /* Default exponent = 3 */",
        "u64 bytes_acked = (first_ack_range + 1) * 1200;",
        "while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n        spin_unlock(&gro->lock);\n        deliver(skb);\n        flushed++;\n        spin_lock(&gro->lock);\n    }\n\n    gro->held_count = 0;",
        "skb_queue_tail(&stream->recv_buf, data_skb);  // line 971: DATA QUEUED\n\n// ... then LATER ...\n\nif (offset > ((1ULL << 62) - 1) - length) {   // line 980: VALIDATION\n    return -EPROTO;                            // line 982: ERROR, but skb\n}                                              //           "
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, correctness, memory, perf, security.",
      "Severity disagreement across reports: S0, S1, S2."
    ],
    "verification_commands": [
      "rg -n \"dispatcher\" \"net/tquic/tquic_input.c\"",
      "rg -n \"stream\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a flag to `tquic_rx_ctx` that records when a length-less STREAM frame is processed, and assert in the dispatcher that no further frames follow. / ** Remove the 65535 limit since line 912 already validates against the actual packet bounds. / ** Splice the queue under a single lock hold, then deliver all packets without the lock.",
    "tests_to_add": [
      "Add regression test for: Stream Data Queued Before Validation Check (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-013",
    "fingerprint": "connection-hold-lock_sock-teardown-tquic_close|net/tquic/tquic_socket.c|tquic_sock|concurrency",
    "title": "`tquic_close()` Does Not Hold `lock_sock()` During Connection Teardown",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_sock. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sock",
        "tquic_conn_close_with_error",
        "tquic_pm_conn_release",
        "lock_sock",
        "sock",
        "tquic_close",
        "tquic_socket",
        "tquic_stream",
        "tquic_sendmsg",
        "tquic_connection",
        "msghdr",
        "close"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_close(struct sock *sk, long timeout)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n\n    if (tsk->conn) {\n        tquic_pm_conn_release(tsk->conn);\n        if (tsk->conn->state == TQUIC_CONN_CONNECTED ||\n            tsk->conn->state == TQUIC_CONN_CONNECTING) {\n            tquic_conn_close_w",
        "int tquic_sendmsg(struct sock *sk, struct msghdr *msg, size_t len)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    struct tquic_connection *conn = tsk->conn;  // no lock\n    struct tquic_stream *stream;\n    /* ... */\n    if (!conn || conn->state != TQUIC_CONN_CONNECTED)\n        return -ENOTCONN;\n\n ",
        "void tquic_close(struct sock *sk, long timeout)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n\n    if (tsk->conn) {\n        tquic_pm_conn_release(tsk->conn);\n        if (tsk->conn->state == TQUIC_CONN_CONNECTED ||\n            tsk->conn->state == TQUIC_CONN_CONNECTING) {\n            tquic_conn_close_with_error(tsk->conn, 0x00, NULL);\n        }\n    }\n    inet_sk_set_state(sk, TCP_CLOSE);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other.",
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"tquic_sock\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"tquic_close\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_close()` Does Not Hold `lock_sock()` During Connection Teardown (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-014",
    "fingerprint": "certs_len-integer-tquic_hs_process_certificate-track-underflow|net/tquic/crypto/handshake.c|tquic_hs_process_certificate|correctness",
    "title": "`tquic_hs_process_certificate` -- integer underflow in `certs_len` tracking",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_certificate. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_certificate"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1778-1778",
        "net/tquic/crypto/handshake.c:1780-1780",
        "net/tquic/crypto/handshake.c:1800-1800"
      ],
      "snippets": [
        "while (p < data + 4 + msg_len && certs_len > 0) {\n    u32 cert_len;\n    u16 ext_len;\n\n    if (p + 3 > end)\n        break;\n\n    cert_len = (p[0] << 16) | (p[1] << 8) | p[2];\n    p += 3;\n    certs_len -= 3;              // <-- can underflow if certs_len < 3\n\n    if (p + cert_len > end || cert_len > certs_len)\n        return -EINVAL;\n    // ...\n    p += cert_len;\n    certs_len -= cert_len;\n\n    /* Certificate extensions */\n    if (p + 2 > end)\n        break;\n    ext_len = (p[0] << 8) | p[1];\n    p += 2;\n    certs_len -= 2;              // <-- can underflow if certs_len < 2\n\n    if (ext_len > certs_len)\n        return -EINVAL;\n\n    p += ext_len;\n    certs_len -= ext_len;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_certificate\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check `certs_len >= 3` before `certs_len -= 3`, and\n`certs_len >= 2` before `certs_len -= 2`. Alternatively, track position using\npointer arithmetic against `end` only.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_certificate` -- integer underflow in `certs_len` tracking (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-015",
    "fingerprint": "nonce-overflow-session-ticket-tquic_hs_process_new_session_ticket|net/tquic/crypto/handshake.c|tquic_session_ticket|memory",
    "title": "`tquic_hs_process_new_session_ticket` -- nonce overflow into session ticket",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_session_ticket. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_session_ticket",
        "ever",
        "tquic_hs_process_new_session_ticket"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:76-77"
      ],
      "snippets": [
        "/* Ticket nonce */\nnonce_len = *p++;\nif (p + nonce_len > end)\n    return -EINVAL;\n\n/* ... allocate session_ticket ... */\n\nhs->session_ticket->nonce_len = nonce_len;\nmemcpy(hs->session_ticket->nonce, p, nonce_len);",
        "struct tquic_session_ticket {\n    // ...\n    u8 nonce[255];\n    u8 nonce_len;\n    // ...\n};",
        "p += session_id_len;\n\n    /* Cipher suite */\n    cipher_suite = (p[0] << 8) | p[1];\n    p += 2;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_session_ticket\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_process_new_session_ticket\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_new_session_ticket` -- nonce overflow into session ticket (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-016",
    "fingerprint": "bound-byte-check-compression-read-tquic_hs_process_server_hello|net/tquic/crypto/handshake.c|tquic_hs_process_server_hello|memory",
    "title": "`tquic_hs_process_server_hello` -- missing bounds check before compression byte read",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_server_hello. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_server_hello"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Compression (must be null) */\n    compression = *p++;\n    if (compression != 0) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_server_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (p >= end) return -EINVAL;` before reading compression.",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_server_hello` -- missing bounds check before compression byte read (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-017",
    "fingerprint": "connection-lock_sock-race-state-tquic_shutdown|net/tquic/tquic_socket.c|tquic_shutdown|concurrency",
    "title": "`tquic_shutdown()` Missing `lock_sock()` -- Race on Connection State",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_shutdown. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_shutdown",
        "tquic_sock",
        "socket",
        "tquic_sock_shutdown",
        "lock_sock",
        "sock",
        "tquic_socket",
        "close",
        "sendmsg"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_sock_shutdown(struct socket *sock, int how)\n{\n    struct sock *sk = sock->sk;\n    struct tquic_sock *tsk = tquic_sk(sk);\n    int ret = 0;\n\n    if (tsk->conn && tsk->conn->state == TQUIC_CONN_CONNECTED) {\n        ret = tquic_conn_shutdown(tsk->conn);\n    }\n    // NO lock_sock() -- concurren",
        "int tquic_sock_shutdown(struct socket *sock, int how)\n{\n    struct sock *sk = sock->sk;\n    struct tquic_sock *tsk = tquic_sk(sk);\n    int ret = 0;\n\n    if (tsk->conn && tsk->conn->state == TQUIC_CONN_CONNECTED) {\n        ret = tquic_conn_shutdown(tsk->conn);\n    }\n    // NO lock_sock() -- concurrent sendmsg/recvmsg can race"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_shutdown\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_shutdown()` Missing `lock_sock()` -- Race on Connection State (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-018",
    "fingerprint": "error-invalid-propagation-return-tquic_varint_len-valu|net/tquic/tquic_output.c|tquic_varint_len|correctness",
    "title": "`tquic_varint_len()` Returns 0 for Invalid Values Without Error Propagation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_output.c :: tquic_varint_len. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_varint_len",
        "tquic_output",
        "tquic_encode_varint"
      ],
      "line_ranges": [],
      "snippets": [
        "static inline int tquic_varint_len(u64 val)\n{\n    // ... (declared elsewhere but used here)\n}\n\nstatic inline int tquic_encode_varint(u8 *buf, size_t buf_len, u64 val)\n{\n    int len = tquic_varint_len(val);\n    if (len > buf_len)\n        return -ENOSPC;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"tquic_varint_len\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add explicit check: `if (len == 0) return -EOVERFLOW;` / ** Add `if (len == 0) return -EOVERFLOW;` after the `tquic_varint_len()` call.",
    "tests_to_add": [
      "Add regression test for: `tquic_varint_len()` Returns 0 for Invalid Values Without Error Propagation (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-019",
    "fingerprint": "adaptive-exit-feedback-list_for_each_entry-path|net/tquic/multipath/tquic_scheduler.c|tquic_path|memory",
    "title": "Adaptive Feedback Uses Path After list_for_each_entry Exit",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_path. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_int_connection",
        "list_for_each_entry_rcu",
        "rcu_read_unlock",
        "tquic_update_rtt",
        "tquic_scheduler",
        "tquic_adaptive_feedback"
      ],
      "line_ranges": [],
      "snippets": [
        "list_for_each_entry_rcu(path, &conn->paths, list) {\n    if (path->path_id == fb->path_id)\n        break;\n    path_idx++;\n}\n\nif (path->path_id != fb->path_id) {  // path may be &conn->paths (list head)!\n    rcu_read_unlock();\n    return;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"adaptive\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a separate flag variable to track whether the path was found, or use `list_for_each_entry_rcu()` with a found flag check.",
    "tests_to_add": [
      "Add regression test for: Adaptive Feedback Uses Path After list_for_each_entry Exit (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-020",
    "fingerprint": "asn-character-pars-rang-time-validate|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "ASN.1 Time Parsing Does Not Validate Character Ranges",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int parse_time(const u8 *data, u32 len, s64 *time_out)\n{\n    ...\n    const char *t = (const char *)data + 1 + hdr_len;\n    year = (t[0] - '0') * 10 + (t[1] - '0');\n    year += (year < 50) ? 2000 : 1900;\n    month = (t[2] - '0') * 10 + (t[3] - '0');\n    day = (t[4] - '0') * 10 + (t[5] - '0');\n    hour = (t[6] - '0') * 10 + (t[7] - '0');\n    min = (t[8] - '0') * 10 + (t[9] - '0');\n    sec = (t[10] - '0') * 10 + (t[11] - '0');\n    ...\n    *time_out = mktime64(year, month, day, hour, min, sec);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"asn\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate each character is an ASCII digit before arithmetic. Validate month (1-12), day (1-31), hour (0-23), minute (0-59), second (0-59).",
    "tests_to_add": [
      "Add regression test for: ASN.1 Time Parsing Does Not Validate Character Ranges (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-021",
    "fingerprint": "authentication-aware-bypas-proxy-quic|net/tquic/masque/quic_proxy.c|tquic_quic_proxy_register_conn|security",
    "title": "Authentication Bypass in QUIC-Aware Proxy",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/quic_proxy.c :: tquic_quic_proxy_register_conn. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [
        "tquic_quic_proxy_register_conn",
        "quic_proxy"
      ],
      "line_ranges": [],
      "snippets": [
        "proxy->config.require_auth = false;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_quic_proxy_register_conn\" \"net/tquic/masque/quic_proxy.c\"",
      "rg -n \"authentication\" \"net/tquic/masque/quic_proxy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Set `require_auth = true` by default. Implement mandatory authentication (PSK, certificate, or token-based) in `tquic_quic_proxy_register_conn()` before processing any registration.",
    "tests_to_add": [
      "Add regression test for: Authentication Bypass in QUIC-Aware Proxy (net/tquic/masque/quic_proxy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-022",
    "fingerprint": "blest-callback-inconsistent-lock|net/tquic/multipath/sched_blest.c|blest_get_path|concurrency",
    "title": "BLEST Inconsistent Locking -- 3 of 6 Callbacks Lack Lock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/multipath/sched_blest.c :: blest_get_path. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_blest.c"
      ],
      "symbols": [
        "blest_get_path",
        "blest_path_removed",
        "blest_ack_received",
        "blest_loss_detected",
        "blest_packet_sent"
      ],
      "line_ranges": [],
      "snippets": [
        "// blest_ack_received -- NO LOCK\nstatic void blest_ack_received(...) {\n    ps = blest_find_path_state(sd, path->path_id);  // reads sd->paths[]\n    ps->inflight_bytes -= acked_bytes;               // modifies ps\n    ps->rtt_us = path->cc.smoothed_rtt_us;           // modifies ps\n    ps->send_rate = path->cc.bandwidth;              // modifies ps\n}\n\n// blest_path_removed -- NO LOCK\nstatic void blest_path_removed(...) {\n    ps = blest_find_path_state(sd, path->path_id);\n    ps->valid = false;        // races with blest_get_path reading valid\n    sd->current_path_id = TQUIC_INVALID_PATH_ID;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"blest_get_path\" \"net/tquic/multipath/sched_blest.c\"",
      "rg -n \"blest\" \"net/tquic/multipath/sched_blest.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `spin_lock_irqsave(&sd->lock, flags)` to `blest_path_removed()`, `blest_ack_received()`, and `blest_loss_detected()`.\n\n---",
    "tests_to_add": [
      "Add regression test for: BLEST Inconsistent Locking -- 3 of 6 Callbacks Lack Lock (net/tquic/multipath/sched_blest.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-023",
    "fingerprint": "busy-lock-packet-per-poll-unlock|net/tquic/napi.c|__skb_dequeue|concurrency",
    "title": "Busy-poll per-packet lock/unlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/napi.c :: __skb_dequeue. Category=concurrency, severity=S0.\nEvidence union: 2 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.c",
        "net/tquic/napi.c:460-465"
      ],
      "symbols": [
        "__skb_dequeue",
        "atomic_dec",
        "rates",
        "skb_queue_splice_init",
        "spin_lock_irqsave",
        "spin_unlock_irqrestore",
        "tquic_busy_poll",
        "tquic_napi_poll"
      ],
      "line_ranges": [
        "net/tquic/napi.c:460-465",
        "net/tquic/napi.c:317-317",
        "net/tquic/napi.c:295-295"
      ],
      "snippets": [
        "while (work_done < budget) {\n    spin_lock_irqsave(&tn->lock, flags);\n    skb = __skb_dequeue(&tn->rx_queue);\n    if (skb)\n        atomic_dec(&tn->rx_queue_len);\n    spin_unlock_irqrestore(&tn->lock, flags);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"__skb_dequeue\" \"net/tquic/napi.c\"",
      "rg -n \"busy\" \"net/tquic/napi.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use the same batch-splice pattern as `tquic_napi_poll()`: splice the queue to a local list under a single lock acquisition, then process without holding the lock. / ** Mirror the `tquic_napi_poll()` pattern -- use `skb_queue_splice_init()` to batch-dequeue into a local `sk_buff_head`, then process without holding the lock. Update `rx_queue_len` atomically by the batch count.",
    "tests_to_add": [
      "Add regression test for: Busy-poll per-packet lock/unlock (net/tquic/napi.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-024",
    "fingerprint": "addition-buffer-capsule-overflow-size|net/quic/tquic/masque/capsule.c|unknown_symbol|correctness",
    "title": "Capsule Buffer Size Addition Overflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/masque/capsule.c :: unknown_symbol. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/masque/capsule.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/masque/capsule.c:850-850",
        "net/quic/tquic/masque/capsule.c:894-894"
      ],
      "snippets": [
        "buf_len = CAPSULE_MAX_HEADER_SIZE + cap->length;      /* line 850 */\nbuf_len = CAPSULE_MAX_HEADER_SIZE + payload_len;       /* line 894 */",
        "if (cap->length > SIZE_MAX - CAPSULE_MAX_HEADER_SIZE)\n    return -EOVERFLOW;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"capsule\" \"net/quic/tquic/masque/capsule.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add overflow check:\n```c\nif (cap->length > SIZE_MAX - CAPSULE_MAX_HEADER_SIZE)\n    return -EOVERFLOW;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Capsule Buffer Size Addition Overflow (net/quic/tquic/masque/capsule.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-025",
    "fingerprint": "addres-complete-connect-ssrf-udp-validation|net/tquic/masque/connect_udp.c|resolve_target|security",
    "title": "Complete SSRF in CONNECT-UDP -- No Address Validation",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_udp.c :: resolve_target. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [
        "resolve_target",
        "tquic_connect_udp_tunnel",
        "sockaddr_in6",
        "ipv4_is_loopback",
        "ipv4_is_private_192",
        "ipv4_is_zeronet",
        "ipv4_is_lbcast",
        "ipv4_is_multicast",
        "ipv4_is_private_172",
        "tquic_connect_udp_target",
        "ipv4_is_private_10"
      ],
      "line_ranges": [],
      "snippets": [
        "static int resolve_target(struct tquic_connect_udp_tunnel *tunnel)\n{\n    struct tquic_connect_udp_target *target = &tunnel->target;\n    struct sockaddr_in *sin;\n    struct sockaddr_in6 *sin6;\n    int ret;\n\n    if (target->resolved)\n        return 0;\n\n    /* Try IPv4 first */\n    sin = (struct sockaddr_in *)&target->addr;\n    ret = in4_pton(target->host, strlen(target->host),\n                   (u8 *)&sin->sin_addr.s_addr, -1, NULL);\n    if (ret == 1) {\n        sin->sin_family = AF_INET;\n        sin->sin_port = htons(target->port);\n        target->resolved = true;\n        return 0;   /* <-- NO VALIDATION WHATSOEVER */\n    }\n    /* ... IPv6 path similarly unvalidated ... */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"resolve_target\" \"net/tquic/masque/connect_udp.c\"",
      "rg -n \"complete\" \"net/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add address validation after `in4_pton`/`in6_pton` succeeds. Block at minimum: `ipv4_is_loopback()`, `ipv4_is_multicast()`, `ipv4_is_lbcast()`, `ipv4_is_zeronet()`, `ipv4_is_private_10()`, `ipv4_is_private_172()`, `ipv4_is_private_192()`, link-local (169.254.0.0/16), and the IPv6 equivalents. Provide a configurable allowlist/denylist for deployment flexibility.\n\n---",
    "tests_to_add": [
      "Add regression test for: Complete SSRF in CONNECT-UDP -- No Address Validation (net/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-026",
    "fingerprint": "but-declar-ecf-lock-never-scheduler|net/tquic/multipath/sched_ecf.c|spin_lock_irqsave|concurrency",
    "title": "ECF Scheduler Declares Lock But Never Uses It",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/multipath/sched_ecf.c :: spin_lock_irqsave. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_ecf.c"
      ],
      "symbols": [
        "spin_lock_irqsave"
      ],
      "line_ranges": [],
      "snippets": [
        "// ecf_sched_data has spinlock_t lock -- never acquired\nstatic int ecf_get_path(...) {\n    // NO lock\n    ps = ecf_find_path_state(sd, path->path_id);\n    if (!ps) {\n        ps = ecf_alloc_path_state(sd, path->path_id); // modifies sd->paths[]\n    }\n    // reads ps->inflight_bytes, ps->send_rate -- concurrently modified by ecf_ack_received\n}\n\nstatic void ecf_packet_sent(...) {\n    // NO lock\n    ps->inflight_bytes += sent_bytes; // races with ecf_ack_received\n}\n\nstatic void ecf_ack_received(...) {\n    // NO lock\n    ps->inflight_bytes -= acked_bytes; // races with ecf_packet_sent\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"spin_lock_irqsave\" \"net/tquic/multipath/sched_ecf.c\"",
      "rg -n \"ecf\" \"net/tquic/multipath/sched_ecf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Wrap all accesses to `sd->paths[]` and `sd->current_path_id` in `spin_lock_irqsave(&sd->lock, flags)` / `spin_unlock_irqrestore(&sd->lock, flags)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: ECF Scheduler Declares Lock But Never Uses It (net/tquic/multipath/sched_ecf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-027",
    "fingerprint": "count-delta-ecn-process-track|net/tquic/tquic_input.c|tquic_cong_on_ecn|correctness",
    "title": "ECN CE Count Processing Does Not Track Deltas",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_cong_on_ecn. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cong_on_ecn",
        "tquic_ecn_tracking",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "if (has_ecn && ecn_ce > 0) {\n    /*\n     * Track previous ECN-CE count to detect increase.\n     * For now, treat any reported CE count as new marks.\n     */\n    tquic_cong_on_ecn(ctx->path, ecn_ce);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_on_ecn\" \"net/tquic/tquic_input.c\"",
      "rg -n \"ecn\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Store the previous ECN counts per path (in `struct tquic_ecn_tracking`) and only call `tquic_cong_on_ecn()` with the delta when `ecn_ce > path->ecn.ce_count`. Update the stored count after processing.",
    "tests_to_add": [
      "Add regression test for: ECN CE Count Processing Does Not Track Deltas (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-028",
    "fingerprint": "accumulation-gso-overflow-segment-skb-tailroom|net/quic/tquic/tquic_output.c|tquic_gso_ctx|correctness",
    "title": "GSO Segment Accumulation Can Overflow SKB Tailroom",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_gso_ctx. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_gso_ctx",
        "tquic_output"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1487-1487"
      ],
      "snippets": [
        "static int __maybe_unused tquic_gso_add_segment(struct tquic_gso_ctx *gso,\n                                                const u8 *data, size_t len)\n{\n    if (gso->gso_segs >= TQUIC_GSO_MAX_SEGS)\n        return -ENOSPC;\n\n    if (len > gso->gso_size)\n        return -EINVAL;\n\n    /* Add data to GSO SKB */\n    skb_put_data(gso->gso_skb, data, len);\n\n    /* Pad to segment size if not the last */\n    if (len < gso->gso_size) {\n        memset(skb_put(gso->gso_skb, gso->gso_size - len), 0,\n               gso->gso_size - len);\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_gso_ctx\" \"net/quic/tquic/tquic_output.c\"",
      "rg -n \"gso\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate cumulative bytes written against SKB tailroom\nbefore each `skb_put_data`/`skb_put` call, or check\n`skb_tailroom(gso->gso_skb) >= len` before the write.\n\n---",
    "tests_to_add": [
      "Add regression test for: GSO Segment Accumulation Can Overflow SKB Tailroom (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-029",
    "fingerprint": "allocation-gso-multiplication-overflow-skb|net/quic/tquic/tquic_output.c|tquic_output|concurrency",
    "title": "GSO SKB Allocation Multiplication Overflow",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_output. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output",
        "tquic_xmit"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1851-1851"
      ],
      "snippets": [
        "ret = tquic_output_packet(conn, path, skb);\nif (ret < 0)\n    break;",
        "gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);",
        "size_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size) ||\n    check_add_overflow(alloc_size, (size_t)MAX_HEADER, &alloc_size))\n    return -EOVERFLOW;\ngso->gso_skb = alloc_skb(alloc_size, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other.",
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"tquic_output\" \"net/quic/tquic/tquic_output.c\"",
      "rg -n \"gso\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `check_mul_overflow` and `check_add_overflow`:\n```c\nsize_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size) ||\n    check_add_overflow(alloc_size, (size_t)MAX_HEADER, &alloc_size))\n    return -EOVERFLOW;\ngso->gso_skb = alloc_skb(alloc_size, GFP_ATOMIC);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: GSO SKB Allocation Multiplication Overflow (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-030",
    "fingerprint": "handshake-offset-packet-pars-unvalidat|net/tquic/core/connection.c|tquic_parse_long_header|memory",
    "title": "Handshake Packet Parsing with Unvalidated Offsets",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_parse_long_header. Category=memory, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_parse_long_header"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:1932-1932",
        "net/tquic/core/connection.c:1934-1934",
        "net/tquic/core/connection.c:1938-1938",
        "net/tquic/core/connection.c:1947-1947",
        "net/tquic/core/connection.c:1950-1950"
      ],
      "snippets": [
        "if (len > 20) {\n    size_t hdr_offset;\n    u8 dcid_len, scid_len;\n    ...\n    hdr_offset = 5;\n    dcid_len = data[hdr_offset++];       // Line 1932\n    hdr_offset += dcid_len;              // No bounds check\n    scid_len = data[hdr_offset++];       // Line 1934: May be past buffer end\n    hdr_offset += scid_len;              // No bounds check\n\n    token_len = data[hdr_offset];        // Line 1938: May be past buffer end\n    ...\n    hdr_offset += token_len_size + token_len;  // Line 1947\n\n    pkt_length = data[hdr_offset];       // Line 1950: May be past buffer end\n    ...\n    hdr_offset += length_size;\n    hdr_offset += 4;                     // Line 1961\n\n    payload_offset = hdr_offset;\n\n    if (payload_offset < len &&\n        data[payload_offset] == 0x06) {  // Line 1967"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_parse_long_header\" \"net/tquic/core/connection.c\"",
      "rg -n \"handshake\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace the ad-hoc parsing with calls to the existing safe header parser `tquic_parse_long_header()`, or add proper bounds checks before every `data[hdr_offset]` access.\n\n---",
    "tests_to_add": [
      "Add regression test for: Handshake Packet Parsing with Unvalidated Offsets (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-031",
    "fingerprint": "actually-fail-hard-mode-revocation|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Hard-Fail Revocation Mode Does Not Actually Fail",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (ctx->check_revocation == TQUIC_REVOKE_HARD_FAIL) {\n        pr_warn(\"tquic_cert: Revocation check required but no OCSP stapling available\\n\");\n        /* In production, this should return an error.\n         * For now, allow to support existing deployments.\n         */\n    }\n\n    return 0;  // <--",
        "if (ctx->check_revocation == TQUIC_REVOKE_HARD_FAIL) {\n        pr_warn(\"tquic_cert: Revocation check required but no OCSP stapling available\\n\");\n        /* In production, this should return an error.\n         * For now, allow to support existing deployments.\n         */\n    }\n\n    return 0;  // <-- RETURNS SUCCESS EVEN IN HARD_FAIL MODE"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"hard\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** The function must return `-EKEYREVOKED` or a similar error when `TQUIC_REVOKE_HARD_FAIL` is set and revocation status cannot be determined.\n\n---",
    "tests_to_add": [
      "Add regression test for: Hard-Fail Revocation Mode Does Not Actually Fail (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-032",
    "fingerprint": "bypas-creation-hardcod-init_net-namespace-socket|net/tquic/masque/connect_udp.c|tquic_tunnel|correctness",
    "title": "Hardcoded init_net Namespace Bypass in Socket Creation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_udp.c :: tquic_tunnel. Category=correctness, severity=S0.\nEvidence union: 2 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c",
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net",
        "tquic_tunnel"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = sock_create_kern(&init_net, family, SOCK_DGRAM, IPPROTO_UDP, &sock);",
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP, &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_tunnel\" \"net/tquic/masque/connect_udp.c\"",
      "rg -n \"hardcod\" \"net/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Store a reference to the correct network namespace (`struct net *`) at connection establishment time (via `sock_net(sk)` from the original QUIC socket) and use that namespace for all subsequent socket creation.\n\n---",
    "tests_to_add": [
      "Add regression test for: Hardcoded init_net Namespace Bypass in Socket Creation (net/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-033",
    "fingerprint": "access-install-lock-secret-state-unlock|net/tquic/crypto/key_update.c|tquic_ku_derive_keys|concurrency",
    "title": "Install Secrets Accesses State Without Lock After Unlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: tquic_ku_derive_keys. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "tquic_ku_derive_keys",
        "tquic_initiate_key_update"
      ],
      "line_ranges": [
        "net/tquic/crypto/key_update.c:878-878",
        "net/tquic/crypto/key_update.c:881-881",
        "net/tquic/crypto/key_update.c:885-885",
        "net/tquic/crypto/key_update.c:890-890",
        "net/tquic/crypto/key_update.c:868-878"
      ],
      "snippets": [
        "spin_unlock_irqrestore(&state->lock, flags);    /* line 878 */\n\n/* Derive keys from secrets -- NO LOCK HELD */\nret = tquic_ku_derive_keys(state, &state->current_read);   /* line 881 */\nif (ret)\n    return ret;\n\nret = tquic_ku_derive_keys(state, &state->current_write);  /* line 885 */\nif (ret)\n    return ret;\n\n/* Pre-compute next generation keys -- NO LOCK HELD */\nret = tquic_ku_derive_next_generation(state, &state->current_read,\n                                      &state->next_read);   /* line 890 */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_ku_derive_keys\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"install\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Copy the secrets into local variables under the lock, then derive from\nthe local copies (the pattern already used correctly in\n`tquic_initiate_key_update` at lines 392-405). The results should be committed\nback under the lock.",
    "tests_to_add": [
      "Add regression test for: Install Secrets Accesses State Without Lock After Unlock (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-034",
    "fingerprint": "calculation-identity-integer-length-overflow-psk|net/tquic/crypto/handshake.c|tquic_hs_build_ch_extensions|correctness",
    "title": "Integer overflow in `tquic_hs_build_ch_extensions` PSK identity length calculations",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_build_ch_extensions. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_build_ch_extensions"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1224-1234",
        "net/tquic/crypto/handshake.c:1217-1218"
      ],
      "snippets": [
        "if (hs->psk_count > 0) {\n    u32 identities_len = 0;\n    u32 binders_len = 0;\n    u32 i;\n\n    for (i = 0; i < hs->psk_count; i++) {\n        identities_len += 2 + hs->psk_identities[i].identity_len + 4;\n        binders_len += 1 + hs->hash_len;\n    }\n\n    *p++ = (TLS_EXT_PRE_SHARED_KEY >> 8) & 0xff;\n ",
        "if (hs->psk_count > 0) {\n    u32 identities_len = 0;\n    u32 binders_len = 0;\n    u32 i;\n\n    for (i = 0; i < hs->psk_count; i++) {\n        identities_len += 2 + hs->psk_identities[i].identity_len + 4;\n        binders_len += 1 + hs->hash_len;\n    }\n\n    *p++ = (TLS_EXT_PRE_SHARED_KEY >> 8) & 0xff;\n    *p++ = TLS_EXT_PRE_SHARED_KEY & 0xff;\n    *p++ = ((identities_len + binders_len + 4) >> 8) & 0xff;\n    *p++ = (identities_len + binders_len + 4) & 0xff;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_build_ch_extensions\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"integer\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check for u32 overflow in the accumulation loop. Validate that\nthe total extension length fits in a u16.\n\n---",
    "tests_to_add": [
      "Add regression test for: Integer overflow in `tquic_hs_build_ch_extensions` PSK identity length calculations (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-035",
    "fingerprint": "balancer-expos-load-mode-plaintext-server|net/tquic/lb/quic_lb.c|pr_warn_once|memory",
    "title": "Load Balancer Plaintext Mode Exposes Server ID",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: pr_warn_once. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "pr_warn_once"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_LB_MODE_PLAINTEXT:\n    memcpy(cid->payload, plaintext, payload_len);\n    break;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"pr_warn_once\" \"net/tquic/lb/quic_lb.c\"",
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Log a `pr_warn_once()` when plaintext mode is selected. Consider requiring `CAP_NET_ADMIN` to create plaintext configs, or removing plaintext mode entirely. At minimum, add a prominent `IS THIS REALLY WHAT YOU WANT` style warning.",
    "tests_to_add": [
      "Add regression test for: Load Balancer Plaintext Mode Exposes Server ID (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-036",
    "fingerprint": "1918-check-filter-ipv4-network-private|net/tquic/tquic_tunnel.c|ipv4_is_linklocal_169|concurrency",
    "title": "Missing RFC 1918 / Private Network Filtering in IPv4 SSRF Checks",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: ipv4_is_linklocal_169. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "the",
        "ipv4_is_linklocal_169",
        "ipv4_is_private_192",
        "ipv4_is_private_172",
        "ipv4_is_private_10"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv4_is_loopback(addr4) ||\n    ipv4_is_multicast(addr4) ||\n    ipv4_is_lbcast(addr4) ||\n    ipv4_is_zeronet(addr4)) {\n    return -EACCES;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"ipv4_is_linklocal_169\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"rfc\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add checks for `ipv4_is_private_10()`, `ipv4_is_private_172()`, `ipv4_is_private_192()`, `ipv4_is_linklocal_169()`, and other reserved ranges per RFC 5737 (192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24). / Add checks for `ipv4_is_private_10()`, `ipv4_is_private_172()`, `ipv4_is_private_192()`, `ipv4_is_linklocal_169()`, and other reserved ranges per RFC 5737 (192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24).\n\n---",
    "tests_to_add": [
      "Add regression test for: Missing RFC 1918 / Private Network Filtering in IPv4 SSRF Checks (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-037",
    "fingerprint": "check-coalesc-output-packet-skb-tailroom|net/quic/tquic/tquic_output.c|tquic_output|correctness",
    "title": "Missing SKB Tailroom Check in Coalesced Packet Output",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 8 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_output. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1356-1356",
        "net/quic/tquic/tquic_output.c:981-981"
      ],
      "snippets": [
        "gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate;",
        "if (header_len > 0)\n    skb_put_data(skb, header, header_len);\n\nskb_put_data(skb, buf_stack, ctx.offset);",
        "payload_buf = skb_put(skb, max_payload + 16);\n\nctx.buf_len = max_payload - 128 - 16;  /* room for header + tag */",
        "skb_put_data(send_skb, frame_hdr, hdr_len);\nskb_put_data(send_skb, crypto_skb->data, data_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, other, security.",
      "Severity disagreement across reports: S0, S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_output\" \"net/quic/tquic/tquic_output.c\"",
      "rg -n \"skb\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `BUILD_BUG_ON(TQUIC_MAX_HEADER_SIZE > 64)` or use\n`min(header_len, 64)` as a defense.\n\n--- / ** Add `if (max_payload > 65535) max_payload = 1500;`\n\n---",
    "tests_to_add": [
      "Add regression test for: Missing SKB Tailroom Check in Coalesced Packet Output (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-038",
    "fingerprint": "code-hierarchy-lock-nest-timer-violation|net/quic/tquic/tquic_timer.c|tquic_timer_update_pto|concurrency",
    "title": "Nested Lock Hierarchy Violation in Timer Code",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_timer.c :: tquic_timer_update_pto. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 5 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer_update_pto",
        "tquic_timer_detect_lost",
        "tquic_timer_pto_expired",
        "tquic_timer"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_timer.c:975-1029",
        "net/quic/tquic/tquic_timer.c:820-870",
        "net/quic/tquic/tquic_timer.c:1628-1677",
        "net/quic/tquic/tquic_timer.c:1782-1782",
        "net/quic/tquic/tquic_timer.c:842-842"
      ],
      "snippets": [
        "// tquic_timer_pto_expired (timer callback, softirq context)\nspin_lock_bh(&ts->lock);           // Lock #1: ts->lock\n    spin_lock(&rs->lock);           // Lock #2: rs->lock (nested)\n    rs->pto_count++;\n    spin_unlock(&rs->lock);\nspin_unlock_bh(&ts->lock);",
        "spin_lock_bh(&ts->lock);           // Lock #1: ts->lock\n    for (i = 0; i < TQUIC_PN_SPACE_COUNT; i++) {\n        spin_lock(&pns->lock);      // Lock #2: pns->lock (nested)\n            spin_lock(&rs->lock);    // Lock #3: rs->lock (TRIPLE nested!)\n            spin_unlock(&rs->lock);\n        spin_unlo",
        "spin_lock_bh(&pns->lock);           // Lock pns FIRST\n    spin_lock(&rs->lock);            // Then rs\n    spin_unlock(&rs->lock);\nspin_unlock_bh(&pns->lock);",
        "spin_lock_bh(&ts->lock);           // Lock #1: ts->lock\n    for (i = 0; i < TQUIC_PN_SPACE_COUNT; i++) {\n        spin_lock(&pns->lock);      // Lock #2: pns->lock (nested)\n            spin_lock(&rs->lock);    // Lock #3: rs->lock (TRIPLE nested!)\n            spin_unlock(&rs->lock);\n        spin_unlock(&pns->lock);\n    }\nspin_unlock_bh(&ts->lock);",
        "spin_lock_bh(&pns->lock);\n    list_for_each_entry_safe(pkt, tmp, &pns->sent_list, list) {\n        spin_lock(&rs->lock);        // Nested under pns->lock\n        spin_unlock(&rs->lock);\n    }\nspin_unlock_bh(&pns->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_timer_update_pto\" \"net/quic/tquic/tquic_timer.c\"",
      "rg -n \"nest\" \"net/quic/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Standardize ALL uses of `rs->lock` and `pns->lock` to use `spin_lock_bh` / `spin_unlock_bh` consistently, since they are accessed from both timer/softirq context and process context.",
    "tests_to_add": [
      "Add regression test for: Nested Lock Hierarchy Violation in Timer Code (net/quic/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-039",
    "fingerprint": "hook-init_net-netfilter-register|net/tquic/tquic_nf.c|tquic_nf|security",
    "title": "Netfilter Hooks Registered Only in init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_nf.c :: tquic_nf. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_nf.c"
      ],
      "symbols": [
        "tquic_nf"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = nf_register_net_hooks(&init_net, tquic_nf_hooks,\n                            ARRAY_SIZE(tquic_nf_hooks));\n\ntquic_nf_proc_entry = proc_create(\"tquic_conntrack\", 0444,\n                                   init_net.proc_net, &tquic_nf_proc_ops);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_nf\" \"net/tquic/tquic_nf.c\"",
      "rg -n \"netfilter\" \"net/tquic/tquic_nf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Register hooks via `pernet_operations` so each namespace gets its own hooks, or verify this is intentionally init_net-only and document the limitation.\n\n---",
    "tests_to_add": [
      "Add regression test for: Netfilter Hooks Registered Only in init_net (net/tquic/tquic_nf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-040",
    "fingerprint": "addres-connect-injection-packet-validation|net/tquic/masque/connect_ip.c|netif_rx|correctness",
    "title": "No Address Validation in CONNECT-IP Packet Injection",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_ip.c :: netif_rx. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "netif_rx",
        "tquic_connect_ip_inject_packet",
        "connect_ip_validate_ip_header",
        "sk_buff",
        "tquic_connect_ip_tunnel"
      ],
      "line_ranges": [],
      "snippets": [
        "static int connect_ip_validate_ip_header(struct sk_buff *skb, u8 *version)\n{\n    /* Only checks: version, IHL >= 5, length consistency */\n    /* NO check on source address, destination address */\n    /* NO check on protocol field */\n    /* NO check for RFC1918, loopback, multicast, link-local */\n}",
        "int tquic_connect_ip_inject_packet(struct tquic_connect_ip_tunnel *tunnel,\n                                   struct sk_buff *skb)\n{\n    unsigned char *data;\n    u8 ip_version;\n\n    /* ... basic NULL/length checks ... */\n\n    data = skb->data;\n    ip_version = (data[0] >> 4) & 0x0f;\n\n    skb->dev = NULL;  /* No device association */\n    skb_reset_mac_header(skb);\n    skb_reset_network_header(skb);\n\n    if (ip_version == 4) {\n        skb->protocol = htons(ETH_P_IP);\n        ret = netif_rx(skb);  /* <-- Inject arbitrary packet into kernel */\n    }\n    /* ... IPv6 path similar ... */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"netif_rx\" \"net/tquic/masque/connect_ip.c\"",
      "rg -n \"addres\" \"net/tquic/masque/connect_ip.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add source and destination address validation in `connect_ip_validate_ip_header()` or a new function called before `netif_rx()`. Block loopback, multicast, broadcast, link-local, RFC1918, and IPv4-mapped-IPv6 addresses. Set `skb->dev` to the tunnel's virtual network device so netfilter rules apply correctly.\n\n---",
    "tests_to_add": [
      "Add regression test for: No Address Validation in CONNECT-IP Packet Injection (net/tquic/masque/connect_ip.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-041",
    "fingerprint": "check-creation-privilege-socket-tquic|net/tquic/tquic_proto.c|tquic_proto|security",
    "title": "No Privilege Check for TQUIC Socket Creation",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_proto.c :: tquic_proto. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_proto.c"
      ],
      "symbols": [
        "tquic_proto"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_proto\" \"net/tquic/tquic_proto.c\"",
      "rg -n \"privilege\" \"net/tquic/tquic_proto.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider requiring `CAP_NET_ADMIN` for bonding/multipath features, or at minimum for creating tunnels and MASQUE proxies.\n\n---",
    "tests_to_add": [
      "Add regression test for: No Privilege Check for TQUIC Socket Creation (net/tquic/tquic_proto.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-042",
    "fingerprint": "check-option-privilege-security-sensitive-socket|net/tquic/tquic_socket.c|tquic_socket|security",
    "title": "No Privilege Checks for Security-Sensitive Socket Options",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_socket. Category=security, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_socket",
        "tquic_sock_setsockopt"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:771-771",
        "net/tquic/tquic_socket.c:780-780",
        "net/tquic/tquic_socket.c:803-803",
        "net/tquic/tquic_socket.c:823-823",
        "net/tquic/tquic_socket.c:830-830"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_socket\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"privilege\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `ns_capable(sock_net(sk)->user_ns, CAP_NET_ADMIN)` checks for privileged options.\n\n---",
    "tests_to_add": [
      "Add regression test for: No Privilege Checks for Security-Sensitive Socket Options (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-043",
    "fingerprint": "hook-invocation-security_socket_|unknown_file|tquic_sock_bind|concurrency",
    "title": "No security_socket_* Hook Invocations",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: unknown_file :: tquic_sock_bind. Category=concurrency, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_sock_bind",
        "security_socket_create",
        "sock_net",
        "tquic_sock_create",
        "security_socket_bind",
        "tquic_connect_socket",
        "security_socket_sendmsg",
        "security_socket_connect",
        "security_socket_recvmsg",
        "socket"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Invoke appropriate `security_socket_*` hooks in TQUIC socket operations. At minimum:\n- `security_socket_create()` in `tquic_sock_create()`\n- `security_socket_connect()` in `tquic_connect_socket()`\n- `security_socket_bind()` in `tquic_sock_bind()`",
    "tests_to_add": [
      "Add regression test for: No security_socket_* Hook Invocations",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-044",
    "fingerprint": "bound-encrypt-frame-infinite-padd-payload|net/tquic/tquic_input.c|tquic_rx_ctx|correctness",
    "title": "PADDING Frame Infinite Skip Without Bound on Encrypted Payload",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_rx_ctx. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_rx_ctx",
        "tquic_process_padding_frame",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:565-571",
        "net/tquic/tquic_input.c:1901-1901",
        "net/tquic/tquic_input.c:2058-2058",
        "net/tquic/tquic_input.c:1900-1900",
        "net/tquic/tquic_input.c:2528-2529"
      ],
      "snippets": [
        "static int tquic_process_padding_frame(struct tquic_rx_ctx *ctx)\n{\n    /* Just skip padding bytes */\n    while (ctx->offset < ctx->len && ctx->data[ctx->offset] == 0)\n        ctx->offset++;\n\n    return 0;\n}",
        "if (ctx.offset == prev_offset)\n    return -EPROTO;",
        "/* Packet number length from first byte */\n    pkt_num_len = (data[0] & 0x03) + 1;   /* line 2529 or 2545 */\n    ...\n    /* Decode packet number */\n    pkt_num = tquic_decode_pkt_num(data + ctx.offset, pkt_num_len, 0); /* line 2573 */\n    ctx.offset += pkt_num_len;  /* line 2574 */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_rx_ctx\" \"net/tquic/tquic_input.c\"",
      "rg -n \"padd\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a bounds check before decoding the packet number:\n```c\nif (ctx.offset + pkt_num_len > len)\n    return -EINVAL;\n```",
    "tests_to_add": [
      "Add regression test for: PADDING Frame Infinite Skip Without Bound on Encrypted Payload (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-045",
    "fingerprint": "lock-path-pointer-release-use|net/quic/tquic/tquic_input.c|sockaddr_storage|concurrency",
    "title": "Path Pointer Use After Lock Release",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_input.c :: sockaddr_storage. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "sockaddr_storage",
        "tquic_path",
        "tquic_path_put",
        "tquic_connection",
        "tquic_input",
        "tquic_path_get"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:242-243",
        "net/quic/tquic/tquic_input.c:268-285"
      ],
      "snippets": [
        "static struct tquic_path *tquic_find_path_by_addr(struct tquic_connection *conn,\n                                                   struct sockaddr_storage *addr)\n{\n    struct tquic_path *found = NULL;\n\n    spin_lock_bh(&conn->paths_lock);\n    list_for_each_entry(path, &conn->paths, list) {\n        if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) {\n            found = path;\n            break;\n        }\n    }\n    spin_unlock_bh(&conn->paths_lock);\n\n    return found;  // Path can be freed after unlock!\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"sockaddr_storage\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"path\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Take a reference on the path before releasing the lock: `tquic_path_get(found)` and require callers to call `tquic_path_put()`. / Take a reference on the path before releasing the lock: `tquic_path_get(found)` and require callers to call `tquic_path_put()`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Path Pointer Use After Lock Release (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-046",
    "fingerprint": "frame-kmalloc-kzalloc-path-per|net/tquic/tquic_output.c|expensive|memory",
    "title": "Per-frame kzalloc + kmalloc in TX path",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 8 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: expensive. Category=memory, severity=S0.\nEvidence union: 5 file(s), 5 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1806-1826",
        "net/tquic/tquic_output.c:1819-1825",
        "net/tquic/tquic_output.c:1806-1825",
        "net/tquic/tquic_output.c:1825"
      ],
      "symbols": [
        "cache",
        "expensive",
        "memcpy",
        "structs",
        "tquic_assemble_packet",
        "tquic_coalesce_frames",
        "tquic_gen_stream_frame",
        "tquic_xmit",
        "tquic_pending_frame",
        "allocations",
        "buffer",
        "unlikely",
        "tquic_packet_cache",
        "copy_from_iter",
        "reference",
        "allocation",
        "tquic_output",
        "for"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1806-1826",
        "net/tquic/tquic_output.c:1819-1825",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1819-1825` then `365",
        "net/tquic/tquic_output.c:1806-1825",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1825"
      ],
      "snippets": [
        "frame = kzalloc(sizeof(*frame), GFP_ATOMIC);  /* struct allocation */\n...\nframe->data = kmalloc(chunk, GFP_ATOMIC);     /* data copy */\nmemcpy(frame->data, data + offset, chunk);",
        "/* Create pending frame */\nframe = kzalloc(sizeof(*frame), GFP_ATOMIC);\nif (unlikely(!frame)) {\n    ret = -ENOMEM;\n    break;\n}\n\nframe->type = TQUIC_FRAME_STREAM;\n...\nif (chunk > 0) {\n    frame->data = kmalloc(chunk, GFP_ATOMIC);\n    if (!frame->data) {\n        kfree(frame);\n        ret = -ENOMEM;\n        break;\n    }\n    memcpy(frame->data, data + offset, chunk);\n}",
        "memcpy(frame->data, data + offset, chunk);",
        "/* Create pending frame */\nframe = kzalloc(sizeof(*frame), GFP_ATOMIC);\nif (unlikely(!frame)) {\n    ret = -ENOMEM;\n    break;\n}\n\nframe->type = TQUIC_FRAME_STREAM;\n...\nif (chunk > 0) {\n    frame->data = kmalloc(chunk, GFP_ATOMIC);\n    if (!frame->data) {\n        kfree(frame);\n        ret = -ENOMEM;\n "
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory.",
      "Severity disagreement across reports: S0, S2."
    ],
    "verification_commands": [
      "rg -n \"expensive\" \"net/tquic/tquic_output.c\"",
      "rg -n \"per\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n1. Use a slab cache (`kmem_cache`) for `tquic_pending_frame` structs (fixed size, high churn).\n2. Eliminate the intermediate data copy entirely -- write STREAM frame data directly into the skb payload buffer during `tquic_assemble_packet()`. The current architecture allocates frame->data, copies data in, then copies again into the skb via `memcpy()` in `tquic_gen_stream_frame()`. This is a double copy. / ** Restructure `tquic_xmit()` to write directly into the skb's linear data area, eliminating the intermediate `tquic_pending_frame` allocation and copy. / ** Create a dedicated `kmem_cache` for `struct tquic_pending_frame` (the RX path already uses `tquic_packet_cache` as a precedent). For frame data, consider embedding a small inline buffer (e.g., 128 bytes) in the frame struct for small frames, falling back to `kmalloc` only for larger chunks. Alternatively, use a per-connection slab or a free list of pre-allocated frames.",
    "tests_to_add": [
      "Add regression test for: Per-frame kzalloc + kmalloc in TX path (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-047",
    "fingerprint": "aead-condition-crypto_aead_setkey-handle-packet-per|net/tquic/crypto/tls.c|tquic_decrypt_packet|concurrency",
    "title": "Per-Packet crypto_aead_setkey on Shared AEAD Handle -- Race Condition",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/tls.c :: tquic_decrypt_packet. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "tquic_decrypt_packet",
        "tquic_encrypt_packet",
        "crypto_aead_setkey",
        "quic_crypto"
      ],
      "line_ranges": [
        "net/tquic/crypto/tls.c:622-622",
        "net/tquic/crypto/tls.c:679-679"
      ],
      "snippets": [
        "/* In tquic_encrypt_packet(), line 622: */\nret = crypto_aead_setkey(crypto->aead, keys->key, keys->key_len);\n\n/* In tquic_decrypt_packet(), line 679: */\nret = crypto_aead_setkey(crypto->aead, keys->key, keys->key_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_decrypt_packet\" \"net/tquic/crypto/tls.c\"",
      "rg -n \"per\" \"net/tquic/crypto/tls.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use separate AEAD transform handles for TX and RX, each with the key\nset once during key installation (not per-packet). The `quic_crypto.c` file\nalready does this correctly with `tx_aead` and `rx_aead` -- the `tls.c`\nimplementation should follow the same pattern.\n\n---",
    "tests_to_add": [
      "Add regression test for: Per-Packet crypto_aead_setkey on Shared AEAD Handle -- Race Condition (net/tquic/crypto/tls.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-048",
    "fingerprint": "bound-loop-off-pars-priority-priority_update|net/quic/tquic/core/priority.c|unknown_symbol|correctness",
    "title": "Priority PRIORITY_UPDATE Parsing Off-by-Two in Loop Bound",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/priority.c :: unknown_symbol. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/priority.c:633-633",
        "net/quic/tquic/core/priority.c:637-637"
      ],
      "snippets": [
        "for (i = 0; i < pf_len - 2; i++) {\n    if (pf_start[i] == 'u' && pf_start[i + 1] == '=') {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"priority\" \"net/quic/tquic/core/priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement proper Structured Field Dictionary parsing per RFC 8941. Validate the priority field value format strictly.",
    "tests_to_add": [
      "Add regression test for: Priority PRIORITY_UPDATE Parsing Off-by-Two in Loop Bound (net/quic/tquic/core/priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-049",
    "fingerprint": "buffer-decoder-header-large-overflow-qpack|net/quic/tquic/http3/qpack_decoder.c|qpack_decoder|memory",
    "title": "QPACK Decoder Stack Buffer Overflow via Large Headers",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/qpack_decoder.c :: qpack_decoder. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [
        "qpack_decoder",
        "qpack_decode_headers",
        "qpack_decoder_process_encoder_stream"
      ],
      "line_ranges": [],
      "snippets": [
        "char name_buf[QPACK_MAX_HEADER_NAME_LEN];   /* 256 bytes on stack */\nchar value_buf[QPACK_MAX_HEADER_VALUE_LEN];  /* 8192 bytes on stack */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"qpack_decoder\" \"net/quic/tquic/http3/qpack_decoder.c\"",
      "rg -n \"qpack\" \"net/quic/tquic/http3/qpack_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace stack buffers with heap allocation (kmalloc with GFP_ATOMIC). The value_buf alone at 8192 bytes is dangerously large for kernel stack. Alternatively, reduce QPACK_MAX_HEADER_VALUE_LEN and allocate from a slab cache.\n\n---",
    "tests_to_add": [
      "Add regression test for: QPACK Decoder Stack Buffer Overflow via Large Headers (net/quic/tquic/http3/qpack_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-050",
    "fingerprint": "creation-frame-quic_packet-stream-uncapp|net/quic/tquic/core/quic_packet.c|quic_packet|correctness",
    "title": "quic_packet.c Stream Frame - Uncapped Stream Creation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 6 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/quic_packet.c :: quic_packet. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [
        "quic_packet",
        "tquic_stream_create_internal",
        "tquic_stream_open_incoming"
      ],
      "line_ranges": [
        "net/quic/tquic/core/quic_packet.c:1248-1248",
        "net/quic/tquic/core/quic_packet.c:158-158",
        "net/quic/tquic/core/quic_packet.c:938-938"
      ],
      "snippets": [
        "estimated_min_bytes = (1 + ack_range_count * 2);",
        "stream = tquic_stream_lookup_internal(conn, stream_id);\nif (!stream) {\n    stream = tquic_stream_create_internal(conn, stream_id);\n    if (!stream)\n        return -ENOMEM;\n}",
        "/* Process any remaining coalesced packets */\nif (next_skb)\n    return tquic_packet_process(conn, next_skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory, other.",
      "Severity disagreement across reports: S0, S2."
    ],
    "verification_commands": [
      "rg -n \"quic_packet\" \"net/quic/tquic/core/quic_packet.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace `tquic_stream_create_internal` with\n`tquic_stream_open_incoming` which validates peer's MAX_STREAMS limit.\n\n--- / ** Convert recursion to iteration using a loop, or limit\ncoalesced packet depth to a small constant (e.g., 4, since RFC only expects\nInitial + Handshake + 1-RTT).",
    "tests_to_add": [
      "Add regression test for: quic_packet.c Stream Frame - Uncapped Stream Creation (net/quic/tquic/core/quic_packet.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-051",
    "fingerprint": "between-condition-poll-race-recvmsg-sendmsg|net/tquic/tquic_socket.c|read_once|concurrency",
    "title": "Race Condition Between `tquic_destroy_sock()` and Poll/Sendmsg/Recvmsg",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 5 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: read_once. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "read_once",
        "skb_queue_len",
        "skb_queue_empty",
        "tquic_poll",
        "tquic_socket",
        "tquic_sock",
        "sock",
        "write_once",
        "tquic_destroy_sock"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:568-568"
      ],
      "snippets": [
        "if (conn && stream) {\n    if (!skb_queue_empty(&stream->recv_buf))\n        mask |= EPOLLIN | EPOLLRDNORM;\n}",
        "void tquic_destroy_sock(struct sock *sk)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    /* ... */\n    if (tsk->conn) {\n        /* ... */\n        tquic_conn_destroy(tsk->conn);\n        tsk->conn = NULL;\n    }\n}",
        "conn = READ_ONCE(tsk->conn);\n    stream = READ_ONCE(tsk->default_stream);\n    if (conn && stream) {\n        if (!skb_queue_empty(&stream->recv_buf))  // <--- stream may be freed"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, correctness, other.",
      "Severity disagreement across reports: S0, S1, S2."
    ],
    "verification_commands": [
      "rg -n \"read_once\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"race\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** This is acceptable for poll() semantics (spurious wakeups are allowed), but document the intentional lockless access.",
    "tests_to_add": [
      "Add regression test for: Race Condition Between `tquic_destroy_sock()` and Poll/Sendmsg/Recvmsg (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-052",
    "fingerprint": "addres-comparison-constant-non-retry-time|net/tquic/core/connection.c|crypto_memneq|memory",
    "title": "Retry Token Address Validation Uses Non-Constant-Time Comparison",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: crypto_memneq. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "crypto_memneq",
        "tquic_con",
        "tquic_conn_dbg"
      ],
      "line_ranges": [],
      "snippets": [
        "memcpy(&token_hash, p, sizeof(token_hash));\nif (token_hash != expected_hash) {\n    tquic_conn_dbg(conn, \"retry token address mismatch\\n\");\n    return -EINVAL;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"net/tquic/core/connection.c\"",
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `crypto_memneq()` for the hash comparison, or accept the current design as adequate given AEAD authentication.",
    "tests_to_add": [
      "Add regression test for: Retry Token Address Validation Uses Non-Constant-Time Comparison (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-053",
    "fingerprint": "buffer-overread-plaintext-retry-token-validation|net/tquic/core/connection.c|unknown_symbol|memory",
    "title": "Retry Token Validation -- Plaintext Buffer Overread",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:1195-1195"
      ],
      "snippets": [
        "/* Copy ciphertext to plaintext buffer for in-place decryption */\nmemcpy(plaintext, token + TQUIC_RETRY_TOKEN_IV_LEN, ciphertext_len);",
        "u8 plaintext[128];\nciphertext_len = token_len - TQUIC_RETRY_TOKEN_IV_LEN;",
        "token_len >= TQUIC_RETRY_TOKEN_IV_LEN + sizeof(ktime_t) + 1 + sizeof(u32) + TQUIC_RETRY_TOKEN_TAG_LEN"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (ciphertext_len > sizeof(plaintext)) return -EINVAL;` before the memcpy.",
    "tests_to_add": [
      "Add regression test for: Retry Token Validation -- Plaintext Buffer Overread (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-054",
    "fingerprint": "accept-bound-buffer-check-cid-pars|net/tquic/core/connection.c|tquic_cid|memory",
    "title": "Server Accept CID Parsing Missing Bounds Checks -- Buffer Over-Read",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_cid. Category=memory, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:2450-2450",
        "net/tquic/core/connection.c:2509-2509"
      ],
      "snippets": [
        "/* tquic_conn_server_accept */\noffset = 5;\ndcid_len = data[offset++];     // Line 2450: No check that offset < len\nmemcpy(dcid.id, data + offset, dcid_len);  // No check dcid_len <= TQUIC_MAX_CID_LEN\ndcid.len = dcid_len;\noffset += dcid_len;\n\nscid_len = data[offset++];     // Line 2509: No check that",
        "if (offset >= len) goto err_free;\ndcid_len = data[offset++];\nif (dcid_len > TQUIC_MAX_CID_LEN) goto err_free;\nif (offset + dcid_len > len) goto err_free;",
        "/* tquic_conn_server_accept */\noffset = 5;\ndcid_len = data[offset++];     // Line 2450: No check that offset < len\nmemcpy(dcid.id, data + offset, dcid_len);  // No check dcid_len <= TQUIC_MAX_CID_LEN\ndcid.len = dcid_len;\noffset += dcid_len;\n\nscid_len = data[offset++];     // Line 2509: No check that offset < len\nif (offset + scid_len > len)\n    goto err_free;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/tquic/core/connection.c\"",
      "rg -n \"server\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add bounds validation:\n```c\nif (offset >= len) goto err_free;\ndcid_len = data[offset++];\nif (dcid_len > TQUIC_MAX_CID_LEN) goto err_free;\nif (offset + dcid_len > len) goto err_free;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Server Accept CID Parsing Missing Bounds Checks -- Buffer Over-Read (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-055",
    "fingerprint": "buffer-cache-decryption-payload-slab-small|net/quic/tquic/tquic_input.c|tquic_process_stream_frame|concurrency",
    "title": "Slab Cache Decryption Buffer May Be Too Small for Payload",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 8 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_process_stream_frame. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 10 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_stream_frame",
        "tquic_find_path_by_addr",
        "tquic_process_max_data_frame",
        "tquic_input",
        "tquic_decrypt_payload"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:944-944",
        "net/quic/tquic/tquic_input.c:909-909",
        "net/quic/tquic/tquic_input.c:963-968",
        "net/quic/tquic/tquic_input.c:1015-1015",
        "net/quic/tquic/tquic_input.c:917-917",
        "net/quic/tquic/tquic_input.c:251-251",
        "net/quic/tquic/tquic_input.c:245-245",
        "net/quic/tquic/tquic_input.c:245-261",
        "net/quic/tquic/tquic_input.c:49-49",
        "net/quic/tquic/tquic_input.c:2618-2618"
      ],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);",
        "if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) {\n    decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC);\n    decrypted_from_slab = true;\n} else {\n    decrypted = kmalloc(payload_len, GFP_ATOMIC);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, memory, other.",
      "Severity disagreement across reports: S0, S1, S2, S3."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_stream_frame\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"slab\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a comment explaining why `_bh` is not needed in the receive path. / Add a comment explaining why `_bh` is not needed in the receive path.\n\n--- / ** Pass the output buffer size to `tquic_decrypt_payload`",
    "tests_to_add": [
      "Add regression test for: Slab Cache Decryption Buffer May Be Too Small for Payload (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-056",
    "fingerprint": "atomic-context-sleep|net/tquic/tquic_migration.c|tquic_path|concurrency",
    "title": "Sleep-in-Atomic Context",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 3 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_anti_amplification_sent",
        "tquic_migration",
        "tquic_session_ttl_expired",
        "tquic_conn_close_with_error",
        "tquic_path_free",
        "synchronize_rcu"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1395-1395",
        "net/tquic/tquic_migration.c:503-503"
      ],
      "snippets": [
        "bool tquic_path_anti_amplification_check(struct tquic_path *path, u64 bytes)\n{\n    u64 limit;\n    u64 sent, received;\n\n    if (!path->anti_amplification.active)\n        return true;\n\n    received = atomic64_read(&path->anti_amplification.bytes_received);\n    sent = atomic64_read(&path->anti_amplific",
        "tquic_session_ttl_expired()          \u2190 timer callback (softirq context)\n  \u2192 tquic_conn_close_with_error()    \u2190 line 1395\n    \u2192 (connection teardown)\n      \u2192 tquic_path_free()            \u2190 line 503\n        \u2192 synchronize_rcu()          \u2190 BLOCKING CALL IN ATOMIC CONTEXT",
        "void tquic_path_free(struct tquic_path *path) {\n    ...\n    synchronize_rcu();  // line 503: SLEEPS\n    kfree(path);\n}",
        "bool tquic_path_anti_amplification_check(struct tquic_path *path, u64 bytes)\n{\n    u64 limit;\n    u64 sent, received;\n\n    if (!path->anti_amplification.active)\n        return true;\n\n    received = atomic64_read(&path->anti_amplification.bytes_received);\n    sent = atomic64_read(&path->anti_amplification.bytes_sent);\n    limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;\n\n    if (sent + bytes > limit) {\n        /* ... blocked ... */\n        return false;\n    }\n    return true;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"sleep\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Sleep-in-Atomic Context (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-057",
    "fingerprint": "addres-address-bypass-filter-ipv4-ipv6|net/tquic/tquic_tunnel.c|ipv6_addr_v4mapped|security",
    "title": "SSRF via IPv4-Mapped IPv6 Addresses Bypasses Address Filtering",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: ipv6_addr_v4mapped. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "ipv6_addr_v4mapped",
        "ipv6_addr_is_isatap"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv6_addr_loopback(&addr6) ||\n    ipv6_addr_is_multicast(&addr6) ||\n    ipv6_addr_type(&addr6) & IPV6_ADDR_LINKLOCAL) {\n    return -EACCES;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"ipv6_addr_v4mapped\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"ssrf\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add checks for `ipv6_addr_v4mapped()`, `ipv6_addr_is_isatap()`, private RFC 1918 ranges within mapped addresses, and the unspecified address (`::` / `in6addr_any`). Also check for `::ffff:169.254.169.254` (cloud metadata). / Add checks for `ipv6_addr_v4mapped()`, `ipv6_addr_is_isatap()`, private RFC 1918 ranges within mapped addresses, and the unspecified address (`::` / `in6addr_any`). Also check for `::ffff:169.254.169.254` (cloud metadata).\n\n---",
    "tests_to_add": [
      "Add regression test for: SSRF via IPv4-Mapped IPv6 Addresses Bypasses Address Filtering (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-058",
    "fingerprint": "buffer-context-label-overflow-stack-tquic_hs_hkdf_expand_label|net/tquic/crypto/handshake.c|tquic_handshake|memory",
    "title": "Stack buffer overflow in `tquic_hs_hkdf_expand_label` -- unbounded label/context write to 512-byte stack buffer",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 6 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_handshake. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 5 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_handshake",
        "tquic_hs_set_sni",
        "tquic_hs_generate_client_hello",
        "tquic_hs_setup_psk",
        "tquic_hs_set_alpn",
        "tquic_hs_build_ch_extensions",
        "tquic_hs_hkdf_expand_label",
        "memcpy"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:762-762"
      ],
      "snippets": [
        "static int tquic_hs_build_ch_extensions(struct tquic_handshake *hs,\n                                        u8 *buf, u32 buf_len, u32 *out_len)\n{\n    u8 *p = buf;\n    // ...\n    /* Supported Versions extension */\n    *p++ = (TLS_EXT_SUPPORTED_VERSIONS >> 8) & 0xff;\n    *p++ = TLS_EXT_SUPPORTED_VERSI",
        "/* Validate that hkdf_label fits in the stack buffer */\nif (3 + 6 + label_len + 1 + context_len > sizeof(hkdf_label))\n    return -EINVAL;\nif (context_len > 255)\n    return -EINVAL;  /* TLS context is at most 255 bytes */",
        "static int tquic_hs_build_ch_extensions(struct tquic_handshake *hs,\n                                        u8 *buf, u32 buf_len, u32 *out_len)\n{\n    u8 *p = buf;\n    // ...\n    /* Supported Versions extension */\n    *p++ = (TLS_EXT_SUPPORTED_VERSIONS >> 8) & 0xff;\n    *p++ = TLS_EXT_SUPPORTED_VERSIONS & 0xff;\n    // ... ~170 bytes of direct writes ...\n    memcpy(p, hs->key_share.public_key, 32);\n    p += 32;\n    // ... ALPN, SNI, transport params, PSK identities ...",
        "static int tquic_hs_hkdf_expand_label(struct tquic_handshake *hs,\n                                      const u8 *secret, u32 secret_len,\n                                      const char *label,\n                                      const u8 *context, u32 context_len,\n                                      u8 *out, u32 out_len)\n{\n    u8 hkdf_label[512];     // <-- stack buffer\n    u8 *p = hkdf_label;\n    u32 label_len = strlen(label);\n    u32 total_label_len = 6 + label_len;\n    // ...\n    *p++ = (out_len >> 8) & 0xff;\n    *p++ = out_len & 0xff;\n    *p++ = total_label_len;\n    memcpy(p, \"tls13 \", 6);\n    p += 6;\n    memcpy(p, label, label_len);\n    p += label_len;\n    *p++ = context_len;        // <-- truncated to u8\n    if (context_len > 0) {\n        memcpy(p, context, context_len);   // <-- no bounds check\n        p += context_len;\n    }",
        "int tquic_hs_generate_client_hello(struct tquic_handshake *hs,\n                                   u8 *buf, u32 buf_len, u32 *out_len)\n{\n    u8 *p = buf;\n    // ...\n    /* Handshake header */\n    *p++ = TLS_HS_CLIENT_HELLO;\n    msg_len_ptr = p;\n    p += 3;\n    *p++ = (TLS_LEGACY_VERSION >> 8) & 0xff;\n    *p++ = TLS_LEGACY_VERSION & 0xff;\n    memcpy(p, hs->client_random, TLS_RANDOM_LEN);  // 32 bytes\n    p += TLS_RANDOM_LEN;\n    // ... session ID (up to 32 bytes) ...\n    // ... cipher suites (8 bytes) ...\n    // ... compression (2 bytes) ...\n    memcpy(p, extensions, ext_len);  // up to 2048 bytes\n    p += ext_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_handshake\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"stack\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add bounds checking throughout `tquic_hs_build_ch_extensions`. Every\nwrite to `p` must verify `p + N <= buf + buf_len` before writing. Use a macro similar to\n`TP_CHECK_SPACE` from the transport params encoder.\n\n--- / **\n```c\n/* Validate that hkdf_label fits in the stack buffer */\nif (3 + 6 + label_len + 1 + context_len > sizeof(hkdf_label))\n    return -EINVAL;\nif (context_len > 255)\n    return -EINVAL;  /* TLS context is at most 255 bytes */\n```\n\n--- / ** Check `buf_len` before each write block, or compute the total\nrequired size first and validate it fits.\n\n---",
    "tests_to_add": [
      "Add regression test for: Stack buffer overflow in `tquic_hs_hkdf_expand_label` -- unbounded label/context write to 512-byte stack buffer (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-059",
    "fingerprint": "bypass-machine-reset-state-stateles|net/tquic/tquic_input.c|tquic_conn_set_state|concurrency",
    "title": "Stateless Reset Bypasses State Machine",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_conn_set_state. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_connection",
        "tquic_input",
        "tquic_handle_stateless_reset",
        "tquic_conn_close_with_error",
        "sock",
        "tquic_rx_ctx"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:1308-1308"
      ],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    // ...\n    spin_unlock_bh(&conn->lock);\n    if (sk)\n        sk->sk_state_change(sk);\n}",
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;  // \u2190 DIRECT ASSIGNMENT\n    conn->error_code = EQUIC_NO_ERROR;\n\n    sk = READ_ONCE(conn->sk);\n    spin_unlock_bh(&conn->lock);\n\n    if (",
        "static int tquic_process_handshake_done_frame(struct tquic_rx_ctx *ctx)\n{\n    ...\n    spin_lock(&ctx->conn->lock);\n    if (ctx->conn->state == TQUIC_CONN_CONNECTING) {\n        ctx->conn->state = TQUIC_CONN_CONNECTED;  // line 1308: DIRECT\n        ctx->conn->handshake_complete = true;\n    }\n    spin_"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness.",
      "Severity disagreement across reports: S0, S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_set_state\" \"net/tquic/tquic_input.c\"",
      "rg -n \"stateles\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use the state machine: call `tquic_conn_set_state(conn, TQUIC_CONN_CLOSED, TQUIC_REASON_PEER_CLOSE)` instead.",
    "tests_to_add": [
      "Add regression test for: Stateless Reset Bypasses State Machine (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-060",
    "fingerprint": "alloc_skb-data-delivery-length-stream-u32|net/quic/tquic/core/quic_packet.c|tquic_stream|concurrency",
    "title": "Stream Data Delivery Uses u64 Length with u32 alloc_skb",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/quic_packet.c :: tquic_stream. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [
        "tquic_stream",
        "quic_packet"
      ],
      "line_ranges": [
        "net/quic/tquic/core/quic_packet.c:1198-1198"
      ],
      "snippets": [
        "static void quic_packet_deliver_stream_data(struct tquic_stream *stream, u64 offset,\n                                            const u8 *data, u64 len, bool fin)\n{\n    if (!stream || !data || len == 0)\n        return;\n\n    if (len > U32_MAX)\n        return;\n\n    skb = alloc_skb((unsigned int)len, ",
        "static void quic_packet_deliver_stream_data(struct tquic_stream *stream, u64 offset,\n                                            const u8 *data, u64 len, bool fin)\n{\n    if (!stream || !data || len == 0)\n        return;\n\n    if (len > U32_MAX)\n        return;\n\n    skb = alloc_skb((unsigned int)len, GFP_ATOMIC);\n    if (!skb)\n        return;\n\n    skb_put_data(skb, data, len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream\" \"net/quic/tquic/core/quic_packet.c\"",
      "rg -n \"stream\" \"net/quic/tquic/core/quic_packet.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Cap `len` to a reasonable maximum (e.g., 16384 or the\nconnection's max_stream_data) before allocation.\n\n---",
    "tests_to_add": [
      "Add regression test for: Stream Data Delivery Uses u64 Length with u32 alloc_skb (net/quic/tquic/core/quic_packet.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-061",
    "fingerprint": "cids-err_free-item-leak-register-timer|net/quic/tquic/core/connection.c|tquic_crypto_init_versioned|security",
    "title": "tquic_conn_server_accept() -- err_free leaks registered CIDs, work items, timers, crypto state",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/connection.c :: tquic_crypto_init_versioned. Category=security, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_crypto_init_versioned",
        "tquic_conn_server_accept",
        "tquic_conn_add_remote_cid",
        "tquic_conn_set_state",
        "tquic_conn_add_local_cid",
        "tquic_crypto_free"
      ],
      "line_ranges": [
        "net/quic/tquic/core/connection.c:2518-2518",
        "net/quic/tquic/core/connection.c:2524-2524",
        "net/quic/tquic/core/connection.c:2573-2573",
        "net/quic/tquic/core/connection.c:2492-2494",
        "net/quic/tquic/core/connection.c:2545-2545"
      ],
      "snippets": [
        "conn->state_machine = cs;  // set BEFORE error paths below\n\n// ... tquic_conn_add_remote_cid, tquic_conn_add_local_cid, crypto_init ...\n\nerr_free:\n    kfree(cs);\n    conn->state_machine = NULL;\n    return -EINVAL;",
        "err_free_crypto:\n    tquic_crypto_free(conn->crypto_state);\n    conn->crypto_state = NULL;\nerr_free_cids:\n    /* remove added CIDs */\nerr_free_cs:\n    skb_queue_purge(&cs->zero_rtt_buffer);\n    kfree(cs);\n    conn->state_machine = NULL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_crypto_init_versioned\" \"net/quic/tquic/core/connection.c\"",
      "rg -n \"tquic_conn_server_accept\" \"net/quic/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Create incremental error labels:\n```\nerr_free_crypto:\n    tquic_crypto_free(conn->crypto_state);\n    conn->crypto_state = NULL;\nerr_free_cids:\n    /* remove added CIDs */\nerr_free_cs:\n    skb_queue_purge(&cs->zero_rtt_buffer);\n    kfree(cs);\n    conn->state_machine = NULL;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_conn_server_accept() -- err_free leaks registered CIDs, work items, timers, crypto state (net/quic/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-062",
    "fingerprint": "actual-code-einval-error-overrid-tquic_conn_server_accept|net/quic/tquic/core/connection.c|tquic_conn_server_accept|correctness",
    "title": "tquic_conn_server_accept() -- overrides actual error code with -EINVAL",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/connection.c :: tquic_conn_server_accept. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_conn_server_accept"
      ],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    kfree(cs);\n    conn->state_machine = NULL;\n    return -EINVAL;  // BUG: discards actual 'ret' value"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_server_accept\" \"net/quic/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Change to `return ret;`",
    "tests_to_add": [
      "Add regression test for: tquic_conn_server_accept() -- overrides actual error code with -EINVAL (net/quic/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-063",
    "fingerprint": "failure-header-leak-packet-skb-tquic_send_connection_close|net/quic/tquic/tquic_output.c|tquic_send_connection_close|build",
    "title": "tquic_send_connection_close() -- SKB leak and unencrypted packet on header failure",
    "category": "build",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_send_connection_close. Category=build, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_send_connection_close",
        "tquic_build_short_header_internal",
        "tquic_output_packet",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "if (header_len > 0)\n    skb_put_data(skb, header, header_len);\n}\n\nskb_put_data(skb, buf, ctx.offset);\nkfree(buf);\n\nreturn tquic_output_packet(conn, path, skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: build, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_send_connection_close\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (header_len < 0) { kfree_skb(skb); kfree(buf); return header_len; }` before the `skb_put_data` calls.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_send_connection_close() -- SKB leak and unencrypted packet on header failure (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-064",
    "fingerprint": "connection-refcount-stream-tquic_stream_sendmsg-writ|net/quic/tquic/tquic_stream.c|tquic_stream_sendmsg|memory",
    "title": "tquic_stream_sendmsg Writes to Stream Without Connection Refcount on Stream",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_sendmsg. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_sendmsg",
        "tquic_stream",
        "tquic_conn_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_sendmsg\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Stream objects need reference counting. The stream_sock should hold a reference to the stream. Only when both the tree reference and the socket reference are dropped should the stream be freed.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_sendmsg Writes to Stream Without Connection Refcount on Stream (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-065",
    "fingerprint": "buffer-doubl-overflow-reallocation-transcript|net/quic/tquic/crypto/handshake.c|unknown_symbol|correctness",
    "title": "Transcript Buffer Reallocation Doubling Overflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/crypto/handshake.c :: unknown_symbol. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/crypto/handshake.c:842-842",
        "net/quic/tquic/crypto/handshake.c:849-849",
        "net/quic/tquic/crypto/handshake.c:859-859"
      ],
      "snippets": [
        "u32 new_alloc = max(new_len * 2, 4096U);",
        "u32 new_alloc;\nif (check_mul_overflow(new_len, 2U, &new_alloc))\n    new_alloc = TQUIC_MAX_TRANSCRIPT_SIZE;\nnew_alloc = max(new_alloc, 4096U);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"transcript\" \"net/quic/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `check_mul_overflow` or cap `new_alloc` more conservatively:\n```c\nu32 new_alloc;\nif (check_mul_overflow(new_len, 2U, &new_alloc))\n    new_alloc = TQUIC_MAX_TRANSCRIPT_SIZE;\nnew_alloc = max(new_alloc, 4096U);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Transcript Buffer Reallocation Doubling Overflow (net/quic/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-066",
    "fingerprint": "escape-init_net-namespace-tunnel|net/tquic/tquic_tunnel.c|net|security",
    "title": "Tunnel Uses init_net -- Namespace Escape",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: net. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP,\n                       &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"net\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"tunnel\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use the network namespace from the QUIC connection's socket (`sock_net(conn->sk)`) instead of `&init_net`. Pass the correct `struct net *` through the client and tunnel structures. / Use the network namespace from the QUIC connection's socket (`sock_net(conn->sk)`) instead of `&init_net`. Pass the correct `struct net *` through the client and tunnel structures.\n\n---",
    "tests_to_add": [
      "Add regression test for: Tunnel Uses init_net -- Namespace Escape (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-067",
    "fingerprint": "allocation-attacker-capsule-controll-length-memory|net/tquic/masque/capsule.c|capsule_alloc|perf",
    "title": "Unbounded Memory Allocation from Attacker-Controlled Capsule Length",
    "category": "perf",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/capsule.c :: capsule_alloc. Category=perf, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/capsule.c"
      ],
      "symbols": [
        "capsule_alloc",
        "capsule"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Header complete, allocate capsule */\nparser->cur_capsule = capsule_alloc(\n    parser->header.type,\n    parser->header.length,  /* <-- attacker-controlled u64 */\n    GFP_ATOMIC);",
        "struct capsule *capsule_alloc(u64 type, size_t payload_len, gfp_t gfp)\n{\n    struct capsule *cap;\n    /* ... allocate cap ... */\n    cap->type = type;\n    cap->length = payload_len;\n\n    if (payload_len > 0) {\n        cap->value = kmalloc(payload_len, gfp);  /* <-- NO UPPER BOUND CHECK */\n        if",
        "struct capsule *capsule_alloc(u64 type, size_t payload_len, gfp_t gfp)\n{\n    struct capsule *cap;\n    /* ... allocate cap ... */\n    cap->type = type;\n    cap->length = payload_len;\n\n    if (payload_len > 0) {\n        cap->value = kmalloc(payload_len, gfp);  /* <-- NO UPPER BOUND CHECK */\n        if (!cap->value) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, perf."
    ],
    "verification_commands": [
      "rg -n \"capsule_alloc\" \"net/tquic/masque/capsule.c\"",
      "rg -n \"unbound\" \"net/tquic/masque/capsule.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate `parser->header.length <= CAPSULE_MAX_PAYLOAD_SIZE` immediately after header decode succeeds, before calling `capsule_alloc()`. Additionally, add the same check inside `capsule_alloc()` as defense-in-depth.\n\n---",
    "tests_to_add": [
      "Add regression test for: Unbounded Memory Allocation from Attacker-Controlled Capsule Length (net/tquic/masque/capsule.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-068",
    "fingerprint": "free-lookup-path-use|net/tquic/tquic_input.c|memcmp|memory",
    "title": "Use-After-Free in Path Lookup",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_input.c :: memcmp. Category=memory, severity=S0.\nEvidence union: 2 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c",
        "net/tquic/tquic_input.c:253"
      ],
      "symbols": [
        "memcmp",
        "struct",
        "sockaddr_storage",
        "tquic_input",
        "tquic_path",
        "tquic_path_put",
        "tquic_connection",
        "tquic_find_path_by_addr"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:245-245",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:253",
        "net/tquic/tquic_input.c:245-261",
        "net/tquic/tquic_input.c:2562-2562"
      ],
      "snippets": [
        "if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, perf.",
      "Severity disagreement across reports: S0, S1."
    ],
    "verification_commands": [
      "rg -n \"memcmp\" \"net/tquic/tquic_input.c\"",
      "rg -n \"use\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Compare by `ss_family`, then compare only the relevant address+port fields for that family. / ** Compare only the relevant fields: for IPv4 compare `sin_family + sin_addr + sin_port` (8 bytes); for IPv6 compare `sin6_family + sin6_addr + sin6_port` (22 bytes). Or pre-compute and store a hash for fast comparison. / Implement reference counting on `tquic_path` objects. The lookup function should atomically increment the refcount under `paths_lock` before returning. Callers must call `tquic_path_put()` when done.",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in Path Lookup (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-069",
    "fingerprint": "cid-length-negotiation-overflow-packet-tquic_send_version_negotiation|net/tquic/core/connection.c|tquic_cid|correctness",
    "title": "Version Negotiation Packet Overflow -- Unsanitized CID Lengths in tquic_send_version_negotiation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_cid. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 4 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid",
        "tquic_connection",
        "tquic_send_version_negotiation",
        "tquic_conn_add_remote_cid"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:961-961",
        "net/tquic/core/connection.c:965-965",
        "net/tquic/core/connection.c:971-971",
        "net/tquic/core/connection.c:275-310"
      ],
      "snippets": [
        "int tquic_conn_add_remote_cid(struct tquic_connection *conn,\n                              const struct tquic_cid *cid, u64 seq, ...)\n{\n    ...\n    entry = tquic_cid_entry_create(cid, seq);\n    ...\n    list_add_tail(&entry->list, &cs->remote_cids);",
        "int tquic_send_version_negotiation(struct tquic_connection *conn,\n                                   const struct tquic_cid *dcid,\n                                   const struct tquic_cid *scid)\n{\n    u8 packet[256];\n    u8 *p = packet;\n\n    *p++ = 0x80;\n    *p++ = 0x00; *p++ = 0x00; *p++ = 0x00; *p++ = 0x00;\n\n    *p++ = scid->len;\n    memcpy(p, scid->id, scid->len);   // Line 961\n    p += scid->len;\n\n    *p++ = dcid->len;\n    memcpy(p, dcid->id, dcid->len);   // Line 965\n    p += dcid->len;\n\n    for (i = 0; tquic_supported_versions[i] != 0; i++) {\n        u32 ver = cpu_to_be32(tquic_supported_versions[i]);\n        memcpy(p, &ver, 4);           // Line 971\n        p += 4;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S0, S1, S3."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/tquic/core/connection.c\"",
      "rg -n \"version\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Calculate required size upfront and validate against `sizeof(packet)`.\n\n--- / ** Check for existing seq before adding.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Packet Overflow -- Unsanitized CID Lengths in tquic_send_version_negotiation (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-070",
    "fingerprint": "allocation-capsule-close-large-stack-webtransport|net/quic/tquic/http3/webtransport.c|unknown_symbol|memory",
    "title": "WebTransport Close Capsule Large Stack Allocation",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/webtransport.c :: unknown_symbol. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u8 buf[128 + WEBTRANSPORT_MAX_URL_LEN];  /* 128 + 8192 = 8320 bytes */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"webtransport\" \"net/quic/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use heap allocation (kmalloc/kzalloc) for this buffer.\n\n---",
    "tests_to_add": [
      "Add regression test for: WebTransport Close Capsule Large Stack Allocation (net/quic/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-071",
    "fingerprint": "af_xdp-device-init_net-lookup-socket-use|net/tquic/af_xdp.c|tquic_xsk_create|security",
    "title": "AF_XDP Socket and Device Lookup Use init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/af_xdp.c :: tquic_xsk_create. Category=security, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c"
      ],
      "symbols": [
        "tquic_xsk_create"
      ],
      "line_ranges": [
        "net/tquic/af_xdp.c:367-367",
        "net/tquic/af_xdp.c:1096-1096",
        "net/tquic/af_xdp.c:300-300"
      ],
      "snippets": [
        "// Socket creation (line 367):\nerr = sock_create_kern(&init_net, AF_XDP, SOCK_RAW, 0, &xsk->sock);\n\n// Device lookup (line 1096 and 1117):\ndev = dev_get_by_name(&init_net, ifname);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_xsk_create\" \"net/tquic/af_xdp.c\"",
      "rg -n \"af_xdp\" \"net/tquic/af_xdp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: AF_XDP Socket and Device Lookup Use init_net (net/tquic/af_xdp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-072",
    "fingerprint": "access-conn-lock-reset-stateles|net/tquic/tquic_input.c|tquic_connection|memory",
    "title": "conn->sk Accessed Without Lock After Stateless Reset",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_connection. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_connection",
        "sock",
        "tquic_release",
        "tquic_handle_stateless_reset"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:397-407"
      ],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    conn->error_code = EQUIC_NO_ERROR;\n\n    /* Read sk under lock to prevent use-after-free */\n    sk = READ_ONCE(conn->sk);\n    spin_un"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_connection\" \"net/tquic/tquic_input.c\"",
      "rg -n \"conn\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Hold a reference to the socket (`sock_hold(sk)`) under the lock, then call `sk_state_change`, then release the reference (`sock_put(sk)`).",
    "tests_to_add": [
      "Add regression test for: conn->sk Accessed Without Lock After Stateless Reset (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-073",
    "fingerprint": "bytes_ack-calculation-integer-overflow|net/quic/tquic/tquic_input.c|tquic_cong_on_ack|correctness",
    "title": "Integer Overflow in bytes_acked Calculation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_cong_on_ack. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cong_on_ack",
        "check_mul_overflow",
        "tquic_process_ack_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:737-737"
      ],
      "snippets": [
        "u64 bytes_acked = (first_ack_range + 1) * 1200;",
        "if (first_ack_range > 100000) /* Sanity: no packet contains >100K ranges */\n    first_ack_range = 100000;\nu64 bytes_acked = (first_ack_range + 1) * 1200;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_on_ack\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"integer\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Integer Overflow in bytes_acked Calculation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Integer Overflow in bytes_acked Calculation (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-074",
    "fingerprint": "lock-race-tquic_connect-tquic_sock_bind|net/tquic/tquic_socket.c|copies|memory",
    "title": "Missing Lock in `tquic_sock_bind()` -- Race with `tquic_connect()`",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: copies. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "copies",
        "tquic_sock_bind",
        "tquic_sock",
        "sockaddr_storage",
        "socket",
        "tquic_connect",
        "lock_sock",
        "sock",
        "sockaddr",
        "sockaddr_in",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:246-246"
      ],
      "snippets": [
        "int tquic_sock_bind(struct socket *sock, TQUIC_SOCKADDR *uaddr, int addr_len)\n{\n    struct sockaddr *addr = (struct sockaddr *)uaddr;\n    struct sock *sk = sock->sk;\n    struct tquic_sock *tsk = tquic_sk(sk);\n\n    if (addr_len < sizeof(struct sockaddr_in))\n        return -EINVAL;\n\n    memcpy(&tsk->b"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"copies\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"lock\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Missing Lock in `tquic_sock_bind()` -- Race with `tquic_connect()` (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-075",
    "fingerprint": "bound-coalesc-count-packet-upper|net/quic/tquic/tquic_input.c|tquic_udp_recv|correctness",
    "title": "Missing Upper Bound on Coalesced Packet Count",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_udp_recv. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 6 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_udp_recv",
        "tquic_parse_short_header_internal",
        "check_add_overflow",
        "tquic_parse_long_header_internal",
        "tquic_process_version_negotiation",
        "tquic_process_coalesced",
        "tquic_lookup_by_dcid"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:3079-3079",
        "net/quic/tquic/tquic_input.c:2080-2080",
        "net/quic/tquic/tquic_input.c:2129-2129",
        "net/quic/tquic/tquic_input.c:437-437",
        "net/quic/tquic/tquic_input.c:2924-2924",
        "net/quic/tquic/tquic_input.c:2923-2925"
      ],
      "snippets": [
        "while (offset < total_len) {\n    ...\n    offset += pkt_len;\n    packets++;\n}",
        "u8 dcid_len = min_t(size_t, len - 1, TQUIC_MAX_CID_LEN);\nconn = tquic_lookup_by_dcid(data + 1, dcid_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Severity disagreement across reports: S0, S2.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_udp_recv\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"upper\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Missing Upper Bound on Coalesced Packet Count', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Missing Upper Bound on Coalesced Packet Count (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-076",
    "fingerprint": "extract-header-length-number-packet-unprotection|net/tquic/tquic_input.c|tquic_remove_header_protection|correctness",
    "title": "Packet Number Length Extracted Before Header Unprotection",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_remove_header_protection. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_remove_header_protection"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2529-2529",
        "net/tquic/tquic_input.c:2545-2545",
        "net/tquic/tquic_input.c:2565-2565"
      ],
      "snippets": [
        "// Long header path (line 2529):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Short header path (line 2545):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Header protection removal (line 2565):\n    ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);",
        "ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_remove_header_protection\" \"net/tquic/tquic_input.c\"",
      "rg -n \"packet\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Move the `pkt_num_len` extraction to AFTER `tquic_remove_header_protection()`:\n```c\nret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;\n```",
    "tests_to_add": [
      "Add regression test for: Packet Number Length Extracted Before Header Unprotection (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-077",
    "fingerprint": "client-init_net-quic-server-socket-tcp|net/tquic/transport/quic_over_tcp.c|quic_over_tcp|security",
    "title": "QUIC-over-TCP Client and Server Sockets Use init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/transport/quic_over_tcp.c :: quic_over_tcp. Category=security, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/transport/quic_over_tcp.c"
      ],
      "symbols": [
        "quic_over_tcp"
      ],
      "line_ranges": [
        "net/tquic/transport/quic_over_tcp.c:1225-1225",
        "net/tquic/transport/quic_over_tcp.c:1446-1446"
      ],
      "snippets": [
        "// Client socket (line 1225):\nret = sock_create_kern(&init_net, addr->sa_family, SOCK_STREAM,\n                       IPPROTO_TCP, &conn->tcp_sk);\n\n// Server listener (line 1446):\nret = sock_create_kern(&init_net, AF_INET6, SOCK_STREAM,\n                       IPPROTO_TCP, &listener->tcp_sk);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"quic_over_tcp\" \"net/tquic/transport/quic_over_tcp.c\"",
      "rg -n \"quic\" \"net/tquic/transport/quic_over_tcp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: QUIC-over-TCP Client and Server Sockets Use init_net (net/tquic/transport/quic_over_tcp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-078",
    "fingerprint": "creation-netlink-path-refcount-underflow|net/tquic/tquic_netlink.c|tquic_netlink|memory",
    "title": "Refcount Underflow in Netlink Path Creation",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_netlink.c :: tquic_netlink. Category=memory, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_netlink"
      ],
      "line_ranges": [
        "net/tquic/tquic_netlink.c:427-427",
        "net/tquic/tquic_netlink.c:439-439",
        "net/tquic/tquic_netlink.c:445-445",
        "net/tquic/tquic_netlink.c:449-449",
        "net/tquic/tquic_netlink.c:631-631"
      ],
      "snippets": [
        "// tquic_nl_path_create (line 427):\nrefcount_set(&path->refcnt, 1);       // line 439: refcount = 1\nlist_add_tail_rcu(&path->list, ...);   // line 445: list owns it (needs ref)\nreturn path;                           // line 449: caller owns it (needs ref)\n// TWO owners, ONE refcount\n\n// tquic_path_r"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_netlink\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"refcount\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Refcount Underflow in Netlink Path Creation (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-079",
    "fingerprint": "ip_local_out-len-read-skb-stale|net/tquic/tquic_output.c|ip_local_out|correctness",
    "title": "Stale skb->len Read After ip_local_out",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: ip_local_out. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "ip_local_out",
        "ktime_get"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1730-1736"
      ],
      "snippets": [
        "/* Send via IP */\n    ret = ip_local_out(&init_net, NULL, skb);\n\n    /* Update path statistics */\n    if (ret >= 0) {\n        path->stats.tx_packets++;\n        path->stats.tx_bytes += skb->len;   /* <-- skb may be freed */\n        path->last_activity = ktime_get();",
        "u32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"ip_local_out\" \"net/tquic/tquic_output.c\"",
      "rg -n \"stale\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Save `skb->len` in a local variable before calling `ip_local_out()`:\n```c\nu32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;\n```",
    "tests_to_add": [
      "Add regression test for: Stale skb->len Read After ip_local_out (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-080",
    "fingerprint": "confusion-conn-machine-pointer-state-state_machine|net/tquic/tquic_migration.c|tquic_conn_get_migration_state|correctness",
    "title": "State Machine Type Confusion via `conn->state_machine` Void Pointer",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_conn_get_migration_state. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "could",
        "tquic_conn_get_migration_state",
        "tquic_migrate_auto",
        "tquic_server_start_session_ttl",
        "tquic_conn_get_session_state",
        "tquic_migration",
        "timer_list",
        "tquic_migration_cleanup",
        "tquic_pref_addr_client_cleanup",
        "tquic_connection",
        "tquic_session_state"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1098-1098"
      ],
      "snippets": [
        "static void tquic_session_ttl_expired(struct timer_list *t)\n{\n    struct tquic_session_state *state;\n    struct tquic_connection *conn;\n\n    state = from_timer(state, t, timer);\n    conn = state->conn;\n\n    /* Close connection - all paths failed and TTL expired */\n    tquic_conn_close_with_error(con"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S0, S1.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_get_migration_state\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"state\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'State Machine Type Confusion via `conn->state_machine` Void Pointer', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: State Machine Type Confusion via `conn->state_machine` Void Pointer (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-081",
    "fingerprint": "free-lookup-pointer-refcount-return-stream|net/quic/tquic/core/priority.c|tquic_stream|memory",
    "title": "Stream Lookup Returns Pointer Without Refcount -- Use-After-Free",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/priority.c :: tquic_stream. Category=memory, severity=S0.\nEvidence union: 4 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c",
        "net/quic/tquic/core/stream.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream",
        "tquic_stream_put",
        "rcu_read_lock",
        "h3_stream_lookup"
      ],
      "line_ranges": [
        "net/quic/tquic/core/priority.c:497-524",
        "net/quic/tquic/core/priority.c:1461-1489",
        "net/quic/tquic/core/priority.c:339-358",
        "net/quic/tquic/core/priority.c:60-85"
      ],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nnode = conn->streams.rb_node;\nwhile (node) {\n    stream = rb_entry(node, struct tquic_stream, node);\n    if (stream_id < stream->id)\n        node = node->rb_left;\n    else if (stream_id > stream->id)\n        node = node->rb_right;\n    else {\n        spin_unlock_bh(&conn->l"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream\" \"net/quic/tquic/core/priority.c\"",
      "rg -n \"stream\" \"net/quic/tquic/core/priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Stream Lookup Returns Pointer Without Refcount -- Use-After-Free (net/quic/tquic/core/priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-082",
    "fingerprint": "failover-hysteresi-race-toctou|net/quic/tquic/bond/tquic_failover.c|atomic_set|concurrency",
    "title": "TOCTOU Race in Failover Hysteresis",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/bond/tquic_failover.c :: atomic_set. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 4 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "atomic_set",
        "atomic_inc_return",
        "tquic_failover"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_failover.c:198-229",
        "net/quic/tquic/bond/tquic_failover.c:207-207",
        "net/quic/tquic/bond/tquic_failover.c:230-230",
        "net/quic/tquic/bond/tquic_failover.c:688-688"
      ],
      "snippets": [
        "WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1);\nWRITE_ONCE(pt->consec_successes, 0);",
        "switch (READ_ONCE(pt->hyst_state)) {        // Line 207\ncase TQUIC_PATH_HYST_DEGRADED:\n    if (READ_ONCE(pt->consec_failures) >= TQUIC_HYST_FAIL_THRESHOLD)\n        goto do_failover;                     // Line 230",
        "WRITE_ONCE(pt->consec_successes, READ_ONCE(pt->consec_successes) + 1);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"atomic_set\" \"net/quic/tquic/bond/tquic_failover.c\"",
      "rg -n \"toctou\" \"net/quic/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Either protect these operations with a per-path spinlock, or use `atomic_inc_return()` / `atomic_set()` with `atomic_t` fields instead of plain integers + READ_ONCE/WRITE_ONCE.",
    "tests_to_add": [
      "Add regression test for: TOCTOU Race in Failover Hysteresis (net/quic/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-083",
    "fingerprint": "check-field-reserv-tquic_new_stream-zero|net/quic/tquic/tquic_stream.c|tquic_conn_get|memory",
    "title": "TQUIC_NEW_STREAM Missing Reserved Field Zeroing Check",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_conn_get. Category=memory, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_conn_get"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:680-680"
      ],
      "snippets": [
        "if (args.flags > TQUIC_STREAM_UNIDI || args.reserved != 0)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_get\" \"net/quic/tquic/tquic_stream.c\"",
      "rg -n \"tquic_new_stream\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: TQUIC_NEW_STREAM Missing Reserved Field Zeroing Check (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-084",
    "fingerprint": "pointer-reference-return-smartnic-tquic_nic_find-useafterfree|net/tquic/offload/smartnic.c|tquic_offload_key_install|memory",
    "title": "UAF-P1-01: - SmartNIC tquic_nic_find() returns pointer without reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/offload/smartnic.c :: tquic_offload_key_install. Category=memory, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "tquic_offload_key_install",
        "tquic_offload_encrypt",
        "net_device",
        "tquic_nic_device",
        "tquic_nic_find",
        "tquic_nic_unregister",
        "tquic_offload_decrypt"
      ],
      "line_ranges": [
        "net/tquic/offload/smartnic.c:264-264",
        "net/tquic/offload/smartnic.c:300-300"
      ],
      "snippets": [
        "struct tquic_nic_device *tquic_nic_find(struct net_device *netdev)\n{\n    struct tquic_nic_device *dev;\n\n    spin_lock(&tquic_nic_lock);\n    list_for_each_entry(dev, &tquic_nic_devices, list) {\n        if (dev->netdev == netdev) {\n            spin_unlock(&tquic_nic_lock);  // <-- UNLOCK\n            r"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_offload_key_install\" \"net/tquic/offload/smartnic.c\"",
      "rg -n \"useafterfree\" \"net/tquic/offload/smartnic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P1-01: - SmartNIC tquic_nic_find() returns pointer without reference (net/tquic/offload/smartnic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-085",
    "fingerprint": "connect-free-use|net/tquic/tquic_socket.c|tquic_connection|memory",
    "title": "Use-After-Free in Connect",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_connection. Category=memory, severity=S0.\nEvidence union: 1 file(s), 5 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "sock",
        "tquic_connection",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:230-230",
        "net/tquic/tquic_socket.c:285-285",
        "net/tquic/tquic_socket.c:291-291",
        "net/tquic/tquic_socket.c:293-293",
        "net/tquic/tquic_socket.c:309-309"
      ],
      "snippets": [
        "int tquic_connect(struct sock *sk, ...) {\n    struct tquic_connection *conn = tsk->conn;  // line 230: cache pointer\n    ...\n    release_sock(sk);                           // line 285: drop lock\n    ret = tquic_wait_for_handshake(...);        // line 291: SLEEP\n    lock_sock(sk);                   ",
        "conn = tsk->conn;\nif (!conn) { ret = -ECONNABORTED; goto out_close; }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_connection\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"use\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in Connect (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-086",
    "fingerprint": "ip_local_out-namespace-network-wrong|net/tquic/tquic_output.c|unknown_symbol|security",
    "title": "Wrong Network Namespace in ip_local_out",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "priority_score": 10.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1730-1730",
        "net/tquic/tquic_output.c:1681-1681"
      ],
      "snippets": [
        "ret = ip_local_out(&init_net, NULL, skb);",
        "ret = ip_local_out(net, conn->sk, skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"wrong\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `sock_net(conn->sk)` instead of `&init_net`. The correct network namespace was already computed at line 1681 in the `rt` lookup:\n```c\nret = ip_local_out(net, conn->sk, skb);\n```",
    "tests_to_add": [
      "Add regression test for: Wrong Network Namespace in ip_local_out (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-087",
    "fingerprint": "actual-check-cipher-read-suite-tquic_hs_process_server_hello|unknown_file|tquic_hs_process_server_hello|other",
    "title": "(actual): `tquic_hs_process_server_hello` -- missing check before cipher suite read",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_hs_process_server_hello. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_hs_process_server_hello"
      ],
      "line_ranges": [],
      "snippets": [
        "p += session_id_len;\n\n    /* Cipher suite */\n    cipher_suite = (p[0] << 8) | p[1];\n    p += 2;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (p + 2 > end) return -EINVAL;` before the cipher suite read.\n\n---",
    "tests_to_add": [
      "Add regression test for: (actual): `tquic_hs_process_server_hello` -- missing check before cipher suite read",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-088",
    "fingerprint": "against-data-pkt_num_len-remain-revis-tquic_input|unknown_file|tquic_process_packet|other",
    "title": "(Revised): tquic_process_packet Does Not Validate pkt_num_len Against Remaining Data (tquic_input.c, lines 2528-2529, 2572-2574)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_process_packet. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_packet",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Packet number length from first byte */\n    pkt_num_len = (data[0] & 0x03) + 1;   /* line 2529 or 2545 */\n    ...\n    /* Decode packet number */\n    pkt_num = tquic_decode_pkt_num(data + ctx.offset, pkt_num_len, 0); /* line 2573 */\n    ctx.offset += pkt_num_len;  /* line 2574 */",
        "if (ctx.offset + pkt_num_len > len)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a bounds check before decoding the packet number:\n```c\nif (ctx.offset + pkt_num_len > len)\n    return -EINVAL;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: (Revised): tquic_process_packet Does Not Validate pkt_num_len Against Remaining Data (tquic_input.c, lines 2528-2529, 2572-2574)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-089",
    "fingerprint": "ack-failover-iterate-number-packet-range|net/tquic/bond/tquic_failover.c|tquic_failover_ctx|correctness",
    "title": "ACK Range Failover Can Iterate Over Unbounded Packet Number Range",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_failover.c :: tquic_failover_ctx. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover_ctx",
        "tquic_failover",
        "tquic_failover_on_ack_range",
        "tquic_failover_on_ack"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_failover_on_ack_range(struct tquic_failover_ctx *fc,\n                                u64 first, u64 last)\n{\n    for (pkt_num = first; pkt_num <= last; pkt_num++) {\n        if (tquic_failover_on_ack(fc, pkt_num) == 0)\n            count++;\n    }\n    return count;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_failover_ctx\" \"net/tquic/bond/tquic_failover.c\"",
      "rg -n \"ack\" \"net/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'ACK Range Failover Can Iterate Over Unbounded Packet Number Range', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: ACK Range Failover Can Iterate Over Unbounded Packet Number Range (net/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-090",
    "fingerprint": "af_xdp-container-device-escape-init_net-lookup|unknown_file|ns_capable|other",
    "title": "AF_XDP Socket and Device Lookup Use init_net (Container Escape)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: ns_capable. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "ns_capable",
        "capable"
      ],
      "line_ranges": [],
      "snippets": [
        "// Socket creation (line 367):\nerr = sock_create_kern(&init_net, AF_XDP, SOCK_RAW, 0, &xsk->sock);\n\n// Device lookup (line 1096 and 1117):\ndev = dev_get_by_name(&init_net, ifname);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace `&init_net` with `current->nsproxy->net_ns` consistently, and use `ns_capable()` instead of `capable()` to check capabilities relative to the correct namespace.\n\n---",
    "tests_to_add": [
      "Add regression test for: AF_XDP Socket and Device Lookup Use init_net (Container Escape)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-091",
    "fingerprint": "allocation-attacker-controll-siz||unknown_symbol|concurrency",
    "title": "Attacker-Controlled Allocation Sizes",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: unknown_symbol. Category=concurrency, severity=S0.\nEvidence union: 0 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":909-909"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"attacker\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Attacker-Controlled Allocation Sizes ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-092",
    "fingerprint": "appear-cid-demux-functional-lookup-non|net/tquic/core/connection.c|tquic_cid_hash_add|security",
    "title": "CID demux/lookup appears non-functional: the RX path uses one table, while connection creation populates different tables",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/core/connection.c :: tquic_cid_hash_add. Category=security, severity=S0.\nEvidence union: 4 file(s), 4 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c",
        "net/tquic/core/quic_connection.c",
        "net/tquic/tquic_cid.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cid_hash_add",
        "tquic_cid_issue",
        "tquic_cid_lookup",
        "tquic_cid_pool_init",
        "tquic_conn_lookup_by_cid",
        "tquic_lookup_by_dcid"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:2696-2696",
        "net/tquic/core/quic_connection.c:463-463",
        "net/tquic/tquic_cid.c:530-530",
        "net/tquic/tquic_input.c:222-222"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid_hash_add\" \"net/tquic/core/connection.c\"",
      "rg -n \"cid\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Pick exactly one authoritative CID demux table for RX and ensure connection creation inserts the SCID/DCIDs into it.\n- Delete or hard-disable the unused tables (or clearly fence them behind config/ifdef) to reduce attack surface and confusion.",
    "tests_to_add": [
      "Add regression test for: CID demux/lookup appears non-functional: the RX path uses one table, while connection creation populates different tables (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-093",
    "fingerprint": "bypas-certificate-client-eku-logic-server|unknown_file|tquic_hs_verify_client_cert|security",
    "title": "Client Certificate Verification Uses Server Logic (EKU Bypass)",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_hs_verify_client_cert. Category=security, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_hs_verify_client_cert"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_hs_verify_client_cert(struct tquic_handshake *hs,\n                                struct tquic_connection *conn)\n{\n    /* Client certificate verification uses same logic\n     * but checks for client auth EKU instead of server auth\n     */\n    return tquic_hs_verify_server_cert(hs, conn);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** `tquic_hs_verify_client_cert` must call `verify_chain(ctx, false)` instead of delegating to the server verification function.\n\n---",
    "tests_to_add": [
      "Add regression test for: Client Certificate Verification Uses Server Logic (EKU Bypass)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-094",
    "fingerprint": "397-access-conn-lin-lock-reset|unknown_file|tquic_input|other",
    "title": "conn->sk Accessed Without Lock After Stateless Reset (tquic_input.c, lines 397-407)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    conn->error_code = EQUIC_NO_ERROR;\n\n    /* Read sk under lock to prevent use-after-free */\n    sk = READ_ONCE(conn->sk);\n    spin_unlock_bh(&conn->lock);\n\n    /* Notify upper layer */\n    if (sk)\n        sk->sk_state_change(sk);  /* <-- sk could be freed here */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Hold a reference to the socket (`sock_hold(sk)`) under the lock, then call `sk_state_change`, then release the reference (`sock_put(sk)`).\n\n---",
    "tests_to_add": [
      "Add regression test for: conn->sk Accessed Without Lock After Stateless Reset (tquic_input.c, lines 397-407)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-095",
    "fingerprint": "atomic-connection-fully-state-transition|net/tquic/core/connection.c|tquic_conn_set_state|concurrency",
    "title": "Connection State Transition Not Fully Atomic",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/core/connection.c :: tquic_conn_set_state. Category=concurrency, severity=S0.\nEvidence union: 2 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_handle_stateless_reset",
        "tquic_connection",
        "tquic_conn_state",
        "tquic_state_reason"
      ],
      "line_ranges": [],
      "snippets": [
        "static int tquic_conn_set_state(struct tquic_connection *conn,\n                                enum tquic_conn_state new_state,\n                                enum tquic_state_reason reason)\n{\n    // ... state validation ...\n    conn->state = new_state;\n    // ... entry actions (scheduling work, wa"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_set_state\" \"net/tquic/core/connection.c\"",
      "rg -n \"connection\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Connection State Transition Not Fully Atomic (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-096",
    "fingerprint": "atomic-connection-fully-state-transition|net/tquic/tquic_input.c|tquic_conn_set_state|correctness",
    "title": "Connection State Transition Not Fully Atomic",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_conn_set_state. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_handle_stateless_reset",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "static int tquic_conn_set_state(struct tquic_connection *conn,\n                                enum tquic_conn_state new_state,\n                                enum tquic_state_reason reason)\n{\n    // ... state validation ...\n    conn->state = new_state;\n    // ... entry actions (scheduling work, waking waiters) ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_set_state\" \"net/tquic/tquic_input.c\"",
      "rg -n \"connection\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** All state transitions MUST go through `tquic_conn_set_state()`, and the function should assert/acquire `conn->lock` internally. Fix `tquic_handle_stateless_reset()` to use the state machine.",
    "tests_to_add": [
      "Add regression test for: Connection State Transition Not Fully Atomic (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-097",
    "fingerprint": "excessive-recovery-stack-usage|net/tquic/fec/fec_decoder.c|attempt_rs_recovery|correctness",
    "title": "Excessive Stack Usage in RS Recovery",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_decoder.c :: attempt_rs_recovery. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "attempt_rs_recovery",
        "rs_recovery_ctx"
      ],
      "line_ranges": [],
      "snippets": [
        "u8 *symbols[255];       /* 255 * 8 = 2040 bytes (64-bit) */\nu16 lengths[255];       /* 255 * 2 = 510 bytes */\nu8 erasure_pos[255];    /* 255 bytes */\nu8 *recovered[255];     /* 2040 bytes */\nu16 recovered_lens[255]; /* 510 bytes */",
        "struct rs_recovery_ctx {\n    u8 *symbols[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u16 lengths[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u8 erasure_pos[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u8 *recovered[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u16 recovered_lens[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n};\n\nstruct rs_recovery_ctx *"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"attempt_rs_recovery\" \"net/tquic/fec/fec_decoder.c\"",
      "rg -n \"excessive\" \"net/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Excessive Stack Usage in RS Recovery', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Excessive Stack Usage in RS Recovery (net/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-098",
    "fingerprint": "but-connection-global-hashtable-initializ-never|net/tquic/tquic_main.c|hashtable|correctness",
    "title": "Global connection hashtable (`tquic_conn_table`) is initialized and removed-from, but never inserted-into",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/tquic_main.c :: hashtable. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_main.c"
      ],
      "symbols": [
        "hashtable",
        "rhashtable_remove_fast",
        "tquic_conn_lookup_by_token",
        "tquic_conn_table"
      ],
      "line_ranges": [
        "net/tquic/tquic_main.c:145-145",
        "net/tquic/tquic_main.c:796-796"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"hashtable\" \"net/tquic/tquic_main.c\"",
      "rg -n \"global\" \"net/tquic/tquic_main.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Either wire up insertion consistently at connection establishment, or delete `tquic_conn_table` and all iteration users in favor of the per-netns list already used by `tquic_conn_lookup_by_token()`.",
    "tests_to_add": [
      "Add regression test for: Global connection hashtable (`tquic_conn_table`) is initialized and removed-from, but never inserted-into (net/tquic/tquic_main.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-099",
    "fingerprint": "header-ignor-key-length-number-output|net/tquic/tquic_input.c|tquic_hp_unprotect|security",
    "title": "Header protection outputs are ignored; packet-number length + key phase are derived from protected header",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/tquic_input.c :: tquic_hp_unprotect. Category=security, severity=S0.\nEvidence union: 1 file(s), 3 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_hp_unprotect",
        "tquic_remove_header_protection"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2528-2528",
        "net/tquic/tquic_input.c:2539-2539",
        "net/tquic/tquic_input.c:302-302"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_hp_unprotect\" \"net/tquic/tquic_input.c\"",
      "rg -n \"header\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Treat `tquic_hp_unprotect()` as authoritative for `pn_len` and (short header) `key_phase`.\n- After HP removal, recompute any fields derived from the masked bits (pn length, key phase, reserved bits validation).\n- In short header parsing: do not interpret spin/key-phase/pn-len prior to unprotect.",
    "tests_to_add": [
      "Add regression test for: Header protection outputs are ignored; packet-number length + key phase are derived from protected header (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-100",
    "fingerprint": "256-algorithmic-complexity-decoder-dos-huffman|net/quic/tquic/http3/qpack.c|unknown_symbol|security",
    "title": "Huffman Decoder O(n*256) Algorithmic Complexity DoS",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/qpack.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (decoded < out_len && bit_offset < total_bits) {\n    /* Try each symbol to find match */\n    for (sym = 0; sym < 256; sym++) {\n        u32 code = qpack_huffman_encode_table[sym].code;\n        u8 nbits = qpack_huffman_encode_table[sym].nbits;\n        ...\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"huffman\" \"net/quic/tquic/http3/qpack.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Huffman Decoder O(n*256) Algorithmic Complexity DoS (net/quic/tquic/http3/qpack.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-101",
    "fingerprint": "calculation-coupl-increase-integer-overflow|net/tquic/bond/cong_coupled.c|coupled_cc_increase|correctness",
    "title": "Integer Overflow in Coupled CC Increase Calculation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/cong_coupled.c :: coupled_cc_increase. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "coupled_cc_increase"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Compute with overflow protection: reorder to divide early */\nu64 increase = div64_u64((u64)alpha * acked_bytes, total_cwnd * COUPLED_ALPHA_SCALE);\nincrease = increase * mss; /* Now safe: increase is small after division */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"coupled_cc_increase\" \"net/tquic/bond/cong_coupled.c\"",
      "rg -n \"integer\" \"net/tquic/bond/cong_coupled.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Integer Overflow in Coupled CC Increase Calculation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Integer Overflow in Coupled CC Increase Calculation (net/tquic/bond/cong_coupled.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-102",
    "fingerprint": "addres-discovery-enumerat-host-interfac-ipv4|net/tquic/tquic_ipv6.c|unknown_symbol|security",
    "title": "IPv4/IPv6 Address Discovery Enumerates Host Interfaces",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_ipv6.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 2 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_ipv6.c",
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for_each_netdev(&init_net, dev) {",
        "for_each_netdev_rcu(&init_net, dev) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"ipv4\" \"net/tquic/tquic_ipv6.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: IPv4/IPv6 Address Discovery Enumerates Host Interfaces (net/tquic/tquic_ipv6.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-103",
    "fingerprint": "addres-container-discovery-enumerat-host-interfac|unknown_file|unknown_symbol|other",
    "title": "IPv4/IPv6 Address Discovery Enumerates Host Interfaces (Container Escape / Info Leak)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for_each_netdev(&init_net, dev) {",
        "for_each_netdev_rcu(&init_net, dev) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `sock_net(conn->sk)` to enumerate only devices visible in the connection's namespace.\n\n---",
    "tests_to_add": [
      "Add regression test for: IPv4/IPv6 Address Discovery Enumerates Host Interfaces (Container Escape / Info Leak)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-104",
    "fingerprint": "bpm-invalidation-iterator-list-netdev-notifier|net/quic/tquic/bond/tquic_bpm.c|rcu_read_unlock|concurrency",
    "title": "List Iterator Invalidation in BPM Netdev Notifier",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/bond/tquic_bpm.c :: rcu_read_unlock. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "rcu_read_unlock",
        "list_for_each_entry_safe",
        "tquic_bpm_path_set_state",
        "rcu_read_lock",
        "tquic_bpm"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bpm.c:1876-1898"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rcu_read_unlock\" \"net/quic/tquic/bond/tquic_bpm.c\"",
      "rg -n \"list\" \"net/quic/tquic/bond/tquic_bpm.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `list_for_each_entry_safe()` is NOT sufficient here since the iteration continues after relock. Instead, collect paths to process into a separate list under the lock, then process them after releasing the lock.",
    "tests_to_add": [
      "Add regression test for: List Iterator Invalidation in BPM Netdev Notifier (net/quic/tquic/bond/tquic_bpm.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-105",
    "fingerprint": "bpm-drop-invalidation-iterator-list-netdev|unknown_file|tquic_bpm_path_set_state|concurrency",
    "title": "List Iterator Invalidation in BPM Netdev Notifier (Drop-Relock Pattern)",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_bpm_path_set_state. Category=concurrency, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_bpm_path_set_state",
        "list_for_each_entry_safe"
      ],
      "line_ranges": [],
      "snippets": [
        "rcu_read_lock();\nlist_for_each_entry_rcu(pm, &tquic_bpm_list, path_list) {\n    spin_lock_bh(&pm->lock);\n    list_for_each_entry(path, &pm->path_list, list) {\n        if (path->ifindex == dev->ifindex &&\n            path->state != TQUIC_BPM_PATH_FAILED) {\n            spin_unlock_bh(&pm->lock);           // DROPPED\n            tquic_bpm_path_set_state(path, ...);  // path may be freed here\n            spin_lock_bh(&pm->lock);              // REACQUIRED\n            pm->paths_failed++;                    // list iteration continues!\n        }\n    }\n    spin_unlock_bh(&pm->lock);\n}\nrcu_read_unlock();"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `list_for_each_entry_safe()` is NOT sufficient here since the iteration continues after relock. Instead, collect paths to process into a separate list under the lock, then process them after releasing the lock.\n\n---",
    "tests_to_add": [
      "Add regression test for: List Iterator Invalidation in BPM Netdev Notifier (Drop-Relock Pattern)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-106",
    "fingerprint": "connect-creat-init_net-masque-proxy-socket|net/tquic/masque/connect_udp.c|unknown_symbol|security",
    "title": "MASQUE CONNECT-UDP Proxy Creates Sockets in init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/masque/connect_udp.c :: unknown_symbol. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = sock_create_kern(&init_net, family, SOCK_DGRAM, IPPROTO_UDP, &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"masque\" \"net/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: MASQUE CONNECT-UDP Proxy Creates Sockets in init_net (net/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-107",
    "fingerprint": "connect-container-creat-init_net-masque-proxy|unknown_file|unknown_symbol|other",
    "title": "MASQUE CONNECT-UDP Proxy Creates Sockets in init_net (Container Escape)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = sock_create_kern(&init_net, family, SOCK_DGRAM, IPPROTO_UDP, &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** The tunnel must inherit the network namespace from the QUIC connection's socket: `sock_net(tunnel->conn->sk)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: MASQUE CONNECT-UDP Proxy Creates Sockets in init_net (Container Escape)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-108",
    "fingerprint": "bound-check-frame-read-type||unknown_symbol|memory",
    "title": "Missing Bounds Check Before Frame Type Read",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: unknown_symbol. Category=memory, severity=S0.\nEvidence union: 0 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":1873-1873",
        ":579-579"
      ],
      "snippets": [
        "while (ctx.offset < ctx.len) {\n    prev_offset = ctx.offset;\n    frame_type = ctx.data[ctx.offset];  // Line 1873"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"bound\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Missing Bounds Check Before Frame Type Read ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-109",
    "fingerprint": "extract-header-length-lin-number-packet|unknown_file|tquic_remove_header_protection|other",
    "title": "Packet Number Length Extracted Before Header Unprotection (tquic_input.c, lines 2529, 2545 vs 2565)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_remove_header_protection. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_remove_header_protection",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "// Long header path (line 2529):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Short header path (line 2545):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Header protection removal (line 2565):\n    ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);",
        "ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Move the `pkt_num_len` extraction to AFTER `tquic_remove_header_protection()`:\n```c\nret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;\n```",
    "tests_to_add": [
      "Add regression test for: Packet Number Length Extracted Before Header Unprotection (tquic_input.c, lines 2529, 2545 vs 2565)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-110",
    "fingerprint": "largest_pn-number-packet-reconstruction|net/tquic/tquic_input.c|tquic_decode_pkt_num|correctness",
    "title": "Packet number reconstruction always uses `largest_pn = 0`",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/tquic_input.c :: tquic_decode_pkt_num. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_decode_pkt_num"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2572-2572"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_decode_pkt_num\" \"net/tquic/tquic_input.c\"",
      "rg -n \"packet\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Track `largest_pn` per PN space (Initial/Handshake/Application) and pass it into `tquic_decode_pkt_num()`.",
    "tests_to_add": [
      "Add regression test for: Packet number reconstruction always uses `largest_pn = 0` (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-111",
    "fingerprint": "bit-crypto-frame-integer-overflow-potential||unknown_symbol|correctness",
    "title": "Potential Integer Overflow in CRYPTO Frame on 32-bit",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: unknown_symbol. Category=correctness, severity=S0.\nEvidence union: 0 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":806-806"
      ],
      "snippets": [
        "if (length > ctx->len || ctx->offset + (size_t)length > ctx->len)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"potential\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Potential Integer Overflow in CRYPTO Frame on 32-bit', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Potential Integer Overflow in CRYPTO Frame on 32-bit ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-112",
    "fingerprint": "duplicate-dynamic-qpack-race-table-toctou|net/quic/tquic/http3/qpack_dynamic.c|qpack_dynamic|concurrency",
    "title": "QPACK Dynamic Table Duplicate TOCTOU Race",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/qpack_dynamic.c :: qpack_dynamic. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_dynamic.c"
      ],
      "symbols": [
        "qpack_dynamic",
        "qpack_dynamic_table_duplicate"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_irqsave(&table->lock, flags);\nentry = qpack_dynamic_table_get(table, index);\nif (!entry) { unlock; return error; }\nmemcpy(name_buf, entry->name, entry->name_len);  /* Copy while locked */\nmemcpy(value_buf, entry->value, entry->value_len);\nname_len = entry->name_len;\nvalue_len = entry->valu"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"qpack_dynamic\" \"net/quic/tquic/http3/qpack_dynamic.c\"",
      "rg -n \"qpack\" \"net/quic/tquic/http3/qpack_dynamic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: QPACK Dynamic Table Duplicate TOCTOU Race (net/quic/tquic/http3/qpack_dynamic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-113",
    "fingerprint": "code-exfil-function-mitigation-pointer-quic|net/tquic/security/quic_exfil.c|unknown_symbol|concurrency",
    "title": "QUIC-Exfil mitigation code uses `skb->cb` as a function-pointer slot and gates on `skb->cb[0]`",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/security/quic_exfil.c :: unknown_symbol. Category=concurrency, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:1090-1090",
        "net/tquic/security/quic_exfil.c:270-270"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"quic\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Never store function pointers in `skb->cb`.\n- Use a wrapper object (`struct { struct sk_buff *skb; void (*send_fn)(...); }`) in a dedicated queue, or at least define a strict `struct` overlay for `skb->cb` and always set a sentinel + zero the rest.",
    "tests_to_add": [
      "Add regression test for: QUIC-Exfil mitigation code uses `skb->cb` as a function-pointer slot and gates on `skb->cb[0]` (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-114",
    "fingerprint": "client-container-init_net-quic-server-socket|unknown_file|quic_conn|other",
    "title": "QUIC-over-TCP Client and Server Sockets Use init_net (Container Escape)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: quic_conn. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "quic_conn"
      ],
      "line_ranges": [],
      "snippets": [
        "// Client socket (line 1225):\nret = sock_create_kern(&init_net, addr->sa_family, SOCK_STREAM,\n                       IPPROTO_TCP, &conn->tcp_sk);\n\n// Server listener (line 1446):\nret = sock_create_kern(&init_net, AF_INET6, SOCK_STREAM,\n                       IPPROTO_TCP, &listener->tcp_sk);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Propagate `sock_net(quic_conn->sk)` to the TCP socket creation.\n\n---",
    "tests_to_add": [
      "Add regression test for: QUIC-over-TCP Client and Server Sockets Use init_net (Container Escape)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-115",
    "fingerprint": "calculation-integer-overflow-rate|net/quic/tquic/rate_limit.c|unknown_symbol|concurrency",
    "title": "Rate Calculation Integer Overflow",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/rate_limit.c :: unknown_symbol. Category=concurrency, severity=S0.\nEvidence union: 2 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/rate_limit.c",
        "net/quic/tquic/tquic_ratelimit.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "count = atomic_xchg(&state->rate_window_count, 0);\nrate = (count * 1000) / elapsed_ms;",
        "rate = (u64)count * 1000 / elapsed_ms;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rate\" \"net/quic/tquic/rate_limit.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Rate Calculation Integer Overflow (net/quic/tquic/rate_limit.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-116",
    "fingerprint": "1000-calculation-count-integer-overflow-rate|unknown_file|unknown_symbol|other",
    "title": "Rate Calculation Integer Overflow (`count * 1000`)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "count = atomic_xchg(&state->rate_window_count, 0);\nrate = (count * 1000) / elapsed_ms;",
        "rate = (u64)count * 1000 / elapsed_ms;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Cast to `u64` before multiplication:\n```c\nrate = (u64)count * 1000 / elapsed_ms;\n```",
    "tests_to_add": [
      "Add regression test for: Rate Calculation Integer Overflow (`count * 1000`)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-117",
    "fingerprint": "bit-length-reason-underflow||unknown_symbol|correctness",
    "title": "Reason Length Underflow on 32-bit",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: unknown_symbol. Category=correctness, severity=S0.\nEvidence union: 0 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":1248-1248"
      ],
      "snippets": [
        "if (reason_len > ctx->len - ctx->offset)\n    return -EINVAL;\nctx->offset += (size_t)reason_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"reason\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Reason Length Underflow on 32-bit', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Reason Length Underflow on 32-bit ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-118",
    "fingerprint": "bit-collision-deduplication-hash-redundant-scheduler|net/tquic/multipath/tquic_scheduler.c|tquic_connection|correctness",
    "title": "Redundant Scheduler Deduplication Uses Only 8-bit Sequence Hash -- Trivial Collision",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_connection. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_connection",
        "tquic_scheduler",
        "tquic_redundant_is_duplicate"
      ],
      "line_ranges": [],
      "snippets": [
        "bool tquic_redundant_is_duplicate(struct tquic_connection *conn, u64 seq)\n{\n    seq_byte = (u8)(seq & 0xFF);\n    for (i = 0; i < 256; i++) {\n        if (rd->dedup_window[i] == seq_byte) {\n            return true;  /* Duplicate found */\n        }\n    }\n    rd->dedup_window[rd->dedup_head] = seq_byte;",
        "size_t (*get_info)(struct tquic_connection *conn, char *buf, size_t len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S0, S3.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_connection\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"redundant\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Redundant Scheduler Deduplication Uses Only 8-bit Sequence Hash -- Trivial Collision', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Redundant Scheduler Deduplication Uses Only 8-bit Sequence Hash -- Trivial Collision (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-119",
    "fingerprint": "actually-count-direct-enforc-lifetime-rcu|Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h|assertions|memory",
    "title": "Reference counting/RCU lifetime is not actually enforced; direct `tquic_conn_destroy()` calls can free live connections",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h :: assertions. Category=memory, severity=S0.\nEvidence union: 4 file(s), 4 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h",
        "net/tquic/pm/path_manager.c",
        "net/tquic/tquic_handshake.c",
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "assertions",
        "internal",
        "pointer",
        "rcu_read_lock",
        "refcount_inc_not_zero",
        "sites",
        "tquic_conn_destroy",
        "tquic_conn_get",
        "tquic_conn_lookup_by_token",
        "tquic_conn_put"
      ],
      "line_ranges": [
        "Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h:1965-1965",
        "Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h:1981-1981",
        "net/tquic/pm/path_manager.c:1136-1136",
        "net/tquic/tquic_socket.c:171-171"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"assertions\" \"Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h\"",
      "rg -n \"reference\" \"Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Make `tquic_conn_destroy()` private/internal (not a general-purpose public API). Enforce that all external callers use `tquic_conn_put()` and that the destructor only runs on the refcount-to-zero edge.\n- Add debug assertions (at least under `CONFIG_DEBUG_KERNEL`) to catch direct destruction with `refcnt != 1` or while still discoverable in lookup tables/lists.",
    "tests_to_add": [
      "Add regression test for: Reference counting/RCU lifetime is not actually enforced; direct `tquic_conn_destroy()` calls can free live connections (Users/justinadams/Downloads/tquic-kernel/include/net/tquic.h)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-120",
    "fingerprint": "cid-free-lifetime-rcu-rhashtable-tabl|net/tquic/core/quic_connection.c|call_rcu|memory",
    "title": "rhashtable/RCU lifetime issues (use-after-free risk) in CID tables",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/core/quic_connection.c :: call_rcu. Category=memory, severity=S0.\nEvidence union: 2 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/quic_connection.c",
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "call_rcu",
        "kfree_rcu",
        "rcu_read_lock",
        "rhashtable_lookup_fast",
        "softirq",
        "synchronize_rcu"
      ],
      "line_ranges": [
        "net/tquic/tquic_cid.c:355-355",
        "net/tquic/tquic_cid.c:537-537"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"call_rcu\" \"net/tquic/core/quic_connection.c\"",
      "rg -n \"rhashtable\" \"net/tquic/core/quic_connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Decide on a correct concurrency model:\n  - Option A: Use rhashtable in the intended RCU mode.\n    - Lookups under `rcu_read_lock()`.\n    - Deletions free via `kfree_rcu()` / `call_rcu()` (or `synchronize_rcu()` prior to free).\n    - Consider `SLAB_TYPESAFE_BY_RCU` for caches holding RCU-freed objects.\n  - Option B: Do not use lockless lookups.\n    - Protect *all* lookup/insert/remove with a lock and use the non-fast lookup variant as appropriate.",
    "tests_to_add": [
      "Add regression test for: rhashtable/RCU lifetime issues (use-after-free risk) in CID tables (net/tquic/core/quic_connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-121",
    "fingerprint": "assum-contiguou-data-decryption-linear-non|net/tquic/tquic_input.c|skb_copy_bits|memory",
    "title": "RX parsing/decryption assumes contiguous skb data (non-linear skb / GRO risk)",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/tquic_input.c :: skb_copy_bits. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "skb_copy_bits",
        "skb_linearize"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"skb_copy_bits\" \"net/tquic/tquic_input.c\"",
      "rg -n \"pars\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Linearize the skb before any parsing/decryption that assumes contiguity, or use `skb_copy_bits()` into a contiguous buffer for header+payload.\n- Do this *before* using `data[offset]` patterns.",
    "tests_to_add": [
      "Add regression test for: RX parsing/decryption assumes contiguous skb data (non-linear skb / GRO risk) (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-122",
    "fingerprint": "increase-olia-overflow-path-same|net/tquic/bond/cong_coupled.c|olia_cc_increase|correctness",
    "title": "Same Overflow in OLIA Increase Path",
    "category": "correctness",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/cong_coupled.c :: olia_cc_increase. Category=correctness, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "olia_cc_increase"
      ],
      "line_ranges": [],
      "snippets": [
        "s64 eps_increase = div64_s64((s64)epsilon * (s64)acked_bytes, (s64)total_cwnd);\neps_increase *= mss;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"olia_cc_increase\" \"net/tquic/bond/cong_coupled.c\"",
      "rg -n \"same\" \"net/tquic/bond/cong_coupled.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Same Overflow in OLIA Increase Path', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Same Overflow in OLIA Increase Path (net/tquic/bond/cong_coupled.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-123",
    "fingerprint": "1730-ip_local_out-len-lin-read-skb|unknown_file|ip_local_out|other",
    "title": "Stale skb->len Read After ip_local_out (tquic_output.c, lines 1730-1736)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: ip_local_out. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "ip_local_out",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Send via IP */\n    ret = ip_local_out(&init_net, NULL, skb);\n\n    /* Update path statistics */\n    if (ret >= 0) {\n        path->stats.tx_packets++;\n        path->stats.tx_bytes += skb->len;   /* <-- skb may be freed */\n        path->last_activity = ktime_get();",
        "u32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Save `skb->len` in a local variable before calling `ip_local_out()`:\n```c\nu32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Stale skb->len Read After ip_local_out (tquic_output.c, lines 1730-1736)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-124",
    "fingerprint": "atomic-failover-hysteresi-modify-race-read|unknown_file|atomic_inc_return|concurrency",
    "title": "TOCTOU Race in Failover Hysteresis (Atomic Read-Modify-Write)",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: atomic_inc_return. Category=concurrency, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "atomic_inc_return",
        "atomic_set"
      ],
      "line_ranges": [],
      "snippets": [
        "WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1);\nWRITE_ONCE(pt->consec_successes, 0);",
        "switch (READ_ONCE(pt->hyst_state)) {        // Line 207\ncase TQUIC_PATH_HYST_DEGRADED:\n    if (READ_ONCE(pt->consec_failures) >= TQUIC_HYST_FAIL_THRESHOLD)\n        goto do_failover;                     // Line 230",
        "WRITE_ONCE(pt->consec_successes, READ_ONCE(pt->consec_successes) + 1);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Either protect these operations with a per-path spinlock, or use `atomic_inc_return()` / `atomic_set()` with `atomic_t` fields instead of plain integers + READ_ONCE/WRITE_ONCE.\n\n---",
    "tests_to_add": [
      "Add regression test for: TOCTOU Race in Failover Hysteresis (Atomic Read-Modify-Write)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-125",
    "fingerprint": "creation-init_net-socket-tunnel|net/tquic/tquic_tunnel.c|should|security",
    "title": "Tunnel Socket Creation Uses init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_tunnel.c :: should. Category=security, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net",
        "should",
        "tquic_tunnel"
      ],
      "line_ranges": [],
      "snippets": [
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP,\n                       &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"should\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"tunnel\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Tunnel Socket Creation Uses init_net (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-126",
    "fingerprint": "container-creation-escape-init_net-socket-tunnel|unknown_file|unknown_symbol|other",
    "title": "Tunnel Socket Creation Uses init_net (Container Escape)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP,\n                       &sock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Must use `sock_net(conn->sk)` or propagate the caller's namespace. The tunnel struct should store a `struct net *` reference obtained from the originating socket.\n\n---",
    "tests_to_add": [
      "Add regression test for: Tunnel Socket Creation Uses init_net (Container Escape)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-127",
    "fingerprint": "access-skb-udp_tunnel_xmit_skb-useafterfree|net/tquic/tquic_udp.c|udp_tunnel_xmit_skb|memory",
    "title": "UAF-P2-01: - SKB accessed after udp_tunnel_xmit_skb",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_udp.c :: udp_tunnel_xmit_skb. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_udp.c"
      ],
      "symbols": [
        "udp_tunnel_xmit_skb",
        "tquic_udp"
      ],
      "line_ranges": [],
      "snippets": [
        "TQUIC_UDP_TUNNEL_XMIT_SKB(rt, sk, skb,\n                  saddr, daddr,\n                  0, ip4_dst_hoplimit(&rt->dst),\n                  0, us->local_port, us->remote_port,\n                  false, !us->csum_offload);\n\nus->stats.tx_packets++;\nus->stats.tx_bytes += skb->len;  // <-- UAF: skb was con",
        "int pkt_len = skb->len;\nTQUIC_UDP_TUNNEL_XMIT_SKB(...);\nus->stats.tx_bytes += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"udp_tunnel_xmit_skb\" \"net/tquic/tquic_udp.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P2-01: - SKB accessed after udp_tunnel_xmit_skb (net/tquic/tquic_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-128",
    "fingerprint": "access-conn-connection-reference-retransmit_work_fn-useafterfree|net/tquic/tquic_timer.c|cancel_work_sync|memory",
    "title": "UAF-P3-01: - retransmit_work_fn accesses ts->conn without connection reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_timer.c :: cancel_work_sync. Category=memory, severity=S0.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "cancel_work_sync",
        "tquic_timer_state_free",
        "tquic_detect_lost_packets",
        "tquic_conn_get",
        "tquic_conn_put",
        "tquic_timer_state",
        "work_struct",
        "tquic_timer"
      ],
      "line_ranges": [
        "net/tquic/tquic_timer.c:848-848",
        "net/tquic/tquic_timer.c:1422-1422"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"cancel_work_sync\" \"net/tquic/tquic_timer.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P3-01: - retransmit_work_fn accesses ts->conn without connection reference (net/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-129",
    "fingerprint": "access-conn-path_work_fn-reference-useafterfree|net/tquic/tquic_timer.c|tquic_timer_state|memory",
    "title": "UAF-P3-02: - path_work_fn accesses ts->conn without reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_timer.c :: tquic_timer_state. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer_state",
        "work_struct",
        "tquic_timer"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_path_work_fn(struct work_struct *work)\n{\n    struct tquic_timer_state *ts = container_of(work, ...);\n\n    spin_lock_bh(&ts->lock);\n    if (!ts->active || ts->shutting_down) {\n        spin_unlock_bh(&ts->lock);\n        return;\n    }\n    spin_unlock_bh(&ts->lock);\n    // <-- ts and c"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_timer_state\" \"net/tquic/tquic_timer.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P3-02: - path_work_fn accesses ts->conn without reference (net/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-130",
    "fingerprint": "free-path-protect-rcu-tquic_migrate_auto-unlock|net/tquic/tquic_migration.c|tquic_migrate_auto|memory",
    "title": "Use-After-Free in `tquic_migrate_auto()` -- RCU-Protected Path Used After RCU Unlock",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_migrate_auto. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migrate_auto",
        "rcu_read_lock",
        "rcu_read_unlock",
        "tquic_path_free",
        "synchronize_rcu",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_migrate_auto\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"use\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in `tquic_migrate_auto()` -- RCU-Protected Path Used After RCU Unlock (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-131",
    "fingerprint": "free-path-reference-tquic_migrate_explicit-use-used|net/tquic/tquic_migration.c|tquic_path_find_by_addr|memory",
    "title": "Use-After-Free in `tquic_migrate_explicit()` -- Path Used Without Reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path_find_by_addr. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_find_by_addr",
        "rcu_read_unlock",
        "tquic_migrate_explicit",
        "rcu_read_lock",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Check if we already have a path with this local address */\n    rcu_read_lock();\n    new_path = tquic_path_find_by_addr(conn, new_local);\n    rcu_read_unlock();             // <--- RCU unlocked\n\n    if (!new_path) {\n        /* Create new path ... */\n    }\n    /* ... continues to use new_path witho"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_find_by_addr\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"use\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in `tquic_migrate_explicit()` -- Path Used Without Reference (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-132",
    "fingerprint": "algorithm-free-name-return-use|net/tquic/cong/tquic_cong.c|tquic_cong_get_default_name|memory",
    "title": "Use-After-Free in Algorithm Name Return",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/tquic_cong.c :: tquic_cong_get_default_name. Category=memory, severity=S0.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "tquic_cong_get_default_name",
        "rcu_read_unlock",
        "rcu_read_lock",
        "tquic_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "const char *tquic_cong_get_default_name(void)\n{\n    const char *name;\n    rcu_read_lock();\n    ca = rcu_dereference(default_ca);\n    name = ca->name;\n    rcu_read_unlock();\n    return name; /* <-- ca may be freed here */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_get_default_name\" \"net/tquic/cong/tquic_cong.c\"",
      "rg -n \"use\" \"net/tquic/cong/tquic_cong.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in Algorithm Name Return (net/tquic/cong/tquic_cong.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-133",
    "fingerprint": "245-261-free-lin-lookup-path|unknown_file|tquic_path_put|other",
    "title": "Use-After-Free in Path Lookup (tquic_input.c, lines 245-261)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_path_put. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_path_put",
        "tquic_input",
        "tquic_path"
      ],
      "line_ranges": [],
      "snippets": [
        "static struct tquic_path *tquic_find_path_by_addr(struct tquic_connection *conn,\n                                                  struct sockaddr_storage *addr)\n{\n    struct tquic_path *path;\n    struct tquic_path *found = NULL;\n\n    spin_lock_bh(&conn->paths_lock);\n    list_for_each_entry(path, &conn->paths, list) {\n        if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) {\n            found = path;\n            break;\n        }\n    }\n    spin_unlock_bh(&conn->paths_lock);\n\n    return found;  /* <-- returned WITHOUT refcount increment */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement reference counting on `tquic_path` objects. The lookup function should atomically increment the refcount under `paths_lock` before returning. Callers must call `tquic_path_put()` when done.\n\n---",
    "tests_to_add": [
      "Add regression test for: Use-After-Free in Path Lookup (tquic_input.c, lines 245-261)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-134",
    "fingerprint": "allocator-core-kfree-kmem_cache-kzalloc-mismatch|net/tquic/Makefile|evidence|memory",
    "title": "Widespread allocator mismatches (kmem_cache vs kzalloc/kfree) for core objects (conn/path/stream)",
    "category": "memory",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/Makefile :: evidence. Category=memory, severity=S0.\nEvidence union: 6 file(s), 9 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/Makefile",
        "net/tquic/core/quic_connection.c",
        "net/tquic/core/quic_path.c",
        "net/tquic/tquic_main.c",
        "net/tquic/tquic_migration.c",
        "net/tquic/tquic_stream.c"
      ],
      "symbols": [
        "evidence",
        "kfree",
        "kmem_cache_free",
        "mismatches",
        "objects",
        "tquic_conn_alloc",
        "tquic_conn_destroy",
        "tquic_conn_free",
        "tquic_path_alloc",
        "tquic_path_create",
        "tquic_path_destroy",
        "tquic_path_free",
        "tquic_stream_alloc",
        "tquic_stream_free",
        "type",
        "tquic_connection",
        "tquic_path",
        "tquic_stream"
      ],
      "line_ranges": [
        "net/tquic/Makefile:18-18",
        "net/tquic/core/quic_connection.c:428-428",
        "net/tquic/core/quic_connection.c:965-965",
        "net/tquic/core/quic_path.c:323-323",
        "net/tquic/tquic_main.c:157-157",
        "net/tquic/tquic_main.c:182-182",
        "net/tquic/tquic_main.c:212-212",
        "net/tquic/tquic_migration.c:403-403",
        "net/tquic/tquic_stream.c:299-299"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"evidence\" \"net/tquic/Makefile\"",
      "rg -n \"widespread\" \"net/tquic/Makefile\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Pick exactly one allocator strategy per object type (`tquic_connection`, `tquic_path`, `tquic_stream`) and enforce it via dedicated wrappers:\n  - `tquic_conn_alloc()/tquic_conn_free()`\n  - `tquic_path_alloc()/tquic_path_free()`\n  - `tquic_stream_alloc()/tquic_stream_free()`\n- Remove or fence any alternate implementation files that allocate the same types differently, or clearly split the types so the compiler can\u2019t mix them.",
    "tests_to_add": [
      "Add regression test for: Widespread allocator mismatches (kmem_cache vs kzalloc/kfree) for core objects (conn/path/stream) (net/tquic/Makefile)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-135",
    "fingerprint": "1730-ip_local_out-line-namespace-network-tquic_output|unknown_file|tquic_output|other",
    "title": "Wrong Network Namespace in ip_local_out (tquic_output.c, line 1730)",
    "category": "other",
    "severity": "S0",
    "confidence": "medium",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_output. Category=other, severity=S0.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = ip_local_out(&init_net, NULL, skb);",
        "ret = ip_local_out(net, conn->sk, skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S0 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `sock_net(conn->sk)` instead of `&init_net`. The correct network namespace was already computed at line 1681 in the `rt` lookup:\n```c\nret = ip_local_out(net, conn->sk, skb);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Wrong Network Namespace in ip_local_out (tquic_output.c, line 1730)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-136",
    "fingerprint": "ext-final_size-overflow-sign|net/tquic/core/stream.c|unknown_symbol|correctness",
    "title": "`ext->final_size = -1` Uses Signed Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/core/stream.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ext->final_size = -1;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"ext\" \"net/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Define `#define TQUIC_STREAM_SIZE_UNKNOWN U64_MAX` and use it consistently.",
    "tests_to_add": [
      "Add regression test for: `ext->final_size = -1` Uses Signed Overflow (net/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-137",
    "fingerprint": "branch-cid-constant-has-length-time|net/tquic/security/quic_exfil.c|tquic_ct_memcmp|memory",
    "title": "Constant-Time CID Validation Has Branching on Lengths",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: tquic_ct_memcmp. Category=memory, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "min",
        "tquic_ct_memcmp",
        "tquic_ct_validate_cid",
        "quic_exfil"
      ],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:394-394"
      ],
      "snippets": [
        "bool tquic_ct_validate_cid(const u8 *cid, size_t cid_len,\n                           const u8 *expected, size_t expected_len)\n{\n    ...\n    /* Compare lengths without branching */\n    len_match = !(cid_len ^ expected_len);\n\n    /* Use the larger length to ensure constant-time */\n    max_len = cid_len > expected_len ? cid_len : expected_len;\n    if (max_len > sizeof(dummy_buf))\n        max_len = si",
        "bool tquic_ct_validate_cid(const u8 *cid, size_t cid_len,\n                           const u8 *expected, size_t expected_len)\n{\n    ...\n    /* Compare lengths without branching */\n    len_match = !(cid_len ^ expected_len);\n\n    /* Use the larger length to ensure constant-time */\n    max_len = cid_le",
        "/* Use the larger length to ensure constant-time */\nmax_len = cid_len > expected_len ? cid_len : expected_len;",
        "bool tquic_ct_validate_cid(const u8 *cid, size_t cid_len,\n                           const u8 *expected, size_t expected_len)\n{\n    ...\n    /* Compare lengths without branching */\n    len_match = !(cid_len ^ expected_len);\n\n    /* Use the larger length to ensure constant-time */\n    max_len = cid_len > expected_len ? cid_len : expected_len;\n    if (max_len > sizeof(dummy_buf))\n        max_len = sizeof(dummy_buf);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: build, memory, other, security.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_ct_memcmp\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"constant\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Read exactly `min(cid_len, expected_len)` bytes with bounds checking, use `ct_select` for branchless max, and ensure both buffers are adequately sized or copy to fixed-size local buffers first. / Read exactly `min(cid_len, expected_len)` bytes with bounds checking, use `ct_select` for branchless max, and ensure both buffers are adequately sized or copy to fixed-size local buffers first.\n\n---",
    "tests_to_add": [
      "Add regression test for: Constant-Time CID Validation Has Branching on Lengths (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-138",
    "fingerprint": "asn-attack-custom-parser-surface|net/tquic/crypto/cert_verify.c|decoder|security",
    "title": "Custom ASN.1 Parser - High Attack Surface",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: decoder. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "decoder",
        "infrastructure",
        "parser",
        "parsers"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"decoder\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"custom\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider using the kernel's built-in ASN.1 decoder (`lib/asn1_decoder.c`) and the x509 certificate parser (`crypto/asymmetric_keys/x509_cert_parser.c`) which have been battle-tested. If the custom parser must be retained, add fuzzing tests targeting all parsing entry points.",
    "tests_to_add": [
      "**Recommendation:** Consider using the kernel's built-in ASN.1 decoder (`lib/asn1_decoder.c`) and the x509 certificate parser (`crypto/asymmetric_keys/x509_cert_parser.c`) which have been battle-tested. If the custom parser must be retained, add fuzzing tests targeting all parsing entry points."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-139",
    "fingerprint": "function-pointer-skb-stor-validation|net/tquic/security/quic_exfil.c|corrupted|security",
    "title": "Function Pointer Stored in skb->cb Without Validation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: corrupted. Category=security, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "corrupted",
        "send_fn",
        "sk_buff",
        "__is_kernel_text",
        "quic_exfil"
      ],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:71-71",
        "net/tquic/security/quic_exfil.c:533-533"
      ],
      "snippets": [
        "/* Store send function in skb->cb */\n*(unsigned long *)skb->cb = (unsigned long)send_fn;\n\n/* Later, retrieve and call */\nvoid (*send_fn)(struct sk_buff *) =\n    (void (*)(struct sk_buff *))(*(unsigned long *)skb->cb);\nsend_fn(skb);",
        "/* Store send function in skb->cb */\n*(unsigned long *)skb->cb = (unsigned long)send_fn;",
        "if (skb->cb[0]) {\n    void (*send_fn)(struct sk_buff *) =\n        (void (*)(struct sk_buff *))\n        (*(unsigned long *)skb->cb);\n    send_fn(skb);  /* <-- calling unvalidated function pointer */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other, security."
    ],
    "verification_commands": [
      "rg -n \"corrupted\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"function\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Do not store raw function pointers in `skb->cb`. Instead, use a dedicated structure with a magic number for validation, or use a callback registration mechanism that does not rely on `skb->cb`. / Do not store raw function pointers in `skb->cb`. Instead, use a dedicated structure with a magic number for validation, or use a callback registration mechanism that does not rely on `skb->cb`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Function Pointer Stored in skb->cb Without Validation (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-140",
    "fingerprint": "between-check-http-request-send-state|net/tquic/http3/http3_request.c|h3_request_send_headers|concurrency",
    "title": "HTTP/3 Request: TOCTOU Between State Check and Send",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_request.c :: h3_request_send_headers. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_request_send_headers",
        "state"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"h3_request_send_headers\" \"net/tquic/http3/http3_request.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either hold the lock during the entire send operation, or re-validate state after acquiring any needed resources.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Request: TOCTOU Between State Check and Send (net/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-141",
    "fingerprint": "frame-http-length-setting-truncation|net/tquic/http3/http3_stream.c|h3_connection_send_settings|security",
    "title": "HTTP/3 Settings Frame Length Truncation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_stream.c :: h3_connection_send_settings. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "h3_connection_send_settings"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other, security."
    ],
    "verification_commands": [
      "rg -n \"h3_connection_send_settings\" \"net/tquic/http3/http3_stream.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use proper QUIC variable-length integer encoding for the frame length, or validate that `settings_len <= 255` before the cast and return an error if exceeded.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Settings Frame Length Truncation (net/tquic/http3/http3_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-142",
    "fingerprint": "balancer-destroy-encryption-key-load-zeroiz|net/tquic/lb/quic_lb.c|crypto_free_sync_skcipher|security",
    "title": "Load Balancer Encryption Key Not Zeroized on Destroy",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: crypto_free_sync_skcipher. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "crypto_free_sync_skcipher",
        "kmem_cache_free",
        "memzero_explicit",
        "tquic_lb_config_destroy",
        "tquic_lb_config"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_lb_config_destroy(struct tquic_lb_config *cfg)\n{\n    if (!cfg)\n        return;\n\n    if (cfg->aes_tfm)\n        crypto_free_sync_skcipher(cfg->aes_tfm);\n\n    kmem_cache_free(lb_config_cache, cfg);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"crypto_free_sync_skcipher\" \"net/tquic/lb/quic_lb.c\"",
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Add `memzero_explicit(cfg->encryption_key, sizeof(cfg->encryption_key))` and `memzero_explicit(cfg->server_id, sizeof(cfg->server_id))` before `kmem_cache_free()`. / Add `memzero_explicit(cfg->encryption_key, sizeof(cfg->encryption_key))` and `memzero_explicit(cfg->server_id, sizeof(cfg->server_id))` before `kmem_cache_free()`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Load Balancer Encryption Key Not Zeroized on Destroy (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-143",
    "fingerprint": "cap_net_admin-check-creation-tunnel|net/tquic/tquic_tunnel.c|capable|security",
    "title": "No CAP_NET_ADMIN Check for Tunnel Creation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: capable. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "capable",
        "destinations",
        "tquic_tunnel_create",
        "tquic_tunnel_create_tproxy",
        "tquic_tunnel",
        "the",
        "tquic_stream",
        "tquic_client"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_tunnel *tquic_tunnel_create(struct tquic_client *client,\n                                         struct tquic_stream *stream,\n                                         const u8 *header_data,\n                                         size_t header_len)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"capable\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"cap_net_admin\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Add `capable(CAP_NET_ADMIN)` check at the entry point of tunnel creation, or ensure the calling path enforces this. / Add `capable(CAP_NET_ADMIN)` check at the entry point of tunnel creation, or ensure the calling path enforces this.\n\n---",
    "tests_to_add": [
      "Add regression test for: No CAP_NET_ADMIN Check for Tunnel Creation (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-144",
    "fingerprint": "cap_net_admin-check-metric-netlink-path-permission|net/tquic/diag/path_metrics.c|export|security",
    "title": "Path Metrics Netlink: Missing CAP_NET_ADMIN Permission Check",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/path_metrics.c :: export. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [
        "export",
        "metadata",
        "tquic_nl_get_path_metrics",
        "tquic_nl_get_all_paths",
        "tquic_nl_subscribe_events"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"export\" \"net/tquic/diag/path_metrics.c\"",
      "rg -n \"path\" \"net/tquic/diag/path_metrics.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `.policy` with `GENL_ADMIN_PERM` flag or explicit `CAP_NET_ADMIN` check in each handler.",
    "tests_to_add": [
      "Add regression test for: Path Metrics Netlink: Missing CAP_NET_ADMIN Permission Check (net/tquic/diag/path_metrics.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-145",
    "fingerprint": "call-crypto_aead_setkey-decrypt-encrypt-hot-path|net/tquic/crypto/tls.c|changes|security",
    "title": "Per-Call crypto_aead_setkey in Encrypt/Decrypt Hot Path",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/tls.c :: changes. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "changes",
        "crypto_aead_setkey",
        "expansion",
        "tquic_key_generation"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"changes\" \"net/tquic/crypto/tls.c\"",
      "rg -n \"per\" \"net/tquic/crypto/tls.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Set the key once when it changes (at key installation time), not on every packet. Store the AEAD transform with the key pre-set in `tquic_key_generation`.",
    "tests_to_add": [
      "Add regression test for: Per-Call crypto_aead_setkey in Encrypt/Decrypt Hot Path (net/tquic/crypto/tls.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-146",
    "fingerprint": "call-crypto_alloc_aead-decrypt-encrypt-per-rtt|net/tquic/crypto/zero_rtt.c|crypto_alloc_aead|security",
    "title": "Per-Call crypto_alloc_aead in 0-RTT Encrypt/Decrypt",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: crypto_alloc_aead. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "crypto_alloc_aead",
        "tquic_zero_rtt_attempt",
        "tquic_zero_rtt_decrypt",
        "tquic_zero_rtt_encrypt",
        "tquic_zero_rtt_init",
        "tquic_zero_rtt_"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: perf, security."
    ],
    "verification_commands": [
      "rg -n \"crypto_alloc_aead\" \"net/tquic/crypto/zero_rtt.c\"",
      "rg -n \"per\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pre-allocate the AEAD transform during `tquic_zero_rtt_init()` or `tquic_zero_rtt_attempt()` and reuse it for the lifetime of the 0-RTT state.",
    "tests_to_add": [
      "Add regression test for: Per-Call crypto_alloc_aead in 0-RTT Encrypt/Decrypt (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-147",
    "fingerprint": "block-decoder-exhaustion-memory-qpack-stream|net/tquic/http3/qpack_decoder.c|blocks|concurrency",
    "title": "QPACK Decoder: Unbounded Blocked Stream Memory Exhaustion",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack_decoder.c :: blocks. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [
        "blocks",
        "kmemdup",
        "limit",
        "received",
        "qpack_decoder"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"blocks\" \"net/tquic/http3/qpack_decoder.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Track total blocked stream memory and enforce a per-connection limit (e.g., 1MB total blocked stream data).",
    "tests_to_add": [
      "Add regression test for: QPACK Decoder: Unbounded Blocked Stream Memory Exhaustion (net/tquic/http3/qpack_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-148",
    "fingerprint": "count-encoder-increment-insert-overflow-qpack|net/tquic/http3/qpack_encoder.c|qpack_encoder|memory",
    "title": "QPACK Encoder: Insert Count Increment Overflow",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack_encoder.c :: qpack_encoder. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_encoder.c"
      ],
      "symbols": [
        "qpack_encoder"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, other."
    ],
    "verification_commands": [
      "rg -n \"qpack_encoder\" \"net/tquic/http3/qpack_encoder.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate that `known_received_count + value <= insert_count` (the total entries ever inserted) and that the addition does not overflow.",
    "tests_to_add": [
      "Add regression test for: QPACK Encoder: Insert Count Increment Overflow (net/tquic/http3/qpack_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-149",
    "fingerprint": "condition-installation-key-race-secret-update|net/tquic/crypto/key_update.c|derivation|concurrency",
    "title": "Race Condition in Key Update Secret Installation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: derivation. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "derivation",
        "flag",
        "state",
        "tquic_key_update_install_secrets"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"derivation\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"race\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a state flag (e.g., `keys_installing`) that prevents concurrent use during the derivation window. Set the flag under the first lock acquisition, derive keys, then clear it under the second lock acquisition.",
    "tests_to_add": [
      "Add regression test for: Race Condition in Key Update Secret Installation (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-150",
    "fingerprint": "256-algorithm-hardcod-hash-pss-rsa|net/tquic/crypto/cert_verify.c|verification|security",
    "title": "RSA-PSS Hash Algorithm Hardcoded to SHA-256",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: verification. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "verification"
      ],
      "line_ranges": [],
      "snippets": [
        "} else if (oid_len == sizeof(oid_rsa_pss) &&\n               memcmp(oid, oid_rsa_pss, oid_len) == 0) {\n        /* RSA-PSS: hash algo determined from parameters */\n        *hash_algo = TQUIC_HASH_SHA256;\n        *pubkey_algo = TQUIC_PUBKEY_ALGO_RSA;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"verification\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"rsa\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Parse the RSA-PSS AlgorithmIdentifier parameters to extract the actual hash algorithm. / ** Parse RSA-PSS AlgorithmIdentifier parameters to extract the actual hash algorithm.\n\n---",
    "tests_to_add": [
      "Add regression test for: RSA-PSS Hash Algorithm Hardcoded to SHA-256 (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-151",
    "fingerprint": "derivation-error-function-key-path-secret|net/tquic/crypto/handshake.c|consumed|security",
    "title": "Secrets not zeroized on error paths in key derivation functions",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: consumed. Category=security, severity=S1.\nEvidence union: 1 file(s), 5 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "consumed",
        "memzero_explicit",
        "tquic_handshake",
        "tquic_hs_derive_handshake_secrets"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:995-1045",
        "net/tquic/crypto/handshake.c:1050-1071",
        "net/tquic/crypto/handshake.c:895-930",
        "net/tquic/crypto/handshake.c:2379-2462",
        "net/tquic/crypto/handshake.c:2467-2536"
      ],
      "snippets": [
        "static int tquic_hs_derive_handshake_secrets(struct tquic_handshake *hs)\n{\n    u8 derived[TLS_SECRET_MAX_LEN];\n    u8 transcript_hash[TLS_SECRET_MAX_LEN];\n    // ...\n    ret = tquic_hs_derive_secret(hs, hs->early_secret, \"derived\",\n                                 NULL, 0, derived, hash_len);\n    if",
        "static int tquic_hs_derive_handshake_secrets(struct tquic_handshake *hs)\n{\n    u8 derived[TLS_SECRET_MAX_LEN];\n    u8 transcript_hash[TLS_SECRET_MAX_LEN];\n    // ...\n    ret = tquic_hs_derive_secret(hs, hs->early_secret, \"derived\",\n                                 NULL, 0, derived, hash_len);\n    if (ret)\n        return ret;        // <-- derived[] left on stack with secret data\n    // ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other, security.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"consumed\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"secret\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Zeroize these secrets using `memzero_explicit()` as soon as they have been consumed (after key derivation and ticket issuance). / ** Use `goto out_zeroize` pattern with `memzero_explicit()` on all\nlocal secret buffers before returning, even on error paths.\n\n---",
    "tests_to_add": [
      "Add regression test for: Secrets not zeroized on error paths in key derivation functions (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-152",
    "fingerprint": "allow-machine-open-state-stream-transition|net/tquic/core/stream.c|data_sent|correctness",
    "title": "Stream State Machine Allows Unexpected Transitions from OPEN",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/core/stream.c :: data_sent. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [
        "data_sent",
        "recv",
        "reset_recvd",
        "reset_sent",
        "send",
        "size_known"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_STREAM_OPEN:\n    /* Can go to SIZE_KNOWN, DATA_SENT, RESET_SENT, RESET_RECVD */\n    if (new_state != TQUIC_STREAM_SIZE_KNOWN &&\n        new_state != TQUIC_STREAM_DATA_SENT &&\n        new_state != TQUIC_STREAM_RESET_SENT &&\n        new_state != TQUIC_STREAM_RESET_RECVD)\n        return -EINVAL;\n    break;",
        "case TQUIC_STREAM_OPEN:\n    /* Can go to SIZE_KNOWN, DATA_SENT, RESET_SENT, RESET_RECVD */\n    if (new_state != TQUIC_STREAM_SIZE_KNOWN &&\n        new_state != TQUIC_STREAM_DATA_SENT &&\n        new_state != TQUIC_STREAM_RESET_SENT &&\n        new_state != TQUIC_STREAM_RESET_RECVD)\n        return -EIN"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"data_sent\" \"net/tquic/core/stream.c\"",
      "rg -n \"stream\" \"net/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add TQUIC_STREAM_SEND and TQUIC_STREAM_RECV as valid transitions from OPEN.",
    "tests_to_add": [
      "Add regression test for: Stream State Machine Allows Unexpected Transitions from OPEN (net/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-153",
    "fingerprint": "block-normalization-packet-path-process-tim|net/tquic/security/quic_exfil.c|context|concurrency",
    "title": "Timing Normalization Can Block in Packet Processing Path",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: context. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "context",
        "injection",
        "might_sleep",
        "msleep",
        "processing",
        "tquic_timing_normalize_process",
        "udelay",
        "usleep_range",
        "tquic_exfil_process_incoming"
      ],
      "line_ranges": [],
      "snippets": [
        "if (delay_us <= 10) {\n    udelay(delay_us);\n} else if (delay_us <= 1000) {\n    usleep_range(delay_us, delay_us + 10);\n} else {\n    msleep(delay_us / 1000);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"context\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"tim\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Never sleep in packet processing paths. Use `udelay()` only for very short delays, or defer processing to a workqueue. Add a `might_sleep()` annotation and ensure callers are in sleepable context.",
    "tests_to_add": [
      "Add regression test for: Timing Normalization Can Block in Packet Processing Path (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-154",
    "fingerprint": "connection-creation-netlink-unbound|net/tquic/tquic_netlink.c|connections|security",
    "title": "Unbounded Connection Creation via Netlink",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: connections. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "connections",
        "tquic_conn_info_create",
        "tquic_conn_lookup",
        "tquic_nl_cmd_path_add",
        "tquic_net"
      ],
      "line_ranges": [],
      "snippets": [
        "conn = tquic_conn_lookup(net, conn_id);\nif (!conn) {\n    conn = tquic_conn_info_create(net, conn_id);\n    if (!conn)\n        return -ENOMEM;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"connections\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"unbound\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Add a per-namespace limit on the number of connections (e.g., via an `atomic_t conn_count` in `struct tquic_net`). / Add a per-namespace limit on the number of connections (e.g., via an `atomic_t conn_count` in `struct tquic_net`).\n\n---",
    "tests_to_add": [
      "Add regression test for: Unbounded Connection Creation via Netlink (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-155",
    "fingerprint": "context-destroy-drop-iteration-lock-webtransport|net/tquic/http3/webtransport.c|context_destroy|memory",
    "title": "WebTransport Context Destroy: Lock Drop During Iteration",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/webtransport.c :: context_destroy. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [
        "context_destroy"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"context_destroy\" \"net/tquic/http3/webtransport.c\"",
      "rg -n \"webtransport\" \"net/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a safe iteration pattern: move items to a local list under the lock, release the lock, then process the local list.",
    "tests_to_add": [
      "Add regression test for: WebTransport Context Destroy: Lock Drop During Iteration (net/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-156",
    "fingerprint": "buffer-capsule-growth-unbound-webtransport|net/tquic/http3/webtransport.c|capsule|security",
    "title": "WebTransport: Unbounded Capsule Buffer Growth",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/webtransport.c :: capsule. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [
        "capsule",
        "size"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"capsule\" \"net/tquic/http3/webtransport.c\"",
      "rg -n \"webtransport\" \"net/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Enforce a maximum capsule buffer size (e.g., 64KB or configurable via socket option) and reject connections that exceed it with `H3_EXCESSIVE_LOAD`.",
    "tests_to_add": [
      "Add regression test for: WebTransport: Unbounded Capsule Buffer Growth (net/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-157",
    "fingerprint": "cast-field-quic_offload-shift-version|net/quic/tquic/quic_offload.c|quic_offload|correctness",
    "title": "`quic_offload.c` Version Field Shift Without Cast",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/quic_offload.c :: quic_offload. Category=correctness, severity=S1.\nEvidence union: 2 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/quic_offload.c",
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "quic_offload"
      ],
      "line_ranges": [
        "net/quic/tquic/quic_offload.c:429-429",
        "net/quic/tquic/quic_offload.c:474-475"
      ],
      "snippets": [
        "version = (data[1] << 24) | (data[2] << 16) | (data[3] << 8) | data[4];",
        "version = ((u32)data[1] << 24) | ((u32)data[2] << 16) |\n          ((u32)data[3] << 8) | data[4];"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"quic_offload\" \"net/quic/tquic/quic_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Cast to `u32` before shift:\n```c\nversion = ((u32)data[1] << 24) | ((u32)data[2] << 16) |\n          ((u32)data[3] << 8) | data[4];\n```",
    "tests_to_add": [
      "Add regression test for: `quic_offload.c` Version Field Shift Without Cast (net/quic/tquic/quic_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-158",
    "fingerprint": "remov-rhashtable-spinlock-tquic_cid_pool_destroy|net/tquic/tquic_cid.c|kfree_rcu|concurrency",
    "title": "`tquic_cid_pool_destroy()` Removes from rhashtable Under BH spinlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_cid.c :: kfree_rcu. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "kfree_rcu",
        "rhashtable_lookup_fast",
        "tquic_cid_pool_destroy",
        "rhashtable_remove_fast",
        "synchronize_rcu",
        "tquic_cid",
        "kfree"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&pool->lock);\n    list_for_each_entry_safe(entry, tmp, &pool->local_cids, list) {\n        if (cid_table_initialized && entry->state == CID_STATE_ACTIVE)\n            rhashtable_remove_fast(&tquic_cid_table, &entry->node,\n                                   cid_rht_params);\n        list_de",
        "spin_lock_bh(&pool->lock);\n    list_for_each_entry_safe(entry, tmp, &pool->local_cids, list) {\n        if (cid_table_initialized && entry->state == CID_STATE_ACTIVE)\n            rhashtable_remove_fast(&tquic_cid_table, &entry->node,\n                                   cid_rht_params);\n        list_del(&entry->list);\n        kfree(entry);    // <--- immediate kfree, not kfree_rcu\n    }\n    spin_unlock_bh(&pool->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"kfree_rcu\" \"net/tquic/tquic_cid.c\"",
      "rg -n \"tquic_cid_pool_destroy\" \"net/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_cid_pool_destroy()` Removes from rhashtable Under BH spinlock (net/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-159",
    "fingerprint": "cid-hash-lookup-remove-table-tquic_conn_retire_cid|net/tquic/core/connection.c|tquic_conn_retire_cid|correctness",
    "title": "`tquic_conn_retire_cid()` Does Not Remove CID from Lookup Hash Table",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_conn_retire_cid. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_conn_retire_cid",
        "rhashtable_remove_fast"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_retire_cid\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Call `rhashtable_remove_fast()` when retiring a local CID.",
    "tests_to_add": [
      "Add regression test for: `tquic_conn_retire_cid()` Does Not Remove CID from Lookup Hash Table (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-160",
    "fingerprint": "alpn-but-byte-extension-length-overflow|net/tquic/crypto/handshake.c|tquic_hs_set_alpn|security",
    "title": "`tquic_hs_build_ch_extensions` -- ALPN extension length written as 2-byte but can overflow u16",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_set_alpn. Category=security, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_set_alpn",
        "tquic_hs_build_ch_extensions"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:2964-2964"
      ],
      "snippets": [
        "if (hs->alpn_count > 0) {\n        u32 alpn_total_len = 0;\n\n        for (i = 0; i < hs->alpn_count; i++)\n            alpn_total_len += 1 + strlen(hs->alpn_list[i]);\n\n        *p++ = ((alpn_total_len + 2) >> 8) & 0xff;\n        *p++ = (alpn_total_len + 2) & 0xff;",
        "if (hs->alpn_list) {\n        for (i = 0; i < hs->alpn_count; i++)\n            kfree(hs->alpn_list[i]);\n        kfree(hs->alpn_list);\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security.",
      "Severity disagreement across reports: S1, S3."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_set_alpn\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_build_ch_extension\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate ALPN total length fits in u16 in `tquic_hs_set_alpn()`.\nAdd a reasonable cap on `alpn_count`.\n\n--- / ** Set `hs->alpn_count = 0` after freeing the old list.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_build_ch_extensions` -- ALPN extension length written as 2-byte but can overflow u16 (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-161",
    "fingerprint": "double-free-potential-session-ticket-tquic_hs_cleanup|net/tquic/crypto/handshake.c|tquic_hs_setup_psk|memory",
    "title": "`tquic_hs_cleanup` -- potential double-free of session ticket",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_setup_psk. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_setup_psk",
        "tquic_hs_cleanup"
      ],
      "line_ranges": [],
      "snippets": [
        "if (hs->session_ticket) {\n        kfree(hs->session_ticket->ticket);\n        kfree(hs->session_ticket);\n    }",
        "/* Store session ticket for early data */\n    hs->session_ticket = ticket;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_setup_psk\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_cleanup\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either document clearly that `tquic_hs_setup_psk` takes ownership\n(and the caller must not free), or make `tquic_hs_setup_psk` copy the ticket data.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_cleanup` -- potential double-free of session ticket (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-162",
    "fingerprint": "buf-buffer-minimum-output-size-tquic_hs_generate_client_hello|net/tquic/crypto/handshake.c|tquic_hs_generate_client_hello|memory",
    "title": "`tquic_hs_generate_client_hello` -- output buffer `buf` not validated for minimum size",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_generate_client_hello. Category=memory, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_generate_client_hello"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1320-1320"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_generate_client_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate `buf_len` against the minimum required size at function entry.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_generate_client_hello` -- output buffer `buf` not validated for minimum size (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-163",
    "fingerprint": "context_len-tquic_hs_hkdf_expand_label-truncat|net/tquic/crypto/handshake.c|tquic_hs_hkdf_expand_label|security",
    "title": "`tquic_hs_hkdf_expand_label` -- `context_len` truncated to u8",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_hkdf_expand_label. Category=security, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_hkdf_expand_label"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:762-762"
      ],
      "snippets": [
        "*p++ = context_len;     // context_len is u32, written as u8",
        "if (context_len > 255)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_hkdf_expand_label\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n```c\nif (context_len > 255)\n    return -EINVAL;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_hkdf_expand_label` -- `context_len` truncated to u8 (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-164",
    "fingerprint": "alpn-insufficient-tquic_hs_process_encrypted_extension-validation|net/tquic/crypto/handshake.c|tquic_hs_process_encrypted_extensions|security",
    "title": "`tquic_hs_process_encrypted_extensions` -- ALPN validation insufficient",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_encrypted_extensions. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_encrypted_extensions"
      ],
      "line_ranges": [],
      "snippets": [
        "case TLS_EXT_ALPN:\n        if (ext_data_len >= 3) {\n            u16 list_len = (p[0] << 8) | p[1];\n            u8 proto_len = p[2];\n\n            if (list_len >= proto_len + 1 && proto_len > 0) {\n                kfree(hs->alpn_selected);\n                hs->alpn_selected = kmalloc(proto_len + 1, GFP_",
        "if (ext_data_len >= 3 && proto_len > 0 && 3 + proto_len <= ext_data_len) {",
        "case TLS_EXT_ALPN:\n        if (ext_data_len >= 3) {\n            u16 list_len = (p[0] << 8) | p[1];\n            u8 proto_len = p[2];\n\n            if (list_len >= proto_len + 1 && proto_len > 0) {\n                kfree(hs->alpn_selected);\n                hs->alpn_selected = kmalloc(proto_len + 1, GFP_KERNEL);\n                if (hs->alpn_selected) {\n                    memcpy(hs->alpn_selected, p + 3, proto_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_encrypted_extensions\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_process_encrypted_extension\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n```c\nif (ext_data_len >= 3 && proto_len > 0 && 3 + proto_len <= ext_data_len) {\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_encrypted_extensions` -- ALPN validation insufficient (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-165",
    "fingerprint": "data-entry-leak-memory-old-ticket|net/tquic/crypto/handshake.c|tquic_hs_process_new_session_ticket|security",
    "title": "`tquic_hs_process_new_session_ticket` -- memory leak of old ticket data on re-entry",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_new_session_ticket. Category=security, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_new_session_ticket",
        "kfree",
        "tquic_hs_setup_psk"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:2609-2609",
        "net/tquic/crypto/handshake.c:2610-2610"
      ],
      "snippets": [
        "if (!hs->session_ticket) {\n        hs->session_ticket = kzalloc(sizeof(*hs->session_ticket), GFP_KERNEL);\n        if (!hs->session_ticket)\n            return -ENOMEM;\n    }\n    // ... writes to hs->session_ticket fields ...\n\n    kfree(hs->session_ticket->ticket);\n    hs->session_ticket->ticket = kma",
        "if (!hs->session_ticket) {\n        hs->session_ticket = kzalloc(sizeof(*hs->session_ticket), GFP_KERNEL);\n        if (!hs->session_ticket)\n            return -ENOMEM;\n    }\n    // ... writes to hs->session_ticket fields ...\n\n    kfree(hs->session_ticket->ticket);\n    hs->session_ticket->ticket = kmalloc(ticket_len, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_new_session_ticket\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Track whether `hs->session_ticket` is owned or borrowed. Only free\nowned tickets. / ** Add a reasonable upper limit (e.g., 8192 bytes) for ticket length.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_new_session_ticket` -- memory leak of old ticket data on re-entry (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-166",
    "fingerprint": "bound-comparison-fully-safe-session-tquic_hs_process_server_hello|net/tquic/crypto/handshake.c|tquic_hs_process_server_hello|security",
    "title": "`tquic_hs_process_server_hello` -- session ID comparison not fully bounds-safe",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_server_hello. Category=security, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_server_hello"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1423-1423",
        "net/tquic/crypto/handshake.c:1426-1426",
        "net/tquic/crypto/handshake.c:1486-1486",
        "net/tquic/crypto/handshake.c:1655-1655"
      ],
      "snippets": [
        "session_id_len = *p++;\n    if (session_id_len > TLS_SESSION_ID_MAX_LEN)\n        return -EINVAL;\n    if (p + session_id_len > end)\n        return -EINVAL;",
        "while (p < data + 4 + msg_len) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_server_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (p >= end) return -EINVAL;` before `session_id_len = *p++;`.\n\n--- / ** Use `const u8 *ext_end = p + ext_len;` and loop `while (p < ext_end)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_server_hello` -- session ID comparison not fully bounds-safe (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-167",
    "fingerprint": "age-calculation-integer-overflow-ticket-tquic_hs_setup_psk|net/tquic/crypto/handshake.c|tquic_hs_setup_psk|correctness",
    "title": "`tquic_hs_setup_psk` -- integer overflow in ticket age calculation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_setup_psk. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_setup_psk"
      ],
      "line_ranges": [],
      "snippets": [
        "age = (now - ticket->creation_time) * 1000;  /* Convert to ms */\n    obfuscated_age = age + ticket->age_add;\n    psk->obfuscated_ticket_age = obfuscated_age;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_setup_psk\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `u64` for `age` and validate the time difference before\nmultiplication. Also validate `lifetime` against RFC 8446 maximum of 604800 (7 days).\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_setup_psk` -- integer overflow in ticket age calculation (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-168",
    "fingerprint": "same-tquic_recvmsg|net/tquic/tquic_socket.c|tquic_recvmsg|concurrency",
    "title": "`tquic_recvmsg()` Same Issue as HIGH-07",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_recvmsg. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_recvmsg",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_recvmsg\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_recvmsg()` Same Issue as HIGH-07 (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-169",
    "fingerprint": "accept-held-lock_sock-sk_lock-slock-spin_lock_bh|net/quic/tquic/tquic_socket.c|lock_sock|concurrency",
    "title": "accept() Uses spin_lock_bh on sk_lock.slock While lock_sock() Is Held",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_socket.c :: lock_sock. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 4 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c",
        "net/quic/tquic/tquic_migration.c"
      ],
      "symbols": [
        "lock_sock",
        "copy_from_sockptr",
        "tquic_sock_setsockopt",
        "tquic_accept",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:95-95",
        "net/quic/tquic/tquic_socket.c:2841-2854",
        "net/quic/tquic/tquic_socket.c:726-726",
        "net/quic/tquic/tquic_socket.c:562-562"
      ],
      "snippets": [
        "limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;  /* received * 3 */",
        "if (vlen > 0 &&\n    tlen <= TQUIC_MAX_TOKEN_LEN &&\n    (size_t)vlen <= len - offset &&\n    tlen <= len - offset - vlen)",
        "lock_sock(sk);\n// ...\nfor (;;) {\n    spin_lock_bh(&sk->sk_lock.slock);    // Takes the backing spinlock!\n    if (!list_empty(&tsk->accept_queue)) {\n        // ...\n        spin_unlock_bh(&sk->sk_lock.slock);\n        goto out_unlock;\n    }\n    spin_unlock_bh(&sk->sk_lock.slock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"lock_sock\" \"net/quic/tquic/tquic_socket.c\"",
      "rg -n \"accept\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Remove the inner `spin_lock_bh(&sk->sk_lock.slock)` calls in `tquic_accept()`. The `lock_sock()` already provides sufficient serialization. If the accept queue needs to be accessed from softirq context, use a dedicated spinlock instead of the socket's backing slock. / Remove the inner `spin_lock_bh(&sk->sk_lock.slock)` calls in `tquic_accept()`. The `lock_sock()` already provides sufficient serialization. If the accept queue needs to be accessed from softirq context, use a dedicated spinlock instead of the socket's backing slock.\n\n---",
    "tests_to_add": [
      "Add regression test for: accept() Uses spin_lock_bh on sk_lock.slock While lock_sock() Is Held (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-170",
    "fingerprint": "amplification-anti-integer-overflow|net/tquic/core/connection.c|unknown_symbol|correctness",
    "title": "Anti-Amplification Integer Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (cs->is_server) {\n    u64 limit = cs->bytes_received_unvalidated * cs->amplification_limit;\n    if (cs->bytes_sent_unvalidated + bytes > limit) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"anti\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `check_add_overflow` and `check_mul_overflow` for safe arithmetic.\n\n---",
    "tests_to_add": [
      "Add regression test for: Anti-Amplification Integer Overflow (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-171",
    "fingerprint": "atomic_sub-incompatible-refcount_t-sk_rmem_alloc|net/quic/tquic/core/stream.c|skb_set_owner_r|memory",
    "title": "atomic_sub on sk_rmem_alloc Incompatible with refcount_t",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: skb_set_owner_r. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "skb_set_owner_r",
        "tquic_stream"
      ],
      "line_ranges": [],
      "snippets": [
        "atomic_sub(skb->truesize, &sk->sk_rmem_alloc);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"skb_set_owner_r\" \"net/quic/tquic/core/stream.c\"",
      "rg -n \"atomic_sub\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `skb_set_owner_r()` for receive buffers and let the destructor handle accounting, consistent with the tquic_stream.c approach.\n\n---",
    "tests_to_add": [
      "Add regression test for: atomic_sub on sk_rmem_alloc Incompatible with refcount_t (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-172",
    "fingerprint": "bbrv2-calculation-inflight-truncation|net/quic/tquic/cong/bbrv2.c|unknown_symbol|correctness",
    "title": "BBRv2 Inflight Calculation Truncation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/cong/bbrv2.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/cong/bbrv2.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "inflight = bbr_bdp(bbr);\ninflight = (inflight * gain) >> BBR_SCALE;\nreturn max((u32)inflight, (u32)(BBR_MIN_CWND * mss));",
        "return (u32)min_t(u64, inflight, U32_MAX);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"bbrv2\" \"net/quic/tquic/cong/bbrv2.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Return `u64` or `u32` with saturation:\n```c\nreturn (u32)min_t(u64, inflight, U32_MAX);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: BBRv2 Inflight Calculation Truncation (net/quic/tquic/cong/bbrv2.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-173",
    "fingerprint": "bloom-false-filter-has-positive-rate|net/tquic/crypto/zero_rtt.h|unknown_symbol|security",
    "title": "Bloom Filter Has High False Positive Rate at Scale",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.h :: unknown_symbol. Category=security, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.h"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.h:913-916"
      ],
      "snippets": [
        "#define TQUIC_REPLAY_BLOOM_BITS         (1 << 16)    /* 64K bits */\n#define TQUIC_REPLAY_BLOOM_HASHES       4             /* 4 hash functions */\n#define TQUIC_REPLAY_TTL_SECONDS        3600          /* 1 hour */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"bloom\" \"net/tquic/crypto/zero_rtt.h\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Increase `TQUIC_REPLAY_BLOOM_BITS` to at least `(1 << 20)` (1M bits = 128KB) for production use, or make it configurable via sysctl.\n\n---",
    "tests_to_add": [
      "Add regression test for: Bloom Filter Has High False Positive Rate at Scale (net/tquic/crypto/zero_rtt.h)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-174",
    "fingerprint": "bond-drop-machine-relock-state-validation|net/quic/tquic/bond/tquic_bonding.c|tquic_bonding_destroy|concurrency",
    "title": "Bonding State Machine Drop-Relock Without Re-validation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/bond/tquic_bonding.c :: tquic_bonding_destroy. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_destroy",
        "synchronize_rcu",
        "tquic_bonding"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bonding.c:174-174"
      ],
      "snippets": [
        "spin_lock_bh(&bc->state_lock);\n    // ... state transition logic ...\n    if (new_state == TQUIC_BOND_SINGLE_PATH && bc->reorder) {\n        spin_unlock_bh(&bc->state_lock);     // DROP LOCK\n        tquic_bonding_free_reorder(bc);       // Calls synchronize_rcu()!\n        spin_lock_bh(&bc->state_lock)",
        "spin_lock_bh(&bc->state_lock);\n    // ... state transition logic ...\n    if (new_state == TQUIC_BOND_SINGLE_PATH && bc->reorder) {\n        spin_unlock_bh(&bc->state_lock);     // DROP LOCK\n        tquic_bonding_free_reorder(bc);       // Calls synchronize_rcu()!\n        spin_lock_bh(&bc->state_lock);        // REACQUIRE\n\n        // Re-evaluate after relock (good!)\n        total_usable = bc->active_path_count;\n        // ... re-checks state ...\n    }\nspin_unlock_bh(&bc->state_lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_bonding_destroy\" \"net/quic/tquic/bond/tquic_bonding.c\"",
      "rg -n \"bond\" \"net/quic/tquic/bond/tquic_bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a \"destroying\" flag to `bc` checked after relock, or use refcounting on `bc`. / Add a \"destroying\" flag to `bc` checked after relock, or use refcounting on `bc`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Bonding State Machine Drop-Relock Without Re-validation (net/quic/tquic/bond/tquic_bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-175",
    "fingerprint": "cid-connection-count-lookup-reference-return|net/tquic/tquic_cid.c|kfree_rcu|memory",
    "title": "CID Lookup Returns Connection Without Reference Count",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_cid.c :: kfree_rcu. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "kfree_rcu",
        "tquic_cid",
        "tquic_connection",
        "tquic_cid_lookup",
        "tquic_cid_table"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_connection *tquic_cid_lookup(const struct tquic_cid *cid)\n{\n    entry = rhashtable_lookup_fast(&tquic_cid_table, cid, cid_rht_params);\n    if (entry && entry->state == CID_STATE_ACTIVE)\n        return entry->conn;\n    return NULL;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"kfree_rcu\" \"net/tquic/tquic_cid.c\"",
      "rg -n \"cid\" \"net/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** The caller should be in an RCU read-side section, and connections should be freed via `kfree_rcu()`. Alternatively, take a refcount on the connection before returning.",
    "tests_to_add": [
      "Add regression test for: CID Lookup Returns Connection Without Reference Count (net/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-176",
    "fingerprint": "assum-coalesc-encod-packet-splitt-type|net/tquic/core/packet.c|tquic_decode_packet_type|correctness",
    "title": "Coalesced Packet Splitting Assumes v1 Packet Type Encoding",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/packet.c :: tquic_decode_packet_type. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [
        "tquic_decode_packet_type"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Check for Initial packet (has token) */\nif ((data[offset] & QUIC_LONG_HEADER_TYPE_MASK) ==\n    (QUIC_PACKET_TYPE_INITIAL << QUIC_LONG_HEADER_TYPE_SHIFT)) {",
        "if ((data[offset] & QUIC_LONG_HEADER_TYPE_MASK) ==\n    (QUIC_PACKET_TYPE_RETRY << QUIC_LONG_HEADER_TYPE_SHIFT)) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_decode_packet_type\" \"net/tquic/core/packet.c\"",
      "rg -n \"coalesc\" \"net/tquic/core/packet.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Read the version field (bytes 1-4) and use `tquic_decode_packet_type()` for version-aware type detection.\n\n---",
    "tests_to_add": [
      "Add regression test for: Coalesced Packet Splitting Assumes v1 Packet Type Encoding (net/tquic/core/packet.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-177",
    "fingerprint": "conn-every-held-lock-packet-path|net/tquic/tquic_output.c|read_once|concurrency",
    "title": "conn->lock held during path selection on every TX packet",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: read_once. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1121-1132"
      ],
      "symbols": [
        "read_once",
        "connections",
        "spin_lock_bh",
        "spin_unlock_bh",
        "tquic_bond_select_path",
        "tquic_select_path",
        "tquic_path",
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1121-1132"
      ],
      "snippets": [
        "struct tquic_path *tquic_select_path(...)\n{\n    spin_lock_bh(&conn->lock);\n    if (conn->scheduler)\n        selected = tquic_bond_select_path(conn, skb);\n    else\n        selected = conn->active_path;\n    spin_unlock_bh(&conn->lock);\n    return selected;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"read_once\" \"net/tquic/tquic_output.c\"",
      "rg -n \"conn\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** For the single-path fast path, use `READ_ONCE(conn->active_path)` without the lock. Only take the lock when a scheduler is configured. Consider RCU protection for the path list.",
    "tests_to_add": [
      "Add regression test for: conn->lock held during path selection on every TX packet (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-178",
    "fingerprint": "conn-flush-iteration-lock-output-reacquir|net/tquic/tquic_output.c|operations|concurrency",
    "title": "conn->lock released and reacquired during output flush stream iteration",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: operations. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:2058-2072"
      ],
      "symbols": [
        "operations",
        "rb_first",
        "rb_next",
        "spin_lock_bh",
        "spin_unlock_bh",
        "tquic_output_flush",
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:2058-2072"
      ],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nif (conn->data_sent >= conn->max_data_remote) {\n    spin_unlock_bh(&conn->lock);\n    ...\n}\nconn_credit = conn->max_data_remote - conn->data_sent;\nspin_unlock_bh(&conn->lock);\n\nspin_lock_bh(&conn->lock);\nfor (node = rb_first(&conn->streams); node && packets_sent < 16;\n     node = rb_next(node)) {",
        "spin_lock_bh(&conn->lock);\nif (conn->data_sent >= conn->max_data_remote) {\n    spin_unlock_bh(&conn->lock);\n    ...\n}\nconn_credit = conn->max_data_remote - conn->data_sent;\nspin_unlock_bh(&conn->lock);\n\nspin_lock_bh(&conn->lock);\nfor (node = rb_first(&conn->streams); node && packets_sent < 16;\n     "
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"operations\" \"net/tquic/tquic_output.c\"",
      "rg -n \"conn\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Merge the two critical sections into one: check flow control credit and begin stream iteration under the same `conn->lock` hold.",
    "tests_to_add": [
      "Add regression test for: conn->lock released and reacquired during output flush stream iteration (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-179",
    "fingerprint": "conn-every-packet-path-paths_lock|net/tquic/tquic_input.c|list_for_each_entry|memory",
    "title": "conn->paths_lock in RX path for every packet",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_input.c :: list_for_each_entry. Category=memory, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c",
        "net/tquic/tquic_input.c:251-258"
      ],
      "symbols": [
        "first",
        "list_for_each_entry",
        "spin_lock_bh",
        "table",
        "tquic_find_path_by_addr",
        "tquic_path",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:251-258"
      ],
      "snippets": [
        "static struct tquic_path *tquic_find_path_by_addr(...)\n{\n    spin_lock_bh(&conn->paths_lock);\n    list_for_each_entry(path, &conn->paths, list) {\n        if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) {\n            ..."
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"list_for_each_entry\" \"net/tquic/tquic_input.c\"",
      "rg -n \"conn\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a hash table (rhashtable) for path-by-address lookup. For single-path connections, cache the last-used path and check it first (fast-path optimization).",
    "tests_to_add": [
      "Add regression test for: conn->paths_lock in RX path for every packet (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-180",
    "fingerprint": "buffer-connection_close-kmalloc-small|net/tquic/tquic_output.c|tquic_send_ack|perf",
    "title": "CONNECTION_CLOSE uses kmalloc for small buffer",
    "category": "perf",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_send_ack. Category=perf, severity=S1.\nEvidence union: 2 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1950-1951"
      ],
      "symbols": [
        "does",
        "tquic_send_ack",
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1950-1951",
        "net/tquic/tquic_output.c:1877-1877"
      ],
      "snippets": [
        "buf = kmalloc(256, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, perf."
    ],
    "verification_commands": [
      "rg -n \"tquic_send_ack\" \"net/tquic/tquic_output.c\"",
      "rg -n \"connection_close\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a stack buffer like `tquic_send_ack()` does (line 1877: `u8 buf_stack[128]`). A 256-byte stack allocation is safe in kernel context.",
    "tests_to_add": [
      "Add regression test for: CONNECTION_CLOSE uses kmalloc for small buffer (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-181",
    "fingerprint": "const-correctnes-decode-packet-proxy-violation|net/tquic/masque/quic_proxy_capsules.c|quic_proxy_capsules|memory",
    "title": "const-Correctness Violation in Proxy Packet Decode",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/quic_proxy_capsules.c :: quic_proxy_capsules. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy_capsules.c"
      ],
      "symbols": [
        "quic_proxy_capsules"
      ],
      "line_ranges": [],
      "snippets": [
        "capsule->packet = (u8 *)(buf + offset);  /* discards const from buf */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"quic_proxy_capsules\" \"net/tquic/masque/quic_proxy_capsules.c\"",
      "rg -n \"const\" \"net/tquic/masque/quic_proxy_capsules.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either copy the packet data into a separately allocated buffer, or declare `capsule->packet` as `const u8 *` and ensure all consumers respect const correctness.\n\n---",
    "tests_to_add": [
      "Add regression test for: const-Correctness Violation in Proxy Packet Decode (net/tquic/masque/quic_proxy_capsules.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-182",
    "fingerprint": "controll-copy_from_user-option-size-socket-user|net/quic/tquic/tquic_socket.c|tquic_socket|api",
    "title": "copy_from_user with User-Controlled Size in Socket Options",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 3 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_socket.c :: tquic_socket. Category=api, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_SCHEDULER: {\n    char name[TQUIC_SCHED_NAME_MAX];\n    ...\n    if (optlen < 1 || optlen >= TQUIC_SCHED_NAME_MAX)\n        return -EINVAL;\n\n    if (copy_from_sockptr(name, optval, optlen))\n        return -EFAULT;\n    name[optlen] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: api, memory.",
      "Severity disagreement across reports: S1, S3."
    ],
    "verification_commands": [
      "rg -n \"tquic_socket\" \"net/quic/tquic/tquic_socket.c\"",
      "rg -n \"copy_from_user\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'copy_from_user with User-Controlled Size in Socket Options', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: copy_from_user with User-Controlled Size in Socket Options (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-183",
    "fingerprint": "check-counter-directly-ecn-overflow-pass|net/tquic/tquic_input.c|tquic_input|correctness",
    "title": "ECN Counter Values Passed Directly to TQUIC_ADD_STATS Without Overflow Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_input. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:702-707",
        "net/tquic/tquic_input.c:764-764",
        "net/tquic/tquic_input.c:759-763"
      ],
      "snippets": [
        "if (ecn_ect0 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT0RX, ecn_ect0);\n    if (ecn_ect1 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT1RX, ecn_ect1);\n    if (ecn_ce > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNCEMARKSRX, ecn_ce);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/tquic/tquic_input.c\"",
      "rg -n \"ecn\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Validate that ECN counts are monotonically increasing from previous values. Store previous ECN counts per-path and only react to the *increase*, not the absolute value (as RFC 9002 Section 7.1 requires). The comment at line 759-763 acknowledges this is missing. / Validate that ECN counts are monotonically increasing from previous values. Store previous ECN counts per-path and only react to the *increase*, not the absolute value (as RFC 9002 Section 7.1 requires). The comment at line 759-763 acknowledges this is missing.\n\n---",
    "tests_to_add": [
      "Add regression test for: ECN Counter Values Passed Directly to TQUIC_ADD_STATS Without Overflow Check (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-184",
    "fingerprint": "deriv-eku-hash_tfm-keys-lock|net/tquic/crypto/extended_key_update.c|eku_hkdf_extract|concurrency",
    "title": "EKU Derives Keys Using KU hash_tfm Without KU Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/extended_key_update.c :: eku_hkdf_extract. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "eku_hkdf_extract"
      ],
      "line_ranges": [
        "net/tquic/crypto/extended_key_update.c:821-821",
        "net/tquic/crypto/extended_key_update.c:829-829",
        "net/tquic/crypto/extended_key_update.c:830-830"
      ],
      "snippets": [
        "spin_unlock_irqrestore(&state->lock, flags);    /* line 821 */\n\n/* Access ku_state->hash_tfm WITHOUT ku_state->lock */\nif (ku_state->hash_tfm) {                       /* line 829 */\n    ret = eku_hkdf_extract(ku_state->hash_tfm,  /* line 830 */\n                           current_secret, secret_len,\n",
        "spin_unlock_irqrestore(&state->lock, flags);    /* line 821 */\n\n/* Access ku_state->hash_tfm WITHOUT ku_state->lock */\nif (ku_state->hash_tfm) {                       /* line 829 */\n    ret = eku_hkdf_extract(ku_state->hash_tfm,  /* line 830 */\n                           current_secret, secret_len,\n                           state->injected_psk,\n                           state->injected_psk_len,\n                           mixed_secret, secret_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"eku_hkdf_extract\" \"net/tquic/crypto/extended_key_update.c\"",
      "rg -n \"eku\" \"net/tquic/crypto/extended_key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either (a) hold the KU lock around `hash_tfm` access, or (b) copy\n`hash_tfm` under the KU lock and use the copy (though crypto transforms are\nnot reference-counted, so this requires ensuring the transform outlives usage).\nFor the PSK, copy it under the EKU lock before releasing.\n\n---",
    "tests_to_add": [
      "Add regression test for: EKU Derives Keys Using KU hash_tfm Without KU Lock (net/tquic/crypto/extended_key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-185",
    "fingerprint": "eku-get_current_key-key-mismatch-return-secret|net/tquic/crypto/extended_key_update.c|tquic_key_update_get_current_keys|security",
    "title": "EKU Semantic Mismatch: get_current_keys Returns Key, Not Secret",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/extended_key_update.c :: tquic_key_update_get_current_keys. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "tquic_key_update_get_current_keys",
        "tquic_key_update_state"
      ],
      "line_ranges": [],
      "snippets": [
        "size_t secret_len = 32;  /* SHA-256 default */\nu8 current_secret[48];\nu32 key_len;\n\n/* Get current secret from base key update state */\nret = tquic_key_update_get_current_keys(ku_state, 1,\n                                        current_secret, &key_len,\n                                        NULL,",
        "size_t secret_len = 32;  /* SHA-256 default */\nu8 current_secret[48];\nu32 key_len;\n\n/* Get current secret from base key update state */\nret = tquic_key_update_get_current_keys(ku_state, 1,\n                                        current_secret, &key_len,\n                                        NULL, NULL);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_key_update_get_current_keys\" \"net/tquic/crypto/extended_key_update.c\"",
      "rg -n \"eku\" \"net/tquic/crypto/extended_key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add and use a function to retrieve the current traffic secret (not the\nderived key) from `tquic_key_update_state`. Derive `secret_len` from the\ncipher suite.\n\n---",
    "tests_to_add": [
      "Add regression test for: EKU Semantic Mismatch: get_current_keys Returns Key, Not Secret (net/tquic/crypto/extended_key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-186",
    "fingerprint": "decoder-failure-fec-kzalloc-leak-partial|net/quic/tquic/fec/fec_decoder.c|unknown_symbol|concurrency",
    "title": "FEC decoder recovery -- partial recovery leaks on kzalloc failure",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_decoder.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_erasures; i++) {\n    symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC);\n    if (!symbol) {\n        kfree(recovered[i]);\n        continue;    // BUG: same pattern as encoder\n    }\n    symbol->data = recovered[i];\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/quic/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: FEC decoder recovery -- partial recovery leaks on kzalloc failure (net/quic/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-187",
    "fingerprint": "encoder-fec-generation-leak-partial-repair|net/quic/tquic/fec/fec_encoder.c|unknown_symbol|concurrency",
    "title": "FEC encoder repair symbol generation -- partial resource leak on kzalloc failure",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_encoder.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_repair; i++) {\n    repair_sym = kzalloc(sizeof(*repair_sym), GFP_ATOMIC);\n    if (!repair_sym) {\n        kfree(repair_bufs[i]);\n        continue;    // BUG: leaks remaining repair_bufs[i+1..num_repair-1]\n    }\n    repair_sym->data = repair_bufs[i];\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/quic/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** After the loop, iterate remaining entries and free any\n`repair_bufs[i]` that were not successfully adopted by a `repair_sym`.\n\n---",
    "tests_to_add": [
      "Add regression test for: FEC encoder repair symbol generation -- partial resource leak on kzalloc failure (net/quic/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-188",
    "fingerprint": "block_size-computation-count-fec-repair-target_fec_rate|net/quic/tquic/fec/fec_scheduler.c|unknown_symbol|concurrency",
    "title": "FEC Repair Count Computation: `block_size * target_fec_rate` Truncation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_scheduler.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "repair_count = ((u32)block_size * sched->target_fec_rate + 99) / 100;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/quic/tquic/fec/fec_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate `target_fec_rate <= 100` before this calculation.\n\n---",
    "tests_to_add": [
      "Add regression test for: FEC Repair Count Computation: `block_size * target_fec_rate` Truncation (net/quic/tquic/fec/fec_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-189",
    "fingerprint": "fec-loss-overflow-rate-scheduler|net/quic/tquic/fec/fec_scheduler.c|unknown_symbol|correctness",
    "title": "FEC Scheduler Loss Rate Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_scheduler.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "new_rate = (sched->loss_count * 1000) / sched->packet_count;",
        "new_rate = (u32)((u64)sched->loss_count * 1000 / sched->packet_count);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/quic/tquic/fec/fec_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n```c\nnew_rate = (u32)((u64)sched->loss_count * 1000 / sched->packet_count);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: FEC Scheduler Loss Rate Overflow (net/quic/tquic/fec/fec_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-190",
    "fingerprint": "getsockopt-identity-length-psk-validation|net/quic/tquic/tquic_socket.c|tquic_socket|correctness",
    "title": "getsockopt PSK Identity - Missing Length Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 8 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_socket.c :: tquic_socket. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_socket"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:1317-1317",
        "net/quic/tquic/tquic_socket.c:1334-1334"
      ],
      "snippets": [
        "if (copy_to_user(optval, tsk->psk_identity, identity_len)) {\n    ...\n}\nif (put_user(identity_len, optlen))",
        "if (copy_to_user(optval, hostname, hostname_len)) {\n    ...\n}\nif (put_user(hostname_len, optlen))",
        "if (copy_to_user(optval, &info, sizeof(info)))\n    return -EFAULT;\nif (put_user(sizeof(info), optlen))\n    return -EFAULT;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_socket\" \"net/quic/tquic/tquic_socket.c\"",
      "rg -n \"getsockopt\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (identity_len > len) return -EINVAL;` before\nthe copy_to_user call.\n\n---",
    "tests_to_add": [
      "Add regression test for: getsockopt PSK Identity - Missing Length Validation (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-191",
    "fingerprint": "byte-cid-coalesce-comparison-gro-hardcod|net/tquic/tquic_input.c|tquic_input|correctness",
    "title": "GRO Coalesce Uses Hardcoded 8-byte CID Comparison",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_input. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2249-2253"
      ],
      "snippets": [
        "/* For short headers, compare DCID */\n    if (!(h1[0] & TQUIC_HEADER_FORM_LONG)) {\n        /* Assume 8-byte CID for now */\n        return memcmp(h1 + 1, h2 + 1, 8) == 0;\n    }",
        "if (skb1->len < 1 + cid_len || skb2->len < 1 + cid_len)\n    return false;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/tquic/tquic_input.c\"",
      "rg -n \"gro\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "The GRO coalesce function needs to know the actual CID length. Pass it via skb metadata or look it up from connection state. Also add length checks:\n```c\nif (skb1->len < 1 + cid_len || skb2->len < 1 + cid_len)\n    return false;\n``` / The GRO coalesce function needs to know the actual CID length. Pass it via skb metadata or look it up from connection state. Also add length checks:\n```c\nif (skb1->len < 1 + cid_len || skb2->len < 1 + cid_len)\n    return false;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: GRO Coalesce Uses Hardcoded 8-byte CID Comparison (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-192",
    "fingerprint": "flush-gro-loop-relock-unlock-validation|net/quic/tquic/tquic_input.c|tquic_gro_receive_internal|concurrency",
    "title": "GRO Flush Unlock-Relock Loop Without Re-validation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_gro_receive_internal. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_gro_receive_internal",
        "tquic_input"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:2306-2306",
        "net/quic/tquic/tquic_input.c:2309-2309"
      ],
      "snippets": [
        "spin_lock(&gro->lock);\nwhile ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n    spin_unlock(&gro->lock);\n    deliver(skb);               // Arbitrary callback!\n    flushed++;\n    spin_lock(&gro->lock);     // New packets may have been added\n}\ngro->held_count = 0;           // Resets to 0, but n",
        "spin_lock(&gro->lock);\nwhile ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n    spin_unlock(&gro->lock);\n    deliver(skb);               // Arbitrary callback!\n    flushed++;\n    spin_lock(&gro->lock);     // New packets may have been added\n}\ngro->held_count = 0;           // Resets to 0, but new packets arrived!\nspin_unlock(&gro->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_gro_receive_internal\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"gro\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "After the loop, set `gro->held_count = skb_queue_len(&gro->hold_queue)` instead of hard-coding 0. / After the loop, set `gro->held_count = skb_queue_len(&gro->hold_queue)` instead of hard-coding 0.\n\n---",
    "tests_to_add": [
      "Add regression test for: GRO Flush Unlock-Relock Loop Without Re-validation (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-193",
    "fingerprint": "frame-h3_control_recv_frame-parse-payload|net/quic/tquic/http3/http3_request.c|h3_control_recv_frame|correctness",
    "title": "h3_control_recv_frame Does Not Parse Frame Payloads",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_control_recv_frame. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_control_recv_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "case H3_FRAME_SETTINGS:\n    pr_debug(\"h3: received SETTINGS frame\\n\");\n    /* Parse settings - implementation would extract parameters */\n    break;\ncase H3_FRAME_GOAWAY:\n    pr_debug(\"h3: received GOAWAY frame\\n\");\n    /* Parse stream ID from GOAWAY */\n    break;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"h3_control_recv_frame\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement actual parsing and processing for each frame type in this handler.\n\n---",
    "tests_to_add": [
      "Add regression test for: h3_control_recv_frame Does Not Parse Frame Payloads (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-194",
    "fingerprint": "atomic64_inc_return-every-number-packet|net/tquic/tquic_output.c|atomic64_inc_return|concurrency",
    "title": "HIGH: atomic64_inc_return for packet number on every TX",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: atomic64_inc_return. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1785"
      ],
      "symbols": [
        "rmw",
        "atomic64_inc_return",
        "tquic_output"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1785"
      ],
      "snippets": [
        "pkt_num = atomic64_inc_return(&conn->pkt_num_tx) - 1;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"atomic64_inc_return\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** If the TX path is always serialized by `conn->lock`, replace with a plain `u64` increment. If not always locked, document which paths require the atomic and consider whether a per-path packet number counter with a regular lock would be more appropriate.",
    "tests_to_add": [
      "Add regression test for: HIGH: atomic64_inc_return for packet number on every TX (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-195",
    "fingerprint": "atomic64-every-global-gro-packet-stat|net/tquic/tquic_offload.c|atomic64_inc|correctness",
    "title": "HIGH: GRO stats use global atomic64 on every packet",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 6 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_offload.c :: atomic64_inc. Category=correctness, severity=S1.\nEvidence union: 4 file(s), 3 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_offload.c",
        "net/tquic/tquic_offload.c:295",
        "net/tquic/tquic_offload.c:235-253",
        "net/tquic/tquic_offload.c:148"
      ],
      "symbols": [
        "atomic64_inc",
        "napi_gro_cb",
        "list_for_each_entry",
        "skb_gro_offset",
        "tquic_gro_parse_header",
        "tquic_gro_header",
        "tquic_offload",
        "tquic_gro_stats"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:295",
        "net/tquic/tquic_offload.c:235-253",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:148"
      ],
      "snippets": [
        "atomic64_inc(&tquic_gro_stats.coalesced_packets);",
        "list_for_each_entry(p, head, list) {\n    ...\n    ret = tquic_gro_parse_header(p->data + skb_gro_offset(p),\n                                 p->len, &held_hdr);",
        "hdr->dcid_len = TQUIC_DEFAULT_CID_LEN;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: api, concurrency, correctness, perf.",
      "Severity disagreement across reports: S1, S2, S3."
    ],
    "verification_commands": [
      "rg -n \"atomic64_inc\" \"net/tquic/tquic_offload.c\"",
      "rg -n \"gro\" \"net/tquic/tquic_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use per-CPU counters for GRO statistics, aggregate on read. / ** Cache the parsed `tquic_gro_header` in `NAPI_GRO_CB(skb)` on first parse, avoid re-parsing on subsequent comparisons. / ** Store the negotiated CID length in a per-socket or per-connection field accessible from the GRO callback.",
    "tests_to_add": [
      "Add regression test for: HIGH: GRO stats use global atomic64 on every packet (net/tquic/tquic_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-196",
    "fingerprint": "addres-buffer-entri-kernel-ring-stor|net/tquic/io_uring.c|userspace|security",
    "title": "HIGH: Kernel address stored as u64 in buffer ring entries",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/io_uring.c :: userspace. Category=security, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/io_uring.c",
        "net/tquic/io_uring.c:833"
      ],
      "symbols": [
        "ids",
        "userspace",
        "field"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:833"
      ],
      "snippets": [
        "br->br->bufs[tail].addr = (u64)(br->buf_base + bid * br->buf_size);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"userspace\" \"net/tquic/io_uring.c\"",
      "rg -n \"kernel\" \"net/tquic/io_uring.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use buffer IDs (indices) rather than raw kernel addresses. Store the base address separately in a kernel-only structure and compute the buffer address from `base + bid * size` at use time, never exposing the kernel address in shared structures.",
    "tests_to_add": [
      "Add regression test for: HIGH: Kernel address stored as u64 in buffer ring entries (net/tquic/io_uring.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-197",
    "fingerprint": "datagram-kmalloc-mtu-path-per-send|net/tquic/tquic_output.c|buffer|concurrency",
    "title": "HIGH: kmalloc(path->mtu) per datagram send",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: buffer. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:2508"
      ],
      "symbols": [
        "buffer",
        "bytes",
        "small",
        "tquic_send_datagram",
        "tquic_output",
        "tquic_sen"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:2508"
      ],
      "snippets": [
        "buf = kmalloc(path->mtu, GFP_ATOMIC);\nif (!buf)\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"buffer\" \"net/tquic/tquic_output.c\"",
      "rg -n \"kmalloc\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a per-connection pre-allocated scratch buffer (protected by `conn->lock` which is already held in the send path), or use a stack allocation since `path->mtu` is bounded and small (typically <= 1500 bytes; 1500 bytes on stack is acceptable in kernel context).",
    "tests_to_add": [
      "Add regression test for: HIGH: kmalloc(path->mtu) per datagram send (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-198",
    "fingerprint": "_bh-http3_stream-spin_lock|net/quic/tquic/http3/http3_stream.c|spin_lock|concurrency",
    "title": "http3_stream.c Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_stream.c :: spin_lock. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"spin_lock\" \"net/quic/tquic/http3/http3_stream.c\"",
      "rg -n \"http3_stream\" \"net/quic/tquic/http3/http3_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `spin_lock_bh` consistently. / Use `spin_lock_bh` consistently.\n\n---",
    "tests_to_add": [
      "Add regression test for: http3_stream.c Uses spin_lock Without _bh (net/quic/tquic/http3/http3_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-199",
    "fingerprint": "incomplete-protection-quic-ssrf-tcp-tunnel|net/tquic/tquic_tunnel.c|ipv6_addr_v4mapped|concurrency",
    "title": "Incomplete SSRF Protection in TCP-over-QUIC Tunnel",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: ipv6_addr_v4mapped. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "ipv6_addr_v4mapped",
        "ipv4_is_private_192",
        "ipv4_is_private_172",
        "ipv4_is_private",
        "ipv4_is_private_10",
        "tquic_tunnel"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv4_is_loopback(addr4) ||\n    ipv4_is_multicast(addr4) ||\n    ipv4_is_lbcast(addr4) ||\n    ipv4_is_zeronet(addr4)) {\n    return -EACCES;\n}\n/* MISSING: ipv4_is_private_10, ipv4_is_private_172, ipv4_is_private_192 */\n/* MISSING: link-local (169.254.0.0/16) including cloud metadata */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"ipv6_addr_v4mapped\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"incomplete\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add checks for all private ranges. Use `ipv4_is_private_10()`, `ipv4_is_private_172()`, `ipv4_is_private_192()` (or the unified `ipv4_is_private()` if available in the kernel version). Add link-local check. For IPv6, add check for IPv4-mapped addresses: `ipv6_addr_v4mapped()` and then validate the embedded IPv4 address.\n\n---",
    "tests_to_add": [
      "Add regression test for: Incomplete SSRF Protection in TCP-over-QUIC Tunnel (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-200",
    "fingerprint": "eexist-emsgsize-infinite-loop-retry|net/tquic/tquic_zerocopy.c|tquic_skb_zerocopy_iter_stream|concurrency",
    "title": "Infinite retry loop on EMSGSIZE/EEXIST",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: tquic_skb_zerocopy_iter_stream. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c",
        "net/tquic/tquic_zerocopy.c:315-318"
      ],
      "symbols": [
        "tquic_skb_zerocopy_iter_stream",
        "counter",
        "persistent",
        "tquic_zerocopy"
      ],
      "line_ranges": [
        "net/tquic/tquic_zerocopy.c:315-318"
      ],
      "snippets": [
        "if (err == -EMSGSIZE || err == -EEXIST) {\n    /* Try with a new skb */\n    continue;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"tquic_skb_zerocopy_iter_stream\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"infinite\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a retry counter (e.g., max 3 retries) and return an error after exhausting retries. Alternatively, adjust the chunk size downward on EMSGSIZE before retrying.",
    "tests_to_add": [
      "Add regression test for: Infinite retry loop on EMSGSIZE/EEXIST (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-201",
    "fingerprint": "calculation-integer-iovec-length-overflow-total|net/tquic/masque/connect_udp.c|check_add_overflow|memory",
    "title": "Integer Overflow in iovec Total Length Calculation",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_udp.c :: check_add_overflow. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [
        "check_add_overflow",
        "tquic_connect_udp_sendv"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Calculate total length */\nfor (i = 0; i < iovcnt; i++)\n    total_len += iov[i].iov_len;  /* <-- can overflow on 32-bit */\n\nif (total_len > TQUIC_CONNECT_UDP_MAX_PAYLOAD)\n    return -EMSGSIZE;\n\n/* Allocate and copy to contiguous buffer */\nbuf = kmalloc(total_len, GFP_KERNEL);  /* small due to over",
        "/* Calculate total length */\nfor (i = 0; i < iovcnt; i++)\n    total_len += iov[i].iov_len;  /* <-- can overflow on 32-bit */\n\nif (total_len > TQUIC_CONNECT_UDP_MAX_PAYLOAD)\n    return -EMSGSIZE;\n\n/* Allocate and copy to contiguous buffer */\nbuf = kmalloc(total_len, GFP_KERNEL);  /* small due to overflow */\nif (!buf)\n    return -ENOMEM;\n\nfor (i = 0; i < iovcnt; i++) {\n    memcpy(buf + offset, iov[i].iov_base, iov[i].iov_len);  /* heap overflow */\n    offset += iov[i].iov_len;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"check_add_overflow\" \"net/tquic/masque/connect_udp.c\"",
      "rg -n \"integer\" \"net/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `check_add_overflow()` or manually check for overflow: `if (total_len + iov[i].iov_len < total_len) return -EOVERFLOW;` within the accumulation loop.\n\n---",
    "tests_to_add": [
      "Add regression test for: Integer Overflow in iovec Total Length Calculation (net/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-202",
    "fingerprint": "buffer-get-io_ur-operation-per-put|net/tquic/io_uring.c|acquisitions|concurrency",
    "title": "io_uring buffer ring spinlock per get/put operation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/io_uring.c :: acquisitions. Category=concurrency, severity=S1.\nEvidence union: 3 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/io_uring.c",
        "net/tquic/io_uring.c:804-838",
        "net/tquic/io_uring.c:799-838"
      ],
      "symbols": [
        "acquisitions",
        "contexts",
        "thread",
        "tquic_io_buf_ring_get",
        "tquic_io_buf_ring_put",
        "tquic_io_buf_ring_get_batch",
        "tquic_io_buf_ring_put_batch",
        "tquic_io_buf_ring"
      ],
      "line_ranges": [
        "net/tquic/io_uring.c:804-838",
        "net/tquic/io_uring.c:799-838"
      ],
      "snippets": [
        "void *tquic_io_buf_ring_get(struct tquic_io_buf_ring *br, u16 *bid)\n{\n    spin_lock(&br->lock);\n    ...\n    spin_unlock(&br->lock);\n}\n\nvoid tquic_io_buf_ring_put(struct tquic_io_buf_ring *br, u16 bid)\n{\n    spin_lock(&br->lock);\n    ...\n    spin_unlock(&br->lock);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"acquisitions\" \"net/tquic/io_uring.c\"",
      "rg -n \"io_ur\" \"net/tquic/io_uring.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** If get/put are guaranteed to be called from different contexts (producer vs consumer), replace the spinlock with a lockless SPSC ring using `smp_store_release`/`smp_load_acquire` on head/tail. If multi-producer or multi-consumer, consider per-CPU rings or batch get/put APIs. / ** Add batch APIs: `tquic_io_buf_ring_get_batch(br, bufs, bids, count)` and `tquic_io_buf_ring_put_batch(br, bids, count)` that acquire the lock once for multiple operations.",
    "tests_to_add": [
      "Add regression test for: io_uring buffer ring spinlock per get/put operation (net/tquic/io_uring.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-203",
    "fingerprint": "balancer-check-has-load-privilege|net/tquic/lb/quic_lb.c|quic_lb|security",
    "title": "Load Balancer Has No Privilege Checks",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: quic_lb. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "quic_lb"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"quic_lb\" \"net/tquic/lb/quic_lb.c\"",
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** All LB configuration interfaces should require `CAP_NET_ADMIN`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Load Balancer Has No Privilege Checks (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-204",
    "fingerprint": "acces-control-has-masque-proxy|net/tquic/masque/connect_udp.c|unknown_symbol|security",
    "title": "MASQUE Proxy Has No Access Control",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_udp.c :: unknown_symbol. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"masque\" \"net/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Require `CAP_NET_ADMIN` to enable MASQUE proxy functionality.\n\n---",
    "tests_to_add": [
      "Add regression test for: MASQUE Proxy Has No Access Control (net/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-205",
    "fingerprint": "instead-key-material-memset-memzero_explicit-old|net/tquic/crypto/key_update.c|memzero_explicit|security",
    "title": "memset Instead of memzero_explicit for Old Key Material",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: memzero_explicit. Category=security, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "memzero_explicit"
      ],
      "line_ranges": [
        "net/tquic/crypto/key_update.c:435-435",
        "net/tquic/crypto/key_update.c:627-628",
        "net/tquic/crypto/key_update.c:404-404"
      ],
      "snippets": [
        "/* Line 435: After key rotation in tquic_initiate_key_update */\nmemset(&state->next_write, 0, sizeof(state->next_write));\n\n/* Lines 627-628: After peer key phase change */\nmemset(&state->next_read, 0, sizeof(state->next_read));\nmemset(&state->next_write, 0, sizeof(state->next_write));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"memzero_explicit\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"memset\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace all `memset(..., 0, ...)` clearing key material with\n`memzero_explicit()`.",
    "tests_to_add": [
      "Add regression test for: memset Instead of memzero_explicit for Old Key Material (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-206",
    "fingerprint": "buffer-crypto-extension-handshake-key-kfree_sensitive|net/quic/tquic/crypto/handshake.c|kfree_sensitive|security",
    "title": "Missing kfree_sensitive for key material in crypto/handshake.c extensions buffer",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/crypto/handshake.c :: kfree_sensitive. Category=security, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "kfree_sensitive"
      ],
      "line_ranges": [
        "net/quic/tquic/crypto/handshake.c:1280-1280",
        "net/quic/tquic/crypto/handshake.c:3260-3260"
      ],
      "snippets": [
        "extensions = kzalloc(2048, GFP_KERNEL);\n...\nhs->key_share.public_key = kzalloc(32, GFP_KERNEL);\nhs->key_share.private_key = kzalloc(32, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"kfree_sensitive\" \"net/quic/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Missing kfree_sensitive for key material in crypto/handshake.c extensions buffer (net/quic/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-207",
    "fingerprint": "against-first_ack_range-largest_ack-validation|net/tquic/core/frame.c|tquic_input|correctness",
    "title": "Missing Validation of `first_ack_range` Against `largest_ack`",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/frame.c :: tquic_input. Category=correctness, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/frame.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/core/frame.c:358-364"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/tquic/core/frame.c\"",
      "rg -n \"validation\" \"net/tquic/core/frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add validation: `if (first_ack_range > largest_ack) return -EPROTO;`",
    "tests_to_add": [
      "Add regression test for: Missing Validation of `first_ack_range` Against `largest_ack` (net/tquic/core/frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-208",
    "fingerprint": "addres-sockopt-tquic_migrate-validation|net/tquic/tquic_socket.c|tquic_path_find_by_addr|correctness",
    "title": "Missing Validation of `TQUIC_MIGRATE` sockopt Address",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_path_find_by_addr. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_path_find_by_addr",
        "tquic_migrate_args",
        "tquic_migrate_explicit",
        "tquic_path_create",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_MIGRATE: {\n        struct tquic_migrate_args args;\n\n        if (optlen < sizeof(args))\n            return -EINVAL;\n\n        if (copy_from_sockptr(&args, optval, sizeof(args)))\n            return -EFAULT;\n\n        if (args.reserved != 0)\n            return -EINVAL;\n\n        if (tsk->conn)\n",
        "case TQUIC_MIGRATE: {\n        struct tquic_migrate_args args;\n\n        if (optlen < sizeof(args))\n            return -EINVAL;\n\n        if (copy_from_sockptr(&args, optval, sizeof(args)))\n            return -EFAULT;\n\n        if (args.reserved != 0)\n            return -EINVAL;\n\n        if (tsk->conn)\n            return tquic_migrate_explicit(tsk->conn,\n                                          &args.local_addr,\n                                          args.flags);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_find_by_addr\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"validation\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Missing Validation of `TQUIC_MIGRATE` sockopt Address', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Missing Validation of `TQUIC_MIGRATE` sockopt Address (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-209",
    "fingerprint": "arbitrary-dcid-header-length-netfilter-pars|net/quic/tquic/tquic_nf.c|tquic_nf|memory",
    "title": "Netfilter Short Header DCID Parsing Uses Arbitrary Length",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_nf.c :: tquic_nf. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_nf.c"
      ],
      "symbols": [
        "tquic_nf"
      ],
      "line_ranges": [],
      "snippets": [
        "info->dcid.len = 8;\nif (len < info->dcid.len)\n    info->dcid.len = len;\nmemcpy(info->dcid.id, p, info->dcid.len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_nf\" \"net/quic/tquic/tquic_nf.c\"",
      "rg -n \"netfilter\" \"net/quic/tquic/tquic_nf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Netfilter Short Header DCID Parsing Uses Arbitrary Length (net/quic/tquic/tquic_nf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-210",
    "fingerprint": "check-forward-has-packet-privilege|net/tquic/tquic_forward.c|tquic_forward|security",
    "title": "Packet Forwarding Has No Privilege Checks",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_forward.c :: tquic_forward. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_forward.c"
      ],
      "symbols": [
        "tquic_forward"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_forward\" \"net/tquic/tquic_forward.c\"",
      "rg -n \"packet\" \"net/tquic/tquic_forward.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Require `CAP_NET_ADMIN` to enable packet forwarding.\n\n---",
    "tests_to_add": [
      "Add regression test for: Packet Forwarding Has No Privilege Checks (net/tquic/tquic_forward.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-211",
    "fingerprint": "header-long-pars-payload_len-subtraction-underflow|net/tquic/core/packet.c|unknown_symbol|correctness",
    "title": "payload_len Subtraction Underflow in Long Header Parsing",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/packet.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/packet.c:590-601",
        "net/tquic/core/packet.c:619-619"
      ],
      "snippets": [
        "hdr->header_len = offset;\n/* Adjust payload_len to not include packet number */\nhdr->payload_len -= hdr->pn_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"payload_len\" \"net/tquic/core/packet.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (hdr->payload_len < hdr->pn_len) return -EPROTO;` before the subtraction.",
    "tests_to_add": [
      "Add regression test for: payload_len Subtraction Underflow in Long Header Parsing (net/tquic/core/packet.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-212",
    "fingerprint": "congestion-control-ecn_ce_count-mss-overflow-prague|net/quic/tquic/cong/prague.c|unknown_symbol|correctness",
    "title": "Prague Congestion Control: `ecn_ce_count * mss` Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/cong/prague.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/cong/prague.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ce_bytes = ecn_ce_count * mss;",
        "ecn_ce_count = min_t(u64, ecn_ce_count, U32_MAX);\nce_bytes = ecn_ce_count * mss;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"prague\" \"net/quic/tquic/cong/prague.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Clamp `ecn_ce_count` to a reasonable maximum before multiplication:\n```c\necn_ce_count = min_t(u64, ecn_ce_count, U32_MAX);\nce_bytes = ecn_ce_count * mss;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Prague Congestion Control: `ecn_ce_count * mss` Overflow (net/quic/tquic/cong/prague.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-213",
    "fingerprint": "check-privilege-procf-trusted_ca-writable|net/tquic/crypto/cert_verify.c|current_cred|security",
    "title": "Procfs trusted_cas Writable Without Privilege Check",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: current_cred. Category=security, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "current_cred"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2772-2808",
        "net/tquic/crypto/cert_verify.c:2615-2615"
      ],
      "snippets": [
        "proc_create(\"trusted_cas\", 0644, tquic_cert_proc_dir,\n                &tquic_proc_trusted_cas_ops);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"current_cred\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"procf\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `capable(CAP_NET_ADMIN)` check in the write handler. Consider using 0600 permissions.",
    "tests_to_add": [
      "Add regression test for: Procfs trusted_cas Writable Without Privilege Check (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-214",
    "fingerprint": "duration-exponential-overflow-pto-shift|net/quic/tquic/tquic_timer.c|tquic_timer|correctness",
    "title": "PTO Duration Exponential Shift Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_timer.c :: tquic_timer. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer"
      ],
      "line_ranges": [],
      "snippets": [
        "pto_duration *= (1 << rs->pto_count);",
        "u32 shift = min_t(u32, rs->pto_count, 30);\npto_duration *= (1ULL << shift);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_timer\" \"net/quic/tquic/tquic_timer.c\"",
      "rg -n \"pto\" \"net/quic/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n```c\nu32 shift = min_t(u32, rs->pto_count, 30);\npto_duration *= (1ULL << shift);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: PTO Duration Exponential Shift Overflow (net/quic/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-215",
    "fingerprint": "between-check-copy_to_user-length-qlog-race|net/quic/tquic/diag/qlog.c|unknown_symbol|concurrency",
    "title": "qlog TOCTOU Race Between Length Check and copy_to_user",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/diag/qlog.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (tail != head && total < count) {\n    ...\n    json_len = tquic_qlog_emit_json(qlog, entry, json_buf, 1024);\n    ...\n    if (total + json_len > count)\n        break;\n\n    spin_unlock_irqrestore(&qlog->lock, flags);\n\n    if (copy_to_user(buf + total, json_buf, json_len)) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"qlog\" \"net/quic/tquic/diag/qlog.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: qlog TOCTOU Race Between Length Check and copy_to_user (net/quic/tquic/diag/qlog.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-216",
    "fingerprint": "condition-connection-idle-process-race-timer|net/tquic/masque/quic_proxy.c|proxied_conn_put|concurrency",
    "title": "Race Condition in Idle Timer Connection Processing",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/quic_proxy.c :: proxied_conn_put. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [
        "proxied_conn_put",
        "quic_proxy",
        "tquic_quic_proxy_deregister_conn"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_unlock_bh(&proxy->lock);\n\n/* Process removals outside lock */\nlist_for_each_entry_safe(pconn, tmp, &to_remove, list) {\n    list_del(&pconn->list);\n    tquic_quic_proxy_deregister_conn(pconn, QUIC_PROXY_DEREG_TIMEOUT, 0);\n    proxied_conn_put(pconn);  /* <-- pconn may already be freed by concurr",
        "spin_unlock_bh(&proxy->lock);\n\n/* Process removals outside lock */\nlist_for_each_entry_safe(pconn, tmp, &to_remove, list) {\n    list_del(&pconn->list);\n    tquic_quic_proxy_deregister_conn(pconn, QUIC_PROXY_DEREG_TIMEOUT, 0);\n    proxied_conn_put(pconn);  /* <-- pconn may already be freed by concurrent path */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"proxied_conn_put\" \"net/tquic/masque/quic_proxy.c\"",
      "rg -n \"race\" \"net/tquic/masque/quic_proxy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Hold a reference count on each connection while it is in the `to_remove` list (which appears to be partially done via `proxied_conn_put`). Ensure CID hash removal happens atomically with the list removal under the proxy lock, so no new lookups can find the connection after it is selected for removal.\n\n---",
    "tests_to_add": [
      "Add regression test for: Race Condition in Idle Timer Connection Processing (net/tquic/masque/quic_proxy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-217",
    "fingerprint": "count-redundant-statistic-triple|net/tquic/napi.c|atomic64_add|api",
    "title": "Redundant triple-counting of statistics",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 6 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/napi.c :: atomic64_add. Category=api, severity=S1.\nEvidence union: 4 file(s), 7 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.c",
        "net/tquic/napi.c:307-308",
        "net/tquic/napi.c:308,477",
        "net/tquic/napi.c:306-308"
      ],
      "symbols": [
        "atomic64_add",
        "atomic64_inc",
        "this_cpu_add",
        "this_cpu_inc",
        "tquic_napi_aggregate_pcpu_stats",
        "tquic_napi_global_stats",
        "sysfs",
        "writes",
        "tquic_napi_pcpu_stats",
        "tquic_nap",
        "tquic_napi_glo"
      ],
      "line_ranges": [
        "net/tquic/napi.c:307-308",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:308,477",
        "net/tquic/napi.c:306-308",
        "net/tquic/napi.c:346-347",
        "net/tquic/napi.c:75-75",
        "net/tquic/napi.c:308-308",
        "net/tquic/napi.c:477-477"
      ],
      "snippets": [
        "this_cpu_inc(tquic_napi_pcpu_stats.total_polls);\natomic64_inc(&tquic_napi_global_stats.total_polls);",
        "this_cpu_add(tquic_napi_pcpu_stats.total_packets, work_done);\natomic64_add(work_done, &tquic_napi_global_stats.total_packets);",
        "atomic64_inc(&tquic_napi_global_stats.total_polls);     // line 308\natomic64_add(work_done, &tquic_napi_global_stats.busy_poll_packets); // line 477",
        "tn->stats.poll_cycles++;\nthis_cpu_inc(tquic_napi_pcpu_stats.total_polls);\natomic64_inc(&tquic_napi_global_stats.total_polls);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: api, concurrency.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"atomic64_add\" \"net/tquic/napi.c\"",
      "rg -n \"redundant\" \"net/tquic/napi.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Remove the `tquic_napi_global_stats` atomic counters entirely. Use `tquic_napi_aggregate_pcpu_stats()` (already implemented at line 75) when global totals are needed for /proc display. / ** Remove the global atomic counters entirely. They are redundant with the per-CPU counters. Aggregate per-CPU stats on-demand when reading via procfs/sysfs (the `tquic_napi_aggregate_pcpu_stats()` function already exists for this purpose). / ** Keep only per-CPU stats. Remove `tn->stats` (or make it derived) and remove global atomic counters. Aggregate on-demand via `tquic_napi_aggregate_pcpu_stats()` for reporting.",
    "tests_to_add": [
      "Add regression test for: Redundant triple-counting of statistics (net/tquic/napi.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-218",
    "fingerprint": "allocation-check-four-group-individual-null|net/quic/tquic/fec/reed_solomon.c|unknown_symbol|concurrency",
    "title": "reed_solomon.c -- four-allocation group without individual NULL checks",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/reed_solomon.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/reed_solomon.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/reed_solomon.c:590-590"
      ],
      "snippets": [
        "decode_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\ninv_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\nsyndrome = kmalloc_array(num_erasures, max_len, GFP_ATOMIC);\nrepair_used = kmalloc_array(num_erasures, sizeof(int), GFP_ATOMIC);\n\nif (!decode_matrix || !inv_matr",
        "out:\n    kfree(decode_matrix);\n    kfree(inv_matrix);\n    kfree(syndrome);\n    kfree(repair_used);",
        "decode_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\ninv_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\nsyndrome = kmalloc_array(num_erasures, max_len, GFP_ATOMIC);\nrepair_used = kmalloc_array(num_erasures, sizeof(int), GFP_ATOMIC);\n\nif (!decode_matrix || !inv_matrix || !syndrome || !repair_used) {\n    ret = -ENOMEM;\n    goto out;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"reed_solomon\" \"net/quic/tquic/fec/reed_solomon.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: reed_solomon.c -- four-allocation group without individual NULL checks (net/quic/tquic/fec/reed_solomon.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-219",
    "fingerprint": "integrity-key-nonce-quic-retry-tag|net/tquic/core/connection.c|unknown_symbol|security",
    "title": "Retry Integrity Tag Uses Wrong Key/Nonce for QUIC v2",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Select retry integrity key/nonce based on `conn->version`.",
    "tests_to_add": [
      "Add regression test for: Retry Integrity Tag Uses Wrong Key/Nonce for QUIC v2 (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-220",
    "fingerprint": "buffer-overflow-packet-retry-stack|net/tquic/core/connection.c|unknown_symbol|memory",
    "title": "Retry Packet Stack Buffer Overflow",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=memory, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:1379-1379",
        "net/tquic/core/connection.c:1401-1401"
      ],
      "snippets": [
        "int tquic_send_retry(...)\n{\n    u8 packet[512];\n    u8 *p = packet;\n    u8 token[TQUIC_RETRY_TOKEN_MAX_LEN];  // 256 bytes\n    ...\n    u8 pseudo_packet[512];\n    u8 *pp = pseudo_packet;\n    ...\n    *pp++ = original_dcid->len;\n    memcpy(pp, original_dcid->id, original_dcid->len);\n    pp += original_",
        "int tquic_send_retry(...)\n{\n    u8 packet[512];\n    u8 *p = packet;\n    u8 token[TQUIC_RETRY_TOKEN_MAX_LEN];  // 256 bytes\n    ...\n    u8 pseudo_packet[512];\n    u8 *pp = pseudo_packet;\n    ...\n    *pp++ = original_dcid->len;\n    memcpy(pp, original_dcid->id, original_dcid->len);\n    pp += original_dcid->len;\n\n    pkt_len = p - packet;\n    memcpy(pp, packet, pkt_len);     // Line 1379\n    pp += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Allocate `packet`, `token`, and `pseudo_packet` on the heap using `kmalloc`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Retry Packet Stack Buffer Overflow (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-221",
    "fingerprint": "encod-hardcod-packet-retry-version|net/tquic/core/connection.c|tquic_encode_packet_type|memory",
    "title": "Retry Packet Version Encoding Is Hardcoded for v1",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_encode_packet_type. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_encode_packet_type"
      ],
      "line_ranges": [],
      "snippets": [
        "*p++ = 0xf0;  /* Long header, Retry type */\nmemcpy(p, &conn->version, 4);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_encode_packet_type\" \"net/tquic/core/connection.c\"",
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `tquic_encode_packet_type()` for the header byte and `cpu_to_be32(conn->version)` for the version field.",
    "tests_to_add": [
      "Add regression test for: Retry Packet Version Encoding Is Hardcoded for v1 (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-222",
    "fingerprint": "aead-irq-key-non-retry-safe|net/tquic/core/connection.c|unknown_symbol|concurrency",
    "title": "Retry Token AEAD Key Set Under Non-IRQ-Safe Spinlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&tquic_retry_aead_lock);\nret = crypto_aead_setkey(tquic_retry_aead, tquic_retry_token_key, ...);\n...\nret = crypto_aead_encrypt(req);\nspin_unlock(&tquic_retry_aead_lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a mutex instead of a spinlock, or use `spin_lock_bh`. Better yet, allocate a per-connection AEAD instance to avoid global locking entirely.\n\n---",
    "tests_to_add": [
      "Add regression test for: Retry Token AEAD Key Set Under Non-IRQ-Safe Spinlock (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-223",
    "fingerprint": "data-lock-pointer-protect-return-stack|net/tquic/core/connection.c|tquic_cid|concurrency",
    "title": "Return Pointer to Stack/Lock-Protected Data in tquic_conn_get_active_cid",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_cid. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid",
        "tquic_connection",
        "tquic_conn_get_active_cid"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_cid *tquic_conn_get_active_cid(struct tquic_connection *conn)\n{\n    ...\n    spin_lock_bh(&conn->lock);\n    list_for_each_entry(entry, &cs->remote_cids, list) {\n        if (!entry->retired) {\n            result = &entry->cid;\n            break;\n        }\n    }\n    spin_unlock_bh(&conn->l",
        "struct tquic_cid *tquic_conn_get_active_cid(struct tquic_connection *conn)\n{\n    ...\n    spin_lock_bh(&conn->lock);\n    list_for_each_entry(entry, &cs->remote_cids, list) {\n        if (!entry->retired) {\n            result = &entry->cid;\n            break;\n        }\n    }\n    spin_unlock_bh(&conn->lock);\n\n    return result;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/tquic/core/connection.c\"",
      "rg -n \"return\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Copy the CID data into a caller-provided buffer while holding the lock, rather than returning a pointer to shared data.\n\n---",
    "tests_to_add": [
      "Add regression test for: Return Pointer to Stack/Lock-Protected Data in tquic_conn_get_active_cid (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-224",
    "fingerprint": "256-algorithm-certificate-hardcod-regardles-rsa|net/tquic/crypto/cert_verify.c|the|security",
    "title": "RSA Signature Algorithm Hardcoded to SHA-256 Regardless of Certificate",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: the. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "the"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_PUBKEY_ALGO_RSA:\n        alg_name = \"pkcs1pad(rsa,sha256)\";\n        break;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"the\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"rsa\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Construct the algorithm name dynamically from `cert->signature.hash_algo`, e.g., `\"pkcs1pad(rsa,sha384)\"` or `\"pkcs1pad(rsa,sha512)\"`.\n\n---",
    "tests_to_add": [
      "Add regression test for: RSA Signature Algorithm Hardcoded to SHA-256 Regardless of Certificate (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-225",
    "fingerprint": "atomic-harden-pre-security-toctou|net/quic/tquic/security_hardening.c|atomic_inc_return|concurrency",
    "title": "Security Hardening Pre-HS Atomic TOCTOU",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/security_hardening.c :: atomic_inc_return. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/security_hardening.c"
      ],
      "symbols": [
        "atomic_inc_return"
      ],
      "line_ranges": [
        "net/quic/tquic/security_hardening.c:280-280",
        "net/quic/tquic/security_hardening.c:289-289"
      ],
      "snippets": [
        "new_total = atomic64_add_return(size, &pre_hs_state.total_memory);\nif (new_total > pre_hs_state.memory_limit) {\n    atomic64_sub(size, &pre_hs_state.total_memory);\n    return -ENOMEM;\n}\n\nentry = find_or_create_ip_entry(addr, true);\nif (entry) {\n    new_per_ip = atomic64_add_return(size, &entry->memory_used);\n    if (new_per_ip > pre_hs_state.per_ip_budget) {\n        atomic64_sub(size, &entry->memory_used);\n        atomic64_sub(size, &pre_hs_state.total_memory);\n        return -ENOMEM;\n    }\n\n    if (atomic_read(&entry->conn_count) >= TQUIC_PRE_HS_MAX_CONNS_PER_IP) {\n        // ... rollback ...\n        return -ENOMEM;\n    }\n\n    atomic_inc(&entry->conn_count);  // TOCTOU with the check above!\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"atomic_inc_return\" \"net/quic/tquic/security_hardening.c\"",
      "rg -n \"security\" \"net/quic/tquic/security_hardening.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `atomic_inc_return()` and check the result instead of separate read + increment.",
    "tests_to_add": [
      "Add regression test for: Security Hardening Pre-HS Atomic TOCTOU (net/quic/tquic/security_hardening.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-226",
    "fingerprint": "bound-check-copy-decode-psk-session|net/tquic/crypto/zero_rtt.c|unknown_symbol|memory",
    "title": "Session Ticket Decode Missing Bounds Check on PSK Copy",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=memory, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.c:1160-1160",
        "net/tquic/crypto/zero_rtt.c:1143-1143",
        "net/tquic/crypto/zero_rtt.c:1147-1147"
      ],
      "snippets": [
        "out->psk_len = *p++;\n    if (out->psk_len == 0 ||\n        out->psk_len > TQUIC_ZERO_RTT_SECRET_MAX_LEN) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    if (payload_len < 1 + out->psk_len + 4 + 8 + 2 + 1) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    memcpy(out->psk, p, out->psk",
        "out->psk_len = *p++;\n    if (out->psk_len == 0 ||\n        out->psk_len > TQUIC_ZERO_RTT_SECRET_MAX_LEN) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    if (payload_len < 1 + out->psk_len + 4 + 8 + 2 + 1) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    memcpy(out->psk, p, out->psk_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"session\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Session Ticket Decode Missing Bounds Check on PSK Copy (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-227",
    "fingerprint": "_bh-smartnic-spin_lock|net/quic/tquic/offload/smartnic.c|spin_lock|concurrency",
    "title": "smartnic.c Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/offload/smartnic.c :: spin_lock. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"spin_lock\" \"net/quic/tquic/offload/smartnic.c\"",
      "rg -n \"smartnic\" \"net/quic/tquic/offload/smartnic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Audit all call sites. If any are reachable from softirq context, change to `spin_lock_bh`. / Audit all call sites. If any are reachable from softirq context, change to `spin_lock_bh`.\n\n---",
    "tests_to_add": [
      "Add regression test for: smartnic.c Uses spin_lock Without _bh (net/quic/tquic/offload/smartnic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-228",
    "fingerprint": "cold-field-hot-mix-struct-tquic_napi|net/tquic/napi.h|fields|concurrency",
    "title": "struct tquic_napi mixes hot and cold fields",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/napi.h :: fields. Category=concurrency, severity=S1.\nEvidence union: 2 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.h",
        "net/tquic/napi.h:112-143"
      ],
      "symbols": [
        "cpus",
        "fields",
        "tquic_napi",
        "contains",
        "sk_buff_head",
        "napi_struct",
        "layout",
        "tquic_napi_stats",
        "with",
        "itself"
      ],
      "line_ranges": [
        "net/tquic/napi.h:112-143"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"fields\" \"net/tquic/napi.h\"",
      "rg -n \"struct\" \"net/tquic/napi.h\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `____cacheline_aligned_in_smp` between the RX-side fields (`rx_queue`, `rx_queue_len`, `lock`) and the poll-side fields (`stats`, `coalesce`) to separate them onto different cache lines. / ** Reorganize the struct with `____cacheline_aligned_in_smp` annotations:\n  1. Group read-mostly fields (config, coalesce, enabled flags) together\n  2. Group write-heavy fields (stats, state, queue_len) together with explicit cache line alignment\n  3. Place the lock on its own cache line",
    "tests_to_add": [
      "Add regression test for: struct tquic_napi mixes hot and cold fields (net/tquic/napi.h)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-229",
    "fingerprint": "condition-free-race-remove-store-ticket|net/tquic/crypto/zero_rtt.c|tquic_zero_rtt_ticket|memory",
    "title": "Ticket Store Free-After-Remove Race Condition",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: tquic_zero_rtt_ticket. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "tquic_zero_rtt_ticket",
        "tquic_zero_rtt_put_ticket"
      ],
      "line_ranges": [],
      "snippets": [
        "old = ticket_store_find_locked(&global_ticket_store,\n                                   server_name, server_name_len);\n    if (old) {\n        ticket_store_remove_locked(&global_ticket_store, old);\n        ticket_free(old);  // <-- frees while refcount may be > 1\n    }",
        "static void ticket_free(struct tquic_zero_rtt_ticket *ticket)\n{\n    if (!ticket)\n        return;\n    kfree(ticket->ticket);\n    memzero_explicit(&ticket->plaintext, sizeof(ticket->plaintext));\n    kfree(ticket);  // <-- unconditional free\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_zero_rtt_ticket\" \"net/tquic/crypto/zero_rtt.c\"",
      "rg -n \"ticket\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** `ticket_store_remove_locked` should only remove from the tree/list. The actual free should happen via `tquic_zero_rtt_put_ticket` (refcount-based). Change `ticket_free(old)` to `tquic_zero_rtt_put_ticket(old)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Ticket Store Free-After-Remove Race Condition (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-230",
    "fingerprint": "capability-check-inversion-logic-tproxy|net/tquic/tquic_tunnel.c|tquic_tunnel|security",
    "title": "TPROXY Capability Check Logic Inversion",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: tquic_tunnel. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "tquic_tunnel",
        "tquic_kernel_setsockopt",
        "tquic_err",
        "tquic_info"
      ],
      "line_ranges": [],
      "snippets": [
        "if (capable(CAP_NET_ADMIN)) {\n    tquic_err(\"IP_TRANSPARENT failed despite CAP_NET_ADMIN: %d\\n\", err);\n} else {\n    tquic_info(\"IP_TRANSPARENT requires CAP_NET_ADMIN, using normal mode\\n\");\n}",
        "if (is_tproxy) {\n    val = 1;\n    err = tquic_kernel_setsockopt(sock, SOL_IP, IP_TRANSPARENT,\n                                  &val, sizeof(val));\n    if (err < 0) {\n        if (capable(CAP_NET_ADMIN)) {\n            /* Has caps but setsockopt failed -> error */\n            tquic_err(\"IP_TRANSPARENT failed despite CAP_NET_ADMIN: %d\\n\", err);\n            sock_release(sock);\n            return err;\n        }\n        /* No caps -> silent fallback to non-TPROXY */\n        tquic_info(\"IP_TRANSPARENT requires CAP_NET_ADMIN, using normal mode\\n\");\n        tunnel->is_tproxy = false;\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_tunnel\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"tproxy\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check `capable(CAP_NET_ADMIN)` first. If the caller lacks the capability, return `-EPERM` immediately rather than silently degrading. / ** Require `CAP_NET_ADMIN` to create tunnels. Use `ns_capable(sock_net(sk)->user_ns, CAP_NET_ADMIN)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: TPROXY Capability Check Logic Inversion (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-231",
    "fingerprint": "allocat-attacker-bas-controll-length-skb|net/tquic/tquic_input.c|alloc_skb|concurrency",
    "title": "tquic_process_stream_frame Allocates skb Based on Attacker-Controlled length",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: alloc_skb. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "alloc_skb",
        "tquic_stream_open_incoming",
        "tquic_process_stream_frame",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:944-944",
        "net/tquic/tquic_input.c:909-909",
        "net/tquic/tquic_input.c:963-963",
        "net/tquic/tquic_input.c:938-938"
      ],
      "snippets": [
        "if (length > 65535)\n        return -EINVAL;\n    ...\n    /* Copy data to stream receive buffer */\n    data_skb = alloc_skb(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"alloc_skb\" \"net/tquic/tquic_input.c\"",
      "rg -n \"tquic_process_stream_frame\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Move the `sk_rmem_alloc` check BEFORE the `alloc_skb()` call to avoid the allocation entirely when the buffer is full. Also consider a global receive buffer cap. / Move the `sk_rmem_alloc` check BEFORE the `alloc_skb()` call to avoid the allocation entirely when the buffer is full. Also consider a global receive buffer cap.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_process_stream_frame Allocates skb Based on Attacker-Controlled length (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-232",
    "fingerprint": "enforcement-scan-stream-tquic_stream_count_by_type|net/quic/tquic/tquic_stream.c|tquic_stream_count_by_type|concurrency",
    "title": "tquic_stream_count_by_type O(n) Scan for Critical Stream Enforcement",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_count_by_type. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_count_by_type",
        "tquic_stream"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_count_by_type\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Maintain per-type counters in the connection structure, incrementing/decrementing on stream creation/destruction.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_count_by_type O(n) Scan for Critical Stream Enforcement (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-233",
    "fingerprint": "check-control-flow-integer-overflow-potential|net/quic/tquic/core/stream.c|tquic_stream_recv_data|correctness",
    "title": "tquic_stream_recv_data Potential Integer Overflow in Flow Control Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_recv_data. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_recv_data"
      ],
      "line_ranges": [
        "net/quic/tquic/core/stream.c:697-699"
      ],
      "snippets": [
        "if (offset + skb->len > stream->max_recv_data) {\n    ...\n}\nif (mgr->data_received + skb->len > mgr->max_data_local) {\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_recv_data\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add overflow check before the addition: `if (skb->len > U64_MAX - offset) return -EOVERFLOW;`\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_recv_data Potential Integer Overflow in Flow Control Check (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-234",
    "fingerprint": "check-tquic_stream_send_allow-underflow|net/quic/tquic/core/stream.c|tquic_stream_send_allowed|concurrency",
    "title": "tquic_stream_send_allowed Missing Underflow Check",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_send_allowed. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_send_allowed"
      ],
      "line_ranges": [],
      "snippets": [
        "stream_limit = stream->max_send_data - stream->send_offset;\n...\nconn_limit = mgr->max_data_remote - mgr->data_sent;",
        "if (stream->send_offset >= stream->max_send_data) { blocked; return 0; }\nstream_limit = stream->max_send_data - stream->send_offset;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_send_allowed\" \"net/quic/tquic/core/stream.c\"",
      "rg -n \"tquic_stream_send_allow\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add underflow guards:\n```c\nif (stream->send_offset >= stream->max_send_data) { blocked; return 0; }\nstream_limit = stream->max_send_data - stream->send_offset;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_send_allowed Missing Underflow Check (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-235",
    "fingerprint": "first-page-read-tquic_stream_sendfile|net/quic/tquic/core/stream.c|tquic_stream_sendfile|memory",
    "title": "tquic_stream_sendfile Reads Only Into First Page",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_sendfile. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_sendfile"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = kernel_read(file, page_address(pages[0]), chunk, offset);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other.",
      "Severity disagreement across reports: S1, S2."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_sendfile\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Read into each page individually, or allocate a contiguous buffer. The current code only works correctly when `chunk <= PAGE_SIZE`.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_sendfile Reads Only Into First Page (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-236",
    "fingerprint": "double-failure-free-tquic_stream_socket_create|net/quic/tquic/tquic_stream.c|tquic_stream_socket_create|memory",
    "title": "tquic_stream_socket_create Double-Free on fd Failure",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_socket_create. Category=memory, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_socket_create",
        "tquic_stream",
        "tquic_sock_map_fd",
        "tquic_stream_release"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:213-231",
        "net/quic/tquic/tquic_stream.c:219-219",
        "net/quic/tquic/tquic_stream.c:224-224",
        "net/quic/tquic/tquic_stream.c:591-591"
      ],
      "snippets": [
        "fd = tquic_sock_map_fd(sock, O_CLOEXEC);\nif (fd < 0) {\n    /* Note: tquic_sock_map_fd calls sock_release on failure */\n    tquic_stream_remove_from_conn(conn, stream);\n    kfree(ss);\n    tquic_stream_free(stream);\n    return fd;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_socket_create\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Set `sk_user_data` to NULL before calling `tquic_sock_map_fd`, or set it only after successful fd allocation. Fix the `sock_alloc_file` failure path to release the socket.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_socket_create Double-Free on fd Failure (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-237",
    "fingerprint": "leak-partial-send-tquic_zerocopy_sendmsg-uarg|net/quic/tquic/tquic_zerocopy.c|tquic_zerocopy_sendmsg|correctness",
    "title": "tquic_zerocopy_sendmsg -- uarg leak on partial send",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_zerocopy.c :: tquic_zerocopy_sendmsg. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "tquic_zerocopy_sendmsg",
        "tquic_zerocopy"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_zerocopy.c:360-360"
      ],
      "snippets": [
        "while (copied < len) {\n    new_skb = alloc_skb(0, GFP_KERNEL);\n    if (!new_skb) {\n        err = -ENOMEM;\n        goto out_err;\n    }\n    ...\n    skb_queue_tail(&stream->send_buf, new_skb);\n    copied += chunk;\n}\n...\nout_err:\n    if (uarg && !msg->msg_ubuf)\n        net_zcopy_put(uarg);\n    return er",
        "while (copied < len) {\n    new_skb = alloc_skb(0, GFP_KERNEL);\n    if (!new_skb) {\n        err = -ENOMEM;\n        goto out_err;\n    }\n    ...\n    skb_queue_tail(&stream->send_buf, new_skb);\n    copied += chunk;\n}\n...\nout_err:\n    if (uarg && !msg->msg_ubuf)\n        net_zcopy_put(uarg);\n    return err;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_zerocopy_sendmsg\" \"net/quic/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** On the error path, dequeue and free all SKBs added during\nthis call, or commit the partial send as successful (return `copied` instead\nof error if `copied > 0`).\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_zerocopy_sendmsg -- uarg leak on partial send (net/quic/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-238",
    "fingerprint": "byte-first-negotiation-packet-randomiz-version|net/tquic/core/connection.c|tquic_input|correctness",
    "title": "Version Negotiation Packet Missing Randomized First Byte",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_input. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "*p++ = 0x80;  /* Long header */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/tquic/core/connection.c\"",
      "rg -n \"version\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `get_random_bytes(&first_byte, 1); first_byte |= 0x80;` similar to the function in `tquic_input.c:523`.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Packet Missing Randomized First Byte (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-239",
    "fingerprint": "cid-enabl-flood-function-hash-weak|net/tquic/masque/quic_proxy.c|quic_proxy|security",
    "title": "Weak CID Hash Function Enables Hash Flooding",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/quic_proxy.c :: quic_proxy. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [
        "quic_proxy",
        "jhash",
        "siphash"
      ],
      "line_ranges": [],
      "snippets": [
        "static inline u32 cid_hash_key(const u8 *cid, u8 len)\n{\n    u32 hash = 0;\n    int i;\n\n    for (i = 0; i < len; i++)\n        hash = (hash * 31) + cid[i];\n\n    return hash;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"quic_proxy\" \"net/tquic/masque/quic_proxy.c\"",
      "rg -n \"weak\" \"net/tquic/masque/quic_proxy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `jhash()` or `siphash()` with a per-proxy random key initialized at proxy creation time. SipHash is specifically designed to be resistant to hash-flooding attacks.\n\n---",
    "tests_to_add": [
      "Add regression test for: Weak CID Hash Function Enables Hash Flooding (net/tquic/masque/quic_proxy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-240",
    "fingerprint": "deserialization-field-length-rtt-session-ticket|net/quic/tquic/crypto/zero_rtt.c|unknown_symbol|memory",
    "title": "Zero-RTT Session Ticket Deserialization Trusts Length Fields",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=memory, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/crypto/zero_rtt.c:1140-1160"
      ],
      "snippets": [
        "memcpy(out->psk, p, out->psk_len);\n...\nmemcpy(out->alpn, p, out->alpn_len);\n...\nmemcpy(out->transport_params, p, out->transport_params_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"zero\" \"net/quic/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Zero-RTT Session Ticket Deserialization Trusts Length Fields (net/quic/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-241",
    "fingerprint": "error-positive-sk_err-stor-tquic_connect-value|net/tquic/tquic_socket.c|tquic_connect|correctness",
    "title": "`tquic_connect()` Stores Error in `sk->sk_err` as Positive Value Wrongly",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_connect. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_connect",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:260-274"
      ],
      "snippets": [
        "out_close:\n    inet_sk_set_state(sk, TCP_CLOSE);\n    sk->sk_err = -ret;  /* Store error for getsockopt */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_connect\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_connect()` Stores Error in `sk->sk_err` as Positive Value Wrongly', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_connect()` Stores Error in `sk->sk_err` as Positive Value Wrongly (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-242",
    "fingerprint": "ack-bytes_ack-calculation-frame-overflow|net/tquic/tquic_input.c|tquic_cong_on_ack|correctness",
    "title": "ACK Frame bytes_acked Calculation Can Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_cong_on_ack. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cong_on_ack"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:736-738"
      ],
      "snippets": [
        "{\n        u64 bytes_acked = (first_ack_range + 1) * 1200;\n\n        /* Dispatch ACK event to congestion control */\n        tquic_cong_on_ack(ctx->path, bytes_acked, rtt_us);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_on_ack\" \"net/tquic/tquic_input.c\"",
      "rg -n \"ack\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Cap `first_ack_range` to a reasonable value (e.g., the maximum number of packets in flight) before the multiplication. Alternatively, cap `bytes_acked` to the actual bytes in flight.",
    "tests_to_add": [
      "Add regression test for: ACK Frame bytes_acked Calculation Can Overflow (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-243",
    "fingerprint": "ack-process-range-semantic-validation|net/quic/tquic/tquic_input.c|tquic_input|security",
    "title": "ACK Range Processing Without Semantic Validation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 4 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_input. Category=security, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_input",
        "tquic_try_decrypt_with_old_keys",
        "tquic_process_ack_frame",
        "tquic_decode_varint"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:642-642",
        "net/quic/tquic/tquic_input.c:2631-2631",
        "net/quic/tquic/tquic_input.c:733-733",
        "net/quic/tquic/tquic_input.c:646-660"
      ],
      "snippets": [
        "// tquic_input.c:646\nfor (i = 0; i < ack_range_count; i++) {\n    // varint decode for gap and range (2 varints per iteration)\n}",
        "for (i = 0; i < ack_range_count; i++) {\n    u64 gap, range;\n    ret = tquic_decode_varint(ctx->data + ctx->offset,\n                  ctx->len - ctx->offset, &gap);\n    ...\n    ret = tquic_decode_varint(ctx->data + ctx->offset,\n                  ctx->len - ctx->offset, &range);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, security.",
      "Severity disagreement across reports: S1, S2.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"ack\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Limit ACK frames per packet to 1 (which RFC 9000 already expects) / Track consecutive decryption failures per CID and temporarily blacklist CIDs with excessive failures. Also, the rate limiting at the UDP receive entry point should cover short-header packets, not just Initial packets. / Implement proper sent-packet tracking to validate ACK ranges",
    "tests_to_add": [
      "Add regression test for: ACK Range Processing Without Semantic Validation (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-244",
    "fingerprint": "close-connection-content-phrase-reason-skipp|net/tquic/tquic_output.c|tquic_output_packet|memory",
    "title": "Connection Close Reason Phrase Skipped Without Content Validation",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_output_packet. Category=memory, severity=S1.\nEvidence union: 2 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_output_packet"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1248-1250",
        "net/tquic/tquic_output.c:1252-1252",
        "net/tquic/tquic_output.c:1413-1418"
      ],
      "snippets": [
        "if (reason_len > ctx->len - ctx->offset)\n        return -EINVAL;\n    ctx->offset += (size_t)reason_len;",
        "skb = __skb_dequeue(&pacing->queue);\n        spin_unlock_bh(&pacing->lock);\n\n        /* Actually send the packet */\n        tquic_output_packet(NULL, pacing->path, skb);\n\n        spin_lock_bh(&pacing->lock);\n\n        /* Update next send time */\n        gap = tquic_pacing_calc_gap(pacing, skb->len); "
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_output_packet\" \"net/tquic/tquic_output.c\"",
      "rg -n \"connection\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Save `skb->len` before calling `tquic_output_packet()`.",
    "tests_to_add": [
      "Add regression test for: Connection Close Reason Phrase Skipped Without Content Validation (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-245",
    "fingerprint": "check-data-migration-race-server|net/tquic/tquic_migration.c|tquic_migration|memory",
    "title": "Data Race in Server Migration Check",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_migration. Category=memory, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migration"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1261-1261",
        "net/tquic/tquic_migration.c:1270-1270"
      ],
      "snippets": [
        "// line 1261: READ WITHOUT LOCK\nif (!sockaddr_equal(&path->remote_addr, new_remote)) {\n    ...\n    // line 1270: LOCK ACQUIRED LATER\n    spin_lock_bh(&conn->paths_lock);\n    memcpy(&path->remote_addr, new_remote, sizeof(*new_remote));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_migration\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"data\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Data Race in Server Migration Check (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-246",
    "fingerprint": "bound-check-internal-robin-round-scheduler|net/tquic/multipath/tquic_scheduler.c|tquic_weighted_select_path|memory",
    "title": "Internal Round-Robin Scheduler Missing Bounds Check",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_weighted_select_path. Category=memory, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_weighted_select_path",
        "tquic_scheduler"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:817-817"
      ],
      "snippets": [
        "if (!wd || conn->num_paths == 0)\n    return -ENOENT;\n// ... conn->num_paths could become 0 here via concurrent path_remove ...\nstart_idx = wd->current_path_idx % conn->num_paths;  // div by zero"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_weighted_select_path\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"internal\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Internal Round-Robin Scheduler Missing Bounds Check (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-247",
    "fingerprint": "encryption-frame-level-multipath-process-validation|net/tquic/tquic_input.c|tquic_process_mp_new_connection_id_frame|security",
    "title": "Multipath Frame Processing Lacks Encryption Level Validation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_process_mp_new_connection_id_frame. Category=security, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_mp_new_connection_id_frame"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2027-2038"
      ],
      "snippets": [
        "} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_mp_new_connection_id_frame\" \"net/tquic/tquic_input.c\"",
      "rg -n \"multipath\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add encryption level checks for all multipath frame types. They should only be accepted in 1-RTT packets (and possibly 0-RTT):\n```c\n} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);\n```",
    "tests_to_add": [
      "Add regression test for: Multipath Frame Processing Lacks Encryption Level Validation (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-248",
    "fingerprint": "condition-last_activity-path-race|net/quic/tquic/tquic_input.c|tquic_process_packet|concurrency",
    "title": "Race Condition on path->last_activity",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_process_packet. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_packet",
        "tquic_process_coalesced",
        "tquic_process_ack_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:723-723",
        "net/quic/tquic/tquic_input.c:2687-2687",
        "net/quic/tquic/tquic_input.c:3070-3070"
      ],
      "snippets": [
        "rtt_us = ktime_us_delta(now, ctx->path->last_activity);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_packet\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"race\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Race Condition on path->last_activity (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-249",
    "fingerprint": "against-number-prior-retire-sequence-validat|net/quic/tquic/tquic_input.c|tquic_process_retire_connection_id_frame|correctness",
    "title": "Retire Prior To Not Validated Against Sequence Number",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_process_retire_connection_id_frame. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 7 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_retire_connection_id_frame",
        "tquic_process_new_connection_id_frame",
        "tquic_input",
        "tquic_path_handle_challenge",
        "tquic_path_handle_response"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1045-1045",
        "net/quic/tquic/tquic_input.c:1126-1138",
        "net/quic/tquic/tquic_input.c:1138-1138",
        "net/quic/tquic/tquic_input.c:1188-1188",
        "net/quic/tquic/tquic_input.c:1195-1195",
        "net/quic/tquic/tquic_input.c:1188-1207",
        "net/quic/tquic/tquic_input.c:1066-1066"
      ],
      "snippets": [
        "if (retire_prior_to > seq_num) return -EPROTO;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Severity disagreement across reports: S1, S2.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_retire_connection_id_frame\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"retire\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Retire Prior To Not Validated Against Sequence Number', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Retire Prior To Not Validated Against Sequence Number (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-250",
    "fingerprint": "fallback-init_net-lookup-route|net/tquic/tquic_output.c|tquic_output|security",
    "title": "Route Lookup Fallback to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_output. Category=security, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1681-1681",
        "net/tquic/tquic_output.c:1714-1714"
      ],
      "snippets": [
        "ret = ip_local_out(&init_net, NULL, skb);",
        "rt = ip_route_output_key(net ?: &init_net, &fl4);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_output\" \"net/tquic/tquic_output.c\"",
      "rg -n \"route\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Route Lookup Fallback to init_net (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-251",
    "fingerprint": "conn-ip_local_out-null-pass-tquic_output_packet|net/tquic/tquic_output.c|tquic_output_packet|correctness",
    "title": "tquic_output_packet Passes NULL conn to ip_local_out",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_output_packet. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 5 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output_packet",
        "tquic_pacing_state"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1413-1413",
        "net/tquic/tquic_output.c:1662-1663",
        "net/tquic/tquic_output.c:1730-1730",
        "net/tquic/tquic_output.c:1735-1735",
        "net/tquic/tquic_output.c:1739-1739"
      ],
      "snippets": [
        "/* Actually send the packet */\n    tquic_output_packet(NULL, pacing->path, skb);",
        "ret = ip_local_out(&init_net, NULL, skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_output_packet\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Store a reference to `conn` in `tquic_pacing_state` and pass it through.",
    "tests_to_add": [
      "Add regression test for: tquic_output_packet Passes NULL conn to ip_local_out (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-252",
    "fingerprint": "corruption-creat-memory-shadow-type|net/tquic/multipath/tquic_scheduler.c|tquic_mp_sched_notify_sent|api",
    "title": "Type Shadowing Creates Memory Corruption Risk",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_mp_sched_notify_sent. Category=api, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_mp_sched_notify_sent",
        "fields",
        "tquic_scheduler",
        "tquic_path",
        "tquic_int_path"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:2158-2164"
      ],
      "snippets": [
        "{\n    void *c = conn;   // tquic_int_connection *, not tquic_connection *\n    void *p = path;   // tquic_int_path *, not tquic_path *\n    tquic_mp_sched_notify_sent(c, p, bytes);  // ABI mismatch!\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_mp_sched_notify_sent\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"type\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Type Shadowing Creates Memory Corruption Risk', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Type Shadowing Creates Memory Corruption Risk (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-253",
    "fingerprint": "access-conn-reference-tquic_diag-useafterfree|net/tquic/tquic_diag.c|tquic_net_close_connection|memory",
    "title": "UAF-P1-02: - tquic_diag.c accesses conn->sk without reference",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_diag.c :: tquic_net_close_connection. Category=memory, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_diag.c"
      ],
      "symbols": [
        "tquic_net_close_connection",
        "refcount_inc_not_zero",
        "tquic_diag"
      ],
      "line_ranges": [
        "net/tquic/tquic_diag.c:153-153",
        "net/tquic/tquic_diag.c:1019-1019"
      ],
      "snippets": [
        "sk = conn->sk;          // line 153 -- no reference taken\nif (!sk || !net_eq(sock_net(sk), net))  // sk could be freed between these two lines\n    continue;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_net_close_connection\" \"net/tquic/tquic_diag.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_diag.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P1-02: - tquic_diag.c accesses conn->sk without reference (net/tquic/tquic_diag.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-254",
    "fingerprint": "close-connect_work-forward_work-rac-tunnel-useafterfree|net/tquic/tquic_tunnel.c|cancel_work_sync|memory",
    "title": "UAF-P3-03: - Tunnel close races with connect_work and forward_work",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_tunnel.c :: cancel_work_sync. Category=memory, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "cancel_work_sync",
        "tquic_tunnel",
        "tquic_tunnel_close",
        "tquic_tunnel_put"
      ],
      "line_ranges": [
        "net/tquic/tquic_tunnel.c:469-469",
        "net/tquic/tquic_tunnel.c:429-429",
        "net/tquic/tquic_tunnel.c:440-440",
        "net/tquic/tquic_tunnel.c:451-451"
      ],
      "snippets": [
        "void tquic_tunnel_close(struct tquic_tunnel *tunnel)\n{\n    // ... sets state to CLOSING\n    // Removes from client list\n    // Shuts down TCP socket\n    tunnel->state = TQUIC_TUNNEL_CLOSED;\n    tquic_tunnel_put(tunnel);  // May free tunnel\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"cancel_work_sync\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P3-03: - Tunnel close races with connect_work and forward_work (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-255",
    "fingerprint": "access-callback-free-path-potential-timer|net/tquic/tquic_timer.c|tquic_path|memory",
    "title": "UAF-P3-04: - Path validation timer callback accesses path after potential free",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_timer.c :: tquic_path. Category=memory, severity=S1.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_path",
        "timer_setup",
        "timer_list",
        "tquic_timer_start_path_validation",
        "tquic_path_free",
        "tquic_connection",
        "del_timer_sync",
        "tquic_timer"
      ],
      "line_ranges": [
        "net/tquic/tquic_timer.c:483-483",
        "net/tquic/tquic_timer.c:1345-1345",
        "net/tquic/tquic_timer.c:1359-1361"
      ],
      "snippets": [
        "static void tquic_path_validation_expired(struct timer_list *t)\n{\n    struct tquic_path *path = from_timer(path, t, validation_timer);\n    struct tquic_connection *conn;\n\n    conn = path->conn;  // <-- path may already be freed\n    if (!conn)\n        return;\n\n    spin_lock_bh(&conn->lock);\n    // .."
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/tquic/tquic_timer.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P3-04: - Path validation timer callback accesses path after potential free (net/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-256",
    "fingerprint": "dereference-device-fre-ops-smartnic-useafterfree|net/tquic/offload/smartnic.c|tquic_nic_unregister|memory",
    "title": "UAF-P6-01: - SmartNIC ops dereference after device could be freed",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/offload/smartnic.c :: tquic_nic_unregister. Category=memory, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "tquic_nic_unregister"
      ],
      "line_ranges": [
        "net/tquic/offload/smartnic.c:253-253",
        "net/tquic/offload/smartnic.c:256-256",
        "net/tquic/offload/smartnic.c:257-257",
        "net/tquic/offload/smartnic.c:312-312"
      ],
      "snippets": [
        "// In tquic_nic_unregister:\nspin_unlock(&tquic_nic_lock);     // line 253\nif (dev->ops && dev->ops->cleanup)  // line 256 -- ok, still valid\n    dev->ops->cleanup(dev);         // line 257\n\n// But callers of tquic_nic_find get dev without refcount:\nif (!dev->ops->add_key)            // line 312 -- d"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_nic_unregister\" \"net/tquic/offload/smartnic.c\"",
      "rg -n \"useafterfree\" \"net/tquic/offload/smartnic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P6-01: - SmartNIC ops dereference after device could be freed (net/tquic/offload/smartnic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-257",
    "fingerprint": "acces-connection-ioctl-unlock|net/tquic/tquic_socket.c|socket|concurrency",
    "title": "Unlocked Connection Access in IOCTL",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "priority_score": 7.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: socket. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "socket",
        "tquic_sock",
        "tquic_connection",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:660-660",
        "net/tquic/tquic_socket.c:672-672"
      ],
      "snippets": [
        "int tquic_sock_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    struct tquic_connection *conn = tsk->conn;  // line 660: NO LOCK\n\n    switch (cmd) {\n    case TQUIC_NEW_STREAM:\n        if (!conn || conn->state != TQUIC_CONN_CONNECTED)  /"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"socket\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"unlock\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Unlocked Connection Access in IOCTL (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-258",
    "fingerprint": "access-len-lin-revis-skb-tquic_output|unknown_file|tquic_output_packet|other",
    "title": "(Revised): tquic_pacing_work Accesses skb->len After tquic_output_packet (tquic_output.c, lines 1413-1418)",
    "category": "other",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_output_packet. Category=other, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_output_packet",
        "tquic_pacing_work",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "skb = __skb_dequeue(&pacing->queue);\n        spin_unlock_bh(&pacing->lock);\n\n        /* Actually send the packet */\n        tquic_output_packet(NULL, pacing->path, skb);\n\n        spin_lock_bh(&pacing->lock);\n\n        /* Update next send time */\n        gap = tquic_pacing_calc_gap(pacing, skb->len);  /* <-- UAF */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Save `skb->len` before calling `tquic_output_packet()`.\n\n---",
    "tests_to_add": [
      "Add regression test for: (Revised): tquic_pacing_work Accesses skb->len After tquic_output_packet (tquic_output.c, lines 1413-1418)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-259",
    "fingerprint": "deriv-empty-keys-rtt-transcript|net/tquic/crypto/zero_rtt.c|unknown_symbol|security",
    "title": "0-RTT Keys Derived With Empty Transcript",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* For simplicity, we use an empty transcript here. The actual\n     * implementation should include the ClientHello hash.\n     */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rtt\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: 0-RTT Keys Derived With Empty Transcript (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-260",
    "fingerprint": "clienthello-deriv-empty-hash-keys-rtt|unknown_file|tquic_zero_rtt_derive_secret|security",
    "title": "0-RTT Keys Derived With Empty Transcript (Not ClientHello Hash)",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_zero_rtt_derive_secret. Category=security, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_zero_rtt_derive_secret",
        "tquic_zero_rtt_derive_keys"
      ],
      "line_ranges": [],
      "snippets": [
        "/* For simplicity, we use an empty transcript here. The actual\n     * implementation should include the ClientHello hash.\n     */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** The ClientHello hash must be included in the key derivation. Use `tquic_zero_rtt_derive_secret` (which does accept `client_hello_hash`) instead of `tquic_zero_rtt_derive_keys` for actual connections.\n\n---",
    "tests_to_add": [
      "Add regression test for: 0-RTT Keys Derived With Empty Transcript (Not ClientHello Hash)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-261",
    "fingerprint": "even-forc-int-optlen-setsockopt-sizeof|net/tquic/tquic_socket.c|copy_from_sockptr|api",
    "title": "`setsockopt(SOL_TQUIC, ...)` forces `optlen >= sizeof(int)` even for string/binary options",
    "category": "api",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/tquic_socket.c :: copy_from_sockptr. Category=api, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "copy_from_sockptr",
        "interface",
        "setsockopt",
        "tquic_sock_setsockopt"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"copy_from_sockptr\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"setsockopt\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Move `copy_from_sockptr(&val, ...)` inside the integer-valued cases only.",
    "tests_to_add": [
      "Add regression test for: `setsockopt(SOL_TQUIC, ...)` forces `optlen >= sizeof(int)` even for string/binary options (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-262",
    "fingerprint": "double-path-put-tquic_nl_cmd_path_remove|net/tquic/tquic_netlink.c|kfree_rcu|concurrency",
    "title": "`tquic_nl_cmd_path_remove()` Double Put on Path",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_netlink.c :: kfree_rcu. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "kfree_rcu",
        "tquic_nl_cmd_path_dump",
        "list_del_rcu",
        "tquic_nl_path_put",
        "tquic_nl_cmd_path_remove",
        "refcount_inc_not_zero",
        "tquic_nl_path_lookup",
        "tquic_netlink"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Remove path from connection */\n    spin_lock_bh(&conn->lock);\n    list_del_rcu(&path->list);\n    conn->path_count--;\n    spin_unlock_bh(&conn->lock);\n\n    /* Drop the lookup reference and the list reference */\n    tquic_nl_path_put(path);\n    tquic_nl_path_put(path);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"kfree_rcu\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"tquic_nl_cmd_path_remove\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_nl_cmd_path_remove()` Double Put on Path (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-263",
    "fingerprint": "736-ack-bytes_ack-calculation-frame-lin|unknown_file|tquic_input|other",
    "title": "ACK Frame bytes_acked Calculation Can Overflow (tquic_input.c, lines 736-738)",
    "category": "other",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "{\n        u64 bytes_acked = (first_ack_range + 1) * 1200;\n\n        /* Dispatch ACK event to congestion control */\n        tquic_cong_on_ack(ctx->path, bytes_acked, rtt_us);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Cap `first_ack_range` to a reasonable value (e.g., the maximum number of packets in flight) before the multiplication. Alternatively, cap `bytes_acked` to the actual bytes in flight.\n\n---",
    "tests_to_add": [
      "Add regression test for: ACK Frame bytes_acked Calculation Can Overflow (tquic_input.c, lines 736-738)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-264",
    "fingerprint": "aggregate-floor-minimum-scheduler-unfair-weight|net/tquic/multipath/sched_aggregate.c|unknown_symbol|concurrency",
    "title": "Aggregate Scheduler Unfair Minimum Weight Floor",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_aggregate.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_aggregate.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"aggregate\" \"net/tquic/multipath/sched_aggregate.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Aggregate Scheduler Unfair Minimum Weight Floor (net/tquic/multipath/sched_aggregate.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-265",
    "fingerprint": "bond-check-lock-machine-state-transition|net/tquic/bond/tquic_bonding.c|tquic_bonding_ctx|concurrency",
    "title": "Bonding State Machine Missing Lock on State Transition Checks",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_bonding.c :: tquic_bonding_ctx. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_ctx",
        "tquic_bonding_set_state",
        "tquic_bonding",
        "tquic_bonding_state"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_bonding_set_state(struct tquic_bonding_ctx *bc,\n                                    enum tquic_bonding_state new_state)\n{\n    enum tquic_bonding_state old_state = bc->state;\n    // ... no lock acquisition ...\n    bc->state = new_state;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bonding_ctx\" \"net/tquic/bond/tquic_bonding.c\"",
      "rg -n \"bond\" \"net/tquic/bond/tquic_bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Bonding State Machine Missing Lock on State Transition Checks (net/tquic/bond/tquic_bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-266",
    "fingerprint": "back-bpm-fall-init_net-manager-path|net/tquic/bond/tquic_bpm.c|tquic_bpm|security",
    "title": "BPM Path Manager Falls Back to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_bpm.c :: tquic_bpm. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "tquic_bpm"
      ],
      "line_ranges": [],
      "snippets": [
        "dev = dev_get_by_index_rcu(path->pm ? path->pm->net : &init_net, ifindex);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bpm\" \"net/tquic/bond/tquic_bpm.c\"",
      "rg -n \"bpm\" \"net/tquic/bond/tquic_bpm.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: BPM Path Manager Falls Back to init_net (net/tquic/bond/tquic_bpm.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-267",
    "fingerprint": "all-cpu-fix-hash-jhash-seed||tquic_nf|security",
    "title": "CPU-5: All hash tables use `jhash` with a **fixed seed of 0**.",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: tquic_nf. Category=security, severity=S1.\nEvidence union: 0 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_nf"
      ],
      "line_ranges": [
        ":848-848"
      ],
      "snippets": [
        "// tquic_nf.c:147\nreturn jhash(cid->id, cid->len, 0);\n\n// tquic_ratelimit.c:97\nreturn jhash_1word(sin->sin_addr.s_addr, 0);\n\n// security_hardening.c:73\nreturn jhash(&sin->sin_addr, sizeof(sin->sin_addr), 0);\n\n// tquic_forward.c:157\nhash = jhash(&sin->sin_addr, sizeof(sin->sin_addr), 0);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_nf\" \"\"",
      "rg -n \"cpu\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `siphash` with a per-boot random key (from `net_get_random_once`) instead of `jhash` with seed 0. This is the standard kernel approach since Linux 4.1.",
    "tests_to_add": [
      "Add regression test for: CPU-5: All hash tables use `jhash` with a **fixed seed of 0**. ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-268",
    "fingerprint": "assum-double-refcnt-tquic_nl_path_put-tquic_path_remove_and_free|net/tquic/tquic_netlink.c|tquic_path_remove_and_free|concurrency",
    "title": "Double `tquic_nl_path_put()` in `tquic_path_remove_and_free()` Assumes refcnt==2",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_netlink.c :: tquic_path_remove_and_free. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_path_remove_and_free",
        "tquic_nl_cmd_path_add",
        "tquic_nl_path_put",
        "tquic_nl_path_info",
        "tquic_nl_conn_info",
        "refcount_inc_not_zero",
        "tquic_nl_path_lookup",
        "tquic_netlink"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_path_remove_and_free(struct tquic_nl_conn_info *conn,\n                                       struct tquic_nl_path_info *path)\n{\n    spin_lock_bh(&conn->lock);\n    list_del_rcu(&path->list);\n    conn->path_count--;\n    spin_unlock_bh(&conn->lock);\n\n    /* Drop the caller's reference"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_remove_and_free\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"double\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Double `tquic_nl_path_put()` in `tquic_path_remove_and_free()` Assumes refcnt==2 (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-269",
    "fingerprint": "expensive-loss-operation-path|net/tquic/bond/tquic_bonding.c|tquic_bonding_on_loss_detected|correctness",
    "title": "Expensive Operation in Loss Path",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_bonding.c :: tquic_bonding_on_loss_detected. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_on_loss_detected",
        "tquic_bonding"
      ],
      "line_ranges": [],
      "snippets": [
        "if (time_after(jiffies, ctx->last_weight_update + msecs_to_jiffies(ctx->min_rtt_ms))) {\n    tquic_bonding_derive_weights(ctx);\n    ctx->last_weight_update = jiffies;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bonding_on_loss_detected\" \"net/tquic/bond/tquic_bonding.c\"",
      "rg -n \"expensive\" \"net/tquic/bond/tquic_bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Expensive Operation in Loss Path', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Expensive Operation in Loss Path (net/tquic/bond/tquic_bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-270",
    "fingerprint": "exce-failover-limit-memory-queue-retransmit|net/tquic/bond/tquic_failover.c|tquic_failover|correctness",
    "title": "Failover Retransmit Queue Can Exceed Memory Limits",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_failover.c :: tquic_failover. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover"
      ],
      "line_ranges": [],
      "snippets": [
        "if (requeued >= TQUIC_FAILOVER_MAX_QUEUED) {\n    pr_warn_ratelimited(...);\n    break;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_failover\" \"net/tquic/bond/tquic_failover.c\"",
      "rg -n \"failover\" \"net/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Failover Retransmit Queue Can Exceed Memory Limits', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Failover Retransmit Queue Can Exceed Memory Limits (net/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-271",
    "fingerprint": "fec-scheme-validat-wire|net/tquic/fec/fec_decoder.c|unknown_symbol|memory",
    "title": "FEC Scheme ID Not Validated From Wire",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_decoder.c :: unknown_symbol. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (scheme >= __TQUIC_FEC_SCHEME_MAX) {\n    return -EINVAL;\n}\nframe->scheme = scheme;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: FEC Scheme ID Not Validated From Wire (net/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-272",
    "fingerprint": "cache-congestion-data-global-isolation-namespace|net/tquic/cong/cong_data.c|tquic_cong_data_cache|concurrency",
    "title": "Global Congestion Data Cache Without Namespace Isolation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/cong_data.c :: tquic_cong_data_cache. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_cache",
        "cong_data_entry"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_cong_data_cache {\n    spinlock_t lock;\n    struct cong_data_entry entries[CONG_DATA_CACHE_SIZE];\n};\n/* Register in net_generic */\nstatic unsigned int cong_data_net_id;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_data_cache\" \"net/tquic/cong/cong_data.c\"",
      "rg -n \"global\" \"net/tquic/cong/cong_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Global Congestion Data Cache Without Namespace Isolation (net/tquic/cong/cong_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-273",
    "fingerprint": "check-h3_request_send_header-state-toctou|net/quic/tquic/http3/http3_request.c|h3_request_send_headers|concurrency",
    "title": "h3_request_send_headers State Check TOCTOU",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_request_send_headers. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_request_send_headers"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"h3_request_send_headers\" \"net/quic/tquic/http3/http3_request.c\"",
      "rg -n \"h3_request_send_header\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: h3_request_send_headers State Check TOCTOU (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-274",
    "fingerprint": "h3_stream_lookup_by_push_id-linear-lock-scan|net/quic/tquic/http3/http3_request.c|h3_stream|concurrency",
    "title": "h3_stream_lookup_by_push_id Linear Scan Under Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_stream. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_stream",
        "h3_stream_lookup_by_push_id"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&h3conn->lock);\nfor (node = rb_first(&h3conn->streams); node; node = rb_next(node)) {\n    h3s = rb_entry(node, struct h3_stream, node);\n    if (h3s->type == H3_STREAM_TYPE_PUSH && h3s->push_id == push_id) {\n        spin_unlock(&h3conn->lock);\n        return h3s;\n    }\n}\nspin_unlock(&h3conn"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"h3_stream\" \"net/quic/tquic/http3/http3_request.c\"",
      "rg -n \"h3_stream_lookup_by_push_id\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: h3_stream_lookup_by_push_id Linear Scan Under Lock (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-275",
    "fingerprint": "call-ktime_get-multiple-packet-per|net/tquic/napi.c|ktime_get|perf",
    "title": "HIGH: Multiple ktime_get() calls per packet",
    "category": "perf",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/napi.c :: ktime_get. Category=perf, severity=S1.\nEvidence union: 3 file(s), 4 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.c",
        "net/tquic/tquic_input.c",
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "ktime_get",
        "x86",
        "tquic_rx_ctx"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:305",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2687",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:713",
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1736"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"ktime_get\" \"net/tquic/napi.c\"",
      "rg -n \"multiple\" \"net/tquic/napi.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Read the timestamp once at the start of packet processing and pass it through the context. The `tquic_rx_ctx` struct already exists and could carry a `ktime_t recv_time` field.",
    "tests_to_add": [
      "Add regression test for: HIGH: Multiple ktime_get() calls per packet (net/tquic/napi.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-276",
    "fingerprint": "atomic-counter-hysteresi-lock-non-read_once|net/tquic/bond/tquic_failover.c|tquic_failover_timeout_work|concurrency",
    "title": "Hysteresis Counters Use Non-Atomic READ_ONCE/WRITE_ONCE Without Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_failover.c :: tquic_failover_timeout_work. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover_timeout_work",
        "tquic_failover_update_path_ack",
        "tquic_failover"
      ],
      "line_ranges": [],
      "snippets": [
        "WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1);\nWRITE_ONCE(pt->consec_successes, 0);\n// ... and in update_path_ack:\nWRITE_ONCE(pt->consec_successes, READ_ONCE(pt->consec_successes) + 1);\nWRITE_ONCE(pt->consec_failures, 0);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_failover_timeout_work\" \"net/tquic/bond/tquic_failover.c\"",
      "rg -n \"hysteresi\" \"net/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Hysteresis Counters Use Non-Atomic READ_ONCE/WRITE_ONCE Without Lock (net/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-277",
    "fingerprint": "allocation-large-recovery-stack-xor|net/tquic/fec/fec_decoder.c|attempt_xor_recovery|correctness",
    "title": "Large Stack Allocation in XOR Recovery",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_decoder.c :: attempt_xor_recovery. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "attempt_xor_recovery"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"attempt_xor_recovery\" \"net/tquic/fec/fec_decoder.c\"",
      "rg -n \"large\" \"net/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Large Stack Allocation in XOR Recovery', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Large Stack Allocation in XOR Recovery (net/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-278",
    "fingerprint": "exhaustion-header-list-memory-qpack-unbound|net/quic/tquic/http3/qpack.c|qpack_header_list_add|security",
    "title": "Memory Exhaustion via Unbounded QPACK Header Lists",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/qpack.c :: qpack_header_list_add. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack.c"
      ],
      "symbols": [
        "qpack_header_list_add"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"qpack_header_list_add\" \"net/quic/tquic/http3/qpack.c\"",
      "rg -n \"memory\" \"net/quic/tquic/http3/qpack.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Memory Exhaustion via Unbounded QPACK Header Lists (net/quic/tquic/http3/qpack.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-279",
    "fingerprint": "count-migration-path-pointer-raw-reference|net/tquic/tquic_migration.c|tquic_migration_state|memory",
    "title": "Migration State Stores Raw Path Pointers Without Reference Counting",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_migration_state. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migration_state",
        "tquic_path",
        "tquic_migration_work_handler",
        "tquic_migration_timeout",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_migration_state {\n    struct tquic_path *old_path;\n    struct tquic_path *new_path;\n    // ...\n};\n// ...\nms->old_path = conn->active_path;\nms->new_path = best_path;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_migration_state\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"migration\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Migration State Stores Raw Path Pointers Without Reference Counting (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-280",
    "fingerprint": "addres-family-tquic_path_create-validation|net/tquic/tquic_migration.c|sockaddr_in6|memory",
    "title": "Missing Address Family Validation in `tquic_path_create()`",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: sockaddr_in6. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "sockaddr_in6",
        "tquic_path_create",
        "sockaddr_in",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "memcpy(&path->local_addr, local,\n           local->ss_family == AF_INET ?\n           sizeof(struct sockaddr_in) : sizeof(struct sockaddr_in6));\n    memcpy(&path->remote_addr, remote,\n           remote->ss_family == AF_INET ?\n           sizeof(struct sockaddr_in) : sizeof(struct sockaddr_in6));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sockaddr_in6\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"addres\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Missing Address Family Validation in `tquic_path_create()` (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-281",
    "fingerprint": "encryption-frame-level-lin-multipath-process|unknown_file|tquic_input|other",
    "title": "Multipath Frame Processing Lacks Encryption Level Validation (tquic_input.c, lines 2027-2038)",
    "category": "other",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input",
        "tquic_process_mp_new_connection_id_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "#ifdef CONFIG_TQUIC_MULTIPATH\n        } else if (frame_type == 0x40) {\n            /* MP_NEW_CONNECTION_ID (RFC 9369) */\n            ret = tquic_process_mp_new_connection_id_frame(&ctx);\n        } else if (frame_type == 0x41) {\n            /* MP_RETIRE_CONNECTION_ID (RFC 9369) */\n            ret = tquic_process_mp_retire_connection_id_frame(&ctx);\n        } else if (frame_type == 0x42 || frame_type == 0x43) {\n            /* MP_ACK or MP_ACK_ECN (RFC 9369) */\n            ret = tquic_process_mp_ack_frame(&ctx);\n        } else if (tquic_is_mp_extended_frame(&ctx)) {\n            /* Extended multipath frames (PATH_ABANDON, PATH_STATUS) */\n            ret = tquic_process_mp_extended_frame(&ctx);\n#endif",
        "} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add encryption level checks for all multipath frame types. They should only be accepted in 1-RTT packets (and possibly 0-RTT):\n```c\n} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Multipath Frame Processing Lacks Encryption Level Validation (tquic_input.c, lines 2027-2038)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-282",
    "fingerprint": "call-ktime_get-multiple-packet-per|net/tquic/tquic_output.c|already|perf",
    "title": "Multiple ktime_get() calls per packet",
    "category": "perf",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: already. Category=perf, severity=S1.\nEvidence union: 3 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_input.c",
        "net/tquic/napi.c"
      ],
      "symbols": [
        "already",
        "ktime_get",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"already\" \"net/tquic/tquic_output.c\"",
      "rg -n \"multiple\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Multiple ktime_get() calls per packet', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Multiple ktime_get() calls per packet (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-283",
    "fingerprint": "ack-frame-frequency-limit-packet-per|net/quic/tquic/tquic_input.c|tquic_process_frames|security",
    "title": "No ACK Frame Frequency Limit Per Packet",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_process_frames. Category=security, severity=S1.\nEvidence union: 1 file(s), 4 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_frames",
        "tquic_process_datagram_frame",
        "tquic_process_connection_close_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1900-1914",
        "net/quic/tquic/tquic_input.c:1871-2060",
        "net/quic/tquic/tquic_input.c:1391-1391",
        "net/quic/tquic/tquic_input.c:1212-1212"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_frames\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"ack\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: No ACK Frame Frequency Limit Per Packet (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-284",
    "fingerprint": "connection-init_net-instead-manager-namespace-net|net/tquic/pm/path_manager.c|tquic_pm_discover_addresses|api",
    "title": "Path Manager Uses init_net Instead of Per-Connection Net Namespace",
    "category": "api",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/pm/path_manager.c :: tquic_pm_discover_addresses. Category=api, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [
        "tquic_pm_discover_addresses",
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "for_each_netdev(&init_net, dev) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_pm_discover_addresses\" \"net/tquic/pm/path_manager.c\"",
      "rg -n \"path\" \"net/tquic/pm/path_manager.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Path Manager Uses init_net Instead of Per-Connection Net Namespace', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Path Manager Uses init_net Instead of Per-Connection Net Namespace (net/tquic/pm/path_manager.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-285",
    "fingerprint": "access-lock-path-state-timeout-unlock|net/tquic/pm/path_validation.c|tquic_path_handle_response|concurrency",
    "title": "Path Validation Timeout Accesses Path State Without Lock After Unlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/pm/path_validation.c :: tquic_path_handle_response. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "tquic_path_handle_response"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Retry validation */\npath->validation.retries++;\nspin_unlock_bh(&conn->paths_lock);\n\n/* Resend PATH_CHALLENGE */\nif (tquic_path_send_challenge(conn, path) == 0) {\n    u32 timeout_us = tquic_validation_timeout_us(path);\n    // ... accesses path->stats after lock release"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_handle_response\" \"net/tquic/pm/path_validation.c\"",
      "rg -n \"path\" \"net/tquic/pm/path_validation.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Path Validation Timeout Accesses Path State Without Lock After Unlock (net/tquic/pm/path_validation.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-286",
    "fingerprint": "count-increment-insert-known_received_count-overflow-qpack_encoder|net/quic/tquic/http3/qpack_encoder.c|qpack_encoder|correctness",
    "title": "qpack_encoder known_received_count Overflow via Insert Count Increment",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/qpack_encoder.c :: qpack_encoder. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_encoder.c"
      ],
      "symbols": [
        "qpack_encoder"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Insert Count Increment: 00xxxxxx */\nret = qpack_decode_integer(data + offset, len - offset,\n                           6, &value, &consumed);\n...\nenc->known_received_count += value;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"qpack_encoder\" \"net/quic/tquic/http3/qpack_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'qpack_encoder known_received_count Overflow via Insert Count Increment', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: qpack_encoder known_received_count Overflow via Insert Count Increment (net/quic/tquic/http3/qpack_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-287",
    "fingerprint": "field-frame-repair-truncation-validation|net/tquic/fec/fec_decoder.c|tquic_fec_decode_repair_frame|correctness",
    "title": "Repair Frame Field Truncation Without Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_decoder.c :: tquic_fec_decode_repair_frame. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "tquic_fec_decode_repair_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "frame->repair_length = (u16)value;",
        "if (value > U16_MAX) {\n    return -EOVERFLOW;\n}\nframe->repair_length = (u16)value;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_fec_decode_repair_frame\" \"net/tquic/fec/fec_decoder.c\"",
      "rg -n \"repair\" \"net/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Repair Frame Field Truncation Without Validation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Repair Frame Field Truncation Without Validation (net/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-288",
    "fingerprint": "encoder-same-stack|net/tquic/fec/fec_encoder.c|generate_rs_repair|perf",
    "title": "Same Stack Issue in Encoder",
    "category": "perf",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_encoder.c :: generate_rs_repair. Category=perf, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c"
      ],
      "symbols": [
        "generate_rs_repair",
        "generate_xor_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"generate_rs_repair\" \"net/tquic/fec/fec_encoder.c\"",
      "rg -n \"same\" \"net/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Same Stack Issue in Encoder', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Same Stack Issue in Encoder (net/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-289",
    "fingerprint": "num_path-rr_select-sch-scheduler-toctou|net/tquic/sched/scheduler.c|unknown_symbol|concurrency",
    "title": "sched/scheduler.c rr_select TOCTOU on num_paths",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/scheduler.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "target = atomic_inc_return(&data->counter) % conn->num_paths;\n// num_paths could be 0 -> div by zero"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sch\" \"net/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: sched/scheduler.c rr_select TOCTOU on num_paths (net/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-290",
    "fingerprint": "sch-scheduler-stale-total_weight-wrr_select|net/tquic/sched/scheduler.c|unknown_symbol|correctness",
    "title": "sched/scheduler.c wrr_select Stale total_weight",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/scheduler.c :: unknown_symbol. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sch\" \"net/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'sched/scheduler.c wrr_select Stale total_weight', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: sched/scheduler.c wrr_select Stale total_weight (net/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-291",
    "fingerprint": "path-pointer-rcu_read_unlock-return-stale|unknown_file|tquic_path_remove|concurrency",
    "title": "Stale Path Pointer Returned After rcu_read_unlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_path_remove. Category=concurrency, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_path_remove",
        "rcu_read_lock",
        "synchronize_rcu",
        "tquic_path_remo"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Stale Path Pointer Returned After rcu_read_unlock",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-292",
    "fingerprint": "back-fall-init_net-reset-stateles|net/tquic/tquic_stateless_reset.c|tquic_stateless_reset|security",
    "title": "Stateless Reset Falls Back to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_stateless_reset.c :: tquic_stateless_reset. Category=security, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset"
      ],
      "line_ranges": [],
      "snippets": [
        "net = sk ? sock_net(sk) : &init_net;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stateless_reset\" \"net/tquic/tquic_stateless_reset.c\"",
      "rg -n \"stateles\" \"net/tquic/tquic_stateless_reset.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Stateless Reset Falls Back to init_net (net/tquic/tquic_stateless_reset.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-293",
    "fingerprint": "count-path-robin-round-selection-toctou|net/tquic/multipath/sched_minrtt.c|unknown_symbol|concurrency",
    "title": "TOCTOU in Round-Robin Path Count vs Selection",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_minrtt.c :: unknown_symbol. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_minrtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"toctou\" \"net/tquic/multipath/sched_minrtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: TOCTOU in Round-Robin Path Count vs Selection (net/tquic/multipath/sched_minrtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-294",
    "fingerprint": "bond-race-state-toctou-transition|net/tquic/bond/tquic_bonding.c|tquic_bonding_update_state|concurrency",
    "title": "TOCTOU Race in Bonding State Transition",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_bonding.c :: tquic_bonding_update_state. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_update_state",
        "tquic_bonding"
      ],
      "line_ranges": [],
      "snippets": [
        "u32 gen = ctx->state_generation;\nspin_unlock_bh(&ctx->lock);\ntquic_bond_reorder_flush(ctx); /* may sleep */\nspin_lock_bh(&ctx->lock);\nif (ctx->state_generation != gen) {\n    /* State changed while lock was dropped, re-evaluate */\n    goto retry;\n}\nctx->state_generation++;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bonding_update_state\" \"net/tquic/bond/tquic_bonding.c\"",
      "rg -n \"toctou\" \"net/tquic/bond/tquic_bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: TOCTOU Race in Bonding State Transition (net/tquic/bond/tquic_bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-295",
    "fingerprint": "mismatch-tquic_max_path|net/tquic/multipath/tquic_scheduler.c|tquic_sched|correctness",
    "title": "TQUIC_MAX_PATHS Mismatch",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_sched. Category=correctness, severity=S1.\nEvidence union: 2 file(s), 4 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c",
        "net/tquic/multipath/tquic_sched.h"
      ],
      "symbols": [
        "tquic_sched",
        "tquic_scheduler"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:40-40",
        "net/tquic/multipath/tquic_scheduler.c:46-46",
        "net/tquic/multipath/tquic_scheduler.c:222-222",
        "net/tquic/multipath/tquic_scheduler.c:1243-1243"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_sched\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"tquic_max_path\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'TQUIC_MAX_PATHS Mismatch', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: TQUIC_MAX_PATHS Mismatch (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-296",
    "fingerprint": "1413-conn-ip_local_out-line-null-pass|unknown_file|tquic_output_packet|other",
    "title": "tquic_output_packet Passes NULL conn to ip_local_out (tquic_output.c, line 1413)",
    "category": "other",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_output_packet. Category=other, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_output_packet",
        "tquic_output",
        "tquic_pacing_state"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Actually send the packet */\n    tquic_output_packet(NULL, pacing->path, skb);",
        "ret = ip_local_out(&init_net, NULL, skb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Store a reference to `conn` in `tquic_pacing_state` and pass it through.",
    "tests_to_add": [
      "Add regression test for: tquic_output_packet Passes NULL conn to ip_local_out (tquic_output.c, line 1413)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-297",
    "fingerprint": "sendmsg-toctou-tquic_stream_check_flow_control|net/quic/tquic/tquic_stream.c|tquic_stream_check_flow_control|concurrency",
    "title": "tquic_stream_check_flow_control TOCTOU with sendmsg",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_check_flow_control. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_check_flow_control",
        "tquic_stream"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:690-690",
        "net/quic/tquic/tquic_stream.c:980-994"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_check_flow_control\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_check_flow_control TOCTOU with sendmsg (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-298",
    "fingerprint": "allocation-gfp_atomic-large-tquic_stream_ext|net/quic/tquic/core/stream.c|tquic_stream_ext|concurrency",
    "title": "tquic_stream_ext Uses GFP_ATOMIC for Large Allocation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_ext. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_ext"
      ],
      "line_ranges": [],
      "snippets": [
        "ext = kmem_cache_zalloc(mgr->stream_cache, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_ext\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_ext Uses GFP_ATOMIC for Large Allocation (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-299",
    "fingerprint": "authenticat-packet-process-reset-stateles-tquic_udp_recv|net/tquic/tquic_input.c|tquic_udp_recv|correctness",
    "title": "tquic_udp_recv Processes Stateless Reset Before Authenticating Packet",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_udp_recv. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_udp_recv"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2916-2932"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_udp_recv\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Only check for stateless reset AFTER regular decryption fails (RFC 9000 Section 10.3.1 recommends this order). The check should be a last resort, not a first check.",
    "tests_to_add": [
      "Add regression test for: tquic_udp_recv Processes Stateless Reset Before Authenticating Packet (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-300",
    "fingerprint": "authenticat-lin-packet-process-reset-stateles|unknown_file|tquic_udp_recv|other",
    "title": "tquic_udp_recv Processes Stateless Reset Before Authenticating Packet (tquic_input.c, lines 2916-2932)",
    "category": "other",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_udp_recv. Category=other, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_udp_recv",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Check for stateless reset (received from peer) */\n    if (len < TQUIC_STATELESS_RESET_MIN_LEN)\n        goto not_reset;\n\n    if (data[0] & TQUIC_HEADER_FORM_LONG)\n        goto not_reset;\n\n    /* Try to find connection for reset check */\n    if (len > 1) {\n        u8 dcid_len = min_t(size_t, len - 1, TQUIC_MAX_CID_LEN);\n        conn = tquic_lookup_by_dcid(data + 1, dcid_len);\n    }\n\n    if (conn && tquic_is_stateless_reset_internal(conn, data, len)) {\n        tquic_handle_stateless_reset(conn);\n        kfree_skb(skb);\n        return 0;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Only check for stateless reset AFTER regular decryption fails (RFC 9000 Section 10.3.1 recommends this order). The check should be a last resort, not a first check.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_udp_recv Processes Stateless Reset Before Authenticating Packet (tquic_input.c, lines 2916-2932)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-301",
    "fingerprint": "congestion-conn-control-dereference-lock-useafterfree|net/tquic/cong/tquic_cong.c|sock_net|memory",
    "title": "UAF-P1-03: - conn->sk dereference in congestion control without locking",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/tquic_cong.c :: sock_net. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "sock_net",
        "tquic_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "if (path && path->conn && path->conn->sk)\n    net = sock_net(path->conn->sk);  // UAF: sk can be freed between check and use"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sock_net\" \"net/tquic/cong/tquic_cong.c\"",
      "rg -n \"useafterfree\" \"net/tquic/cong/tquic_cong.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P1-03: - conn->sk dereference in congestion control without locking (net/tquic/cong/tquic_cong.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-302",
    "fingerprint": "atomic_t-instead-refcount_t-tquic_zc_entry-useafterfree|net/tquic/tquic_zerocopy.c|refcount_set|memory",
    "title": "UAF-P4-01: - tquic_zc_entry uses atomic_t instead of refcount_t",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: refcount_set. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "refcount_set",
        "refcount_inc",
        "tquic_zc_entry",
        "refcount_dec_and_test",
        "tquic_zerocopy"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_zc_entry {\n    // ...\n    atomic_t refcnt;   // <-- Should be refcount_t\n};\n\nstatic void tquic_zc_entry_put(struct tquic_zc_entry *entry)\n{\n    if (atomic_dec_and_test(&entry->refcnt))  // No UAF protection\n        tquic_zc_entry_free(entry);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"refcount_set\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P4-01: - tquic_zc_entry uses atomic_t instead of refcount_t (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-303",
    "fingerprint": "count-entirely-path-reference-useafterfree|net/tquic/tquic_migration.c|tquic_path|memory",
    "title": "UAF-P4-02: - Paths lack reference counting entirely",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_free",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_path_free(struct tquic_path *path)\n{\n    // ... cleanup\n    kfree(path);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P4-02: - Paths lack reference counting entirely (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-304",
    "fingerprint": "first-length-model-number-packet-readable|net/tquic/test/packet_test.c|concurrency|concurrency",
    "title": "Unit tests model packet-number length as readable from the first byte without HP removal",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) A.\nPrimary locus: net/tquic/test/packet_test.c :: concurrency. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/test/packet_test.c"
      ],
      "symbols": [
        "plan",
        "concurrency",
        "skbs",
        "tquic_process_packet",
        "tquic_udp_recv"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "A"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"concurrency\" \"net/tquic/test/packet_test.c\"",
      "rg -n \"unit\" \"net/tquic/test/packet_test.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "- Add tests that build a packet with header protection applied, run HP unprotect, and then validate pn_len and key_phase.",
    "tests_to_add": [
      "`/Users/justinadams/Downloads/tquic-kernel/net/tquic/test/packet_test.c` asserts `(header & 0x03) + 1` as \u201cpacket number length\u201d directly.",
      "This test model will not catch the P0 HP/pn_len bug; it encodes the same incorrect assumption.",
      "Add tests that build a packet with header protection applied, run HP unprotect, and then validate pn_len and key_phase."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-305",
    "fingerprint": "array-global-loss-tracker-unprotect|net/tquic/cong/tquic_cong.c|tquic_loss_tracker|concurrency",
    "title": "Unprotected Global Loss Tracker Array",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/tquic_cong.c :: tquic_loss_tracker. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "tquic_loss_tracker",
        "tquic_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Per-connection loss tracker */\nstruct tquic_loss_tracker *tracker = &conn->path[path_id].loss_tracker;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_loss_tracker\" \"net/tquic/cong/tquic_cong.c\"",
      "rg -n \"unprotect\" \"net/tquic/cong/tquic_cong.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Unprotected Global Loss Tracker Array (net/tquic/cong/tquic_cong.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-306",
    "fingerprint": "addr_len-memcpy-pass-tquic_connect-unvalidat|net/tquic/tquic_socket.c|tquic_connect|memory",
    "title": "Unvalidated `addr_len` Passed to `memcpy` in `tquic_connect()`",
    "category": "memory",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_connect. Category=memory, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_connect",
        "sockaddr_in",
        "sockaddr_storage",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "if (addr_len < sizeof(struct sockaddr_in))\n        return -EINVAL;\n\n    lock_sock(sk);\n    memcpy(&tsk->connect_addr, addr,\n           min_t(size_t, addr_len, sizeof(struct sockaddr_storage)));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_connect\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"unvalidat\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Unvalidated `addr_len` Passed to `memcpy` in `tquic_connect()` (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-307",
    "fingerprint": "accumulation-check-overflow-weight|net/tquic/bond/bonding.c|tquic_select_weighted|correctness",
    "title": "Weight Accumulation Without Overflow Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/bonding.c :: tquic_select_weighted. Category=correctness, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "tquic_select_weighted",
        "get_random_u32"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 total_weight = 0;\nfor_each_path(path) {\n    total_weight += path->weight;\n    if (total_weight > U32_MAX) {\n        /* Normalize weights by shifting all down */\n        ...\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_select_weighted\" \"net/tquic/bond/bonding.c\"",
      "rg -n \"weight\" \"net/tquic/bond/bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Weight Accumulation Without Overflow Check', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Weight Accumulation Without Overflow Check (net/tquic/bond/bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-308",
    "fingerprint": "has-lock-protection-scheduler-weight|net/tquic/multipath/sched_weighted.c|weighted_get_path|concurrency",
    "title": "Weighted Scheduler Has No Lock Protection",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "medium",
    "priority_score": 4.9,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_weighted.c :: weighted_get_path. Category=concurrency, severity=S1.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [
        "weighted_get_path"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"weighted_get_path\" \"net/tquic/multipath/sched_weighted.c\"",
      "rg -n \"weight\" \"net/tquic/multipath/sched_weighted.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Weighted Scheduler Has No Lock Protection (net/tquic/multipath/sched_weighted.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-309",
    "fingerprint": "allow-bloom-false-filter-negativ-replay|net/tquic/crypto/zero_rtt.c|detected|security",
    "title": "Bloom Filter False Negatives Allow Replay",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: detected. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "detected",
        "tickets"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"detected\" \"net/tquic/crypto/zero_rtt.c\"",
      "rg -n \"bloom\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** This is an inherent limitation of bloom filters. Document this as a known limitation. Consider augmenting with a small exact-match cache for recent tickets (last N tickets stored exactly) to eliminate the rotation window for the most common case.",
    "tests_to_add": [
      "Add regression test for: Bloom Filter False Negatives Allow Replay (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-310",
    "fingerprint": "calculation-decoy-packet-size-underflow|net/tquic/security/quic_exfil.c|alloc_skb|security",
    "title": "Decoy Packet Size Calculation Can Underflow",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: alloc_skb. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "alloc_skb",
        "arithmetic",
        "attempt",
        "tquic_traffic_shaper_set_mtu"
      ],
      "line_ranges": [],
      "snippets": [
        "decoy_size = 64 + (rand_val % (shaper->mtu - 64 + 1));",
        "if (mtu < 64) mtu = 64;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security.",
      "Severity disagreement across reports: S2, S3."
    ],
    "verification_commands": [
      "rg -n \"alloc_skb\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"decoy\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Add minimum MTU validation in `tquic_traffic_shaper_set_mtu()`:\n```c\nif (mtu < 64) mtu = 64;\n``` / Add minimum MTU validation in `tquic_traffic_shaper_set_mtu()`:\n```c\nif (mtu < 64) mtu = 64;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: Decoy Packet Size Calculation Can Underflow (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-311",
    "fingerprint": "eku-increment-lock-outside-request|net/tquic/crypto/extended_key_update.c|tquic_eku_request|concurrency",
    "title": "EKU Request ID Increment Outside Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/extended_key_update.c :: tquic_eku_request. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "tquic_eku_request"
      ],
      "line_ranges": [
        "net/tquic/crypto/extended_key_update.c:440-440",
        "net/tquic/crypto/extended_key_update.c:451-451"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_eku_request\" \"net/tquic/crypto/extended_key_update.c\"",
      "rg -n \"eku\" \"net/tquic/crypto/extended_key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Keep the lock held through request allocation and insertion, or use an atomic increment for the request ID.",
    "tests_to_add": [
      "Add regression test for: EKU Request ID Increment Outside Lock (net/tquic/crypto/extended_key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-312",
    "fingerprint": "key-keys-old-rotation-swap-zeroization|net/tquic/crypto/header_protection.c|memzero_explicit|security",
    "title": "HP Key Rotation Swaps Old Keys Without Zeroization",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/header_protection.c :: memzero_explicit. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "memzero_explicit",
        "sensitive"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Rotate read key */\ntmp = ctx->read_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->read_keys[TQUIC_HP_LEVEL_APPLICATION] = ctx->next_read_key;\nctx->next_read_key = tmp;    /* Old key is now \"next\" -- not zeroized */\n\n/* Rotate write key */\ntmp = ctx->write_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->write_keys",
        "/* Rotate read key */\ntmp = ctx->read_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->read_keys[TQUIC_HP_LEVEL_APPLICATION] = ctx->next_read_key;\nctx->next_read_key = tmp;    /* Old key is now \"next\" -- not zeroized */\n\n/* Rotate write key */\ntmp = ctx->write_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->write_keys[TQUIC_HP_LEVEL_APPLICATION] = ctx->next_write_key;\nctx->next_write_key = tmp;   /* Old key is now \"next\" -- not zeroized */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security.",
      "Severity disagreement across reports: S2, S3."
    ],
    "verification_commands": [
      "rg -n \"memzero_explicit\" \"net/tquic/crypto/header_protection.c\"",
      "rg -n \"key\" \"net/tquic/crypto/header_protection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Ensure `memzero_explicit()` is called on the mask buffer in all return paths, including error paths. / ** After the swap, zeroize the key bytes in the now-\"next\" slots (which\nhold old keys) using `memzero_explicit()` on the key material fields. The\n`tfm` pointer should be freed separately if the old cipher context is no longer\nneeded.\n\n---",
    "tests_to_add": [
      "Add regression test for: HP Key Rotation Swaps Old Keys Without Zeroization (net/tquic/crypto/header_protection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-313",
    "fingerprint": "connection-count-entry-http-push|net/tquic/http3/http3_conn.c|client|security",
    "title": "HTTP/3 Connection: O(n) Push Entry Counting",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_conn.c :: client. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_conn.c"
      ],
      "symbols": [
        "client"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"client\" \"net/tquic/http3/http3_conn.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_conn.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Maintain a running counter of push entries instead of counting on demand.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Connection: O(n) Push Entry Counting (net/tquic/http3/http3_conn.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-314",
    "fingerprint": "16mb-frame-http-maximum-pars-payload|net/tquic/http3/http3_frame.c|frames|security",
    "title": "HTTP/3 Frame Parsing: 16MB Maximum Frame Payload",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_frame.c :: frames. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_frame.c"
      ],
      "symbols": [
        "frames"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, perf, security."
    ],
    "verification_commands": [
      "rg -n \"frames\" \"net/tquic/http3/http3_frame.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider reducing the default limit to 1MB or making it configurable. Most HTTP/3 frames (HEADERS, SETTINGS, GOAWAY) should be much smaller.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Frame Parsing: 16MB Maximum Frame Payload (net/tquic/http3/http3_frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-315",
    "fingerprint": "count-http-parser-setting-toctou|net/tquic/http3/http3_frame.c|processing|concurrency",
    "title": "HTTP/3 Settings Parser: TOCTOU on Settings Count",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_frame.c :: processing. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_frame.c"
      ],
      "symbols": [
        "processing"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"processing\" \"net/tquic/http3/http3_frame.c\"",
      "rg -n \"http\" \"net/tquic/http3/http3_frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Ensure the input buffer is exclusively owned during parsing, or perform length validation inline during the single-pass parse.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Settings Parser: TOCTOU on Settings Count (net/tquic/http3/http3_frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-316",
    "fingerprint": "bound-check-parse-pointer-signature-tbs|net/tquic/crypto/cert_verify.c|buffer|memory",
    "title": "Missing Bounds Check on tbs Pointer in Signature Parse",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: buffer. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "buffer",
        "parse_signature",
        "parse_tbs_certificate",
        "tquic_x509_cert_parse"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"buffer\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"bound\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate that `cert->tbs + cert->tbs_len <= data + total_len` before computing `remaining`.",
    "tests_to_add": [
      "Add regression test for: Missing Bounds Check on tbs Pointer in Signature Parse (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-317",
    "fingerprint": "connection-lifetime-metric-path-race-subscription|net/tquic/diag/path_metrics.c|del_timer_sync|memory",
    "title": "Path Metrics Subscription: Timer/Connection Lifetime Race",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/path_metrics.c :: del_timer_sync. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [
        "del_timer_sync",
        "tquic_metrics_unsubscribe_conn"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"del_timer_sync\" \"net/tquic/diag/path_metrics.c\"",
      "rg -n \"path\" \"net/tquic/diag/path_metrics.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `del_timer_sync()` in `tquic_metrics_unsubscribe_conn()` to ensure the timer callback has completed before freeing the connection, or hold a connection reference in the subscription.",
    "tests_to_add": [
      "Add regression test for: Path Metrics Subscription: Timer/Connection Lifetime Race (net/tquic/diag/path_metrics.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-318",
    "fingerprint": "computation-migration-overflow-path-score-selection|net/tquic/tquic_migration.c|bandwidth|memory",
    "title": "Path Score Computation Can Overflow in Migration Target Selection",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_migration.c :: bandwidth. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "bandwidth",
        "min",
        "u64",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 score = 1000000;\nscore = score * 1000 / stats->rtt_smoothed;\nscore = (score * stats->bandwidth) >> 20;\nscore = score * (100 - min(loss_pct, 90ULL)) / 100;\nscore = score * (256 - path->priority) / 256;\nscore = score * path->weight;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, other."
    ],
    "verification_commands": [
      "rg -n \"bandwidth\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"path\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Reorder operations to divide before multiplying, or cap intermediate values.",
    "tests_to_add": [
      "Add regression test for: Path Score Computation Can Overflow in Migration Target Selection (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-319",
    "fingerprint": "call-crypto_alloc_shash-generation-per-reset-stateles|net/tquic/tquic_stateless_reset.c|tquic_stateless_reset_generate_token|security",
    "title": "Per-Call crypto_alloc_shash in Stateless Reset Token Generation",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_stateless_reset.c :: tquic_stateless_reset_generate_token. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_generate_token",
        "tquic_stateless_reset"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_stateless_reset_generate_token\" \"net/tquic/tquic_stateless_reset.c\"",
      "rg -n \"per\" \"net/tquic/tquic_stateless_reset.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pre-allocate a per-CPU or global HMAC transform and reuse it.",
    "tests_to_add": [
      "Add regression test for: Per-Call crypto_alloc_shash in Stateless Reset Token Generation (net/tquic/tquic_stateless_reset.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-320",
    "fingerprint": "call-encrypt-every-key-qat-sets|net/tquic/crypto/hw_offload.c|crypto_aead_setkey|security",
    "title": "QAT Encrypt Sets Key on Every Call",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/hw_offload.c :: crypto_aead_setkey. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [
        "crypto_aead_setkey",
        "tquic_qat_encrypt"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: perf, security."
    ],
    "verification_commands": [
      "rg -n \"crypto_aead_setkey\" \"net/tquic/crypto/hw_offload.c\"",
      "rg -n \"qat\" \"net/tquic/crypto/hw_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Set the key once during context initialization and only re-set on key update.",
    "tests_to_add": [
      "Add regression test for: QAT Encrypt Sets Key on Every Call (net/tquic/crypto/hw_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-321",
    "fingerprint": "buffer-free-lock-qlog-ring-truly|net/tquic/diag/qlog.c|buffer|concurrency",
    "title": "Qlog Ring Buffer: Not Truly Lock-Free",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/qlog.c :: buffer. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [
        "buffer"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"buffer\" \"net/tquic/diag/qlog.c\"",
      "rg -n \"qlog\" \"net/tquic/diag/qlog.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either implement a true lock-free ring buffer (using `smp_store_release`/`smp_load_acquire` pairs) or document the locking requirement clearly.",
    "tests_to_add": [
      "Add regression test for: Qlog Ring Buffer: Not Truly Lock-Free (net/tquic/diag/qlog.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-322",
    "fingerprint": "escap-json-qlog-string|net/tquic/diag/qlog.c|values|api",
    "title": "Qlog: JSON Strings Not Escaped",
    "category": "api",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/qlog.c :: values. Category=api, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [
        "json",
        "values"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: api, other."
    ],
    "verification_commands": [
      "rg -n \"values\" \"net/tquic/diag/qlog.c\"",
      "rg -n \"qlog\" \"net/tquic/diag/qlog.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement JSON string escaping for all string values emitted in qlog JSON output.",
    "tests_to_add": [
      "Add regression test for: Qlog: JSON Strings Not Escaped (net/tquic/diag/qlog.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-323",
    "fingerprint": "decoder-encoder-excessive-qpack-stack-usage|net/tquic/http3/qpack_encoder.c|qpack_encoder_insert_literal|memory",
    "title": "QPACK Encoder/Decoder: Excessive Stack Usage",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack_encoder.c :: qpack_encoder_insert_literal. Category=memory, severity=S2.\nEvidence union: 2 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_encoder.c",
        "net/tquic/http3/qpack_encoder.c`, `qpack_decoder.c"
      ],
      "symbols": [
        "chain",
        "qpack_encoder_insert_literal",
        "qpack_encoder_insert_name_ref",
        "qpack_decoder",
        "qpack_encoder"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, other."
    ],
    "verification_commands": [
      "rg -n \"qpack_encoder_insert_literal\" \"net/tquic/http3/qpack_encoder.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Allocate these buffers dynamically with `kmalloc(GFP_ATOMIC)` or use a pre-allocated per-connection buffer.",
    "tests_to_add": [
      "Add regression test for: QPACK Encoder/Decoder: Excessive Stack Usage (net/tquic/http3/qpack_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-324",
    "fingerprint": "256-complexity-decoder-huffman-qpack|net/tquic/http3/qpack.c|decoder|security",
    "title": "QPACK Huffman Decoder: O(n*256) Complexity",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack.c :: decoder. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack.c"
      ],
      "symbols": [
        "decoder"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"decoder\" \"net/tquic/http3/qpack.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Replace with a 256-entry lookup table or state-machine-based decoder (standard approach for HPACK/QPACK Huffman).",
    "tests_to_add": [
      "Add regression test for: QPACK Huffman Decoder: O(n*256) Complexity (net/tquic/http3/qpack.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-325",
    "fingerprint": "decode-integer-overflow-qpack-shift|net/tquic/http3/qpack.c|behavior|memory",
    "title": "QPACK Integer Decode: Shift Overflow",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/qpack.c :: behavior. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/qpack.c"
      ],
      "symbols": [
        "behavior"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, other."
    ],
    "verification_commands": [
      "rg -n \"behavior\" \"net/tquic/http3/qpack.c\"",
      "rg -n \"qpack\" \"net/tquic/http3/qpack.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a check: `if (shift > 62) return -H3_ERR_QPACK_DECOMPRESSION_FAILED;`",
    "tests_to_add": [
      "Add regression test for: QPACK Integer Decode: Shift Overflow (net/tquic/http3/qpack.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-326",
    "fingerprint": "character-digit-pars-time-validate|net/tquic/crypto/cert_verify.c|isdigit|security",
    "title": "Time Parsing Does Not Validate Digit Characters",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: isdigit. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "isdigit",
        "parse_time",
        "subtraction"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"isdigit\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"time\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `isdigit()` checks for all time component characters before conversion.",
    "tests_to_add": [
      "Add regression test for: Time Parsing Does Not Validate Digit Characters (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-327",
    "fingerprint": "buffer-free-transcript-zeroiz|net/tquic/crypto/handshake.c|kfree_sensitive|security",
    "title": "Transcript Buffer Not Zeroized Before Free",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: kfree_sensitive. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "kfree",
        "kfree_sensitive",
        "memzero_explicit",
        "tquic_hs_cleanup"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"kfree_sensitive\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"transcript\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `kfree_sensitive()` or call `memzero_explicit()` on the transcript buffer before freeing.",
    "tests_to_add": [
      "Add regression test for: Transcript Buffer Not Zeroized Before Free (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-328",
    "fingerprint": "allocation-port-tunnel-underflow-unsign|net/tquic/tquic_tunnel.c|correctly|correctness",
    "title": "Tunnel Port Allocation Unsigned Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_tunnel.c :: correctly. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "none",
        "correctly",
        "ntohs"
      ],
      "line_ranges": [],
      "snippets": [
        "bit = ntohs(port) - ntohs(client->port_range_start);\nif (bit >= TQUIC_PORTS_PER_CLIENT)\n    return;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security.",
      "Severity disagreement across reports: S2, S3."
    ],
    "verification_commands": [
      "rg -n \"correctly\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"tunnel\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text.",
    "tests_to_add": [
      "Add regression test for: Tunnel Port Allocation Unsigned Underflow (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-329",
    "fingerprint": "datagram-push-queue-toctou-webtransport|net/tquic/http3/webtransport.c|unknown_symbol|concurrency",
    "title": "WebTransport: TOCTOU in Datagram Queue Push",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/webtransport.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"webtransport\" \"net/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Perform the size check and push atomically under a lock, or use an atomic counter with compare-and-swap.",
    "tests_to_add": [
      "Add regression test for: WebTransport: TOCTOU in Datagram Queue Push (net/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-330",
    "fingerprint": "additional_addr_add-between-check-duplicate-has-insert|net/tquic/core/additional_addresses.c|additional_addr_add|concurrency",
    "title": "`additional_addr_add()` Has TOCTOU Between Duplicate Check and Insert",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/additional_addresses.c :: additional_addr_add. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/additional_addresses.c"
      ],
      "symbols": [
        "additional_addr_add",
        "kzalloc"
      ],
      "line_ranges": [
        "net/tquic/core/additional_addresses.c:188-188",
        "net/tquic/core/additional_addresses.c:191-191"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"additional_addr_add\" \"net/tquic/core/additional_addresses.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Keep the lock held across the check-and-insert operation, or use a two-phase approach with lock re-check after allocation.",
    "tests_to_add": [
      "Add regression test for: `additional_addr_add()` Has TOCTOU Between Duplicate Check and Insert (net/tquic/core/additional_addresses.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-331",
    "fingerprint": "bbrv3-division-potential-ratio-zero|net/quic/tquic/cong/bbrv3.c|unknown_symbol|correctness",
    "title": "`bbrv3.c` CE Ratio Potential Division by Zero",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/cong/bbrv3.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/cong/bbrv3.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ce_ratio = (ce_count * 100) / (bbr->ecn_ect_count + ce_count);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"bbrv3\" \"net/quic/tquic/cong/bbrv3.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check denominator and use u64 for multiplication.\n\n---",
    "tests_to_add": [
      "Add regression test for: `bbrv3.c` CE Ratio Potential Division by Zero (net/quic/tquic/cong/bbrv3.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-332",
    "fingerprint": "bound-buffer-check-hs_varint_encode-output|net/tquic/crypto/handshake.c|unknown_symbol|memory",
    "title": "`hs_varint_encode` -- no bounds check on output buffer",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int hs_varint_encode(u64 val, u8 *buf, u32 *len)\n{\n    if (val < 0x40) {\n        buf[0] = val;\n        *len = 1;\n    } else if (val < 0x4000) {\n        buf[0] = 0x40 | (val >> 8);\n        buf[1] = val & 0xff;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"hs_varint_encode\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a `u32 buf_len` parameter or document the 8-byte minimum requirement.\n\n---",
    "tests_to_add": [
      "Add regression test for: `hs_varint_encode` -- no bounds check on output buffer (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-333",
    "fingerprint": "bound-count-frame-http3_frame-parser-setting|net/quic/tquic/http3/http3_frame.c|unknown_symbol|correctness",
    "title": "`http3_frame.c` Settings Frame Parser: No Bounds on `count`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_frame.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (p->buf < end && count < max_entries) {\n    ...\n    entries_buf[count].id = id;\n    entries_buf[count].value = value;\n    count++;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"http3_frame\" \"net/quic/tquic/http3/http3_frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`http3_frame.c` Settings Frame Parser: No Bounds on `count`', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `http3_frame.c` Settings Frame Parser: No Bounds on `count` (net/quic/tquic/http3/http3_frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-334",
    "fingerprint": "collision-kmem_cache_create-manager-name-per-stream|net/tquic/core/stream.c|kmem_cache_create|correctness",
    "title": "`kmem_cache_create()` Per Stream Manager Risks Name Collision",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/stream.c :: kmem_cache_create. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [
        "kmem_cache_create",
        "tquic_stream_ext"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"kmem_cache_create\" \"net/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a global slab cache shared across all stream managers, or include a unique identifier in the cache name.",
    "tests_to_add": [
      "Add regression test for: `kmem_cache_create()` Per Stream Manager Risks Name Collision (net/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-335",
    "fingerprint": "loop-ring_index-unbound-while|net/tquic/core/receive_timestamps.c|ring_index|security",
    "title": "`ring_index()` Uses Unbounded While Loop",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/receive_timestamps.c :: ring_index. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/receive_timestamps.c"
      ],
      "symbols": [
        "ring_index"
      ],
      "line_ranges": [],
      "snippets": [
        "static inline u32 ring_index(u32 head, s32 offset, u32 size)\n{\n    s32 idx = (s32)head + offset;\n    while (idx < 0)\n        idx += size;\n    return (u32)(idx % size);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"ring_index\" \"net/tquic/core/receive_timestamps.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a guard: `if (size == 0) return 0;` and use modular arithmetic: `return ((idx % (s32)size) + size) % size;`",
    "tests_to_add": [
      "Add regression test for: `ring_index()` Uses Unbounded While Loop (net/tquic/core/receive_timestamps.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-336",
    "fingerprint": "hold-improperly-sk_lock-slock-tquic_accept|net/tquic/tquic_socket.c|lock_sock|concurrency",
    "title": "`tquic_accept()` Holding `sk_lock.slock` Improperly",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: lock_sock. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "lock_sock",
        "tquic_accept",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"lock_sock\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"tquic_accept\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Access the accept queue under `lock_sock()` alone without the additional spinlock.",
    "tests_to_add": [
      "Add regression test for: `tquic_accept()` Holding `sk_lock.slock` Improperly (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-337",
    "fingerprint": "byte-calculation-ecn-overflow-tquic_cong|net/quic/tquic/cong/tquic_cong.c|tquic_cong|correctness",
    "title": "`tquic_cong.c` ECN Byte Calculation Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/cong/tquic_cong.c :: tquic_cong. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "tquic_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 ecn_bytes = ecn_ce_count * 1200;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong\" \"net/quic/tquic/cong/tquic_cong.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Clamp `ecn_ce_count` to a realistic maximum before multiplication.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_cong.c` ECN Byte Calculation Overflow (net/quic/tquic/cong/tquic_cong.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-338",
    "fingerprint": "between-check-race-tquic_fc_conn_data_sent-update|net/tquic/core/flow_control.c|tquic_fc_conn_data_sent|concurrency",
    "title": "`tquic_fc_conn_data_sent()` Race Between Check and Update",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/flow_control.c :: tquic_fc_conn_data_sent. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/flow_control.c"
      ],
      "symbols": [
        "tquic_fc_conn_data_sent",
        "tquic_fc_conn_try_send",
        "tquic_fc_conn_can_send"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"tquic_fc_conn_data_sent\" \"net/tquic/core/flow_control.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Provide a combined `tquic_fc_conn_try_send()` that atomically checks and commits.",
    "tests_to_add": [
      "Add regression test for: `tquic_fc_conn_data_sent()` Race Between Check and Update (net/tquic/core/flow_control.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-339",
    "fingerprint": "call-check-error-memzero_explicit-tquic_hs_derive_early_secret|net/tquic/crypto/handshake.c|tquic_hs_derive_early_secrets|security",
    "title": "`tquic_hs_derive_early_secrets` -- `memzero_explicit` called before error check",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_derive_early_secrets. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_derive_early_secrets",
        "tquic_hs_derive_secret"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_hs_derive_secret(hs, hs->early_secret,\n                                     \"ext binder\", NULL, 0,\n                                     binder_key, hash_len);\n        memzero_explicit(binder_key, sizeof(binder_key));\n        if (ret)\n            return ret;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_derive_early_secrets\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_derive_early_secret\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Move `memzero_explicit` after the binder key is no longer needed,\nor into an error/cleanup path.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_derive_early_secrets` -- `memzero_explicit` called before error check (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-340",
    "fingerprint": "buffer-crypto-hkdf_label-path-sensitive-stack|net/tquic/crypto/handshake.c|tquic_hs_generate_client_hello|security",
    "title": "`tquic_hs_generate_client_hello` -- `hkdf_label` stack buffer on sensitive crypto path",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_generate_client_hello. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_generate_client_hello",
        "tquic_hs_hkdf_expand_label"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_generate_client_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `memzero_explicit(hkdf_label, sizeof(hkdf_label));` before return.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_generate_client_hello` -- `hkdf_label` stack buffer on sensitive crypto path (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-341",
    "fingerprint": "200-buffer-content-hash-large-overflow|net/tquic/crypto/handshake.c|tquic_hs_process_certificate_verify|memory",
    "title": "`tquic_hs_process_certificate_verify` -- `content[200]` stack buffer could overflow with large hash",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_certificate_verify. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_certificate_verify"
      ],
      "line_ranges": [],
      "snippets": [
        "u8 content[200];\n    u8 *cp = content;\n    // ...\n    memset(cp, 0x20, 64);   // 64 bytes\n    cp += 64;\n    memcpy(cp, \"TLS 1.3, server CertificateVerify\", 33);  // 33 bytes\n    cp += 33;\n    *cp++ = 0x00;            // 1 byte = 98 total\n    memcpy(cp, transcript_hash, hash_len);  // hash_len up to ",
        "u8 content[200];\n    u8 *cp = content;\n    // ...\n    memset(cp, 0x20, 64);   // 64 bytes\n    cp += 64;\n    memcpy(cp, \"TLS 1.3, server CertificateVerify\", 33);  // 33 bytes\n    cp += 33;\n    *cp++ = 0x00;            // 1 byte = 98 total\n    memcpy(cp, transcript_hash, hash_len);  // hash_len up to 48\n    cp += hash_len;          // max = 98 + 48 = 146 bytes"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_certificate_verify\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Compute the required size dynamically: `content_size = 64 + 33 + 1 + hash_len`\nand validate it fits, or allocate dynamically.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_certificate_verify` -- `content[200]` stack buffer could overflow with large hash (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-342",
    "fingerprint": "allocation-certificate-tquic_hs_process_certificate-unbound|net/tquic/crypto/handshake.c|tquic_hs_process_certificate|memory",
    "title": "`tquic_hs_process_certificate` -- unbounded certificate allocation",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_certificate. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_certificate"
      ],
      "line_ranges": [],
      "snippets": [
        "if (!hs->peer_cert && cert_len > 0) {\n        hs->peer_cert = kmalloc(cert_len, GFP_KERNEL);\n        if (!hs->peer_cert)\n            return -ENOMEM;\n        memcpy(hs->peer_cert, p, cert_len);\n        hs->peer_cert_len = cert_len;\n    }",
        "if (cert_len > TLS_CERT_MAX_LEN)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_certificate\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "**\n```c\nif (cert_len > TLS_CERT_MAX_LEN)\n    return -EINVAL;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_certificate` -- unbounded certificate allocation (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-343",
    "fingerprint": "body-const-function-inside-static-tquic_hs_process_server_hello|net/tquic/crypto/handshake.c|tquic_hs_process_server_hello|concurrency",
    "title": "`tquic_hs_process_server_hello` -- `static const` inside function body",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_server_hello. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_server_hello"
      ],
      "line_ranges": [],
      "snippets": [
        "static const u8 hrr_random[32] = {\n        0xcf, 0x21, 0xad, 0x74, ...\n    };"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_server_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Move to file scope alongside the other static const arrays (like\n`tls12_downgrade_sentinel`).",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_server_hello` -- `static const` inside function body (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-344",
    "fingerprint": "drop-lock-pattern-reacquire-tquic_migrate_validate_all_additional|net/tquic/tquic_migration.c|tquic_migrate_validate_all_additional|concurrency",
    "title": "`tquic_migrate_validate_all_additional()` Lock Drop/Reacquire Pattern",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_migrate_validate_all_additional. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migrate_validate_all_additional",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&remote_addrs->lock);\n    list_for_each_entry(entry, &remote_addrs->addresses, list) {\n        if (entry->validated || !entry->active)\n            continue;\n\n        spin_unlock_bh(&remote_addrs->lock);\n\n        /* Create probe path */\n        probe_path = tquic_path_create(conn, &local",
        "spin_lock_bh(&remote_addrs->lock);\n    list_for_each_entry(entry, &remote_addrs->addresses, list) {\n        if (entry->validated || !entry->active)\n            continue;\n\n        spin_unlock_bh(&remote_addrs->lock);\n\n        /* Create probe path */\n        probe_path = tquic_path_create(conn, &local_addr, &entry->addr);\n        /* ... */\n\n        spin_lock_bh(&remote_addrs->lock);\n    }\n    spin_unlock_bh(&remote_addrs->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_migrate_validate_all_additional\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_migrate_validate_all_additional()` Lock Drop/Reacquire Pattern (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-345",
    "fingerprint": "cast-ctx-incorrect-tquic_nl_cmd_path_dump|net/tquic/tquic_netlink.c|tquic_dump_ctx|correctness",
    "title": "`tquic_nl_cmd_path_dump()` Incorrect Cast of `cb->ctx`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: tquic_dump_ctx. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_dump_ctx",
        "tquic_nl_cmd_path_dump",
        "grows",
        "tquic_netlink"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_dump_ctx *ctx = (struct tquic_dump_ctx *)cb->ctx;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_dump_ctx\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"tquic_nl_cmd_path_dump\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_nl_cmd_path_dump()` Incorrect Cast of `cb->ctx`', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_nl_cmd_path_dump()` Incorrect Cast of `cb->ctx` (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-346",
    "fingerprint": "calculation-integer-overflow-score-tquic_path_compute_score|net/tquic/tquic_migration.c|tquic_path_compute_score|correctness",
    "title": "`tquic_path_compute_score()` Integer Overflow in Score Calculation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path_compute_score. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_compute_score",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 score = 1000000;\n\n    if (stats->rtt_smoothed > 0)\n        score = score * 1000 / stats->rtt_smoothed;\n\n    if (stats->bandwidth > 0)\n        score = (score * stats->bandwidth) >> 20;\n\n    /* ... */\n    score = score * path->weight;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_compute_score\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_path_compute_score()` Integer Overflow in Score Calculation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_path_compute_score()` Integer Overflow in Score Calculation (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-347",
    "fingerprint": "division-possible-tquic_path_is_degrad-zero|net/tquic/tquic_migration.c|tquic_path_is_degraded|correctness",
    "title": "`tquic_path_is_degraded()` Division by Zero Possible",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path_is_degraded. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_is_degraded",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "if (stats->tx_packets > 100) {\n        loss_rate = (stats->lost_packets * 100) / stats->tx_packets;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_is_degraded\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"tquic_path_is_degrad\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_path_is_degraded()` Division by Zero Possible', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_path_is_degraded()` Division by Zero Possible (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-348",
    "fingerprint": "buffer-cid-formatt-hex-overflow-tquic_proc|net/quic/tquic/tquic_proc.c|tquic_proc|memory",
    "title": "`tquic_proc.c` Buffer Overflow in Hex CID Formatting",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_proc.c :: tquic_proc. Category=memory, severity=S2.\nEvidence union: 1 file(s), 3 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_proc.c"
      ],
      "symbols": [
        "tquic_proc",
        "tquic_debug"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_proc.c:414-414",
        "net/quic/tquic/tquic_proc.c:604-604",
        "net/quic/tquic/tquic_proc.c:207-207"
      ],
      "snippets": [
        "for (i = 0; i < scid_len; i++)\n    sprintf(&scid_hex[i * 2], \"%02x\", conn->scid.id[i]);\nscid_hex[scid_len * 2] = '\\0';",
        "snprintf(scid_hex + i * 2, 3, \"%02x\", entry->scid[i]);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_proc\" \"net/quic/tquic/tquic_proc.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `tquic_proc.c` Buffer Overflow in Hex CID Formatting (net/quic/tquic/tquic_proc.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-349",
    "fingerprint": "check-consistency-final-size-tquic_process_stream_frame|net/tquic/tquic_input.c|tquic_process_stream_frame|correctness",
    "title": "`tquic_process_stream_frame()` Does Not Check Final Size Consistency",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_input.c :: tquic_process_stream_frame. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_stream_frame",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "if (fin)\n    stream->fin_received = true;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_stream_frame\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** When FIN is received, record `stream->final_size = offset + length`. On subsequent data, verify `offset + length <= stream->final_size` and that any new FIN matches the recorded value.",
    "tests_to_add": [
      "Add regression test for: `tquic_process_stream_frame()` Does Not Check Final Size Consistency (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-350",
    "fingerprint": "allocat-buffer-controll-kernel-len-siz|net/tquic/tquic_socket.c|tquic_sendmsg_datagram|correctness",
    "title": "`tquic_sendmsg_datagram()` Allocates Kernel Buffer Sized by User-Controlled `len`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_sendmsg_datagram. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sendmsg_datagram",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "if (len > conn->datagram.max_send_size)\n        return -EMSGSIZE;\n\n    buf = kmalloc(len, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_sendmsg_datagram\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_sendmsg_datagram()` Allocates Kernel Buffer Sized by User-Controlled `len`', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_sendmsg_datagram()` Allocates Kernel Buffer Sized by User-Controlled `len` (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-351",
    "fingerprint": "accept-but-int-option-optlen-read|net/tquic/tquic_socket.c|definition|api",
    "title": "`tquic_sock_setsockopt()` Reads `int` for Some Options But Accepts `optlen >= sizeof(int)` Without Capping",
    "category": "api",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: definition. Category=api, severity=S2.\nEvidence union: 1 file(s), 5 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "definition",
        "tquic_sock_setsockopt",
        "tquic_socket",
        "tquic_sock"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:840-840",
        "net/tquic/tquic_socket.c:899-899",
        "net/tquic/tquic_socket.c:942-942",
        "net/tquic/tquic_socket.c:1185-1185",
        "net/tquic/tquic_socket.c:942-956"
      ],
      "snippets": [
        "if (optlen < sizeof(int))\n        return -EINVAL;\n\n    if (copy_from_sockptr(&val, optval, sizeof(val)))\n        return -EFAULT;",
        "if (optlen < 1 || optlen > 64)\n        return -EINVAL;\n    if (copy_from_sockptr(identity, optval, optlen))\n        return -EFAULT;\n    lock_sock(sk);\n    memcpy(tsk->psk_identity, identity, optlen);\n    tsk->psk_identity_len = optlen;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: api, other."
    ],
    "verification_commands": [
      "rg -n \"definition\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"tquic_sock_setsockopt\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_sock_setsockopt()` Reads `int` for Some Options But Accepts `optlen >= sizeof(int)` Without Capping', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_sock_setsockopt()` Reads `int` for Some Options But Accepts `optlen >= sizeof(int)` Without Capping (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-352",
    "fingerprint": "check-count-memcpy-overflow-sizeof-transport_param|net/quic/tquic/core/transport_params.c|unknown_symbol|memory",
    "title": "`transport_params.c` Memcpy with `count * sizeof(u32)` Without Overflow Check",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/transport_params.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/transport_params.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/transport_params.c:2513-2513"
      ],
      "snippets": [
        "memcpy(params->version_info->available_versions, available,\n       count * sizeof(u32));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"transport_param\" \"net/quic/tquic/core/transport_params.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `transport_params.c` Memcpy with `count * sizeof(u32)` Without Overflow Check (net/quic/tquic/core/transport_params.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-353",
    "fingerprint": "ack-against-count-frame-loop-range|net/tquic/core/frame.c|unknown_symbol|correctness",
    "title": "ACK Frame Range Count Uses u64 Loop Variable Against size_t max_ranges",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/frame.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/frame.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/frame.c:370-370"
      ],
      "snippets": [
        "if (frame->ack.ack_range_count > max_ranges)\n    return -EOVERFLOW;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S2, S3."
    ],
    "verification_commands": [
      "rg -n \"ack\" \"net/tquic/core/frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'ACK Frame Range Count Uses u64 Loop Variable Against size_t max_ranges', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: ACK Frame Range Count Uses u64 Loop Variable Against size_t max_ranges (net/tquic/core/frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-354",
    "fingerprint": "all-anti-bucket-cleanup-hash-iterat|net/tquic/core/early_data.c|unknown_symbol|concurrency",
    "title": "Anti-Replay Hash Table Cleanup Iterates All Buckets Under spinlock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/early_data.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/early_data.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"anti\" \"net/tquic/core/early_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a separate periodic cleanup timer rather than inline cleanup, or maintain a time-ordered list for efficient expiration.",
    "tests_to_add": [
      "Add regression test for: Anti-Replay Hash Table Cleanup Iterates All Buckets Under spinlock (net/tquic/core/early_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-355",
    "fingerprint": "atomic_inc-dec-dequeue-enqueue-every-rx_queue_len|net/tquic/napi.c|needed|concurrency",
    "title": "atomic_inc/dec for rx_queue_len on every enqueue/dequeue",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/napi.c :: needed. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.c",
        "net/tquic/napi.c:464,689"
      ],
      "symbols": [
        "count",
        "needed",
        "skb_queue_len",
        "skb_queue_splice_init"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:464,689"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"needed\" \"net/tquic/napi.c\"",
      "rg -n \"atomic_inc\" \"net/tquic/napi.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Remove `rx_queue_len` atomic. Use `skb_queue_len(&tn->rx_queue)` when the length is needed (it reads `qlen` from the queue head, which is maintained by `__skb_queue_tail`/`__skb_dequeue` already under the queue's lock).",
    "tests_to_add": [
      "Add regression test for: atomic_inc/dec for rx_queue_len on every enqueue/dequeue (net/tquic/napi.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-356",
    "fingerprint": "benchmark-buffer-handler-input-stack-user|net/quic/tquic/bench/benchmark.c|unknown_symbol|correctness",
    "title": "Benchmark write() Handler - Stack Buffer for User Input",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/bench/benchmark.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bench/benchmark.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "char cmd[64];\n...\nif (count >= sizeof(cmd))\n    return -EINVAL;\n\nif (copy_from_user(cmd, buf, count))\n    return -EFAULT;\n\ncmd[count] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"benchmark\" \"net/quic/tquic/bench/benchmark.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Benchmark write() Handler - Stack Buffer for User Input', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Benchmark write() Handler - Stack Buffer for User Input (net/quic/tquic/bench/benchmark.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-357",
    "fingerprint": "bloom-filter-never-rotat-seed|net/tquic/crypto/zero_rtt.c|unknown_symbol|security",
    "title": "Bloom Filter Seeds Never Rotated",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/*\n * Seeds are NOT rotated after initialization because rotating seeds\n * invalidates all existing bloom filter entries...\n */\nstatic u32 replay_hash_seed1 __read_mostly;\nstatic u32 replay_hash_seed2 __read_mostly;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"bloom\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use 64-bit seeds (siphash instead of jhash) and rotate seeds during bucket rotation, hashing any remaining entries into the new bucket with new seeds.\n\n---",
    "tests_to_add": [
      "Add regression test for: Bloom Filter Seeds Never Rotated (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-358",
    "fingerprint": "bpm-connection-guard-lifetime-manager-path|net/tquic/bond/tquic_bpm.c|delayed_work|correctness",
    "title": "BPM Path Manager Uses Workqueue Without Connection Lifetime Guard",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/bond/tquic_bpm.c :: delayed_work. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "delayed_work",
        "cancel_delayed_work_sync",
        "work_struct",
        "tquic_connection",
        "tquic_bpm"
      ],
      "line_ranges": [],
      "snippets": [
        "struct work_struct discover_work;\nstruct work_struct failover_work;\nstruct delayed_work probe_work;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"delayed_work\" \"net/tquic/bond/tquic_bpm.c\"",
      "rg -n \"bpm\" \"net/tquic/bond/tquic_bpm.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a `struct tquic_connection *conn` reference with proper refcounting, and verify all work items are cancelled during teardown.",
    "tests_to_add": [
      "Add regression test for: BPM Path Manager Uses Workqueue Without Connection Lifetime Guard (net/tquic/bond/tquic_bpm.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-359",
    "fingerprint": "cert_verify-count-integer-kmalloc-overflow|net/quic/tquic/crypto/cert_verify.c|unknown_symbol|correctness",
    "title": "cert_verify.c - kmalloc(count + 1) Integer Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/crypto/cert_verify.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (count > TQUIC_MAX_CERT_SIZE)\n    return -EINVAL;\n\nkbuf = kmalloc(count + 1, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"cert_verify\" \"net/quic/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'cert_verify.c - kmalloc(count + 1) Integer Overflow', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: cert_verify.c - kmalloc(count + 1) Integer Overflow (net/quic/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-360",
    "fingerprint": "cert_verify-code-error-parse_san_extension-propagat|net/quic/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "cert_verify.c parse_san_extension -- error code not propagated",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    {\n        u32 j;\n        for (j = 0; j < name_count; j++)\n            kfree(names[j]);\n        kfree(names);\n        for (j = 0; j < addr_count; j++)\n            kfree(ips[j]);\n    }\n    kfree(ips);\n    kfree(ip_lengths);\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"cert_verify\" \"net/quic/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: cert_verify.c parse_san_extension -- error code not propagated (net/quic/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-361",
    "fingerprint": "certificate-chain-issuer-linkage-pars-subject|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Certificate Chain Parsing Does Not Verify Issuer-Subject Linkage Before Trust Check",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2319-2319"
      ],
      "snippets": [
        "/* Check if this certificate is a trust anchor */\n    ret = find_trust_anchor(ctx, cert);\n    if (ret == 0) {\n        /* Found trust anchor, chain is valid */\n        return 0;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"certificate\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Certificate Chain Parsing Does Not Verify Issuer-Subject Linkage Before Trust Check (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-362",
    "fingerprint": "cid-failure-insert-number-rhashtable-rollback|net/tquic/core/connection.c|unknown_symbol|concurrency",
    "title": "CID Sequence Number Rollback on rhashtable Insert Failure",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:502-502"
      ],
      "snippets": [
        "cs->next_local_cid_seq--;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"cid\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Perform the sequence number increment inside the spinlock, or use atomic operations.\n\n---",
    "tests_to_add": [
      "Add regression test for: CID Sequence Number Rollback on rhashtable Insert Failure (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-363",
    "fingerprint": "conn-every-frame-stream-streams_lock-tree|net/tquic/tquic_input.c|spin_lock_bh|concurrency",
    "title": "conn->streams_lock for RB-tree walk on every STREAM frame",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_input.c :: spin_lock_bh. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c",
        "net/tquic/tquic_input.c:917-934"
      ],
      "symbols": [
        "spin_lock_bh",
        "spin_unlock_bh",
        "rb_node",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:917-934"
      ],
      "snippets": [
        "spin_lock_bh(&ctx->conn->streams_lock);\n{\n    struct rb_node *node = ctx->conn->streams.rb_node;\n    while (node) { ... }\n}\nspin_unlock_bh(&ctx->conn->streams_lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"spin_lock_bh\" \"net/tquic/tquic_input.c\"",
      "rg -n \"conn\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider RCU-protected RB-tree for read-side lookups, or use a lockless hash table for the common case of looking up an already-existing stream.",
    "tests_to_add": [
      "Add regression test for: conn->streams_lock for RB-tree walk on every STREAM frame (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-364",
    "fingerprint": "allocation-attacker-buffer-connect_ip-data-datagram|net/quic/tquic/masque/connect_ip.c|unknown_symbol|concurrency",
    "title": "connect_ip.c Datagram Buffer Allocation from Attacker Data",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/masque/connect_ip.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_ip.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "datagram_len = context_id_size + skb->len;\n\nif (datagram_len > conn->datagram.max_send_size)\n    return -EMSGSIZE;\n\ndatagram_buf = kmalloc(datagram_len, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"connect_ip\" \"net/quic/tquic/masque/connect_ip.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: connect_ip.c Datagram Buffer Allocation from Attacker Data (net/quic/tquic/masque/connect_ip.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-365",
    "fingerprint": "buffer-connect_udp-encod-exce-url|net/quic/tquic/masque/connect_udp.c|unknown_symbol|correctness",
    "title": "connect_udp.c URL Encoding Can Exceed Buffer",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/masque/connect_udp.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "snprintf(p, remaining, \"%%%02X\", (u8)*src);\n...\nwritten = snprintf(p, remaining, \"/%u/\", port);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"connect_udp\" \"net/quic/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'connect_udp.c URL Encoding Can Exceed Buffer', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: connect_udp.c URL Encoding Can Exceed Buffer (net/quic/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-366",
    "fingerprint": "check-connection-state-tquic_conn_handle_close|net/tquic/core/connection.c|tquic_connection|correctness",
    "title": "Connection State Not Checked in tquic_conn_handle_close",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_connection. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_connection",
        "tquic_conn_handle_close"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_conn_handle_close(struct tquic_connection *conn,\n                            u64 error_code, u64 frame_type,\n                            const char *reason, bool is_app)\n{\n    ...\n    /* Enter draining state */\n    tquic_conn_enter_draining(conn);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_connection\" \"net/tquic/core/connection.c\"",
      "rg -n \"connection\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check `conn->state` and early-return for DRAINING/CLOSED states.",
    "tests_to_add": [
      "Add regression test for: Connection State Not Checked in tquic_conn_handle_close (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-367",
    "fingerprint": "congestion-control-coupl-division-zero|net/quic/tquic/bond/cong_coupled.c|unknown_symbol|concurrency",
    "title": "Coupled Congestion Control Division by Zero",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/bond/cong_coupled.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bond/cong_coupled.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/bond/cong_coupled.c:897-897",
        "net/quic/tquic/bond/cong_coupled.c:949-949"
      ],
      "snippets": [
        "spin_lock_bh(&ctx->lock);\n// ... ctx->total_cwnd checked != 0 at line 897 ...\nincrease = div64_u64(ctx->alpha * acked_bytes * mss,\n                     ctx->total_cwnd * COUPLED_ALPHA_SCALE);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"coupl\" \"net/quic/tquic/bond/cong_coupled.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Coupled Congestion Control Division by Zero (net/quic/tquic/bond/cong_coupled.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-368",
    "fingerprint": "all-decoy-easily-fingerprint-padd-traffic|net/tquic/security/quic_exfil.c|quic_exfil|security",
    "title": "Decoy Traffic Uses Easily Fingerprinted All-Zero Padding",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: quic_exfil. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "quic_exfil"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"quic_exfil\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"decoy\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Fill decoy packets with cryptographically random data, or better yet, use the same encryption layer as real packets so decoy traffic is indistinguishable at the wire level.\n\n---",
    "tests_to_add": [
      "Add regression test for: Decoy Traffic Uses Easily Fingerprinted All-Zero Padding (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-369",
    "fingerprint": "diag-init_net-initialize-tracepoint|net/tquic/diag/tracepoints.c|unknown_symbol|security",
    "title": "Diag/Tracepoints Initialize in init_net",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/diag/tracepoints.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/tracepoints.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_path_metrics_init(&init_net);\n// ...\ntquic_path_metrics_exit(&init_net);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"diag\" \"net/tquic/diag/tracepoints.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Diag/Tracepoints Initialize in init_net (net/tquic/diag/tracepoints.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-370",
    "fingerprint": "atomic-error-ring-spinlock-unnecessarily|net/quic/tquic/tquic_proc.c|tquic_proc|concurrency",
    "title": "Error Ring Uses Atomics Under Spinlock Unnecessarily",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_proc.c :: tquic_proc. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_proc.c"
      ],
      "symbols": [
        "tquic_proc"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_proc.c:572-589"
      ],
      "snippets": [
        "spin_lock(&ring->lock);\nidx = atomic_read(&ring->head) & (TQUIC_ERROR_RING_SIZE - 1);\natomic_inc(&ring->head);\n\nif (atomic_read(&ring->count) < TQUIC_ERROR_RING_SIZE)\n    atomic_set(&ring->count, ...);\n// ...\nspin_unlock(&ring->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_proc\" \"net/quic/tquic/tquic_proc.c\"",
      "rg -n \"error\" \"net/quic/tquic/tquic_proc.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Error Ring Uses Atomics Under Spinlock Unnecessarily (net/quic/tquic/tquic_proc.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-371",
    "fingerprint": "context-destroy-exfil-lock-reinitializ-set_level|net/tquic/security/quic_exfil.c|tquic_exfil_ctx_set_level|memory",
    "title": "Exfil Context set_level Destroys and Reinitializes Without Lock",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: tquic_exfil_ctx_set_level. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_exfil_ctx_set_level",
        "tquic_exfil_ctx",
        "tquic_exfil_process_outgoing"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_exfil_ctx_set_level(struct tquic_exfil_ctx *ctx,\n                               enum tquic_exfil_protection_level level)\n{\n    ...\n    /* Reinitialize shaper and spin with new level */\n    tquic_traffic_shaper_destroy(&ctx->shaper);\n    tquic_traffic_shaper_init(&ctx->shaper, level);\n\n    tquic_spin_randomizer_destroy(&ctx->spin_rand);\n    tquic_spin_randomizer_init(&ctx->spin_rand, level);\n\n    tquic_packet_jitter_destroy(&ctx->jitter);\n    tquic_packet_jitter_init(&ctx->jitter, level);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_exfil_ctx_set_level\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"exfil\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Acquire `ctx->lock` around the destroy/init sequence, or use RCU to swap in a new configuration atomically.",
    "tests_to_add": [
      "Add regression test for: Exfil Context set_level Destroys and Reinitializes Without Lock (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-372",
    "fingerprint": "allocat-encoder-fec-gfp_atomic-per-symbol|net/tquic/fec/fec_encoder.c|unknown_symbol|memory",
    "title": "FEC encoder allocates per-symbol in GFP_ATOMIC",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/fec/fec_encoder.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c",
        "net/tquic/fec/fec_encoder.c:111-115"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/fec/fec_encoder.c:111-115"
      ],
      "snippets": [
        "symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC);\n...\nsymbol->data = kmalloc(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"fec\" \"net/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use slab caches for symbol structs and data buffers. Pre-allocate symbol arrays per block.",
    "tests_to_add": [
      "Add regression test for: FEC encoder allocates per-symbol in GFP_ATOMIC (net/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-373",
    "fingerprint": "double-encoder-fec-lock-nest|net/tquic/fec/fec_encoder.c|list_add_tail|concurrency",
    "title": "FEC encoder double lock nesting",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/fec/fec_encoder.c :: list_add_tail. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c",
        "net/tquic/fec/fec_encoder.c:275-283"
      ],
      "symbols": [
        "list_add_tail",
        "safe",
        "spin_lock_bh",
        "spin_unlock_bh"
      ],
      "line_ranges": [
        "net/tquic/fec/fec_encoder.c:275-283"
      ],
      "snippets": [
        "spin_lock_bh(&enc->lock);\n...\n    spin_lock(&block->lock);\n    list_add_tail(&symbol->list, &block->source_symbols);\n    ...\n    spin_unlock(&block->lock);\n...\nspin_unlock_bh(&enc->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"list_add_tail\" \"net/tquic/fec/fec_encoder.c\"",
      "rg -n \"fec\" \"net/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Remove `block->lock` when the block is only accessed under `enc->lock`, or redesign to avoid nesting.",
    "tests_to_add": [
      "Add regression test for: FEC encoder double lock nesting (net/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-374",
    "fingerprint": "encoder-fec-lock-nest-triple|net/quic/tquic/fec/fec_encoder.c|unknown_symbol|concurrency",
    "title": "FEC Encoder Triple-Nested Locking",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_encoder.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/fec_encoder.c:576-576"
      ],
      "snippets": [
        "spin_lock_bh(&enc->lock);           // Outer lock\n    spin_lock(&block->lock);         // Inner lock (nested)\n    // ... operations ...\n    spin_unlock(&block->lock);\nspin_unlock_bh(&enc->lock);",
        "spin_lock(&block->lock);   // Line 576 -- no enc->lock held!"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"fec\" \"net/quic/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: FEC Encoder Triple-Nested Locking (net/quic/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-375",
    "fingerprint": "approximation-bias-distribution-gaussian-produc-random|net/tquic/security/quic_exfil.c|gaussian_random|correctness",
    "title": "Gaussian Random Approximation Produces Biased Distribution",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: gaussian_random. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "gaussian_random",
        "timing",
        "quic_exfil"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"gaussian_random\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"gaussian\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** If Gaussian jitter is required, use a proper implementation. For kernel context where floating-point is unavailable, consider using the Ziggurat method with integer arithmetic, or use a larger sum of uniform random variables for better CLT approximation (sum of 12 uniform randoms is a common choice).",
    "tests_to_add": [
      "Add regression test for: Gaussian Random Approximation Produces Biased Distribution (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-376",
    "fingerprint": "buffer-frame_hdr-h3_stream_recv_data-partial-read|net/quic/tquic/http3/http3_request.c|h3_stream_recv_data|correctness",
    "title": "h3_stream_recv_data frame_hdr Buffer Partial Read",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_stream_recv_data. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_stream_recv_data",
        "tquic_stream_recv",
        "h3_parse_frame_header"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_stream_recv(h3s->base, frame_hdr, sizeof(frame_hdr));\nif (ret <= 0)\n    return ret ? ret : -EAGAIN;\nhdr_len = h3_parse_frame_header(frame_hdr, ret, &frame_type, &payload_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"h3_stream_recv_data\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate that `ret >= 2` (minimum varint frame header) before calling the parser, or zero-initialize `frame_hdr`.\n\n---",
    "tests_to_add": [
      "Add regression test for: h3_stream_recv_data frame_hdr Buffer Partial Read (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-377",
    "fingerprint": "against-h3_max_frame_payload_size-h3_stream_recv_header-payload_len-validate|net/quic/tquic/http3/http3_request.c|h3_stream_recv_headers|correctness",
    "title": "h3_stream_recv_headers Does Not Validate payload_len Against H3_MAX_FRAME_PAYLOAD_SIZE",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_stream_recv_headers. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_stream_recv_headers"
      ],
      "line_ranges": [],
      "snippets": [
        "if (payload_len > len)\n    return -ENOBUFS;\nret = tquic_stream_recv(h3s->base, buf, payload_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"h3_stream_recv_headers\" \"net/quic/tquic/http3/http3_request.c\"",
      "rg -n \"h3_stream_recv_header\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add: `if (payload_len > H3_MAX_FRAME_PAYLOAD_SIZE) return -EMSGSIZE;`\n\n---",
    "tests_to_add": [
      "Add regression test for: h3_stream_recv_headers Does Not Validate payload_len Against H3_MAX_FRAME_PAYLOAD_SIZE (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-378",
    "fingerprint": "byte-cid-hardcod-header-short-unprotect|net/tquic/core/quic_crypto.c|quic_crypto|security",
    "title": "Hardcoded 8-Byte CID in Short Header Unprotect",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/quic_crypto.c :: quic_crypto. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/quic_crypto.c"
      ],
      "symbols": [
        "quic_crypto"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Short header - DCID starts at byte 1 */\n*pn_offset = 1 + 8;  /* Assume 8-byte connection ID */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"quic_crypto\" \"net/tquic/core/quic_crypto.c\"",
      "rg -n \"hardcod\" \"net/tquic/core/quic_crypto.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pass the known local CID length to the unprotection function. The\nreceiver knows the length of its own CIDs.\n\n---",
    "tests_to_add": [
      "Add regression test for: Hardcoded 8-Byte CID in Short Header Unprotect (net/tquic/core/quic_crypto.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-379",
    "fingerprint": "allocat-hmac-per-token-tquic_stateless_reset_generate_token-transform|net/tquic/tquic_stateless_reset.c|get_random_bytes|concurrency",
    "title": "HMAC Transform Allocated Per-Token in `tquic_stateless_reset_generate_token()`",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_stateless_reset.c :: get_random_bytes. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "get_random_bytes",
        "tquic_stateless_reset_generate_token",
        "tquic_cid_issue",
        "tquic_stateless_reset"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"get_random_bytes\" \"net/tquic/tquic_stateless_reset.c\"",
      "rg -n \"hmac\" \"net/tquic/tquic_stateless_reset.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: HMAC Transform Allocated Per-Token in `tquic_stateless_reset_generate_token()` (net/tquic/tquic_stateless_reset.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-380",
    "fingerprint": "allow-hostname-leftmost-match-non-position|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Hostname Wildcard Matching Allows Wildcards in Non-Leftmost Position",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (pattern_len >= 2 && pattern[0] == '*' && pattern[1] == '.') {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"hostname\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Hostname Wildcard Matching Allows Wildcards in Non-Leftmost Position (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-381",
    "fingerprint": "field-http3_priority-priority-snprintf-truncation|net/quic/tquic/http3/http3_priority.c|unknown_symbol|correctness",
    "title": "http3_priority.c snprintf Priority Field Truncation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_priority.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "written = snprintf(buf, buf_len, \"u=%u\", priority->urgency);\n...\nint added = snprintf(buf + written, buf_len - written, \", i\");"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"http3_priority\" \"net/quic/tquic/http3/http3_priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'http3_priority.c snprintf Priority Field Truncation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: http3_priority.c snprintf Priority Field Truncation (net/quic/tquic/http3/http3_priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-382",
    "fingerprint": "framework-interop-pattern-same|net/quic/tquic/test/interop/interop_framework.c|unknown_symbol|tests",
    "title": "Interop Framework - Same Pattern",
    "category": "tests",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/test/interop/interop_framework.c :: unknown_symbol. Category=tests, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/test/interop/interop_framework.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, tests."
    ],
    "verification_commands": [
      "rg -n \"interop\" \"net/quic/tquic/test/interop/interop_framework.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Interop Framework - Same Pattern', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Interop Framework - Same Pattern (net/quic/tquic/test/interop/interop_framework.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-383",
    "fingerprint": "all-error-key-material-path-tquic_zero_rtt_derive_key|net/tquic/crypto/zero_rtt.c|tquic_zero_rtt_derive_keys|security",
    "title": "Key Material Not Zeroized on All Error Paths in tquic_zero_rtt_derive_keys",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: tquic_zero_rtt_derive_keys. Category=security, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "tquic_zero_rtt_derive_keys"
      ],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.c:662-662",
        "net/tquic/crypto/zero_rtt.c:698-698"
      ],
      "snippets": [
        "out:\n    memzero_explicit(early_secret, sizeof(early_secret));\n    crypto_free_shash(hash);\n    return ret;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_zero_rtt_derive_keys\" \"net/tquic/crypto/zero_rtt.c\"",
      "rg -n \"key\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `if (ret) memzero_explicit(keys, sizeof(*keys));` before the `out:` label, or zeroize in the `out:` path when `ret != 0`.\n\n---",
    "tests_to_add": [
      "Add regression test for: Key Material Not Zeroized on All Error Paths in tquic_zero_rtt_derive_keys (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-384",
    "fingerprint": "connection-kmem_cache-nam-per-unique|net/quic/tquic/core/stream.c|unknown_symbol|correctness",
    "title": "kmem_cache Names Not Unique Per Connection",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "mgr->stream_cache = kmem_cache_create(\"tquic_stream_ext\", ...);\nmgr->gap_cache = kmem_cache_create(\"tquic_stream_gap\", ...);\nmgr->chunk_cache = kmem_cache_create(\"tquic_recv_chunk\", ...);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"kmem_cache\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `KMEM_CACHE` macro or create caches at module init time (shared across all connections), not per-connection. Or use unique names with connection ID suffix.\n\n---",
    "tests_to_add": [
      "Add regression test for: kmem_cache Names Not Unique Per Connection (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-385",
    "fingerprint": "balancer-feistel-half-length-load-network|net/tquic/lb/quic_lb.c|unknown_symbol|memory",
    "title": "Load Balancer Feistel Network Half-Length Overlap",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "half_len = (len + 1) / 2;\nmemcpy(left, plaintext, half_len);\nmemcpy(right, plaintext + half_len, len - half_len);\n...\ntmp[15] = round;  /* Include round number */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use a separate byte position for the round number that does not conflict with data, or XOR the round number rather than overwriting. / Use a separate byte position for the round number that does not conflict with data, or XOR the round number rather than overwriting.\n\n---",
    "tests_to_add": [
      "Add regression test for: Load Balancer Feistel Network Half-Length Overlap (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-386",
    "fingerprint": "balancer-counter-key-load-nonce-wrap|net/tquic/lb/quic_lb.c|unknown_symbol|concurrency",
    "title": "Load Balancer Nonce Counter Wraps Without Re-keying",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&cfg->lock);\ncounter = cfg->nonce_counter++;\nspin_unlock(&cfg->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Detect counter wrap and refuse to generate nonces, or use a larger state that combines counter with additional randomness. / Detect counter wrap and refuse to generate nonces, or use a larger state that combines counter with additional randomness.\n\n---",
    "tests_to_add": [
      "Add regression test for: Load Balancer Nonce Counter Wraps Without Re-keying (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-387",
    "fingerprint": "bandwidth-bbrv3-every-ktime_get_n-sample|net/tquic/cong/bbrv3.c|bbrv3_update_bw|perf",
    "title": "MEDIUM: BBRv3 uses ktime_get_ns() for every bandwidth sample",
    "category": "perf",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/cong/bbrv3.c :: bbrv3_update_bw. Category=perf, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/bbrv3.c",
        "net/tquic/cong/bbrv3.c:206"
      ],
      "symbols": [
        "bbrv3_update_bw",
        "ktime_get_ns",
        "bbrv3"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/bbrv3.c:206"
      ],
      "snippets": [
        "static void bbrv3_update_bw(struct bbrv3 *bbr, u64 acked, u64 rtt_us)\n{\n    u64 now = ktime_get_ns();"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"bbrv3_update_bw\" \"net/tquic/cong/bbrv3.c\"",
      "rg -n \"bbrv3\" \"net/tquic/cong/bbrv3.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pass the timestamp from the caller rather than calling `ktime_get_ns()` again.",
    "tests_to_add": [
      "Add regression test for: MEDIUM: BBRv3 uses ktime_get_ns() for every bandwidth sample (net/tquic/cong/bbrv3.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-388",
    "fingerprint": "async-io_ur-kzalloc-per-request|net/tquic/io_uring.c|io_alloc_async_data|correctness",
    "title": "MEDIUM: kzalloc per io_uring async request",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/io_uring.c :: io_alloc_async_data. Category=correctness, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/io_uring.c",
        "net/tquic/io_uring.c:139"
      ],
      "symbols": [
        "area",
        "io_alloc_async_data",
        "io_kiocb_to_cmd",
        "fits"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:139"
      ],
      "snippets": [
        "data = kzalloc(sizeof(*data), GFP_KERNEL);",
        "data = kzalloc(sizeof(*data), GFP_KERNEL);\nif (!data)\n    return NULL;\n\nreq->async_data = data;\nreq->flags |= REQ_F_ASYNC_DATA;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory, perf."
    ],
    "verification_commands": [
      "rg -n \"io_alloc_async_data\" \"net/tquic/io_uring.c\"",
      "rg -n \"kzalloc\" \"net/tquic/io_uring.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `io_alloc_async_data()` or embed the async data in the `io_kiocb` command data area (the `io_kiocb_to_cmd()` pattern already used for send/recv). / ** Use `io_alloc_async_data()` (io_uring's internal API) or the req's inline async data storage if the struct fits. This avoids the general allocator and leverages io_uring's pre-allocated memory pools.",
    "tests_to_add": [
      "Add regression test for: MEDIUM: kzalloc per io_uring async request (net/tquic/io_uring.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-389",
    "fingerprint": "allocation-chunk-path-per-skb-zerocopy|net/tquic/tquic_zerocopy.c|alloc_skb|api",
    "title": "MEDIUM: Per-chunk skb allocation in zerocopy path",
    "category": "api",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: alloc_skb. Category=api, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c",
        "net/tquic/tquic_zerocopy.c:297"
      ],
      "symbols": [
        "alloc_skb",
        "alloc_skb_with_frags",
        "min_t",
        "napi_alloc_skb",
        "used",
        "tquic_zerocopy"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:297"
      ],
      "snippets": [
        "while (copied < len) {\n    size_t chunk = min_t(size_t, len - copied, 1200);\n\n    new_skb = alloc_skb(0, GFP_KERNEL);\n    if (!new_skb) {\n        err = -ENOMEM;\n        goto out_err;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: api, perf."
    ],
    "verification_commands": [
      "rg -n \"alloc_skb\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"per\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Batch skb allocation using `alloc_skb_with_frags()` or `napi_alloc_skb()` for bulk allocation. Use the path MTU instead of hardcoded 1200. Consider using GSO to coalesce multiple chunks into fewer skbs.",
    "tests_to_add": [
      "Add regression test for: MEDIUM: Per-chunk skb allocation in zerocopy path (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-390",
    "fingerprint": "1200-byt-chunk-sendmsg-zerocopy|net/tquic/tquic_zerocopy.c|chunks|perf",
    "title": "MEDIUM: Zerocopy sendmsg chunks at 1200 bytes",
    "category": "perf",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 4 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: chunks. Category=perf, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c",
        "net/tquic/tquic_zerocopy.c:293"
      ],
      "symbols": [
        "chunks",
        "min_t",
        "sends",
        "mtu",
        "size",
        "tquic_zerocopy"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:293"
      ],
      "snippets": [
        "size_t chunk = min_t(size_t, len - copied, 1200);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: api, correctness, perf."
    ],
    "verification_commands": [
      "rg -n \"chunks\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"zerocopy\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use larger chunks (up to GSO segment size) and coalesce page fragments into fewer skbs. / ** Use the connection's path MTU (minus overhead for QUIC headers) instead of the hardcoded 1200.",
    "tests_to_add": [
      "Add regression test for: MEDIUM: Zerocopy sendmsg chunks at 1200 bytes (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-391",
    "fingerprint": "counter-every-mib-packet-path-updat||tquic_add_stats|perf",
    "title": "MIB counter updates on every packet in RX/TX paths",
    "category": "perf",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus:  :: tquic_add_stats. Category=perf, severity=S2.\nEvidence union: 0 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_add_stats",
        "tquic_inc_stats",
        "ktime_get",
        "macro",
        "packet",
        "sock_net",
        "tquic_input",
        "tquic_output"
      ],
      "line_ranges": [
        ":2692-2693",
        ":1740-1741"
      ],
      "snippets": [
        "TQUIC_INC_STATS(sock_net(conn->sk), TQUIC_MIB_PACKETSRX);\nTQUIC_ADD_STATS(sock_net(conn->sk), TQUIC_MIB_BYTESRX, len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_add_stats\" \"\"",
      "rg -n \"mib\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Acceptable overhead if using per-CPU counters. Verify the macro implementation uses `this_cpu_add` rather than atomics.",
    "tests_to_add": [
      "Add regression test for: MIB counter updates on every packet in RX/TX paths ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-392",
    "fingerprint": "acces-array-bound-check-tquic_hyst_state_nam|net/tquic/bond/tquic_failover.c|tquic_hyst_state_names|memory",
    "title": "Missing Bounds Check on tquic_hyst_state_names Array Access",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/bond/tquic_failover.c :: tquic_hyst_state_names. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_hyst_state_names",
        "tquic_failover",
        "tquic_hyst_stat"
      ],
      "line_ranges": [],
      "snippets": [
        "pr_info(\"path %u hysteresis: %s -> %s ...\\n\",\n    pt->path_id,\n    tquic_hyst_state_names[old_state],\n    tquic_hyst_state_names[new_state], ...);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_hyst_state_names\" \"net/tquic/bond/tquic_failover.c\"",
      "rg -n \"bound\" \"net/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `ARRAY_SIZE(tquic_hyst_state_names)` bounds check before indexing.",
    "tests_to_add": [
      "Add regression test for: Missing Bounds Check on tquic_hyst_state_names Array Access (net/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-393",
    "fingerprint": "assignment-dev-injection-packet-skb|net/tquic/masque/connect_ip.c|tquic_connect_ip_inject_packet|api",
    "title": "Missing skb->dev Assignment in Packet Injection",
    "category": "api",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_ip.c :: tquic_connect_ip_inject_packet. Category=api, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "tquic_connect_ip_inject_packet",
        "netif_rx"
      ],
      "line_ranges": [],
      "snippets": [
        "skb->dev = NULL;  /* Would be set to virtual interface */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: api, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_connect_ip_inject_packet\" \"net/tquic/masque/connect_ip.c\"",
      "rg -n \"skb\" \"net/tquic/masque/connect_ip.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Set `skb->dev` to the tunnel's virtual network device (`iface->net_device` from the tunnel's interface structure).\n\n---",
    "tests_to_add": [
      "Add regression test for: Missing skb->dev Assignment in Packet Injection (net/tquic/masque/connect_ip.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-394",
    "fingerprint": "atomic-enqueue-multiple-napi-operation-path|net/tquic/napi.c|atomic|concurrency",
    "title": "Multiple atomic operations in NAPI enqueue path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/napi.c :: atomic. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/napi.c",
        "net/tquic/napi.c:689"
      ],
      "symbols": [
        "line",
        "atomic",
        "atomic_inc",
        "tquic_napi"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:689"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"atomic\" \"net/tquic/napi.c\"",
      "rg -n \"multiple\" \"net/tquic/napi.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Remove the redundant `rx_queue_len` atomic (as noted above). This reduces to the minimum of one lock acquisition per enqueue.",
    "tests_to_add": [
      "Add regression test for: Multiple atomic operations in NAPI enqueue path (net/tquic/napi.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-395",
    "fingerprint": "against-concurrent-config-free-keepalive-nat|net/tquic/pm/nat_keepalive.c|rcu_assign_pointer|concurrency",
    "title": "NAT Keepalive Config Pointer Not Protected Against Concurrent Free",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/pm/nat_keepalive.c :: rcu_assign_pointer. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/nat_keepalive.c"
      ],
      "symbols": [
        "rcu_assign_pointer",
        "rcu_dereference"
      ],
      "line_ranges": [],
      "snippets": [
        "if (!state || !state->initialized || state->suspended)\n    return false;\nif (!state->config || !state->config->enabled)\n    return false;\n// ...\nconfig = state->config;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"rcu_assign_pointer\" \"net/tquic/pm/nat_keepalive.c\"",
      "rg -n \"nat\" \"net/tquic/pm/nat_keepalive.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Access `state->config` under `state->lock`, or use `rcu_dereference()`/`rcu_assign_pointer()` for RCU-protected access.",
    "tests_to_add": [
      "Add regression test for: NAT Keepalive Config Pointer Not Protected Against Concurrent Free (net/tquic/pm/nat_keepalive.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-396",
    "fingerprint": "conn_id-dump-every-iteration-netlink-path|net/tquic/tquic_netlink.c|tquic_nl_cmd_path_dump|memory",
    "title": "Netlink Path Dump Reads conn_id on Every Iteration",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: tquic_nl_cmd_path_dump. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_nl_cmd_path_dump",
        "tquic_conn_lookup",
        "tquic_nl_conn_put"
      ],
      "line_ranges": [],
      "snippets": [
        "if (!attrs[TQUIC_NL_ATTR_CONN_ID]) {\n    NL_SET_ERR_MSG(cb->extack, \"Connection ID required\");\n    return -EINVAL;\n}\n\nctx->conn_id = nla_get_u64(attrs[TQUIC_NL_ATTR_CONN_ID]);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_nl_cmd_path_dump\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"netlink\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Netlink Path Dump Reads conn_id on Every Iteration (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-397",
    "fingerprint": "cap_net_admin-check-command-netlink|net/tquic/pm/pm_netlink.c|tquic_pm_nl_add_path|security",
    "title": "Netlink PM Commands Missing CAP_NET_ADMIN Checks",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/pm/pm_netlink.c :: tquic_pm_nl_add_path. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/pm_netlink.c"
      ],
      "symbols": [
        "tquic_pm_nl_add_path",
        "tquic_pm_nl_del_path"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_pm_nl_add_path\" \"net/tquic/pm/pm_netlink.c\"",
      "rg -n \"netlink\" \"net/tquic/pm/pm_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Ensure all PM netlink ops have `.flags = GENL_ADMIN_PERM` in the `genl_ops` array, or add explicit `capable(CAP_NET_ADMIN)` checks in each handler.",
    "tests_to_add": [
      "Add regression test for: Netlink PM Commands Missing CAP_NET_ADMIN Checks (net/tquic/pm/pm_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-398",
    "fingerprint": "count-datagram-flow-http-limit-manager|net/tquic/masque/http_datagram.c|http_datagram_flow|security",
    "title": "No Flow Count Limit in HTTP Datagram Manager",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/http_datagram.c :: http_datagram_flow. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/http_datagram.c"
      ],
      "symbols": [
        "http_datagram_flow"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"http_datagram_flow\" \"net/tquic/masque/http_datagram.c\"",
      "rg -n \"flow\" \"net/tquic/masque/http_datagram.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a configurable `max_flows` limit to the manager and reject new flow creation when the limit is reached.\n\n---",
    "tests_to_add": [
      "Add regression test for: No Flow Count Limit in HTTP Datagram Manager (net/tquic/masque/http_datagram.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-399",
    "fingerprint": "beyond-protection-replay-timestamp-token|net/tquic/tquic_token.c|tquic_token|security",
    "title": "No Token Replay Protection Beyond Timestamp",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_token.c :: tquic_token. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_token.c"
      ],
      "symbols": [
        "tquic_token"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_token\" \"net/tquic/tquic_token.c\"",
      "rg -n \"token\" \"net/tquic/tquic_token.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement a token replay cache (e.g., a bloom filter or hash set of\nrecently seen token nonces) similar to the 0-RTT anti-replay mechanism already\ndefined in `zero_rtt.h`.",
    "tests_to_add": [
      "Add regression test for: No Token Replay Protection Beyond Timestamp (net/tquic/tquic_token.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-400",
    "fingerprint": "drop-function-lock-pac-packet-per|net/tquic/tquic_output.c|__skb_dequeue|concurrency",
    "title": "Pacing work function drops and reacquires lock per packet",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: __skb_dequeue. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1396-1421"
      ],
      "symbols": [
        "__skb_dequeue",
        "spin_lock_bh",
        "spin_unlock_bh",
        "tquic_output_packet",
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1396-1421"
      ],
      "snippets": [
        "while (...) {\n    skb = __skb_dequeue(&pacing->queue);\n    spin_unlock_bh(&pacing->lock);\n    tquic_output_packet(NULL, pacing->path, skb);\n    spin_lock_bh(&pacing->lock);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"__skb_dequeue\" \"net/tquic/tquic_output.c\"",
      "rg -n \"pac\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Dequeue a batch of packets under a single lock hold, then send them all without the lock.",
    "tests_to_add": [
      "Add regression test for: Pacing work function drops and reacquires lock per packet (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-401",
    "fingerprint": "decode-input-invalid-number-packet-return|net/tquic/core/packet.c|unknown_symbol|correctness",
    "title": "Packet Number Decode Returns 0 on Invalid Input",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/packet.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (len < 1 || len > 4)\n    return 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"packet\" \"net/tquic/core/packet.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Return a sentinel value or use an error pointer pattern (pass pn by reference, return error code).\n\n---",
    "tests_to_add": [
      "Add regression test for: Packet Number Decode Returns 0 on Invalid Input (net/tquic/core/packet.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-402",
    "fingerprint": "check-constraint-length-off-one-path|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Path Length Constraint Check Off-By-One",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (cert->path_len_constraint >= 0 &&\n        (int)(depth - 1) > cert->path_len_constraint) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"path\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Path Length Constraint Check Off-By-One (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-403",
    "fingerprint": "manager-netdev_event-path-shadow-variable|net/tquic/pm/path_manager.c|unknown_symbol|correctness",
    "title": "Path Manager netdev_event Shadows Variable 'i'",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/pm/path_manager.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "int num_addrs, i;    // outer 'i'\n// ...\nfor (i = 0; i < num_addrs; i++) {  // shadows outer 'i'"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"path\" \"net/tquic/pm/path_manager.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Rename the inner loop variable.",
    "tests_to_add": [
      "Add regression test for: Path Manager netdev_event Shadows Variable 'i' (net/tquic/pm/path_manager.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-404",
    "fingerprint": "allocation-call-hot-mask-path-per|net/tquic/crypto/header_protection.c|tquic_hp_key|concurrency",
    "title": "Per-Call skcipher_request Allocation in HP Mask Hot Path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/header_protection.c :: tquic_hp_key. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "tquic_hp_key"
      ],
      "line_ranges": [
        "net/tquic/crypto/header_protection.c:164-164",
        "net/tquic/crypto/header_protection.c:211-211"
      ],
      "snippets": [
        "/* AES path, line 164: */\nreq = skcipher_request_alloc(hp_key->tfm, GFP_ATOMIC);\nif (!req)\n    return -ENOMEM;\n\n/* ChaCha20 path, line 211: */\nreq = skcipher_request_alloc(hp_key->tfm, GFP_ATOMIC);\nif (!req)\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hp_key\" \"net/tquic/crypto/header_protection.c\"",
      "rg -n \"per\" \"net/tquic/crypto/header_protection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pre-allocate the `skcipher_request` in the `tquic_hp_key` structure\nduring key setup. Use a per-CPU or per-connection pre-allocated request to\navoid hot-path allocations.\n\n---",
    "tests_to_add": [
      "Add regression test for: Per-Call skcipher_request Allocation in HP Mask Hot Path (net/tquic/crypto/header_protection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-405",
    "fingerprint": "batch-decrypt-encrypt-kmalloc-packet-per|net/tquic/crypto/hw_offload.c|unknown_symbol|concurrency",
    "title": "Per-Packet kmalloc in Batch Encrypt/Decrypt",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/hw_offload.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/hw_offload.c:708-708",
        "net/tquic/crypto/hw_offload.c:703-703"
      ],
      "snippets": [
        "/* Encrypt path, line 708: */\nct_buf = kmalloc(ct_buf_len, GFP_ATOMIC);\nif (!ct_buf) {\n    pkt->result = -ENOMEM;\n    continue;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"per\" \"net/tquic/crypto/hw_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Allocate a single buffer sized for the largest packet in the batch, or\nuse a pre-allocated per-CPU bounce buffer. Alternatively, encrypt in-place if\nthe caller guarantees sufficient tail room (the `data_buf_len` check at line\n703 already validates this -- the temporary buffer is unnecessary).\n\n---",
    "tests_to_add": [
      "Add regression test for: Per-Packet kmalloc in Batch Encrypt/Decrypt (net/tquic/crypto/hw_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-406",
    "fingerprint": "both-path-per-stat-updat|unknown_file|tquic_input|correctness",
    "title": "Per-path stats updated from both RX and TX",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: unknown_file :: tquic_input. Category=correctness, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, perf."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Split path stats into `____cacheline_aligned` RX and TX sections, or use per-CPU counters for path stats.",
    "tests_to_add": [
      "Add regression test for: Per-path stats updated from both RX and TX",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-407",
    "fingerprint": "access-any-connection-lock-poll-stream|net/quic/tquic/tquic_socket.c|tquic_socket|concurrency",
    "title": "poll() Accesses Connection/Stream Without Any Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_socket.c :: tquic_socket. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "if (sk->sk_state == TCP_LISTEN) {\n    if (tsk->accept_queue_len > 0)      // No lock!\n        mask |= EPOLLIN | EPOLLRDNORM;\n} else if (sk->sk_state == TCP_ESTABLISHED) {\n    conn = READ_ONCE(tsk->conn);\n    stream = READ_ONCE(tsk->default_stream);\n\n    if (conn && stream) {\n        if (!skb_queue_e",
        "if (sk->sk_state == TCP_LISTEN) {\n    if (tsk->accept_queue_len > 0)      // No lock!\n        mask |= EPOLLIN | EPOLLRDNORM;\n} else if (sk->sk_state == TCP_ESTABLISHED) {\n    conn = READ_ONCE(tsk->conn);\n    stream = READ_ONCE(tsk->default_stream);\n\n    if (conn && stream) {\n        if (!skb_queue_empty(&stream->recv_buf))  // No lock on stream!\n            mask |= EPOLLIN | EPOLLRDNORM;\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_socket\" \"net/quic/tquic/tquic_socket.c\"",
      "rg -n \"poll\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `READ_ONCE(tsk->accept_queue_len)`. / Use `READ_ONCE(tsk->accept_queue_len)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: poll() Accesses Connection/Stream Without Any Lock (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-408",
    "fingerprint": "entri-hardcod-init_net-proc-proc_net|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Proc Entries Hardcoded to init_net.proc_net",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 3 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c",
        "net/tquic/crypto/hw_offload.c",
        "net/tquic/napi.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pde = proc_create(\"tquic_napi\", 0444, init_net.proc_net, ...);",
        "tquic_cert_proc_dir = proc_mkdir(\"tquic_cert\", init_net.proc_net);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"proc\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Proc Entries Hardcoded to init_net.proc_net (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-409",
    "fingerprint": "data-identity-kernel-logg-logs-psk|net/tquic/tquic_socket.c|tquic_dbg|correctness",
    "title": "PSK Identity Logged with `tquic_dbg()` -- Sensitive Data in Kernel Logs",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_dbg. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_dbg",
        "tquic_socket"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:1202-1202"
      ],
      "snippets": [
        "tquic_dbg(\"PSK identity set (%d bytes)\\n\", optlen);",
        "tquic_dbg(\"Expected hostname set to '%s'\\n\", hostname);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_dbg\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"psk\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'PSK Identity Logged with `tquic_dbg()` -- Sensitive Data in Kernel Logs', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: PSK Identity Logged with `tquic_dbg()` -- Sensitive Data in Kernel Logs (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-410",
    "fingerprint": "explicit-outside-rcu-rcu_dereference-section|net/quic/tquic/tquic_udp.c|sk_buff|concurrency",
    "title": "rcu_dereference Outside Explicit RCU Section",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_udp.c :: sk_buff. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_udp.c"
      ],
      "symbols": [
        "sk_buff",
        "sock",
        "tquic_udp"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_udp.c:1303-1303"
      ],
      "snippets": [
        "static struct sk_buff *tquic_udp_gro_receive(struct sock *sk, ...)\n{\n    us = rcu_dereference_sk_user_data(sk);",
        "us = rcu_dereference_sk_user_data(sk);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"sk_buff\" \"net/quic/tquic/tquic_udp.c\"",
      "rg -n \"rcu_dereference\" \"net/quic/tquic/tquic_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: rcu_dereference Outside Explicit RCU Section (net/quic/tquic/tquic_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-411",
    "fingerprint": "int-request-truncation-u64|net/tquic/masque/connect_ip.c|tquic_connect_ip_request_address|correctness",
    "title": "Request ID Truncation from u64 to int",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/masque/connect_ip.c :: tquic_connect_ip_request_address. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "tquic_connect_ip_request_address"
      ],
      "line_ranges": [],
      "snippets": [
        "return (int)request_id;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_connect_ip_request_address\" \"net/tquic/masque/connect_ip.c\"",
      "rg -n \"request\" \"net/tquic/masque/connect_ip.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Change the return type to `s64` or return 0 for success and pass the request_id through an output pointer parameter.\n\n---",
    "tests_to_add": [
      "Add regression test for: Request ID Truncation from u64 to int (net/tquic/masque/connect_ip.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-412",
    "fingerprint": "addres-hash-retry-token-validation-weak|net/tquic/core/connection.c|unknown_symbol|security",
    "title": "Retry Token Address Validation Uses Weak Hash",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u32 hash = jhash(&sin->sin_addr, sizeof(sin->sin_addr), sin->sin_port);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `siphash` instead of `jhash` for address validation hashing.\n\n---",
    "tests_to_add": [
      "Add regression test for: Retry Token Address Validation Uses Weak Hash (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-413",
    "fingerprint": "character-dns-embedd-nam-nul-san|net/tquic/crypto/cert_verify.c|unknown_symbol|memory",
    "title": "SAN DNS Names Not Validated for Embedded NUL Characters",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "names[name_count] = kmalloc(content_len + 1, GFP_KERNEL);\n    if (!names[name_count])\n        goto err_free;\n\n    memcpy(names[name_count], p + 1 + hdr_len, content_len);\n    names[name_count][content_len] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"san\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Reject SAN DNS names containing NUL bytes (0x00). Add: `if (memchr(p + 1 + hdr_len, 0, content_len)) continue;`\n\n---",
    "tests_to_add": [
      "Add regression test for: SAN DNS Names Not Validated for Embedded NUL Characters (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-414",
    "fingerprint": "between-change-check-modification-race-scheduler|net/tquic/multipath/tquic_scheduler.c|tquic_scheduler|concurrency",
    "title": "Scheduler Change Race Between State Check and Modification",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/multipath/tquic_scheduler.c :: tquic_scheduler. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_scheduler"
      ],
      "line_ranges": [],
      "snippets": [
        "if (conn->state != TQUIC_CONN_IDLE)\n    return -EISCONN;\n// ... RCU lookup, module_get ...\nspin_lock_bh(&conn->lock);\nold_sched = conn->sched;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_scheduler\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "rg -n \"scheduler\" \"net/tquic/multipath/tquic_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Move the state check inside the spinlock-protected region.",
    "tests_to_add": [
      "Add regression test for: Scheduler Change Race Between State Check and Modification (net/tquic/multipath/tquic_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-415",
    "fingerprint": "harden-init_net-mib-security-stat|net/tquic/security_hardening.c|unknown_symbol|security",
    "title": "Security Hardening MIB Stats Always Go to init_net",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security_hardening.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security_hardening.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "TQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_PRE_HS_LIMIT);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_RETIRE_CID_FLOOD);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_NEW_CID_RATE_LIMIT);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_OPTIMISTIC_ACK);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_INVALID_ACK);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"security\" \"net/tquic/security_hardening.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pass the connection's `sock_net(conn->sk)` to the security event reporting function.\n\n---",
    "tests_to_add": [
      "Add regression test for: Security Hardening MIB Stats Always Go to init_net (net/tquic/security_hardening.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-416",
    "fingerprint": "delay-mismatch-queue-scheduler-sign-unsign|net/quic/tquic/sched/scheduler.c|unknown_symbol|correctness",
    "title": "Signed/Unsigned Mismatch in Scheduler Queue Delay",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/sched/scheduler.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 queue_delay = (skb->len * path->stats.rtt_smoothed) /"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"sign\" \"net/quic/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Signed/Unsigned Mismatch in Scheduler Queue Delay', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Signed/Unsigned Mismatch in Scheduler Queue Delay (net/quic/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-417",
    "fingerprint": "dev-every-key-lock-offload-operation|net/tquic/offload/smartnic.c|add_key|concurrency",
    "title": "SmartNIC offload takes dev->lock for every key operation",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/offload/smartnic.c :: add_key. Category=concurrency, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c",
        "net/tquic/offload/smartnic.c:326-328"
      ],
      "symbols": [
        "add_key",
        "mutex",
        "time"
      ],
      "line_ranges": [
        "net/tquic/offload/smartnic.c:326-328"
      ],
      "snippets": [
        "spin_lock(&dev->lock);\nret = dev->ops->add_key(dev, &key);\nspin_unlock(&dev->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"add_key\" \"net/tquic/offload/smartnic.c\"",
      "rg -n \"smartnic\" \"net/tquic/offload/smartnic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a per-connection lock or a mutex (key operations are not in the data path and can sleep).",
    "tests_to_add": [
      "Add regression test for: SmartNIC offload takes dev->lock for every key operation (net/tquic/offload/smartnic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-418",
    "fingerprint": "attacker-count-influenc-kmalloc_array-smartnic|net/quic/tquic/offload/smartnic.c|unknown_symbol|concurrency",
    "title": "smartnic.c - kmalloc_array with Attacker-Influenced Count",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/offload/smartnic.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/offload/smartnic.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pns = kmalloc_array(count, sizeof(u64), GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"smartnic\" \"net/quic/tquic/offload/smartnic.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: smartnic.c - kmalloc_array with Attacker-Influenced Count (net/quic/tquic/offload/smartnic.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-419",
    "fingerprint": "check-qlog-return-snprintf-value|net/quic/tquic/diag/qlog.c|unknown_symbol|correctness",
    "title": "snprintf Return Value Not Checked in qlog.c",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/diag/qlog.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "len = snprintf(buf, buflen, ...);     // Returns 1500 if buflen is 1024\nlen += snprintf(buf + len, buflen - len, ...);  // buflen - len underflows!"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"snprintf\" \"net/quic/tquic/diag/qlog.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `scnprintf` consistently (returns actual bytes\nwritten, not hypothetical) or check `if (len >= buflen) return;` after\neach snprintf.\n\n---",
    "tests_to_add": [
      "Add regression test for: snprintf Return Value Not Checked in qlog.c (net/quic/tquic/diag/qlog.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-420",
    "fingerprint": "accessible-export-key-reset-stateles-static|net/tquic/tquic_stateless_reset.c|tquic_stateless_reset_get_static_key|security",
    "title": "Stateless Reset Static Key Accessible via `tquic_stateless_reset_get_static_key()` Export",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_stateless_reset.c :: tquic_stateless_reset_get_static_key. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_get_static_key",
        "tquic_stateless_reset"
      ],
      "line_ranges": [],
      "snippets": [
        "const u8 *tquic_stateless_reset_get_static_key(void)\n{\n    if (!global_ctx_initialized)\n        return NULL;\n\n    return global_reset_ctx.static_key;\n}\nEXPORT_SYMBOL_GPL(tquic_stateless_reset_get_static_key);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_stateless_reset_get_static_key\" \"net/tquic/tquic_stateless_reset.c\"",
      "rg -n \"stateles\" \"net/tquic/tquic_stateless_reset.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Stateless Reset Static Key Accessible via `tquic_stateless_reset_get_static_key()` Export (net/tquic/tquic_stateless_reset.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-421",
    "fingerprint": "entri-init_net-proc-register-sysctl|net/tquic/transport/tcp_fallback.c|tquic_sysctl|security",
    "title": "Sysctl and Proc Entries Registered in init_net Only",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/transport/tcp_fallback.c :: tquic_sysctl. Category=security, severity=S2.\nEvidence union: 4 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/transport/tcp_fallback.c",
        "net/tquic/tquic_sysctl.c",
        "net/tquic/tquic_ratelimit.c",
        "net/tquic/cong/persistent_cong.c"
      ],
      "symbols": [
        "tquic_sysctl",
        "tquic_proto"
      ],
      "line_ranges": [
        "net/tquic/transport/tcp_fallback.c:843-843",
        "net/tquic/transport/tcp_fallback.c:272-272",
        "net/tquic/transport/tcp_fallback.c:2077-2077"
      ],
      "snippets": [
        "tquic_sysctl_header = register_net_sysctl_sz(&init_net, \"net/tquic\", ...);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_sysctl\" \"net/tquic/transport/tcp_fallback.c\"",
      "rg -n \"sysctl\" \"net/tquic/transport/tcp_fallback.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Sysctl and Proc Entries Registered in init_net Only (net/tquic/transport/tcp_fallback.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-422",
    "fingerprint": "overly-permission-permissive-sysctl|net/tquic/tquic_sysctl.c|tquic_sysctl|security",
    "title": "Sysctl Permissions Are Overly Permissive",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_sysctl.c :: tquic_sysctl. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_sysctl.c"
      ],
      "symbols": [
        "tquic_sysctl"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_sysctl\" \"net/tquic/tquic_sysctl.c\"",
      "rg -n \"sysctl\" \"net/tquic/tquic_sysctl.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Sysctl Permissions Are Overly Permissive (net/tquic/tquic_sysctl.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-423",
    "fingerprint": "range-sysctl-validation-variabl|net/tquic/security/quic_exfil.c|unknown_symbol|correctness",
    "title": "Sysctl Variables Lack Range Validation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int exfil_protection_level = TQUIC_EXFIL_LEVEL_MEDIUM;\nstatic int exfil_timing_delay_us = TQUIC_EXFIL_DELAY_MEDIUM_MAX_US;\nstatic int exfil_padding_strategy = TQUIC_PAD_RANDOM;\nstatic int exfil_pad_probability = TQUIC_PAD_PROBABILITY_DEFAULT;\nstatic int exfil_spin_mode = TQUIC_SPIN_RANDOM_PRO",
        "static int exfil_protection_level = TQUIC_EXFIL_LEVEL_MEDIUM;\nstatic int exfil_timing_delay_us = TQUIC_EXFIL_DELAY_MEDIUM_MAX_US;\nstatic int exfil_padding_strategy = TQUIC_PAD_RANDOM;\nstatic int exfil_pad_probability = TQUIC_PAD_PROBABILITY_DEFAULT;\nstatic int exfil_spin_mode = TQUIC_SPIN_RANDOM_PROB;\nstatic int exfil_jitter_min_us = TQUIC_JITTER_DEFAULT_MIN_US;\nstatic int exfil_jitter_max_us = TQUIC_JITTER_DEFAULT_MAX_US;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"sysctl\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Register a proper sysctl table with `proc_dointvec_minmax` handlers and range limits, or add range validation in the accessor functions. / Register a proper sysctl table with `proc_dointvec_minmax` handlers and range limits, or add range validation in the accessor functions.\n\n---",
    "tests_to_add": [
      "Add regression test for: Sysctl Variables Lack Range Validation (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-424",
    "fingerprint": "comparison-constant-hash-time-token|net/tquic/core/connection.c|unknown_symbol|security",
    "title": "Token Hash Comparison Not Constant-Time",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (token_hash != expected_hash) {"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"token\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `crypto_memneq` for the comparison.\n\n---",
    "tests_to_add": [
      "Add regression test for: Token Hash Comparison Not Constant-Time (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-425",
    "fingerprint": "key-old-rotation-token-zeroize|net/tquic/tquic_token.c|memzero_explicit|security",
    "title": "Token Key Rotation Does Not Zeroize Old Key",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_token.c :: memzero_explicit. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_token.c"
      ],
      "symbols": [
        "memzero_explicit",
        "tquic_token_key",
        "tquic_token"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_token_rotate_key(struct tquic_token_key *old_key,\n                           struct tquic_token_key *new_key)\n{\n    if (!new_key)\n        return -EINVAL;\n\n    get_random_bytes(new_key->key, TQUIC_TOKEN_KEY_LEN);\n    new_key->generation = old_key ? old_key->generation + 1 : 1;\n    new_key->",
        "int tquic_token_rotate_key(struct tquic_token_key *old_key,\n                           struct tquic_token_key *new_key)\n{\n    if (!new_key)\n        return -EINVAL;\n\n    get_random_bytes(new_key->key, TQUIC_TOKEN_KEY_LEN);\n    new_key->generation = old_key ? old_key->generation + 1 : 1;\n    new_key->valid = true;\n\n    return 0;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"memzero_explicit\" \"net/tquic/tquic_token.c\"",
      "rg -n \"token\" \"net/tquic/tquic_token.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Zeroize `old_key->key` with `memzero_explicit()` and set\n`old_key->valid = false` inside this function, making the API self-cleaning.\n\n---",
    "tests_to_add": [
      "Add regression test for: Token Key Rotation Does Not Zeroize Old Key (net/tquic/tquic_token.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-426",
    "fingerprint": "but-cancell-failure-initializ-later-timer|net/quic/tquic/tquic_cid.c|init_work|correctness",
    "title": "tquic_cid_pool_init -- timer initialized but not cancelled on later failure",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_cid.c :: init_work. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_cid.c"
      ],
      "symbols": [
        "init_work",
        "timer_setup",
        "del_timer_sync",
        "cancel_work_sync",
        "tquic_cid_pool_init",
        "tquic_cid"
      ],
      "line_ranges": [],
      "snippets": [
        "pool = kzalloc(sizeof(*pool), GFP_KERNEL);\n...\nINIT_WORK(&pool->rotation_work, tquic_cid_rotation_work);\ntimer_setup(&pool->rotation_timer, tquic_cid_rotation_timer_cb, 0);\n...\nentry = kzalloc(sizeof(*entry), GFP_KERNEL);\nif (!entry) {\n    kfree(pool);   // BUG: timer and work not cancelled\n    retu",
        "pool = kzalloc(sizeof(*pool), GFP_KERNEL);\n...\nINIT_WORK(&pool->rotation_work, tquic_cid_rotation_work);\ntimer_setup(&pool->rotation_timer, tquic_cid_rotation_timer_cb, 0);\n...\nentry = kzalloc(sizeof(*entry), GFP_KERNEL);\nif (!entry) {\n    kfree(pool);   // BUG: timer and work not cancelled\n    return -ENOMEM;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"init_work\" \"net/quic/tquic/tquic_cid.c\"",
      "rg -n \"tquic_cid_pool_init\" \"net/quic/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Call `del_timer_sync(&pool->rotation_timer)` before `kfree(pool)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_cid_pool_init -- timer initialized but not cancelled on later failure (net/quic/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-427",
    "fingerprint": "clean-doesn-failure-loss_detection_init-timer-tquic_conn_create|net/quic/tquic/core/quic_connection.c|tquic_conn_create|correctness",
    "title": "tquic_conn_create -- loss_detection_init failure doesn't clean up timers",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/quic_connection.c :: tquic_conn_create. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_connection.c"
      ],
      "symbols": [
        "tquic_conn_create",
        "quic_connection"
      ],
      "line_ranges": [
        "net/quic/tquic/core/quic_connection.c:495-501",
        "net/quic/tquic/core/quic_connection.c:504-506"
      ],
      "snippets": [
        "// Initialize timers (lines 495-501)\ntimer_setup(&conn->timers[TQUIC_TIMER_LOSS], ...);\ntimer_setup(&conn->timers[TQUIC_TIMER_ACK], ...);\n// ... 7 timers total\n\n// Initialize work queues (lines 504-506)\nINIT_WORK(&conn->tx_work, ...);\nINIT_WORK(&conn->rx_work, ...);\nINIT_WORK(&conn->close_work, ...);\n\n// Loss detection init\nif (tquic_loss_detection_init(conn) < 0)\n    goto err_free_pn_spaces;\n\nerr_free_pn_spaces:\n    kfree(conn->pn_spaces);\nerr_free_scid:\n    tquic_cid_entry_destroy(scid_entry);\nerr_free_conn:\n    kfree(conn);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_create\" \"net/quic/tquic/core/quic_connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_conn_create -- loss_detection_init failure doesn't clean up timers', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_conn_create -- loss_detection_init failure doesn't clean up timers (net/quic/tquic/core/quic_connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-428",
    "fingerprint": "actually-reserve-tquic_fc_reserve_credit|net/quic/tquic/core/flow_control.c|tquic_fc_reserve_credit|correctness",
    "title": "tquic_fc_reserve_credit Does Not Actually Reserve",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/flow_control.c :: tquic_fc_reserve_credit. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/flow_control.c"
      ],
      "symbols": [
        "tquic_fc_reserve_credit"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_fc_reserve_credit(..., u64 bytes)\n{\n    tquic_fc_get_credit(fc, stream, &credit);\n    if (bytes > credit.effective_credit)\n        return -ENOSPC;\n    return 0;  /* \"Credit will be committed when transmission succeeds\" */\n}\n\nvoid tquic_fc_release_credit(...)\n{\n    /* This is a no-op in our",
        "int tquic_fc_reserve_credit(..., u64 bytes)\n{\n    tquic_fc_get_credit(fc, stream, &credit);\n    if (bytes > credit.effective_credit)\n        return -ENOSPC;\n    return 0;  /* \"Credit will be committed when transmission succeeds\" */\n}\n\nvoid tquic_fc_release_credit(...)\n{\n    /* This is a no-op in our implementation */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_fc_reserve_credit\" \"net/quic/tquic/core/flow_control.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement actual atomic reservation by deducting credit in reserve and adding back in release.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_fc_reserve_credit Does Not Actually Reserve (net/quic/tquic/core/flow_control.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-429",
    "fingerprint": "but-fre-kfree_sensitive-memzero_explicit-tquic_handshake-tquic_start_handshake|net/quic/tquic/tquic_handshake.c|kfree_sensitive|concurrency",
    "title": "tquic_handshake.c tquic_start_handshake -- hs freed with memzero_explicit but no kfree_sensitive",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_handshake.c :: kfree_sensitive. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_handshake.c"
      ],
      "symbols": [
        "kfree_sensitive",
        "tquic_handshake",
        "tquic_start_handshake"
      ],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    tsk->handshake_state = NULL;\n    memzero_explicit(hs, sizeof(*hs));\n    kfree(hs);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"kfree_sensitive\" \"net/quic/tquic/tquic_handshake.c\"",
      "rg -n \"tquic_handshake\" \"net/quic/tquic/tquic_handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_handshake.c tquic_start_handshake -- hs freed with memzero_explicit but no kfree_sensitive (net/quic/tquic/tquic_handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-430",
    "fingerprint": "acquir-but-dropp-lock-mid-spin_lock_bh|net/quic/tquic/tquic_output.c|tquic_output_flush|concurrency",
    "title": "tquic_output_flush -- spin_unlock_bh after acquiring spin_lock_bh, but lock dropped mid-loop",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_output_flush. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output_flush",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Release lock while sending (may sleep in crypto) */\nspin_unlock_bh(&conn->lock);\n\n/* Assemble and send packet */\nsend_skb = tquic_assemble_packet(conn, path, -1, pkt_num, &frames);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_output_flush\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_output_flush -- spin_unlock_bh after acquiring spin_lock_bh, but lock dropped mid-loop (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-431",
    "fingerprint": "acros-aead-held-integrity_aead_lock-operation-tquic_retry|net/quic/tquic/tquic_retry.c|tquic_retry|concurrency",
    "title": "tquic_retry.c -- integrity_aead_lock held across AEAD operations",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_retry.c :: tquic_retry. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [
        "tquic_retry"
      ],
      "line_ranges": [],
      "snippets": [
        "mutex_lock(&integrity_aead_lock);\naead = tquic_retry_get_integrity_aead(version);\n...\nret = crypto_aead_encrypt(req);\n...\nout_unlock:\n    mutex_unlock(&integrity_aead_lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_retry\" \"net/quic/tquic/tquic_retry.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_retry.c -- integrity_aead_lock held across AEAD operations (net/quic/tquic/tquic_retry.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-432",
    "fingerprint": "cleanup-ext-fre-tquic_stream_memory_pressure|net/quic/tquic/core/stream.c|tquic_stream_memory_pressure|correctness",
    "title": "tquic_stream_memory_pressure Frees Without ext Cleanup",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_memory_pressure. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_memory_pressure",
        "tquic_stream_ext_free"
      ],
      "line_ranges": [],
      "snippets": [
        "if (stream->state == TQUIC_STREAM_CLOSED) {\n    tquic_stream_remove(mgr, stream);\n    /* ... purge buffers ... */\n    kfree(stream);  /* ext is NOT freed! */\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_memory_pressure\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `tquic_stream_ext_free(mgr, stream->ext);` before `kfree(stream);`.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_memory_pressure Frees Without ext Cleanup (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-433",
    "fingerprint": "inflight-tquic_stream_trigger_output-underflow|net/quic/tquic/tquic_stream.c|tquic_stream_trigger_output|correctness",
    "title": "tquic_stream_trigger_output Inflight Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_trigger_output. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_trigger_output",
        "tquic_stream"
      ],
      "line_ranges": [],
      "snippets": [
        "inflight = path->stats.tx_bytes - path->stats.acked_bytes;\ncan_send = (inflight < path->stats.cwnd);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_trigger_output\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add underflow guard: `inflight = (path->stats.tx_bytes > path->stats.acked_bytes) ? path->stats.tx_bytes - path->stats.acked_bytes : 0;`\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_trigger_output Inflight Underflow (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-434",
    "fingerprint": "copy-entire-hold-lock-loop-mgr|net/quic/tquic/core/stream.c|tquic_stream_write|concurrency",
    "title": "tquic_stream_write Holds mgr->lock for Entire Copy Loop",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream_write. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_write"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_write\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Copy data to a pre-allocated buffer outside the lock, then enqueue under the lock. Or use a mutex instead of spinlock for the write path.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_stream_write Holds mgr->lock for Entire Copy Loop (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-435",
    "fingerprint": "challeng-path-pend-unbound|net/tquic/core/connection.c|tquic_path|concurrency",
    "title": "Unbounded Pending Path Challenges",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_path. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_challenge",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_send_path_challenge(struct tquic_connection *conn, struct tquic_path *path)\n{\n    ...\n    challenge = kzalloc(sizeof(*challenge), GFP_ATOMIC);\n    ...\n    list_add_tail(&challenge->list, &cs->pending_challenges);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, correctness."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/tquic/core/connection.c\"",
      "rg -n \"unbound\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Limit pending challenges to a reasonable maximum (e.g., 10).\n\n---",
    "tests_to_add": [
      "Add regression test for: Unbounded Pending Path Challenges (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-436",
    "fingerprint": "authenticat-negotiation-packet-version|net/tquic/core/connection.c|unknown_symbol|correctness",
    "title": "Version Negotiation Packet Not Authenticated",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "int tquic_handle_version_negotiation(...)\n{\n    ...\n    if (cs->version_negotiation_done) {\n        tquic_conn_warn(conn, \"duplicate version negotiation\\n\");\n        return -EPROTO;\n    }\n    new_version = tquic_version_select(versions, num_versions);\n    ...\n    conn->version = new_version;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"version\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check that the VN version list does NOT contain the version the client originally tried.\n\n---",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Packet Not Authenticated (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-437",
    "fingerprint": "accept-check-refcount-session-webtransport|net/quic/tquic/http3/webtransport.c|unknown_symbol|memory",
    "title": "WebTransport Session Refcount Not Checked After Accept",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/webtransport.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, other."
    ],
    "verification_commands": [
      "rg -n \"webtransport\" \"net/quic/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Audit all callers of session-returning functions and ensure every get has a matching put.\n\n---",
    "tests_to_add": [
      "Add regression test for: WebTransport Session Refcount Not Checked After Accept (net/quic/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-438",
    "fingerprint": "atomic_t-entry-refcount-zerocopy|net/tquic/tquic_zerocopy.c|atomic_t|memory",
    "title": "Zerocopy entry refcount uses atomic_t",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: atomic_t. Category=memory, severity=S2.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c",
        "net/tquic/tquic_zerocopy.c:58-59"
      ],
      "symbols": [
        "atomic_t",
        "refcount_dec_and_test",
        "refcount_inc",
        "tquic_zerocopy"
      ],
      "line_ranges": [
        "net/tquic/tquic_zerocopy.c:58-59"
      ],
      "snippets": [
        "atomic_t        refcnt;         /* Reference count */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"atomic_t\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"zerocopy\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Change to `refcount_t` and use `refcount_inc()` / `refcount_dec_and_test()`.",
    "tests_to_add": [
      "Add regression test for: Zerocopy entry refcount uses atomic_t (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-439",
    "fingerprint": "amp-amplification-anti-atomic64-bytes_receiv-bytes_sent|net/quic/tquic/tquic_migration.c|unknown_symbol|concurrency",
    "title": "AMP-1: The anti-amplification check uses `atomic64` operations for `bytes_received` and `bytes_sent`, but the check-then-add pattern is not atomic as a whole:",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_migration.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_migration.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_migration.c:271-271"
      ],
      "snippets": [
        "// Check:\nsent + bytes <= received * TQUIC_ANTI_AMPLIFICATION_LIMIT\n// Then later:\natomic64_add(bytes, &path->anti_amplification.bytes_sent);",
        "// tquic_stateless_reset.c:211\n// \"than the packet it received to avoid being used for amplification.\"",
        "// pm/path_manager.c:169\nTQUIC_MAX_CHALLENGE_RESPONSES_PER_RTT\n\n// pm/path_validation.c:259\nTQUIC_MAX_PENDING_RESPONSES"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"amp\" \"net/quic/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `atomic64_add_return` to atomically check-and-add, or serialize under a spinlock",
    "tests_to_add": [
      "Add regression test for: AMP-1: The anti-amplification check uses `atomic64` operations for `bytes_received` and `bytes_sent`, but the check-then-add pattern is not atomic as a whole: (net/quic/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-440",
    "fingerprint": "0x84-asn1_get_length-handle-length|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "asn1_get_length Does Not Handle Length 0x84+",
    "category": "security",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:186-186",
        "net/tquic/crypto/cert_verify.c:155-155"
      ],
      "snippets": [
        "static int asn1_get_length(const u8 *data, u32 data_len, u32 *len, u32 *hdr_len)\n{\n    ...\n    } else if (data[0] == 0x83) {\n        if (data_len < 4)\n            return -EINVAL;\n        *len = (data[1] << 16) | (data[2] << 8) | data[3];\n        *hdr_len = 4;\n    } else {\n        return -EINVAL;\n   "
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"asn1_get_length\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: asn1_get_length Does Not Handle Length 0x84+ (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-441",
    "fingerprint": "coalesc-overflow-packet-process-silently-truncat|net/tquic/tquic_input.c|unknown_symbol|correctness",
    "title": "Coalesced Packet Processing Silently Truncates on Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:3172-3173"
      ],
      "snippets": [
        "if (offset + pkt_len > total_len)\n            pkt_len = total_len - offset;",
        "if (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"coalesc\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Instead of silently truncating, reject the coalesced packet entirely when the claimed length exceeds remaining data:\n```c\nif (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */\n```",
    "tests_to_add": [
      "Add regression test for: Coalesced Packet Processing Silently Truncates on Overflow (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-442",
    "fingerprint": "conn-data_sent-error-path-underflow|net/quic/tquic/tquic_netlink.c|unknown_symbol|concurrency",
    "title": "conn->data_sent Underflow on Error Path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_netlink.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_netlink.c:1008-1015",
        "net/quic/tquic/tquic_netlink.c:993-993",
        "net/quic/tquic/tquic_netlink.c:699-699",
        "net/quic/tquic/tquic_netlink.c:603-603"
      ],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nconn->data_sent -= (len - copied);\nspin_unlock_bh(&conn->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"conn\" \"net/quic/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: conn->data_sent Underflow on Error Path (net/quic/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-443",
    "fingerprint": "block-cpu-decoder-fec-linear-list|net/quic/tquic/fec/fec_decoder.c|unknown_symbol|concurrency",
    "title": "CPU-2: FEC decoder block search is a linear list walk.",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/fec/fec_decoder.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/fec_decoder.c:285-285"
      ],
      "snippets": [
        "// fec/fec_decoder.c:220\nlist_for_each_entry(block, &dec->active_blocks, list) {\n    if (block->block_id == block_id)\n        return block;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"cpu\" \"net/quic/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use a bitmap or hash set for symbol ID dedup within blocks",
    "tests_to_add": [
      "Add regression test for: CPU-2: FEC decoder block search is a linear list walk. (net/quic/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-444",
    "fingerprint": "call-edf-edf_select_path-lock-scheduler|net/tquic/sched/deadline_scheduler.c|edf_select_path|concurrency",
    "title": "EDF Scheduler edf_select_path Called Without Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/deadline_scheduler.c :: edf_select_path. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 3 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_scheduler.c"
      ],
      "symbols": [
        "edf_select_path",
        "tquic_edf_enqueue"
      ],
      "line_ranges": [
        "net/tquic/sched/deadline_scheduler.c:591-591",
        "net/tquic/sched/deadline_scheduler.c:594-594",
        "net/tquic/sched/deadline_scheduler.c:595-595"
      ],
      "snippets": [
        "entry->selected_path = edf_select_path(sched, entry);  // NO LOCK\nspin_lock_bh(&sched->lock);\nedf_tree_insert(&sched->edf_tree, entry);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"edf_select_path\" \"net/tquic/sched/deadline_scheduler.c\"",
      "rg -n \"edf\" \"net/tquic/sched/deadline_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: EDF Scheduler edf_select_path Called Without Lock (net/tquic/sched/deadline_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-445",
    "fingerprint": "exce-ktime_get_ts64-size-skb-written|net/tquic/tquic_input.c|timespec64|correctness",
    "title": "ktime_get_ts64 Written to skb->cb May Exceed cb Size",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: timespec64. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "for",
        "timespec64"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:1471-1471",
        "net/tquic/tquic_input.c:951-951"
      ],
      "snippets": [
        "/* Store receive timestamp in SKB cb */\n    ktime_get_ts64((struct timespec64 *)dgram_skb->cb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"timespec64\" \"net/tquic/tquic_input.c\"",
      "rg -n \"ktime_get_ts64\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use a typed union or dedicated struct for `skb->cb` usage, documented per frame type.",
    "tests_to_add": [
      "Add regression test for: ktime_get_ts64 Written to skb->cb May Exceed cb Size (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-446",
    "fingerprint": "broad-check-frame-range-too-type|net/quic/tquic/tquic_input.c|unknown_symbol|correctness",
    "title": "MP Frame Type Range Check Too Broad",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_input.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1623-1623",
        "net/quic/tquic/tquic_input.c:1652-1652",
        "net/quic/tquic/tquic_input.c:1292-1292",
        "net/quic/tquic/tquic_input.c:1886-2039"
      ],
      "snippets": [
        "return (frame_type >= 0x15c0 && frame_type <= 0x15cff);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"frame\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'MP Frame Type Range Check Too Broad', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: MP Frame Type Range Check Too Broad (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-447",
    "fingerprint": "check-overflow-tquic_fc_stream_can_send|net/quic/tquic/core/flow_control.c|tquic_fc_stream_can_send|correctness",
    "title": "tquic_fc_stream_can_send Missing Overflow Check",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/flow_control.c :: tquic_fc_stream_can_send. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/flow_control.c"
      ],
      "symbols": [
        "tquic_fc_stream_can_send"
      ],
      "line_ranges": [
        "net/quic/tquic/core/flow_control.c:291-292"
      ],
      "snippets": [
        "can_send = (stream->data_sent + bytes) <= stream->max_data_remote;",
        "can_send = bytes <= (stream->max_data_remote - stream->data_sent);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_fc_stream_can_send\" \"net/quic/tquic/core/flow_control.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_fc_stream_can_send Missing Overflow Check', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_fc_stream_can_send Missing Overflow Check (net/quic/tquic/core/flow_control.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-448",
    "fingerprint": "range-tquic_idle_timeout-validation|net/quic/tquic/tquic_socket.c|unknown_symbol|correctness",
    "title": "TQUIC_IDLE_TIMEOUT Missing Range Validation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_socket.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:768-768"
      ],
      "snippets": [
        "case TQUIC_IDLE_TIMEOUT:\n    if (tsk->conn)\n        tsk->conn->idle_timeout = val;\n    break;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_idle_timeout\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'TQUIC_IDLE_TIMEOUT Missing Range Validation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: TQUIC_IDLE_TIMEOUT Missing Range Validation (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-449",
    "fingerprint": "off-one-potential-tquic_psk_identity|net/quic/tquic/tquic_socket.c|unknown_symbol|memory",
    "title": "TQUIC_PSK_IDENTITY Off-by-One Potential",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_socket.c :: unknown_symbol. Category=memory, severity=S2.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:942-942",
        "net/quic/tquic/tquic_socket.c:942-951"
      ],
      "snippets": [
        "if (optlen < 1 || optlen > 64)\n    return -EINVAL;\ncopy_from_sockptr(identity, optval, optlen);\nlock_sock(sk);\nmemcpy(tsk->psk_identity, identity, optlen);\ntsk->psk_identity_len = optlen;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_psk_identity\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: TQUIC_PSK_IDENTITY Off-by-One Potential (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-450",
    "fingerprint": "forever-loop-pressure-signal-tquic_recv_datagram|net/tquic/tquic_output.c|tquic_recv_datagram|concurrency",
    "title": "tquic_recv_datagram Can Loop Forever Under Signal Pressure",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_recv_datagram. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_recv_datagram"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:2706-2743"
      ],
      "snippets": [
        "int retries = 0;\n...\nretry:\n    if (++retries > 3) return -EAGAIN;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_recv_datagram\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a retry counter to prevent excessive looping:\n```c\nint retries = 0;\n...\nretry:\n    if (++retries > 3) return -EAGAIN;\n```",
    "tests_to_add": [
      "Add regression test for: tquic_recv_datagram Can Loop Forever Under Signal Pressure (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-451",
    "fingerprint": "race-tquic_sched_find-tquic_scheduler|net/quic/tquic/tquic_socket.c|tquic_sched_ops|concurrency",
    "title": "TQUIC_SCHEDULER Race on tquic_sched_find",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_socket.c :: tquic_sched_ops. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 4 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sched_ops",
        "rcu_read_lock",
        "rcu_read_unlock",
        "tquic_sock_getsockopt",
        "tquic_sock_ioctl",
        "tquic_sched_find"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:848-848",
        "net/quic/tquic/tquic_socket.c:848-872",
        "net/quic/tquic/tquic_socket.c:1307-1307",
        "net/quic/tquic/tquic_socket.c:656-656"
      ],
      "snippets": [
        "rcu_read_lock();\nif (!tquic_sched_find(name)) {\n    rcu_read_unlock();\n    return -ENOENT;\n}\nrcu_read_unlock();\n\nlock_sock(sk);\n/* ... */\nstruct tquic_sched_ops *sched_ops = tquic_sched_find(name);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_sched_ops\" \"net/quic/tquic/tquic_socket.c\"",
      "rg -n \"tquic_scheduler\" \"net/quic/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: TQUIC_SCHEDULER Race on tquic_sched_find (net/quic/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-452",
    "fingerprint": "active_path-but-list-path-rcu-useafterfree|net/tquic/tquic_migration.c|rcu_assign_pointer|memory",
    "title": "UAF-P5-02: - Path list uses RCU but active_path does not",
    "category": "memory",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: rcu_assign_pointer. Category=memory, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "rcu_assign_pointer",
        "synchronize_rcu",
        "rcu_dereference",
        "tquic_migration"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:848-848"
      ],
      "snippets": [
        "spin_lock_bh(&conn->paths_lock);\nlist_del_rcu(&path->list);\nconn->num_paths--;\nspin_unlock_bh(&conn->paths_lock);\n\nsynchronize_rcu();  // Wait for RCU readers\n\nkfree(path);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rcu_assign_pointer\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P5-02: - Path list uses RCU but active_path does not (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-453",
    "fingerprint": "limit-logg-negotiation-rate-version|net/tquic/tquic_input.c|tquic_dbg|correctness",
    "title": "Version Negotiation Versions Logged Without Rate Limiting",
    "category": "correctness",
    "severity": "S2",
    "confidence": "high",
    "priority_score": 4.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_dbg. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_dbg"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:473-477"
      ],
      "snippets": [
        "for (i = 0; i + 4 <= versions_len; i += 4) {\n        u32 version = ...;\n        tquic_dbg(\"  version 0x%08x\\n\", version);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_dbg\" \"net/tquic/tquic_input.c\"",
      "rg -n \"version\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Either remove the per-version debug line or cap the number of logged versions.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Versions Logged Without Rate Limiting (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-454",
    "fingerprint": "acros-call-cros-jhash-seed-sit|unknown_file|unknown_symbol|security",
    "title": "CROSS-1: The systematic use of `jhash` with seed 0 across 15+ call sites creates a coordinated attack vector. An attacker who can determine CID values and IP addresses can craft inputs that degrade:",
    "category": "security",
    "severity": "S1",
    "confidence": "low",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: unknown_symbol. Category=security, severity=S1.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S1 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: CROSS-1: The systematic use of `jhash` with seed 0 across 15+ call sites creates a coordinated attack vector. An attacker who can determine CID values and IP addresses can craft inputs that degrade:",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-455",
    "fingerprint": "aead-allocat-encrypt-packet-per-rtt|net/tquic/crypto/zero_rtt.c|unknown_symbol|security",
    "title": "0-RTT Encrypt Allocates AEAD Per-Packet",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "aead = crypto_alloc_aead(tquic_cipher_to_aead_name(state->cipher_suite), 0, 0);\n    if (IS_ERR(aead))\n        return PTR_ERR(aead);\n\n    ret = crypto_aead_setkey(aead, state->keys.key, state->keys.key_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rtt\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: 0-RTT Encrypt Allocates AEAD Per-Packet (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-456",
    "fingerprint": "aead-allocat-encrypt-packet-per-performance|unknown_file|tquic_zero_rtt_keys|security",
    "title": "0-RTT Encrypt Allocates AEAD Per-Packet (Performance / Side Channel)",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_zero_rtt_keys. Category=security, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_zero_rtt_keys"
      ],
      "line_ranges": [],
      "snippets": [
        "aead = crypto_alloc_aead(tquic_cipher_to_aead_name(state->cipher_suite), 0, 0);\n    if (IS_ERR(aead))\n        return PTR_ERR(aead);\n\n    ret = crypto_aead_setkey(aead, state->keys.key, state->keys.key_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Allocate the AEAD transform once during key derivation and store it in `tquic_zero_rtt_keys`. Reuse for all packets.\n\n---",
    "tests_to_add": [
      "Add regression test for: 0-RTT Encrypt Allocates AEAD Per-Packet (Performance / Side Channel)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-457",
    "fingerprint": "all-fail-function-init-oom-scheduler|unknown_file|aggregate_init|correctness",
    "title": "All MP Scheduler init() Functions Silently Fail on OOM",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: aggregate_init. Category=correctness, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "aggregate_init",
        "ecf_init",
        "get_path",
        "weighted_init",
        "blest_init",
        "minrtt_init",
        "rr_init",
        "kzalloc"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'All MP Scheduler init() Functions Silently Fail on OOM', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: All MP Scheduler init() Functions Silently Fail on OOM",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-458",
    "fingerprint": "alpha-coupl-loss-precision|net/tquic/bond/cong_coupled.c|mul_u64_u64_div|correctness",
    "title": "Alpha Precision Loss in Coupled CC",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/cong_coupled.c :: mul_u64_u64_div. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "mul_u64_u64_div",
        "coupled_calc_alpha"
      ],
      "line_ranges": [],
      "snippets": [
        "u32 shift = max(ilog2(max_cwnd_rtt2), ilog2(sum_cwnd_rtt_sq));\nshift = (shift > 30) ? shift - 30 : 0;\n/* ... after division ... */\nalpha = clamp(alpha, COUPLED_ALPHA_MIN, COUPLED_ALPHA_MAX);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"mul_u64_u64_div\" \"net/tquic/bond/cong_coupled.c\"",
      "rg -n \"alpha\" \"net/tquic/bond/cong_coupled.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Alpha Precision Loss in Coupled CC', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Alpha Precision Loss in Coupled CC (net/tquic/bond/cong_coupled.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-459",
    "fingerprint": "249-amp-amplification-anti-check-function|net/quic/tquic/pm/path_validation.c|tquic_path_handle_challenge|security",
    "title": "AMP-2: The `tquic_path_handle_challenge` function in `pm/path_validation.c:249` does not check anti-amplification limits before queuing the PATH_RESPONSE. Per RFC 9000 Section 8.1, data sent on unvali",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/pm/path_validation.c :: tquic_path_handle_challenge. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "tquic_path_handle_challenge",
        "tquic_path_anti_amplification_check"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_handle_challenge\" \"net/quic/tquic/pm/path_validation.c\"",
      "rg -n \"amp\" \"net/quic/tquic/pm/path_validation.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Check `tquic_path_anti_amplification_check` before queuing response; charge response bytes to `bytes_sent`",
    "tests_to_add": [
      "Add regression test for: AMP-2: The `tquic_path_handle_challenge` function in `pm/path_validation.c:249` does not check anti-amplification limits before queuing the PATH_RESPONSE. Per RFC 9000 Section 8.1, data sent on unvali (net/quic/tquic/pm/path_validation.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-460",
    "fingerprint": "amp-connect-connect_udp-creat-implementation-masque|net/quic/tquic/masque/connect_udp.c|unknown_symbol|security",
    "title": "AMP-3: The MASQUE CONNECT-UDP tunnel implementation in `masque/connect_udp.c` creates UDP sockets to forward proxied traffic. There is **no visible limit on the number of tunnels per connection or per",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/masque/connect_udp.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/masque/connect_udp.c:374-374"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"amp\" \"net/quic/tquic/masque/connect_udp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add per-connection and per-client tunnel limits (e.g., max 16 tunnels per connection)",
    "tests_to_add": [
      "Add regression test for: AMP-3: The MASQUE CONNECT-UDP tunnel implementation in `masque/connect_udp.c` creates UDP sockets to forward proxied traffic. There is **no visible limit on the number of tunnels per connection or per (net/quic/tquic/masque/connect_udp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-461",
    "fingerprint": "amplification-anti-check-has-race-toctou|net/tquic/tquic_migration.c|tquic_path_anti_amplification_sent|concurrency",
    "title": "Anti-Amplification Check Has TOCTOU Race",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path_anti_amplification_sent. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_anti_amplification_sent",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "received = atomic64_read(&path->anti_amplification.bytes_received);\nsent = atomic64_read(&path->anti_amplification.bytes_sent);\nlimit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;\nif (sent + bytes > limit) { return false; }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_anti_amplification_sent\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"anti\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Anti-Amplification Check Has TOCTOU Race (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-462",
    "fingerprint": "0x84-asn1_get_length-byte-handle-length|unknown_file|unknown_symbol|security",
    "title": "asn1_get_length Does Not Handle Length 0x84+ (4+ byte lengths)",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int asn1_get_length(const u8 *data, u32 data_len, u32 *len, u32 *hdr_len)\n{\n    ...\n    } else if (data[0] == 0x83) {\n        if (data_len < 4)\n            return -EINVAL;\n        *len = (data[1] << 16) | (data[2] << 8) | data[3];\n        *hdr_len = 4;\n    } else {\n        return -EINVAL;\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: asn1_get_length Does Not Handle Length 0x84+ (4+ byte lengths)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-463",
    "fingerprint": "coalesc-lin-overflow-packet-process-silently|unknown_file|tquic_input|other",
    "title": "Coalesced Packet Processing Silently Truncates on Overflow (tquic_input.c, lines 3172-3173)",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "if (offset + pkt_len > total_len)\n            pkt_len = total_len - offset;",
        "if (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Instead of silently truncating, reject the coalesced packet entirely when the claimed length exceeds remaining data:\n```c\nif (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */\n```",
    "tests_to_add": [
      "Add regression test for: Coalesced Packet Processing Silently Truncates on Overflow (tquic_input.c, lines 3172-3173)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-464",
    "fingerprint": "deadline-in_flight-scheduler-underflow|net/tquic/sched/deadline_aware.c|unknown_symbol|correctness",
    "title": "Deadline Scheduler in_flight Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/deadline_aware.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_aware.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/sched/deadline_aware.c:299-299"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"deadline\" \"net/tquic/sched/deadline_aware.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Deadline Scheduler in_flight Underflow', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Deadline Scheduler in_flight Underflow (net/tquic/sched/deadline_aware.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-465",
    "fingerprint": "congestion-data-division-safety-validation|net/tquic/cong/cong_data.c|tquic_cong_data_on_ack|concurrency",
    "title": "Division Safety in Congestion Data Validation",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/cong_data.c :: tquic_cong_data_on_ack. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_on_ack"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 vrtt = READ_ONCE(state->validated_rtt);\nif (vrtt > 0) {\n    rtt_ratio = (rtt_us * 100) / vrtt;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_data_on_ack\" \"net/tquic/cong/cong_data.c\"",
      "rg -n \"division\" \"net/tquic/cong/cong_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Division Safety in Congestion Data Validation (net/tquic/cong/cong_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-466",
    "fingerprint": "allocation-duplicate-ecf-path-race-state|net/tquic/multipath/sched_ecf.c|unknown_symbol|concurrency",
    "title": "Duplicate ECF Path State Allocation Race",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_ecf.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_ecf.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"duplicate\" \"net/tquic/multipath/sched_ecf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Duplicate ECF Path State Allocation Race (net/tquic/multipath/sched_ecf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-467",
    "fingerprint": "ecn-limitation-per-round-state-track|net/tquic/cong/tquic_cong.h|tquic_cong|correctness",
    "title": "ECN State Tracking Per-Round Limitation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/tquic_cong.h :: tquic_cong. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.h"
      ],
      "symbols": [
        "tquic_cong"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Severity disagreement across reports: S2, S3.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong\" \"net/tquic/cong/tquic_cong.h\"",
      "rg -n \"ecn\" \"net/tquic/cong/tquic_cong.h\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'ECN State Tracking Per-Round Limitation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: ECN State Tracking Per-Round Limitation (net/tquic/cong/tquic_cong.h)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-468",
    "fingerprint": "cast-h3_parse_settings_frame-pointer-u64|net/quic/tquic/http3/http3_frame.c|h3_parse_settings_frame|correctness",
    "title": "h3_parse_settings_frame u64 to Pointer Cast",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_frame.c :: h3_parse_settings_frame. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c"
      ],
      "symbols": [
        "h3_parse_settings_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "end = p->buf + frame_len;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"h3_parse_settings_frame\" \"net/quic/tquic/http3/http3_frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'h3_parse_settings_frame u64 to Pointer Cast', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: h3_parse_settings_frame u64 to Pointer Cast (net/quic/tquic/http3/http3_frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-469",
    "fingerprint": "bound-check-h3_parser_advance|net/quic/tquic/http3/http3_frame.h|h3_parser_advance|memory",
    "title": "h3_parser_advance Missing Bounds Check",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_frame.h :: h3_parser_advance. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.h"
      ],
      "symbols": [
        "h3_parser_advance"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"h3_parser_advance\" \"net/quic/tquic/http3/http3_frame.h\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: h3_parser_advance Missing Bounds Check (net/quic/tquic/http3/http3_frame.h)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-470",
    "fingerprint": "buffer-hmac-size-stack|net/tquic/cong/cong_data.c|tquic_cong_data_compute_hmac|memory",
    "title": "HMAC Stack Buffer Size",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/cong_data.c :: tquic_cong_data_compute_hmac. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_compute_hmac"
      ],
      "line_ranges": [],
      "snippets": [
        "size_t offset = 0;\n#define HMAC_APPEND(ptr, len) do {          \\\n    if (offset + (len) > sizeof(msg))       \\\n        return -EOVERFLOW;                  \\\n    memcpy(msg + offset, (ptr), (len));     \\\n    offset += (len);                        \\\n} while (0)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cong_data_compute_hmac\" \"net/tquic/cong/cong_data.c\"",
      "rg -n \"hmac\" \"net/tquic/cong/cong_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: HMAC Stack Buffer Size (net/tquic/cong/cong_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-471",
    "fingerprint": "arithmetic-calculation-flight-sign|net/tquic/bond/bonding.c|tquic_calc_path_quality|correctness",
    "title": "In-Flight Calculation Signed Arithmetic",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/bonding.c :: tquic_calc_path_quality. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "tquic_calc_path_quality"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 acked_and_lost = (u64)rx_bytes + (u64)lost_packets * 1200;\ns64 in_flight = (s64)tx_bytes - (s64)acked_and_lost;\nif (in_flight < 0) in_flight = 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_calc_path_quality\" \"net/tquic/bond/bonding.c\"",
      "rg -n \"flight\" \"net/tquic/bond/bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'In-Flight Calculation Signed Arithmetic', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: In-Flight Calculation Signed Arithmetic (net/tquic/bond/bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-472",
    "fingerprint": "1471-exce-ktime_get_ts64-line-size-skb|unknown_file|tquic_input|other",
    "title": "ktime_get_ts64 Written to skb->cb May Exceed cb Size (tquic_input.c, line 1471)",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Store receive timestamp in SKB cb */\n    ktime_get_ts64((struct timespec64 *)dgram_skb->cb);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use a typed union or dedicated struct for `skb->cb` usage, documented per frame type.\n\n---",
    "tests_to_add": [
      "Add regression test for: ktime_get_ts64 Written to skb->cb May Exceed cb Size (tquic_input.c, line 1471)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-473",
    "fingerprint": "between-encoder-lock-order-scheduler|net/tquic/fec/fec_scheduler.c|tquic_fec_should_send_repair|concurrency",
    "title": "Lock Ordering Between Encoder and Scheduler",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_scheduler.c :: tquic_fec_should_send_repair. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [
        "tquic_fec_should_send_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_fec_should_send_repair\" \"net/tquic/fec/fec_scheduler.c\"",
      "rg -n \"lock\" \"net/tquic/fec/fec_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Lock Ordering Between Encoder and Scheduler (net/tquic/fec/fec_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-474",
    "fingerprint": "cast-loss-overflow-rate|net/tquic/fec/fec_scheduler.c|update_loss_rate|correctness",
    "title": "Loss Rate Cast Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_scheduler.c :: update_loss_rate. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [
        "update_loss_rate"
      ],
      "line_ranges": [],
      "snippets": [
        "(int)new_rate - (int)sched->current_loss_rate",
        "s64 diff = (s64)new_rate - (s64)sched->current_loss_rate;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"update_loss_rate\" \"net/tquic/fec/fec_scheduler.c\"",
      "rg -n \"loss\" \"net/tquic/fec/fec_scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Loss Rate Cast Overflow', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Loss Rate Cast Overflow (net/tquic/fec/fec_scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-475",
    "fingerprint": "1136-605-allocate-bas-lin-mem|net/quic/tquic/tquic_handshake.c|tquic_handshake|security",
    "title": "MEM-1: `tquic_handshake.c` lines 605 and 1136 allocate skbs based on computed handshake message lengths (`ch_len`, `resp_len`). While these are internally computed (not directly from network), a malfo",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_handshake.c :: tquic_handshake. Category=security, severity=S2.\nEvidence union: 1 file(s), 5 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_handshake.c"
      ],
      "symbols": [
        "tquic_handshake"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_handshake.c:605-605",
        "net/quic/tquic/tquic_handshake.c:963-963",
        "net/quic/tquic/tquic_handshake.c:259-259",
        "net/quic/tquic/tquic_handshake.c:266-266",
        "net/quic/tquic/tquic_handshake.c:656-656"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_handshake\" \"net/quic/tquic/tquic_handshake.c\"",
      "rg -n \"mem\" \"net/quic/tquic/tquic_handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Enforce a hard cap on `ch_len` and `resp_len` (e.g., 16KB max for any single handshake message) / Add per-connection crypto buffer limit (e.g., 256KB per connection per PN space)",
    "tests_to_add": [
      "Add regression test for: MEM-1: `tquic_handshake.c` lines 605 and 1136 allocate skbs based on computed handshake message lengths (`ch_len`, `resp_len`). While these are internally computed (not directly from network), a malfo (net/quic/tquic/tquic_handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-476",
    "fingerprint": "lock-nest-reception-repair|net/tquic/fec/fec_decoder.c|tquic_fec_receive_repair|concurrency",
    "title": "Nested Locking in Repair Reception",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_decoder.c :: tquic_fec_receive_repair. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "tquic_fec_receive_repair"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_nested(&block->lock, SINGLE_DEPTH_NESTING);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_fec_receive_repair\" \"net/tquic/fec/fec_decoder.c\"",
      "rg -n \"nest\" \"net/tquic/fec/fec_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Nested Locking in Repair Reception (net/tquic/fec/fec_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-477",
    "fingerprint": "atomic_t-connection-creation-path-path_id-per|net/tquic/tquic_migration.c|tquic_migration|concurrency",
    "title": "Path Creation Uses static atomic_t for path_id -- Not Per-Connection",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_migration. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [
        "static atomic_t path_id_gen = ATOMIC_INIT(0);\npath->path_id = atomic_inc_return(&path_id_gen);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_migration\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"path\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Path Creation Uses static atomic_t for path_id -- Not Per-Connection (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-478",
    "fingerprint": "access-discover_address-hold-inet6_dev-manager-path|net/tquic/pm/path_manager.c|rtnl_lock|concurrency",
    "title": "Path Manager discover_addresses Holds rtnl_lock While Accessing inet6_dev",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/pm/path_manager.c :: rtnl_lock. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [
        "rtnl_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"rtnl_lock\" \"net/tquic/pm/path_manager.c\"",
      "rg -n \"path\" \"net/tquic/pm/path_manager.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Path Manager discover_addresses Holds rtnl_lock While Accessing inet6_dev (net/tquic/pm/path_manager.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-479",
    "fingerprint": "limit-priority-state-stream_count|net/quic/tquic/http3/http3_priority.c|unknown_symbol|api",
    "title": "Priority State No Limit on stream_count",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_priority.c :: unknown_symbol. Category=api, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"priority\" \"net/quic/tquic/http3/http3_priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Priority State No Limit on stream_count', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Priority State No Limit on stream_count (net/quic/tquic/http3/http3_priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-480",
    "fingerprint": "count-entry-iteration-push|net/quic/tquic/http3/http3_conn.c|unknown_symbol|concurrency",
    "title": "Push Entry Count O(n) Iteration",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_conn.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_conn.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"push\" \"net/quic/tquic/http3/http3_conn.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Push Entry Count O(n) Iteration (net/quic/tquic/http3/http3_conn.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-481",
    "fingerprint": "alignment-buffer-reorder-sequence-skb|net/tquic/bond/bonding.c|put_unaligned|correctness",
    "title": "Reorder Buffer Sequence in skb->cb Alignment",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/bonding.c :: put_unaligned. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "put_unaligned",
        "tquic_skb_cb",
        "tquic_bond_reorder_insert",
        "get_unaligned",
        "overlay"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_skb_cb {\n    u64 sequence;\n    /* other fields */\n};\n#define TQUIC_SKB_CB(skb) ((struct tquic_skb_cb *)(skb)->cb)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"put_unaligned\" \"net/tquic/bond/bonding.c\"",
      "rg -n \"reorder\" \"net/tquic/bond/bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Reorder Buffer Sequence in skb->cb Alignment', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Reorder Buffer Sequence in skb->cb Alignment (net/tquic/bond/bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-482",
    "fingerprint": "debug-kernel-leak-logg-pointer-sch|net/tquic/sched/scheduler.c|tquic_sched_default|correctness",
    "title": "sched/scheduler.c Debug Logging Leaks Kernel Pointers",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/scheduler.c :: tquic_sched_default. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [
        "tquic_sched_default",
        "tquic_sched_init_conn",
        "pr_warn",
        "tquic_sched"
      ],
      "line_ranges": [],
      "snippets": [
        "pr_warn(\"tquic_sched: default_scheduler='%s' owner=%px\\n\",\n        ops->name, ops->owner);\npr_warn(\"tquic_sched: init_conn called, ops=%px conn=%px\\n\", ops, conn);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_sched_default\" \"net/tquic/sched/scheduler.c\"",
      "rg -n \"sch\" \"net/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'sched/scheduler.c Debug Logging Leaks Kernel Pointers', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: sched/scheduler.c Debug Logging Leaks Kernel Pointers (net/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-483",
    "fingerprint": "division-ecf-loss-rate-sch-scheduler|net/tquic/sched/scheduler.c|unknown_symbol|correctness",
    "title": "sched/scheduler.c ECF Loss Rate Division by Zero",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/scheduler.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sch\" \"net/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'sched/scheduler.c ECF Loss Rate Division by Zero', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: sched/scheduler.c ECF Loss Rate Division by Zero (net/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-484",
    "fingerprint": "array-caller-lost-modifi-packet-sort|net/tquic/cong/persistent_cong.c|tquic_lost_packet|correctness",
    "title": "Sort Modifies Caller's Lost Packets Array",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/persistent_cong.c :: tquic_lost_packet. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/persistent_cong.c"
      ],
      "symbols": [
        "tquic_lost_packet",
        "tquic_check_persistent_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_lost_packet *sorted;\nsorted = kmemdup(lost_packets, count * sizeof(*sorted), GFP_ATOMIC);\nif (!sorted) return false;\nsort(sorted, count, sizeof(*sorted), cmp_lost_pkt, NULL);\n/* ... use sorted ... */\nkfree(sorted);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_lost_packet\" \"net/tquic/cong/persistent_cong.c\"",
      "rg -n \"sort\" \"net/tquic/cong/persistent_cong.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Sort Modifies Caller's Lost Packets Array', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Sort Modifies Caller's Lost Packets Array (net/tquic/cong/persistent_cong.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-485",
    "fingerprint": "appear-attack-mode-reactive-state-tquic_rl_cookie_requir|net/quic/tquic/rate_limit.c|unknown_symbol|security",
    "title": "STATE-1: The transition to \"attack mode\" (TQUIC_RL_COOKIE_REQUIRED) appears to be reactive -- it triggers when rate limits are exceeded. During the ramp-up period before attack mode activates, an atta",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/rate_limit.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 2 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/rate_limit.c",
        "net/quic/tquic/tquic_ratelimit.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"state\" \"net/quic/tquic/rate_limit.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Consider proactive cookie validation when pre-handshake memory exceeds 50% of budget, independent of rate limit triggers",
    "tests_to_add": [
      "Add regression test for: STATE-1: The transition to \"attack mode\" (TQUIC_RL_COOKIE_REQUIRED) appears to be reactive -- it triggers when rate limits are exceeded. During the ramp-up period before attack mode activates, an atta (net/quic/tquic/rate_limit.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-486",
    "fingerprint": "acquir-drop-lin-lock-packet-per|unknown_file|tquic_gro_flush|other",
    "title": "tquic_gro_flush Drops and Re-acquires Lock Per Packet (tquic_input.c, lines 2303-2310)",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_gro_flush. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_gro_flush",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n        spin_unlock(&gro->lock);\n        deliver(skb);\n        flushed++;\n        spin_lock(&gro->lock);\n    }\n\n    gro->held_count = 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "After the loop, set `held_count = skb_queue_len(&gro->hold_queue)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_gro_flush Drops and Re-acquires Lock Per Packet (tquic_input.c, lines 2303-2310)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-487",
    "fingerprint": "cleanup-conditional-exit-init-io_ur-mismatch|net/quic/tquic/tquic_main.c|tquic_napi_subsys_exit|api",
    "title": "tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_main.c :: tquic_napi_subsys_exit. Category=api, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [
        "tquic_napi_subsys_exit",
        "tquic_io_uring_init",
        "tquic_server_exit",
        "tquic_napi_subsys_init",
        "tquic_io_uring_exit",
        "tquic_main"
      ],
      "line_ranges": [],
      "snippets": [
        "// Init:\n#if IS_ENABLED(CONFIG_TQUIC_NAPI)\n    err = tquic_napi_subsys_init();\n    if (err)\n        goto err_napi;\n#endif\n\n#if IS_ENABLED(CONFIG_TQUIC_IO_URING)\n    err = tquic_io_uring_init();\n    if (err)\n        goto err_io_uring;\n#endif\n\n// Error path:\nerr_netlink:\n#if IS_ENABLED(CONFIG_TQUIC_IO"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_napi_subsys_exit\" \"net/quic/tquic/tquic_main.c\"",
      "rg -n \"tquic_main\" \"net/quic/tquic/tquic_main.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring (net/quic/tquic/tquic_main.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-488",
    "fingerprint": "cleanup-conditional-exit-init-io_ur-mismatch|err_netlink:|tquic_main|other",
    "title": "tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: err_netlink: :: tquic_main. Category=other, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "err_netlink:"
      ],
      "symbols": [
        "tquic_main"
      ],
      "line_ranges": [],
      "snippets": [
        "// Init:\n#if IS_ENABLED(CONFIG_TQUIC_NAPI)\n    err = tquic_napi_subsys_init();\n    if (err)\n        goto err_napi;\n#endif\n\n#if IS_ENABLED(CONFIG_TQUIC_IO_URING)\n    err = tquic_io_uring_init();\n    if (err)\n        goto err_io_uring;\n#endif\n\n// Error path:\nerr_netlink:\n#if IS_ENABLED(CONFIG_TQUIC_IO_URING)\n    tquic_io_uring_exit();\nerr_io_uring:\n#endif\n#if IS_ENABLED(CONFIG_TQUIC_NAPI)\n    tquic_napi_subsys_exit();\nerr_napi:\n#endif"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_main\" \"err_netlink:\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring (err_netlink:)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-489",
    "fingerprint": "2706-forever-lin-loop-pressure-signal|unknown_file|tquic_recv_datagram|other",
    "title": "tquic_recv_datagram Can Loop Forever Under Signal Pressure (tquic_output.c, lines 2706-2743)",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_recv_datagram. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_recv_datagram",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "retry:\n    spin_lock_irqsave(&conn->datagram.lock, irqflags);\n    skb = skb_peek(&conn->datagram.recv_queue);\n    if (!skb) {\n        spin_unlock_irqrestore(&conn->datagram.lock, irqflags);\n        if (flags & MSG_DONTWAIT)\n            return -EAGAIN;\n        if (timeo == 0)\n            return -EAGAIN;\n        if (signal_pending(current))\n            return sock_intr_errno(timeo);\n        ret = tquic_datagram_wait_data(conn, &timeo);\n        if (ret < 0) { ... return ... }\n        if (conn->state != TQUIC_CONN_CONNECTED ...) return -ENOTCONN;\n        goto retry;\n    }",
        "int retries = 0;\n...\nretry:\n    if (++retries > 3) return -EAGAIN;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add a retry counter to prevent excessive looping:\n```c\nint retries = 0;\n...",
    "tests_to_add": [
      "Add regression test for: tquic_recv_datagram Can Loop Forever Under Signal Pressure (tquic_output.c, lines 2706-2743)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-490",
    "fingerprint": "decode-encode-implementation-triplicat-varint|net/quic/tquic/http3/http3_frame.c|unknown_symbol|correctness",
    "title": "Triplicated Varint Encode/Decode Implementations",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_frame.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 3 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/http3/http3_request.c",
        "net/quic/tquic/http3/http3_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"triplicat\" \"net/quic/tquic/http3/http3_frame.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Triplicated Varint Encode/Decode Implementations', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Triplicated Varint Encode/Decode Implementations (net/quic/tquic/http3/http3_frame.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-491",
    "fingerprint": "add-cancel-forward_work-tproxy-tquic_tunnel_close-tunnel|net/tquic/tquic_tunnel.c|tquic_tunnel_create_tproxy|memory",
    "title": "UAF-ADD-01: - tquic_tunnel_close does not cancel forward_work for tproxy tunnels",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_tunnel.c :: tquic_tunnel_create_tproxy. Category=memory, severity=S2.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "tquic_tunnel_create_tproxy",
        "tquic_tunnel_close",
        "tquic_tunnel"
      ],
      "line_ranges": [
        "net/tquic/tquic_tunnel.c:592-592"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_tunnel_create_tproxy\" \"net/tquic/tquic_tunnel.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_tunnel.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-ADD-01: - tquic_tunnel_close does not cancel forward_work for tproxy tunnels (net/tquic/tquic_tunnel.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-492",
    "fingerprint": "fire-flush_timer-gro-kfree-useafterfree|net/tquic/tquic_input.c|hrtimer_cancel|memory",
    "title": "UAF-P3-05: - GRO flush_timer can fire after kfree",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: hrtimer_cancel. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "hrtimer_cancel",
        "tquic_gro_state",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_gro_cleanup(struct tquic_gro_state *gro)\n{\n    if (!gro)\n        return;\n\n    hrtimer_cancel(&gro->flush_timer);\n    skb_queue_purge(&gro->hold_queue);\n    kfree(gro);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"hrtimer_cancel\" \"net/tquic/tquic_input.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P3-05: - GRO flush_timer can fire after kfree (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-493",
    "fingerprint": "connection-destruction-double-path-useafterfree|net/tquic/tquic_proto.c|tquic_net_close_all_connections|memory",
    "title": "UAF-P4-03: - Double destruction path for connections",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_proto.c :: tquic_net_close_all_connections. Category=memory, severity=S2.\nEvidence union: 2 file(s), 3 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_proto.c",
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_net_close_all_connections",
        "tquic_conn_destroy",
        "tquic_destroy_sock",
        "tquic_conn_put",
        "tquic_socket",
        "tquic_proto"
      ],
      "line_ranges": [
        "net/tquic/tquic_proto.c:171-171",
        "net/tquic/tquic_proto.c:1082-1160",
        "net/tquic/tquic_proto.c:1073-1073"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_net_close_all_connections\" \"net/tquic/tquic_proto.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_proto.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P4-03: - Double destruction path for connections (net/tquic/tquic_proto.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-494",
    "fingerprint": "correct-rcu-tquic_nf-usage-useafterfree|net/tquic/tquic_nf.c|call_rcu|memory",
    "title": "UAF-P5-01: - Correct RCU usage in tquic_nf.c",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_nf.c :: call_rcu. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_nf.c"
      ],
      "symbols": [
        "call_rcu",
        "hash_for_each_possible_rcu",
        "tquic_nf_conn",
        "rcu_read_lock",
        "tquic_nf"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_nf_conn_put(struct tquic_nf_conn *conn)\n{\n    if (refcount_dec_and_test(&conn->refcnt)) {\n        atomic64_dec(&tquic_nf_conn_count);\n        call_rcu(&conn->rcu, tquic_nf_conn_free_rcu);\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"call_rcu\" \"net/tquic/tquic_nf.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_nf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P5-01: - Correct RCU usage in tquic_nf.c (net/tquic/tquic_nf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-495",
    "fingerprint": "callback-chain-tquic_zerocopy_complete-useafterfree|net/tquic/tquic_zerocopy.c|sk_buff|memory",
    "title": "UAF-P6-02: - tquic_zerocopy_complete callback chain",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_zerocopy.c :: sk_buff. Category=memory, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "sk_buff",
        "ubuf_info",
        "tquic_zerocopy_complete",
        "tquic_zerocopy"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_zerocopy_complete(struct sk_buff *skb,\n                                   struct ubuf_info *uarg,\n                                   bool success)\n{\n    if (uarg && uarg->ops && uarg->ops->complete)\n        uarg->ops->complete(skb, uarg, success);\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"sk_buff\" \"net/tquic/tquic_zerocopy.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_zerocopy.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-P6-02: - tquic_zerocopy_complete callback chain (net/tquic/tquic_zerocopy.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-496",
    "fingerprint": "473-limit-lin-logg-negotiation-rate|unknown_file|tquic_input|other",
    "title": "Version Negotiation Versions Logged Without Rate Limiting (tquic_input.c, lines 473-477)",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_input. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i + 4 <= versions_len; i += 4) {\n        u32 version = ...;\n        tquic_dbg(\"  version 0x%08x\\n\", version);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Either remove the per-version debug line or cap the number of logged versions.\n\n---",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Versions Logged Without Rate Limiting (tquic_input.c, lines 473-477)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-497",
    "fingerprint": "anti-check-datagram-double-lock-pattern|net/quic/tquic/http3/webtransport.c|unknown_symbol|concurrency",
    "title": "WebTransport Datagram Queue Double-Checked Locking Anti-Pattern",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/webtransport.c :: unknown_symbol. Category=concurrency, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"webtransport\" \"net/quic/tquic/http3/webtransport.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: WebTransport Datagram Queue Double-Checked Locking Anti-Pattern (net/quic/tquic/http3/webtransport.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-498",
    "fingerprint": "scheduler-validat-weight|net/tquic/multipath/sched_weighted.c|unknown_symbol|correctness",
    "title": "Weighted Scheduler Weight Not Validated",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_weighted.c :: unknown_symbol. Category=correctness, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"weight\" \"net/tquic/multipath/sched_weighted.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Weighted Scheduler Weight Not Validated', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Weighted Scheduler Weight Not Validated (net/tquic/multipath/sched_weighted.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-499",
    "fingerprint": "capable-xdp|net/tquic/af_xdp.c|unknown_symbol|security",
    "title": "XDP Uses capable",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/af_xdp.c :: unknown_symbol. Category=security, severity=S2.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (!capable(CAP_NET_ADMIN))\n    return -EPERM;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"xdp\" \"net/tquic/af_xdp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: XDP Uses capable (net/tquic/af_xdp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-500",
    "fingerprint": "capable-instead-ns_capable-xdp|unknown_file|unknown_symbol|other",
    "title": "XDP Uses capable() Instead of ns_capable()",
    "category": "other",
    "severity": "S2",
    "confidence": "medium",
    "priority_score": 2.8,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S2.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (!capable(CAP_NET_ADMIN))\n    return -EPERM;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S2 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'XDP Uses capable() Instead of ns_capable()', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: XDP Uses capable() Instead of ns_capable()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-501",
    "fingerprint": "allocat-batch-buffer-crypto-packet-per|net/tquic/crypto/hw_offload.c|tquic_crypto_batch_encrypt|perf",
    "title": "Batch Crypto Allocates Per-Packet Temporary Buffer",
    "category": "perf",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/hw_offload.c :: tquic_crypto_batch_encrypt. Category=perf, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [
        "tquic_crypto_batch_encrypt"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, perf, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_crypto_batch_encrypt\" \"net/tquic/crypto/hw_offload.c\"",
      "rg -n \"batch\" \"net/tquic/crypto/hw_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Perform in-place encryption if the caller's buffer has sufficient space (the `data_buf_len` check already exists), or pre-allocate a shared temporary buffer.",
    "tests_to_add": [
      "Add regression test for: Batch Crypto Allocates Per-Packet Temporary Buffer (net/tquic/crypto/hw_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-502",
    "fingerprint": "certificate-chain-check-late-length-limit|net/tquic/crypto/cert_verify.c|csprng|security",
    "title": "Certificate Chain Length Limit Checked Late",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: csprng. Category=security, severity=S3.\nEvidence union: 17 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c",
        "net/tquic/crypto/cert_verify.h",
        "net/tquic/crypto/handshake.c",
        "net/tquic/tquic_stateless_reset.c",
        "net/tquic/crypto/zero_rtt.h",
        "net/tquic/crypto/header_protection.c",
        "net/tquic/crypto/crypto_module.c",
        "net/tquic/core/quic_crypto.c",
        "net/tquic/crypto/key_update.h",
        "net/tquic/crypto/key_update.c",
        "net/tquic/crypto/tls.c",
        "net/tquic/crypto/hw_offload.c",
        "net/tquic/crypto/extended_key_update.h",
        "net/tquic/crypto/zero_rtt.c",
        "net/tquic/crypto/hw_offload.h",
        "net/tquic/tquic_token.c",
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "csprng",
        "check",
        "comparisons",
        "crypto_memneq",
        "get_random_bytes",
        "limits",
        "memzero_explicit",
        "record",
        "reviewed",
        "tquic_zero_rtt_decrypt",
        "tquic_verify_cert_chain"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"csprng\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"certificate\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Move the chain length check to the beginning of the loop iteration.",
    "tests_to_add": [
      "Add regression test for: Certificate Chain Length Limit Checked Late (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-503",
    "fingerprint": "duplicate-module_description-quic_exfil|net/tquic/security/quic_exfil.c|module_author|security",
    "title": "Duplicate MODULE_DESCRIPTION in quic_exfil.c",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 5 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: module_author. Category=security, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "module_author",
        "module_description",
        "module_license",
        "mitigation",
        "none",
        "quic_exfil"
      ],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:1684-1686"
      ],
      "snippets": [
        "MODULE_DESCRIPTION(\"TQUIC QUIC-Exfil Mitigation (draft-iab-quic-exfil)\");\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Linux Foundation\");"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: build, other, security."
    ],
    "verification_commands": [
      "rg -n \"module_author\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"duplicate\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text.",
    "tests_to_add": [
      "Add regression test for: Duplicate MODULE_DESCRIPTION in quic_exfil.c (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-504",
    "fingerprint": "decode-duplicate-function-h3_varint_encode-static|net/tquic/http3/http3_request.c|h3_varint_decode|correctness",
    "title": "Duplicate Static Functions: h3_varint_encode/decode",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_request.c :: h3_varint_decode. Category=correctness, severity=S3.\nEvidence union: 2 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_request.c",
        "net/tquic/http3/http3_request.c`, `http3_stream.c"
      ],
      "symbols": [
        "h3_varint_decode",
        "h3_varint_encode",
        "helper"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"h3_varint_decode\" \"net/tquic/http3/http3_request.c\"",
      "rg -n \"duplicate\" \"net/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Move to a shared helper (e.g., in `http3_frame.c` or a common header as inline functions).",
    "tests_to_add": [
      "Add regression test for: Duplicate Static Functions: h3_varint_encode/decode (net/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-505",
    "fingerprint": "http-initializ-priority-push_bucket|net/tquic/http3/http3_priority.c|unknown_symbol|correctness",
    "title": "HTTP/3 Priority: push_buckets Not Initialized",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/http3/http3_priority.c :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other, perf."
    ],
    "verification_commands": [
      "rg -n \"http\" \"net/tquic/http3/http3_priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Explicitly initialize `push_buckets[]` in the priority init function for defensive coding.",
    "tests_to_add": [
      "Add regression test for: HTTP/3 Priority: push_buckets Not Initialized (net/tquic/http3/http3_priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-506",
    "fingerprint": "concurrent-key-race-revert-timeout-update|net/tquic/crypto/key_update.c|inconsistent|concurrency",
    "title": "Key Update Timeout Revert Could Race With Concurrent Update",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: inconsistent. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "inconsistent",
        "mechanism"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"inconsistent\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"key\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a generation counter or sequence number to the key update so the timeout handler can detect if a response arrived between the timeout firing and the lock acquisition.",
    "tests_to_add": [
      "Add regression test for: Key Update Timeout Revert Could Race With Concurrent Update (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-507",
    "fingerprint": "balancer-buffer-error-feistel-load-stack|net/tquic/lb/quic_lb.c|memzero_explicit|security",
    "title": "Load Balancer Stack Buffers for Feistel Not Zeroized on Error",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/lb/quic_lb.c :: memzero_explicit. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "memzero_explicit",
        "tquic_lb_decrypt_four_pass",
        "tquic_lb_encrypt_four_pass"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"memzero_explicit\" \"net/tquic/lb/quic_lb.c\"",
      "rg -n \"load\" \"net/tquic/lb/quic_lb.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Add `memzero_explicit()` calls in error paths and at function exit. / Add `memzero_explicit()` calls in error paths and at function exit.\n\n---",
    "tests_to_add": [
      "Add regression test for: Load Balancer Stack Buffers for Feistel Not Zeroized on Error (net/tquic/lb/quic_lb.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-508",
    "fingerprint": "configuration-expose-module-parameter-security|net/tquic/crypto/cert_verify.c|tquic_cert_verify_mode|security",
    "title": "Module Parameters Expose Security Configuration",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: tquic_cert_verify_mode. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_cert_verify_mode",
        "tquic_cert_revocation_mode",
        "tquic_cert_verify_mo"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_cert_verify_mode\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"module\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Log a prominent warning when verification mode is set to NONE. Consider requiring a special flag to disable verification in production builds.",
    "tests_to_add": [
      "Add regression test for: Module Parameters Expose Security Configuration (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-509",
    "fingerprint": "event-include-netlink-timestamp|net/tquic/tquic_netlink.c|unknown_symbol|security",
    "title": "Netlink Events Do Not Include Timestamp",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"netlink\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text.",
    "tests_to_add": [
      "Add regression test for: Netlink Events Do Not Include Timestamp (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-510",
    "fingerprint": "export-export_symbol_gpl-family-netlink|net/tquic/tquic_netlink.c|export_symbol_gpl|memory",
    "title": "Netlink Family Exported as EXPORT_SYMBOL_GPL",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: export_symbol_gpl. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "export_symbol_gpl",
        "bypass"
      ],
      "line_ranges": [],
      "snippets": [
        "EXPORT_SYMBOL_GPL(tquic_genl_family);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory, security."
    ],
    "verification_commands": [
      "rg -n \"export_symbol_gpl\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"netlink\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Export only the specific notification helper functions, not the family structure itself.",
    "tests_to_add": [
      "Add regression test for: Netlink Family Exported as EXPORT_SYMBOL_GPL (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-511",
    "fingerprint": "against-bit-cpu-per-protect-read|net/tquic/crypto/hw_offload.c|read_once|security",
    "title": "Per-CPU Stats Not Protected Against Torn Reads on 32-bit",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/hw_offload.c :: read_once. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [
        "read_once",
        "tquic_crypto_get_stats"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"read_once\" \"net/tquic/crypto/hw_offload.c\"",
      "rg -n \"per\" \"net/tquic/crypto/hw_offload.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `u64_stats_sync` infrastructure for proper 64-bit stats on 32-bit architectures.",
    "tests_to_add": [
      "Add regression test for: Per-CPU Stats Not Protected Against Torn Reads on 32-bit (net/tquic/crypto/hw_offload.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-512",
    "fingerprint": "capability-check-file-procf-trusted_ca-writable|net/tquic/crypto/cert_verify.c|capable|security",
    "title": "Procfs trusted_cas File Writable Without Capability Check",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: capable. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "capable",
        "check",
        "tquic_proc_trusted_cas_write",
        "tquic_cert"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"capable\" \"net/tquic/crypto/cert_verify.c\"",
      "rg -n \"procf\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `capable(CAP_NET_ADMIN)` check at the start of `tquic_proc_trusted_cas_write()`.",
    "tests_to_add": [
      "Add regression test for: Procfs trusted_cas File Writable Without Capability Check (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-513",
    "fingerprint": "around-copy_to_user-drop-lock-qlog|net/tquic/diag/qlog.c|behavior|concurrency",
    "title": "Qlog: Lock Drop Around copy_to_user",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/diag/qlog.c :: behavior. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [
        "behavior",
        "copy_to_user"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"behavior\" \"net/tquic/diag/qlog.c\"",
      "rg -n \"qlog\" \"net/tquic/diag/qlog.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Copy the entry to a local kernel buffer under the lock, then `copy_to_user` from the local buffer.",
    "tests_to_add": [
      "Add regression test for: Qlog: Lock Drop Around copy_to_user (net/tquic/diag/qlog.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-514",
    "fingerprint": "expand-extend-hkdf-key-output-unus|net/tquic/crypto/extended_key_update.c|tquic_eku_derive_keys|security",
    "title": "Unused HKDF-Expand Output in Extended Key Update",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/crypto/extended_key_update.c :: tquic_eku_derive_keys. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "tquic_eku_derive_keys"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_eku_derive_keys\" \"net/tquic/crypto/extended_key_update.c\"",
      "rg -n \"unus\" \"net/tquic/crypto/extended_key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Actually use the `mixed_secret` as input to the subsequent key derivation rather than the standard derivation path.",
    "tests_to_add": [
      "Add regression test for: Unused HKDF-Expand Output in Extended Key Update (net/tquic/crypto/extended_key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-515",
    "fingerprint": "constant-function-insufficient-qualifier-time-volatile|net/tquic/security/quic_exfil.c|crypto_memneq|security",
    "title": "Volatile Qualifiers in Constant-Time Functions May Be Insufficient",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) A, B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: crypto_memneq. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [
        "const volatile unsigned char *aa = a;\nconst volatile unsigned char *bb = b;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 3,
      "sources": [
        "A",
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"volatile\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text. / Use `crypto_memneq()` from `<crypto/algapi.h>` instead of a custom implementation. / Use `crypto_memneq()` from `<crypto/algapi.h>` instead of a custom implementation.\n\n---",
    "tests_to_add": [
      "Add regression test for: Volatile Qualifiers in Constant-Time Functions May Be Insufficient (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-516",
    "fingerprint": "connection-established_time-machine-set-state-twice|net/tquic/core/connection.c|ktime_get|correctness",
    "title": "`established_time` Set Twice in Connection State Machine",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: ktime_get. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "ktime_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"ktime_get\" \"net/tquic/core/connection.c\"",
      "rg -n \"established_time\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Only set it in CONNECTED, or rename the CONNECTING one to `handshake_start_time`.",
    "tests_to_add": [
      "Add regression test for: `established_time` Set Twice in Connection State Machine (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-517",
    "fingerprint": "code-error-negative-ret-sk_err-stor|net/tquic/tquic_socket.c|tquic_socket|correctness",
    "title": "`sk->sk_err = -ret` Stores Negative Error Code",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_socket. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "sk->sk_err = -ret;  /* Store error for getsockopt */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_socket\" \"net/tquic/tquic_socket.c\"",
      "rg -n \"sk_err\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a comment: `/* ret is negative errno, sk_err needs positive */`",
    "tests_to_add": [
      "Add regression test for: `sk->sk_err = -ret` Stores Negative Error Code (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-518",
    "fingerprint": "__maybe_unus-mark-tquic_cid_compare|net/tquic/core/connection.c|tquic_cid_compare|correctness",
    "title": "`tquic_cid_compare()` Marked `__maybe_unused`",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_cid_compare. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid_compare"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid_compare\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Remove if truly unused, or remove the `__maybe_unused` annotation.",
    "tests_to_add": [
      "Add regression test for: `tquic_cid_compare()` Marked `__maybe_unused` (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-519",
    "fingerprint": "retire_connection_id-retirement-send-tquic_cid_retire|net/tquic/tquic_cid.c|release_sock|correctness",
    "title": "`tquic_cid_retire()` Sends RETIRE_CONNECTION_ID After Retirement",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_cid.c :: release_sock. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "release_sock",
        "atomic64_cmpxchg",
        "tquic_migration_cleanup",
        "tquic_path_create",
        "rcu_read_lock",
        "lock_sock",
        "tquic_send_retire_connection_id",
        "tquic_cid_retire",
        "rcu_read_unlock",
        "tquic_conn_get_session_state",
        "tquic_cid"
      ],
      "line_ranges": [
        "net/tquic/tquic_cid.c:516-516"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"release_sock\" \"net/tquic/tquic_cid.c\"",
      "rg -n \"tquic_cid_retire\" \"net/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_cid_retire()` Sends RETIRE_CONNECTION_ID After Retirement', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_cid_retire()` Sends RETIRE_CONNECTION_ID After Retirement (net/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-520",
    "fingerprint": "bound-cid-hex-loop-tquic_debug|net/quic/tquic/tquic_debug.c|tquic_debug|correctness",
    "title": "`tquic_debug.c` CID Hex Loop Bound",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_debug.c :: tquic_debug. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_debug.c"
      ],
      "symbols": [
        "tquic_debug"
      ],
      "line_ranges": [],
      "snippets": [
        "for (i = conn->scid.len * 2; i < 34; i++)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_debug\" \"net/quic/tquic/tquic_debug.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_debug.c` CID Hex Loop Bound', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_debug.c` CID Hex Loop Bound (net/quic/tquic/tquic_debug.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-521",
    "fingerprint": "exporter_secret-resumption_secret-tquic_hs_cleanup-zeroize|net/tquic/crypto/handshake.c|tquic_hs_cleanup|security",
    "title": "`tquic_hs_cleanup` -- does not zeroize exporter_secret and resumption_secret",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_cleanup. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_cleanup"
      ],
      "line_ranges": [],
      "snippets": [
        "memzero_explicit(hs->early_secret, sizeof(hs->early_secret));\n    memzero_explicit(hs->handshake_secret, sizeof(hs->handshake_secret));\n    memzero_explicit(hs->master_secret, sizeof(hs->master_secret));\n    // ... other secrets ...\n    memzero_explicit(hs->shared_secret, sizeof(hs->shared_secret));"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_cleanup\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `memzero_explicit` calls for all remaining sensitive fields.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_cleanup` -- does not zeroize exporter_secret and resumption_secret (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-522",
    "fingerprint": "all-check-client-random-tquic_hs_generate_client_hello-zero|net/tquic/crypto/handshake.c|get_random_bytes|security",
    "title": "`tquic_hs_generate_client_hello` -- client random not checked for all-zero",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: get_random_bytes. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "get_random_bytes",
        "tquic_hs_generate_client_hello"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"get_random_bytes\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_generate_client_hello\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_generate_client_hello` -- client random not checked for all-zero (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-523",
    "fingerprint": "buffer-output-size-tquic_hs_get_app_secret-tquic_hs_get_handshake_secret-validation|net/tquic/crypto/handshake.c|tquic_hs_get_handshake_secrets|security",
    "title": "`tquic_hs_get_handshake_secrets` and `tquic_hs_get_app_secrets` -- no output buffer size validation",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_get_handshake_secrets. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_get_handshake_secrets",
        "tquic_hs_get_app_secrets"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_get_handshake_secrets\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_get_handshake_secret\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Document the minimum buffer size requirement or add a `buf_len` parameter.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_get_handshake_secrets` and `tquic_hs_get_app_secrets` -- no output buffer size validation (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-524",
    "fingerprint": "certificateverify-hardcod-server-str-tquic_hs_process_certificate_verify|net/tquic/crypto/handshake.c|tquic_hs_process_certificate_verify|security",
    "title": "`tquic_hs_process_certificate_verify` hardcodes \"server CertificateVerify\" string",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: tquic_hs_process_certificate_verify. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_process_certificate_verify"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hs_process_certificate_verify\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use `hs->is_server ? \"TLS 1.3, client CertificateVerify\" : \"TLS 1.3, server CertificateVerify\"`.\n\n---",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_certificate_verify` hardcodes \"server CertificateVerify\" string (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-525",
    "fingerprint": "extension-ignor-tquic_hs_process_new_session_ticket|net/tquic/crypto/handshake.c|crypto_memneq|security",
    "title": "`tquic_hs_process_new_session_ticket` -- ignores extensions",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/handshake.c :: crypto_memneq. Category=security, severity=S3.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "crypto_memneq",
        "kfree_sensitive",
        "memzero_explicit",
        "tquic_hs_cleanup",
        "tquic_hs_process_new_session_ticket"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1076-1253",
        "net/tquic/crypto/handshake.c:735-809",
        "net/tquic/crypto/handshake.c:1258-1380",
        "net/tquic/crypto/handshake.c:1206-1244",
        "net/tquic/crypto/handshake.c:1769-1807"
      ],
      "snippets": [
        "/* Parse extensions (early_data max size, etc.) */\n    /* Skip for now */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"net/tquic/crypto/handshake.c\"",
      "rg -n \"tquic_hs_process_new_session_ticket\" \"net/tquic/crypto/handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `tquic_hs_process_new_session_ticket` -- ignores extensions (net/tquic/crypto/handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-526",
    "fingerprint": "goto-pattern-restart-tquic_server_check_path_recovery|net/tquic/tquic_migration.c|tquic_path_start_validation|concurrency",
    "title": "`tquic_server_check_path_recovery()` Uses `goto restart` Pattern",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_migration.c :: tquic_path_start_validation. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_start_validation",
        "tquic_server_check_path_recovery",
        "tquic_migration"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_path_start_validation\" \"net/tquic/tquic_migration.c\"",
      "rg -n \"tquic_server_check_path_recovery\" \"net/tquic/tquic_migration.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_server_check_path_recovery()` Uses `goto restart` Pattern (net/tquic/tquic_migration.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-527",
    "fingerprint": "alpn-parameter-store-tquic_store_session_ticket-transport|net/tquic/tquic_handshake.c|tquic_store_session_ticket|correctness",
    "title": "`tquic_store_session_ticket()` Does Not Store ALPN or Transport Parameters",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_handshake.c :: tquic_store_session_ticket. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_handshake.c"
      ],
      "symbols": [
        "tquic_store_session_ticket",
        "tquic_validate_zero_rtt_transport_params",
        "tquic_handshake"
      ],
      "line_ranges": [],
      "snippets": [
        "plaintext.alpn_len = 0;\nplaintext.transport_params_len = 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_store_session_ticket\" \"net/tquic/tquic_handshake.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Populate `plaintext.alpn` and `plaintext.transport_params` from the connection state when storing session tickets.",
    "tests_to_add": [
      "Add regression test for: `tquic_store_session_ticket()` Does Not Store ALPN or Transport Parameters (net/tquic/tquic_handshake.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-528",
    "fingerprint": "declar-function-header-tquic_sysctl_prefer_v2-visible|net/tquic/core/connection.c|tquic_sysctl_prefer_v2|correctness",
    "title": "`tquic_sysctl_prefer_v2()` Function Not Declared in Visible Header",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: tquic_sysctl_prefer_v2. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_sysctl_prefer_v2"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_sysctl_prefer_v2\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a proper declaration in a shared header file.",
    "tests_to_add": [
      "Add regression test for: `tquic_sysctl_prefer_v2()` Function Not Declared in Visible Header (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-529",
    "fingerprint": "af_xdp-alloc-every-frame-free-pool|net/tquic/af_xdp.c|buffer|concurrency",
    "title": "AF_XDP frame pool uses spinlock for every frame alloc/free",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/af_xdp.c :: buffer. Category=concurrency, severity=S3.\nEvidence union: 2 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c",
        "net/tquic/af_xdp.c:222-238"
      ],
      "symbols": [
        "buffer"
      ],
      "line_ranges": [
        "net/tquic/af_xdp.c:222-238"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"buffer\" \"net/tquic/af_xdp.c\"",
      "rg -n \"af_xdp\" \"net/tquic/af_xdp.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a lockless ring buffer (SPSC or MPSC depending on usage pattern) for the free list, similar to how io_uring and XDP use lockless rings.",
    "tests_to_add": [
      "Add regression test for: AF_XDP frame pool uses spinlock for every frame alloc/free (net/tquic/af_xdp.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-530",
    "fingerprint": "bench-benchmark-correctly-kvfree-kvmalloc-used|net/quic/tquic/fec/fec_encoder.c|allocation|correctness",
    "title": "bench/benchmark.c -- kvmalloc used correctly with kvfree",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/fec/fec_encoder.c :: allocation. Category=correctness, severity=S3.\nEvidence union: 2 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c",
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "free",
        "allocation"
      ],
      "line_ranges": [
        "net/quic/tquic/fec/fec_encoder.c:349-350",
        "net/quic/tquic/fec/fec_encoder.c:341-342"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"allocation\" \"net/quic/tquic/fec/fec_encoder.c\"",
      "rg -n \"bench\" \"net/quic/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'bench/benchmark.c -- kvmalloc used correctly with kvfree', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: bench/benchmark.c -- kvmalloc used correctly with kvfree (net/quic/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-531",
    "fingerprint": "benchmark-code-kernel-userspace|net/tquic/bench/bench_common.c|diagnostics|memory",
    "title": "Benchmark Code: Userspace, Not Kernel",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/bench/bench_common.c :: diagnostics. Category=memory, severity=S3.\nEvidence union: 2 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bench/bench_common.c",
        "net/tquic/bench/"
      ],
      "symbols": [
        "apis",
        "diagnostics",
        "immediate",
        "qpack",
        "functions",
        "handling",
        "limits",
        "min_t",
        "patterns",
        "priority",
        "qpack_static_get",
        "quic_trace_conn_id"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: build, memory."
    ],
    "verification_commands": [
      "rg -n \"diagnostics\" \"net/tquic/bench/bench_common.c\"",
      "rg -n \"benchmark\" \"net/tquic/bench/bench_common.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider moving benchmark code to a `tools/` or `tests/` directory to avoid confusion about its execution context.",
    "tests_to_add": [
      "**Impact:** No kernel security impact. The code is a test harness only.",
      "**Recommendation:** Consider moving benchmark code to a `tools/` or `tests/` directory to avoid confusion about its execution context."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-532",
    "fingerprint": "cid-initialization-safe-table-thread|net/tquic/tquic_cid.c|tquic_cid|concurrency",
    "title": "CID Table Initialization Not Thread-Safe",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_cid.c :: tquic_cid. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [],
      "snippets": [
        "static bool cid_table_initialized;  // not atomic\n\n    if (cid_table_initialized) {\n        ret = rhashtable_insert_fast(...);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/tquic/tquic_cid.c\"",
      "rg -n \"cid\" \"net/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: CID Table Initialization Not Thread-Safe (net/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-533",
    "fingerprint": "close_work-drain_work-repurpos-retransmit-schedul|net/tquic/core/connection.c|work_struct|correctness",
    "title": "close_work Repurposes drain_work for Retransmit Scheduling",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: work_struct. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "work_struct"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_close_work_handler(struct work_struct *work)\n{\n    ...\n    if (cs->close_retries < 3) {\n        tquic_send_close_frame(conn);\n        schedule_delayed_work(&cs->drain_work,\n                              msecs_to_jiffies(1000));\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"work_struct\" \"net/tquic/core/connection.c\"",
      "rg -n \"close_work\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use a separate delayed_work for close retransmission.\n\n---",
    "tests_to_add": [
      "Add regression test for: close_work Repurposes drain_work for Retransmit Scheduling (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-534",
    "fingerprint": "consistent-good-key-kfree_sensitive-material-use|unknown_file|tquic_server|security",
    "title": "Consistent use of kfree_sensitive for key material -- GOOD",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: unknown_file :: tquic_server. Category=security, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_server"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Consistent use of kfree_sensitive for key material -- GOOD",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-535",
    "fingerprint": "comparison-constant-integrity-tags-time-used|net/quic/tquic/tquic_retry.c|tquic_retry|security",
    "title": "Constant-Time Comparison Used for Integrity Tags",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_retry.c :: tquic_retry. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [
        "tquic_retry"
      ],
      "line_ranges": [],
      "snippets": [
        "return crypto_memneq(computed_tag, received_tag,\n                     TQUIC_RETRY_INTEGRITY_TAG_LEN) == 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_retry\" \"net/quic/tquic/tquic_retry.c\"",
      "rg -n \"constant\" \"net/quic/tquic/tquic_retry.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Constant-Time Comparison Used for Integrity Tags (net/quic/tquic/tquic_retry.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-536",
    "fingerprint": "check-context-init-level-return-set|net/tquic/security/quic_exfil.c|tquic_exfil_ctx_set_level|correctness",
    "title": "Context Set Level Does Not Check init Return Values",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: tquic_exfil_ctx_set_level. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_exfil_ctx_set_level",
        "quic_exfil",
        "_init",
        "tquic_traffic_shaper_destroy",
        "tquic_traffic_shaper_init",
        "tquic_spin_randomizer_destroy",
        "tquic_spin_randomizer_init"
      ],
      "line_ranges": [],
      "snippets": [
        "tquic_traffic_shaper_destroy(&ctx->shaper);\ntquic_traffic_shaper_init(&ctx->shaper, level);  /* return value ignored */\n\ntquic_spin_randomizer_destroy(&ctx->spin_rand);\ntquic_spin_randomizer_init(&ctx->spin_rand, level);  /* return value ignored */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_exfil_ctx_set_level\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"context\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Check return values and either revert to the previous level or mark the context as failed.\n\n---",
    "tests_to_add": [
      "Add regression test for: Context Set Level Does Not Check init Return Values (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-537",
    "fingerprint": "atomic-context-crypto_tfm_req_may_backlog|net/tquic/crypto/header_protection.c|tquic_hp_mask_aes|concurrency",
    "title": "CRYPTO_TFM_REQ_MAY_BACKLOG in Atomic Context",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/header_protection.c :: tquic_hp_mask_aes. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "tquic_hp_mask_aes",
        "crypto_wait_req",
        "tquic_hp_mask_chacha20"
      ],
      "line_ranges": [],
      "snippets": [
        "skcipher_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,\n                              crypto_req_done, &wait);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_hp_mask_aes\" \"net/tquic/crypto/header_protection.c\"",
      "rg -n \"crypto_tfm_req_may_backlog\" \"net/tquic/crypto/header_protection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Either (a) ensure callers never hold spinlocks when calling HP mask\ngeneration, or (b) use `CRYPTO_TFM_REQ_MAY_SLEEP` only when in process context\nand remove `MAY_BACKLOG` in atomic context, or (c) document the sleeping\nrequirement clearly.\n\n---",
    "tests_to_add": [
      "Add regression test for: CRYPTO_TFM_REQ_MAY_BACKLOG in Atomic Context (net/tquic/crypto/header_protection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-538",
    "fingerprint": "crypto_wait_req-decrypt-encrypt-hot-path-sleep|net/tquic/crypto/tls.c|unknown_symbol|security",
    "title": "crypto_wait_req May Sleep in Encrypt/Decrypt Hot Path",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/tls.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/tls.c:637-637",
        "net/tquic/crypto/tls.c:694-694"
      ],
      "snippets": [
        "ret = crypto_wait_req(crypto_aead_encrypt(req), &wait);  /* line 637 */\nret = crypto_wait_req(crypto_aead_decrypt(req), &wait);  /* line 694 */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"crypto_wait_req\" \"net/tquic/crypto/tls.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Ensure the encrypt/decrypt paths are only called from process context\n(e.g., in a workqueue), or use async completion callbacks instead of\n`crypto_wait_req`.\n\n---",
    "tests_to_add": [
      "Add regression test for: crypto_wait_req May Sleep in Encrypt/Decrypt Hot Path (net/tquic/crypto/tls.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-539",
    "fingerprint": "algorithm-comput-empty-hash-validation|net/tquic/crypto/zero_rtt.c|unknown_symbol|security",
    "title": "Empty Hash Computed Without Algorithm Validation",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"empty\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Zero-initialize `empty_hash` or use `memzero_explicit` after use.\n\n---",
    "tests_to_add": [
      "Add regression test for: Empty Hash Computed Without Algorithm Validation (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-540",
    "fingerprint": "defin-h3_varint_len-multiple-static-tim|net/quic/tquic/http3/http3_request.c|h3_varint_len|correctness",
    "title": "h3_varint_len Defined Multiple Times as Static",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_request.c :: h3_varint_len. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_varint_len"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"h3_varint_len\" \"net/quic/tquic/http3/http3_request.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'h3_varint_len Defined Multiple Times as Static', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: h3_varint_len Defined Multiple Times as Static (net/quic/tquic/http3/http3_request.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-541",
    "fingerprint": "fallback-hmac-output-path-zeroiz|net/tquic/core/connection.c|unknown_symbol|security",
    "title": "HMAC Output Not Zeroized on Fallback Path",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "fallback:\n    kfree(desc);\n    crypto_free_shash(tfm);\n    tquic_stateless_reset_generate_token(cid, static_key, token);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, security."
    ],
    "verification_commands": [
      "rg -n \"hmac\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add `memzero_explicit(hmac_out, sizeof(hmac_out));` before `goto fallback`.\n\n---",
    "tests_to_add": [
      "Add regression test for: HMAC Output Not Zeroized on Fallback Path (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-542",
    "fingerprint": "error-inconsistent-return-verify_chain|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "Inconsistent Error Return From verify_chain",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2332-2332"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"inconsistent\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Inconsistent Error Return From verify_chain (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-543",
    "fingerprint": "getsockopt-io_ur-len-pattern-same-validation|net/quic/tquic/io_uring.c|unknown_symbol|correctness",
    "title": "io_uring.c getsockopt Same len Validation Pattern",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/io_uring.c :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/io_uring.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"io_ur\" \"net/quic/tquic/io_uring.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'io_uring.c getsockopt Same len Validation Pattern', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: io_uring.c getsockopt Same len Validation Pattern (net/quic/tquic/io_uring.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-544",
    "fingerprint": "acquire-derivation-drop-key-lock-pattern|net/tquic/crypto/key_update.c|tquic_ku_derive_next_generation|concurrency",
    "title": "Lock Drop/Re-acquire Pattern in Key Derivation",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/key_update.c :: tquic_ku_derive_next_generation. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "tquic_ku_derive_next_generation"
      ],
      "line_ranges": [],
      "snippets": [
        "staged_cur_write = state->current_write;           /* Copy under lock */\nmemset(&staged_next, 0, sizeof(staged_next));\nspin_unlock_irqrestore(&state->lock, flags);       /* Drop lock */\n\nret = tquic_ku_derive_next_generation(state,       /* Derive unlocked */\n                                      &staged_cur_write,\n                                      &staged_next);\nmemzero_explicit(&staged_cur_write, sizeof(staged_cur_write));\nif (ret) {\n    memzero_explicit(&staged_next, sizeof(staged_next));\n    return ret;\n}\n\nspin_lock_irqsave(&state->lock, flags);            /* Re-acquire */\n\n/* Re-check state for concurrent modification */\nif (state->update_pending || state->next_write.valid) {\n    memzero_explicit(&staged_next, sizeof(staged_next));\n    ret = -EINPROGRESS;\n    goto out_unlock;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_ku_derive_next_generation\" \"net/tquic/crypto/key_update.c\"",
      "rg -n \"lock\" \"net/tquic/crypto/key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pass `hash_tfm` as a separate parameter copied under the lock, rather\nthan passing the entire state.\n\n---",
    "tests_to_add": [
      "Add regression test for: Lock Drop/Re-acquire Pattern in Key Derivation (net/tquic/crypto/key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-545",
    "fingerprint": "division-pacing_calc_gap|net/tquic/tquic_output.c|tquic_output|correctness",
    "title": "LOW: pacing_calc_gap uses division",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_output. Category=correctness, severity=S3.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_output.c:1360"
      ],
      "symbols": [
        "tquic_output"
      ],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1360"
      ],
      "snippets": [
        "gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, perf."
    ],
    "verification_commands": [
      "rg -n \"tquic_output\" \"net/tquic/tquic_output.c\"",
      "rg -n \"pacing_calc_gap\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pre-compute `ns_per_byte = NSEC_PER_SEC / pacing_rate` when the rate changes, then use multiplication: `gap_ns = pkt_size * ns_per_byte`.",
    "tests_to_add": [
      "Add regression test for: LOW: pacing_calc_gap uses division (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-546",
    "fingerprint": "ack-division-every-prague-rtt-scal|net/tquic/cong/prague.c|unknown_symbol|correctness",
    "title": "LOW: Prague RTT scaling division on every ACK",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/cong/prague.c :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 2 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/prague.c",
        "net/tquic/cong/prague.c:154"
      ],
      "symbols": [],
      "line_ranges": [
        "/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/prague.c:154"
      ],
      "snippets": [
        "scaled = (value * rtt_us) / p->params.rtt_target_us;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, perf."
    ],
    "verification_commands": [
      "rg -n \"prague\" \"net/tquic/cong/prague.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Pre-compute a reciprocal multiplier for the RTT target to replace division with multiplication + shift.",
    "tests_to_add": [
      "Add regression test for: LOW: Prague RTT scaling division on every ACK (net/tquic/cong/prague.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-547",
    "fingerprint": "correctly-key-material-memzero_explicit-used||tquic_retry|security",
    "title": "memzero_explicit Used Correctly for Key Material",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus:  :: tquic_retry. Category=security, severity=S3.\nEvidence union: 0 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_retry",
        "tquic_token"
      ],
      "line_ranges": [
        ":471-471",
        ":578-578"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: memory, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_retry\" \"\"",
      "rg -n \"memzero_explicit\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: memzero_explicit Used Correctly for Key Material ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-548",
    "fingerprint": "minimal-overhead-tracepoint|net/tquic/diag/trace.c|recommendations|memory",
    "title": "Minimal tracepoint overhead",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: net/tquic/diag/trace.c :: recommendations. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/diag/trace.c"
      ],
      "symbols": [
        "fec",
        "recommendations",
        "ktime_get",
        "minimal",
        "skb_queue_splice_init",
        "tquic_find_path_by_addr",
        "tracepoints"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, memory."
    ],
    "verification_commands": [
      "rg -n \"recommendations\" \"net/tquic/diag/trace.c\"",
      "rg -n \"minimal\" \"net/tquic/diag/trace.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text.",
    "tests_to_add": [
      "Add regression test for: Minimal tracepoint overhead (net/tquic/diag/trace.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-549",
    "fingerprint": "check-error-init_net-reference|unknown_file|tquic_tunnel|correctness",
    "title": "Missing Error Check for init_net Reference",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: unknown_file :: tquic_tunnel. Category=correctness, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_tunnel"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Store the network namespace reference at module load time and add a helper function that returns the appropriate namespace.\n\n---",
    "tests_to_add": [
      "Add regression test for: Missing Error Check for init_net Reference",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-550",
    "fingerprint": "annotation-lockdep|unknown_file|lockdep_assert_held|concurrency",
    "title": "Missing lockdep Annotations",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: unknown_file :: lockdep_assert_held. Category=concurrency, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "lockdep_assert_held",
        "lock_set_subclass",
        "lock_set_class"
      ],
      "line_ranges": [],
      "snippets": [
        "Global Locks\n                          ============\ntquic_nf_lock (bh)\ntquic_udp_hash_lock (bh)\ntquic_listener_lock (bh)\nport_alloc.lock (bh)\ntquic_nic_lock (plain)\ntquic_sched_lock (plain)\ntquic_bpm_list_lock (bh)\n\n                          Mutex Locks (sleepable)\n                          =======================\ntquic_client_mutex\ntquic_token_mutex\nintegrity_aead_lock\ntquic_retry_mutex\nstate->pool_locks[slot]\nkeyring_mutex\npm_ops_lock\ntquic_cid_table_lock\n\n                          Per-Connection Hierarchy\n                          ========================\nsk->sk_lock (lock_sock)\n  |\n  +-- conn->lock (spin_lock_bh)\n  |     |\n  |     +-- conn->paths_lock (spin_lock_bh or spin_lock in softirq)\n  |     |\n  |     +-- conn->streams_lock (spin_lock_bh)\n  |     |\n  |     +-- conn->datagram.lock (spin_lock)\n  |\n  +-- ts->lock (timer state, spin_lock_bh)\n        |\n        +-- pns->lock (per PN-space, spin_lock_bh or spin_lock)\n        |     |\n        |     +-- rs->lock (recovery state, spin_lock_bh or spin_lock)\n        |\n        +-- rs->lock (can also be direct under ts->lock)\n\n                          Per-Path Hierarchy\n                          ==================\npath->state_lock (spin_lock_bh)\n  |\n  +-- path->cc_lock (spin_lock_bh)\n\n                          Bonding Hierarchy\n                          =================\nbc->state_lock (spin_lock_bh)\n\npm->lock (spin_lock_bh)\n  |\n  +-- path->state_lock (via drop-relock pattern -- UNSAFE)\n\nfc->sent_packets_lock (spin_lock_bh)\n  |\n  +-- fc->retx_queue.lock (spin_lock_bh) -- taken separately, same level\n\n                          FEC Hierarchy\n                          =============\nenc->lock (spin_lock_bh)\n  |\n  +-- block->lock (spin_lock)\n\n                          Other Per-Object Locks\n                          ======================\nh3conn->lock (spin_lock)\nh3s->lock (spin_lock_init only, never used?)\nrb->buffer_lock (reorder, spin_lock_bh)\nstate->lock (deadline sched, spin_lock_bh)\nctx->lock (coupled CC, spin_lock_bh)\npool->lock (CID pool, spin_lock_bh)\nbucket->lock (rate limit, spin_lock_irqsave)\nring->lock (error ring, spin_lock)\ngro->lock (spin_lock)\ncfg->lock (LB config, spin_lock)\nzc->lock (zerocopy, spin_lock_bh)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add `lockdep_assert_held(&conn->lock)` at the beginning of functions that require `conn->lock` to be held.",
    "tests_to_add": [
      "Add regression test for: Missing lockdep Annotations",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-551",
    "fingerprint": "acros-construction-multipath-nonce-path-potential|net/tquic/crypto/tls.c|tquic_crypto_ctx_destroy|security",
    "title": "Multipath Nonce Construction -- Potential Nonce Reuse Across Paths",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/tls.c :: tquic_crypto_ctx_destroy. Category=security, severity=S3.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "tquic_crypto_ctx_destroy",
        "offset",
        "tquic_initiate_key_update"
      ],
      "line_ranges": [
        "net/tquic/crypto/tls.c:392-423",
        "net/tquic/crypto/tls.c:645-645",
        "net/tquic/crypto/tls.c:966-983",
        "net/tquic/crypto/tls.c:1307-1372",
        "net/tquic/crypto/tls.c:183-183"
      ],
      "snippets": [
        "/* XOR path_id into nonce bytes 4..7 for path separation */\nfor (i = 0; i < 4; i++)\n    nonce[7 - i] ^= (path_id >> (i * 8)) & 0xff;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_crypto_ctx_destroy\" \"net/tquic/crypto/tls.c\"",
      "rg -n \"multipath\" \"net/tquic/crypto/tls.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Verify that path_id allocation is monotonically increasing per\nconnection and never reuses IDs within a key phase.",
    "tests_to_add": [
      "Add regression test for: Multipath Nonce Construction -- Potential Nonce Reuse Across Paths (net/tquic/crypto/tls.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-552",
    "fingerprint": "implementation-multiple-redundant-varint|unknown_file|tquic_input|correctness",
    "title": "Multiple Redundant Varint Implementations",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: unknown_file :: tquic_input. Category=correctness, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_input",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consolidate to a single implementation in `varint.c`/`varint.h` and use it everywhere.",
    "tests_to_add": [
      "Add regression test for: Multiple Redundant Varint Implementations",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-553",
    "fingerprint": "all-genl_admin_perm-netlink-operation-require|net/tquic/tquic_netlink.c|tquic_netlink|security",
    "title": "Netlink Operations All Require GENL_ADMIN_PERM",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 4 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_netlink.c :: tquic_netlink. Category=security, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_netlink",
        "net"
      ],
      "line_ranges": [
        "net/tquic/tquic_netlink.c:274-274"
      ],
      "snippets": [
        "struct net *net = sock_net(skb->sk);",
        "{ .cmd = TQUIC_NL_CMD_PATH_ADD,    .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_PATH_REMOVE, .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_PATH_SET,    .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_PATH_GET,    .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_PATH_LIST,   .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_SCHED_SET,   .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_SCHED_GET,   .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_STATS_GET,   .flags = GENL_ADMIN_PERM },\n{ .cmd = TQUIC_NL_CMD_CONN_GET,    .flags = GENL_ADMIN_PERM },"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: other, security."
    ],
    "verification_commands": [
      "rg -n \"tquic_netlink\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"netlink\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Netlink Operations All Require GENL_ADMIN_PERM (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-554",
    "fingerprint": "failure-handle-netlink-nla_put-operation-properly|net/quic/tquic/tquic_netlink.c|tquic_netlink|correctness",
    "title": "nla_put Operations in Netlink Properly Handle Failure",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_netlink.c :: tquic_netlink. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_netlink"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_netlink\" \"net/quic/tquic/tquic_netlink.c\"",
      "rg -n \"nla_put\" \"net/quic/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'nla_put Operations in Netlink Properly Handle Failure', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: nla_put Operations in Netlink Properly Handle Failure (net/quic/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-555",
    "fingerprint": "boolean-hardcod-length-parse_basic_constraint|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "parse_basic_constraints Hardcoded BOOLEAN Length",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (p < end && p[0] == 0x01) {  /* BOOLEAN */\n        if (p + 3 <= end) {\n            *is_ca = (p[2] != 0);\n            p += 3;\n        }\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"parse_basic_constraint\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: parse_basic_constraints Hardcoded BOOLEAN Length (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-556",
    "fingerprint": "mechanism-path-queue-response-track-two|net/tquic/pm/path_validation.c|skb_queue_len|concurrency",
    "title": "Path Validation Response Queue Uses Two Tracking Mechanisms",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/pm/path_validation.c :: skb_queue_len. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "skb_queue_len"
      ],
      "line_ranges": [],
      "snippets": [
        "if (atomic_read(&path->response.count) >= TQUIC_MAX_PENDING_RESPONSES) {\n// ...\nskb_queue_tail(&path->response.queue, skb);\natomic_inc(&path->response.count);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"skb_queue_len\" \"net/tquic/pm/path_validation.c\"",
      "rg -n \"path\" \"net/tquic/pm/path_validation.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use only one mechanism. `skb_queue_len()` is already atomic and thread-safe.",
    "tests_to_add": [
      "Add regression test for: Path Validation Response Queue Uses Two Tracking Mechanisms (net/tquic/pm/path_validation.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-557",
    "fingerprint": "controll-decoy-mtu-packet-quic_exfil-size|net/quic/tquic/security/quic_exfil.c|quic_exfil|correctness",
    "title": "quic_exfil.c Decoy Packet Size Controlled by MTU",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/security/quic_exfil.c :: quic_exfil. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "quic_exfil"
      ],
      "line_ranges": [],
      "snippets": [
        "decoy_size = 64 + (rand_val % (shaper->mtu - 64 + 1));\n...\nmemset(skb_put(skb, decoy_size), 0x00, decoy_size);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"quic_exfil\" \"net/quic/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'quic_exfil.c Decoy Packet Size Controlled by MTU', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: quic_exfil.c Decoy Packet Size Controlled by MTU (net/quic/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-558",
    "fingerprint": "lock-redundant-tquic_bonding_get_state|net/quic/tquic/bond/tquic_bonding.c|tquic_bonding_get_state|concurrency",
    "title": "Redundant Lock in tquic_bonding_get_state",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/bond/tquic_bonding.c :: tquic_bonding_get_state. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_get_state",
        "tquic_bonding"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bonding.c:526-526",
        "net/quic/tquic/bond/tquic_bonding.c:899-899"
      ],
      "snippets": [
        "return READ_ONCE(bc->state);   // Line 526 -- lockless read\n// ...\nif (READ_ONCE(bc->state) == TQUIC_BOND_SINGLE_PATH)   // Line 899"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"tquic_bonding_get_state\" \"net/quic/tquic/bond/tquic_bonding.c\"",
      "rg -n \"redundant\" \"net/quic/tquic/bond/tquic_bonding.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Redundant Lock in tquic_bonding_get_state (net/quic/tquic/bond/tquic_bonding.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-559",
    "fingerprint": "aead-comput-fail-integrity-potentially-retry|net/tquic/core/connection.c|unknown_symbol|memory",
    "title": "Retry Integrity Tag Computed with Potentially-Failing AEAD",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "aead = crypto_alloc_aead(\"gcm(aes)\", 0, 0);\nif (!IS_ERR(aead)) {\n    ...\n    ret = crypto_aead_encrypt(req);\n    if (ret == 0) {\n        memcpy(p, tag, 16);\n        p += 16;\n    }\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"retry\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Return an error if the integrity tag cannot be computed rather than sending a tagless packet.\n\n---",
    "tests_to_add": [
      "Add regression test for: Retry Integrity Tag Computed with Potentially-Failing AEAD (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-560",
    "fingerprint": "capacity-check-limit-pars-san-tighter|net/tquic/crypto/cert_verify.c|unknown_symbol|security",
    "title": "SAN Parsing Capacity Limit Check Could Be Tighter",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/cert_verify.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (name_capacity >= 10000)\n        goto err_free;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"san\" \"net/tquic/crypto/cert_verify.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Reduce limit to 1000 or add a total allocation size limit.",
    "tests_to_add": [
      "Add regression test for: SAN Parsing Capacity Limit Check Could Be Tighter (net/tquic/crypto/cert_verify.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-561",
    "fingerprint": "_bh-lock-scheduler-spin_lock|net/quic/tquic/sched/scheduler.c|spin_lock|concurrency",
    "title": "Scheduler Lock Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/sched/scheduler.c :: spin_lock. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/sched/scheduler.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"spin_lock\" \"net/quic/tquic/sched/scheduler.c\"",
      "rg -n \"scheduler\" \"net/quic/tquic/sched/scheduler.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Scheduler Lock Uses spin_lock Without _bh (net/quic/tquic/sched/scheduler.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-562",
    "fingerprint": "global-rotation-server_ticket_key-static|net/tquic/crypto/zero_rtt.c|unknown_symbol|security",
    "title": "server_ticket_key Is Static Global Without Rotation",
    "category": "security",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/crypto/zero_rtt.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static u8 server_ticket_key[TQUIC_SESSION_TICKET_KEY_LEN];\nstatic bool server_ticket_key_valid;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"server_ticket_key\" \"net/tquic/crypto/zero_rtt.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Implement periodic key rotation (e.g., every 24 hours) with support for decrypting tickets encrypted with the previous key.\n\n---",
    "tests_to_add": [
      "Add regression test for: server_ticket_key Is Static Global Without Rotation (net/tquic/crypto/zero_rtt.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-563",
    "fingerprint": "cache-module-nam-prefix-slab|net/tquic/core/stream.c|tquic_stream_ext|correctness",
    "title": "Slab Cache Names Are Not Module-Prefixed",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/stream.c :: tquic_stream_ext. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream_ext",
        "tquic_core_stream_ext"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_ext\" \"net/tquic/core/stream.c\"",
      "rg -n \"slab\" \"net/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Use names like `\"tquic_core_stream_ext\"` for clarity.",
    "tests_to_add": [
      "Add regression test for: Slab Cache Names Are Not Module-Prefixed (net/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-564",
    "fingerprint": "comparison-right-shift-stream|net/quic/tquic/tquic_stream.c|tquic_stream|correctness",
    "title": "Stream ID Right-Shift Comparison",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 3 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:1409-1410"
      ],
      "snippets": [
        "if ((next_id >> 2) < max_streams)"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream\" \"net/quic/tquic/tquic_stream.c\"",
      "rg -n \"stream\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Stream ID Right-Shift Comparison', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Stream ID Right-Shift Comparison (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-565",
    "fingerprint": "cleanup-thorough-tquic_conn_destroy|net/quic/tquic/core/quic_connection.c|tquic_conn_destroy|correctness",
    "title": "tquic_conn_destroy -- thorough cleanup",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/core/quic_connection.c :: tquic_conn_destroy. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_connection.c"
      ],
      "symbols": [
        "tquic_conn_destroy",
        "quic_connection"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_conn_destroy\" \"net/quic/tquic/core/quic_connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_conn_destroy -- thorough cleanup', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_conn_destroy -- thorough cleanup (net/quic/tquic/core/quic_connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-566",
    "fingerprint": "getsockopt-info-mtu-tquic_ipv6|net/quic/tquic/tquic_ipv6.c|copies|correctness",
    "title": "tquic_ipv6.c MTU Info getsockopt",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_ipv6.c :: copies. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_ipv6.c"
      ],
      "symbols": [
        "copies",
        "tquic_ipv6"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_ipv6.c:171-211",
        "net/quic/tquic/tquic_ipv6.c:226-227",
        "net/quic/tquic/tquic_ipv6.c:285-286",
        "net/quic/tquic/tquic_ipv6.c:267-268",
        "net/quic/tquic/tquic_ipv6.c:339-339"
      ],
      "snippets": [
        "if (copy_to_user(optval, &mtuinfo, sizeof(mtuinfo)))\n    return -EFAULT;\nif (put_user(sizeof(mtuinfo), optlen))\n    return -EFAULT;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"copies\" \"net/quic/tquic/tquic_ipv6.c\"",
      "rg -n \"tquic_ipv6\" \"net/quic/tquic/tquic_ipv6.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_ipv6.c MTU Info getsockopt', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_ipv6.c MTU Info getsockopt (net/quic/tquic/tquic_ipv6.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-567",
    "fingerprint": "cascad-cleanup-correct-init-tquic_main|net/quic/tquic/tquic_main.c|tquic_exit|correctness",
    "title": "tquic_main.c init -- correct cascading cleanup",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_main.c :: tquic_exit. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [
        "tquic_exit",
        "tquic_main"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_main.c:1198-1198"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_exit\" \"net/quic/tquic/tquic_main.c\"",
      "rg -n \"tquic_main\" \"net/quic/tquic/tquic_main.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_main.c init -- correct cascading cleanup', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_main.c init -- correct cascading cleanup (net/quic/tquic/tquic_main.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-568",
    "fingerprint": "allocation-call-conn-gfp_atomic-hold-lock|net/tquic/tquic_output.c|tquic_encap_recv|concurrency",
    "title": "tquic_output_flush Holds conn->lock While Calling GFP_ATOMIC Allocation",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/tquic_output.c :: tquic_encap_recv. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 5 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_encap_recv",
        "tquic_process_frames",
        "tquic_process_packet",
        "udphdr",
        "tquic_output_flush",
        "tquic_output",
        "tquic_assemble_packet"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:2071-2117",
        "net/tquic/tquic_output.c:2071-2071",
        "net/tquic/tquic_output.c:2117-2117",
        "net/tquic/tquic_output.c:2132-2132",
        "net/tquic/tquic_output.c:2148-2148"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_encap_recv\" \"net/tquic/tquic_output.c\"",
      "rg -n \"tquic_output_flush\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Consider pre-allocating frame structures outside the lock, or batching frame preparation.",
    "tests_to_add": [
      "Add regression test for: tquic_output_flush Holds conn->lock While Calling GFP_ATOMIC Allocation (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-569",
    "fingerprint": "correct-order-tquic_pacing_cleanup|net/quic/tquic/tquic_output.c|tquic_pacing_cleanup|correctness",
    "title": "tquic_pacing_cleanup -- correct ordering",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_output.c :: tquic_pacing_cleanup. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_pacing_cleanup",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "hrtimer_cancel(&pacing->timer);\ncancel_work_sync(&pacing->work);\nskb_queue_purge(&pacing->queue);\nkfree(pacing);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_pacing_cleanup\" \"net/quic/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_pacing_cleanup -- correct ordering', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_pacing_cleanup -- correct ordering (net/quic/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-570",
    "fingerprint": "bucket-potential-token-tquic_retry_rate_limit-underflow|net/quic/tquic/tquic_retry.c|tquic_retry_rate_limit|correctness",
    "title": "tquic_retry_rate_limit Potential Token Bucket Underflow",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_retry.c :: tquic_retry_rate_limit. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [
        "tquic_retry_rate_limit",
        "tquic_retry"
      ],
      "line_ranges": [],
      "snippets": [
        "refill = (elapsed_ms / TQUIC_RETRY_RATE_LIMIT_REFILL_MS) *\n         TQUIC_RETRY_RATE_LIMIT_REFILL_AMOUNT;\ntquic_retry_rate_tokens = min_t(u32,\n                                tquic_retry_rate_tokens + refill,\n                                TQUIC_RETRY_RATE_LIMIT_TOKENS);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"tquic_retry_rate_limit\" \"net/quic/tquic/tquic_retry.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_retry_rate_limit Potential Token Bucket Underflow', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_retry_rate_limit Potential Token Bucket Underflow (net/quic/tquic/tquic_retry.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-571",
    "fingerprint": "all-extend-free-state-stream-tquic_stream_manager_destroy|net/quic/tquic/http3/http3_conn.c|tquic_stream_manager_destroy|correctness",
    "title": "tquic_stream_manager_destroy Does Not Free Extended State for All Streams",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/http3/http3_conn.c :: tquic_stream_manager_destroy. Category=correctness, severity=S3.\nEvidence union: 22 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_conn.c",
        "net/quic/tquic/http3/qpack.h",
        "net/quic/tquic/http3/qpack_static.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/http3/qpack_encoder.c",
        "net/quic/tquic/core/priority.c",
        "net/quic/tquic/http3/http3_request.c",
        "net/quic/tquic/http3/qpack.c",
        "net/quic/tquic/http3/http3_settings.c",
        "net/quic/tquic/http3/http3_frame.h",
        "net/quic/tquic/http3/webtransport.h",
        "net/quic/tquic/tquic_stream.c",
        "net/quic/tquic/http3/qpack_decoder.c",
        "net/quic/tquic/http3/http3_module.c",
        "net/quic/tquic/http3/http3_priority.c",
        "net/quic/tquic/core/flow_control.c",
        "net/quic/tquic/http3/http3_stream.h",
        "net/quic/tquic/http3/qpack_dynamic.c",
        "net/quic/tquic/http3/http3_priority.h",
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/core/stream.c",
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [
        "tquic_stream_manager_destroy",
        "tquic_stream_ext_free",
        "tquic_priority_stream_ext",
        "tquic_stream_ext"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_manager_destroy\" \"net/quic/tquic/http3/http3_conn.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_stream_manager_destroy Does Not Free Extended State for All Streams', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_manager_destroy Does Not Free Extended State for All Streams (net/quic/tquic/http3/http3_conn.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-572",
    "fingerprint": "cleanup-correct-loop-tquic_timer_state_alloc|net/quic/tquic/tquic_timer.c|tquic_timer_state_alloc|correctness",
    "title": "tquic_timer_state_alloc -- cleanup loop is correct",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_timer.c :: tquic_timer_state_alloc. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer_state_alloc",
        "tquic_timer"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_timer_state_alloc\" \"net/quic/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_timer_state_alloc -- cleanup loop is correct', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_timer_state_alloc -- cleanup loop is correct (net/quic/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-573",
    "fingerprint": "correct-thorough-tquic_timer_state_free|net/quic/tquic/tquic_timer.c|tquic_timer_state_free|concurrency",
    "title": "tquic_timer_state_free -- thorough and correct",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_timer.c :: tquic_timer_state_free. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer_state_free",
        "tquic_timer"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: concurrency, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_timer_state_free\" \"net/quic/tquic/tquic_timer.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_timer_state_free -- thorough and correct (net/quic/tquic/tquic_timer.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-574",
    "fingerprint": "bit-byte-first-fix-negotiation-randomization|net/tquic/core/connection.c|get_random_u8|correctness",
    "title": "Version Negotiation First Byte Missing Fixed Bit Randomization",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: get_random_u8. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "get_random_u8"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:807-807"
      ],
      "snippets": [
        "*p++ = 0x80;  /* Long header */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [],
    "verification_commands": [
      "rg -n \"get_random_u8\" \"net/tquic/core/connection.c\"",
      "rg -n \"version\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Version Negotiation First Byte Missing Fixed Bit Randomization', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation First Byte Missing Fixed Bit Randomization (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-575",
    "fingerprint": "256-against-byte-negotiation-packet-size|net/tquic/core/connection.c|unknown_symbol|memory",
    "title": "Version Negotiation Packet Size Not Validated Against 256-Byte Buffer",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/core/connection.c :: unknown_symbol. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, memory."
    ],
    "verification_commands": [
      "rg -n \"version\" \"net/tquic/core/connection.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Add a bounds check or use the `p - packet < sizeof(packet)` idiom.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Packet Size Not Validated Against 256-Byte Buffer (net/tquic/core/connection.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-576",
    "fingerprint": "capp-dcid-negotiation-response-scid_len-version|net/quic/tquic/tquic_input.c|tquic_input|memory",
    "title": "Version Negotiation Response - dcid/scid_len Not Capped",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/quic/tquic/tquic_input.c :: tquic_input. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "pkt_len = 7 + dcid_len + scid_len + sizeof(supported_versions);\n...\nmemcpy(p, scid, scid_len);\n...\nmemcpy(p, dcid, dcid_len);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/quic/tquic/tquic_input.c\"",
      "rg -n \"version\" \"net/quic/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Version Negotiation Response - dcid/scid_len Not Capped (net/quic/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-577",
    "fingerprint": "use-validat-workqueue|net/tquic/security/quic_exfil.c|tquic_validate_target_address|correctness",
    "title": "Workqueue Not Validated Before Use",
    "category": "correctness",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) B, C.\nPrimary locus: net/tquic/security/quic_exfil.c :: tquic_validate_target_address. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_validate_target_address",
        "tquic_timing_normalize_send",
        "net",
        "quic_exfil"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "B",
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Category disagreement across reports: correctness, other."
    ],
    "verification_commands": [
      "rg -n \"tquic_validate_target_address\" \"net/tquic/security/quic_exfil.c\"",
      "rg -n \"workqueue\" \"net/tquic/security/quic_exfil.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** If `exfil_wq` is NULL, either send the packet immediately (bypassing timing normalization) or return an error so the caller can handle it.",
    "tests_to_add": [
      "Add regression test for: Workqueue Not Validated Before Use (net/tquic/security/quic_exfil.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-578",
    "fingerprint": "efficient-encod-fec-xor|unknown_file|scheme|concurrency",
    "title": "XOR FEC encoding is efficient",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 2 report item(s) from source(s) A, B.\nPrimary locus: unknown_file :: scheme. Category=concurrency, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "scheme"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 2,
      "sources": [
        "A",
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Missing fix suggestion in source text.",
    "tests_to_add": [
      "Add regression test for: XOR FEC encoding is efficient",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-579",
    "fingerprint": "allocation-bench_latency-check-overflow|net/quic/tquic/bench/tquic_bench_latency.c|tquic_bench_latency|perf",
    "title": "`bench_latency.c` Allocation Without Overflow Check",
    "category": "perf",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/bench/tquic_bench_latency.c :: tquic_bench_latency. Category=perf, severity=S3.\nEvidence union: 2 file(s), 4 line range(s), 3 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bench/tquic_bench_latency.c",
        "net/quic/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_bench_latency"
      ],
      "line_ranges": [
        "net/quic/tquic/bench/tquic_bench_latency.c:980-980",
        "net/quic/tquic/bench/tquic_bench_latency.c:840-840",
        "net/quic/tquic/bench/tquic_bench_latency.c:260-260",
        "net/quic/tquic/bench/tquic_bench_latency.c:276-276"
      ],
      "snippets": [
        "double *rtt_us = malloc(state->sample_count * sizeof(double));",
        "ret = tquic_decode_varint(ctx->data + ctx->offset,\n                          ctx->len - ctx->offset, &value);",
        "data->flags = (u8)val;      /* line 260 - val is u64 from varint */\ndata->loss_rate = (u32)val;  /* line 276 - val is u64 from varint */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bench_latency\" \"net/quic/tquic/bench/tquic_bench_latency.c\"",
      "rg -n \"bench_latency\" \"net/quic/tquic/bench/tquic_bench_latency.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`bench_latency.c` Allocation Without Overflow Check', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `bench_latency.c` Allocation Without Overflow Check (net/quic/tquic/bench/tquic_bench_latency.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-580",
    "fingerprint": "active-cid-count-cpu-enumeration-pool|net/quic/tquic/tquic_cid.c|tquic_cid|concurrency",
    "title": "CPU-3: CID pool active count enumeration.",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_cid.c :: tquic_cid. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_cid.c"
      ],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_cid.c:617-617"
      ],
      "snippets": [
        "// tquic_cid.c:652\nlist_for_each_entry(iter, &pool->remote_cids, list) {\n    if (iter->state == CID_STATE_ACTIVE)\n        active_count++;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/quic/tquic/tquic_cid.c\"",
      "rg -n \"cpu\" \"net/quic/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Maintain running `active_count` counter to avoid list traversal",
    "tests_to_add": [
      "Add regression test for: CPU-3: CID pool active count enumeration. (net/quic/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-581",
    "fingerprint": "spin_lock|net/tquic/tquic_input.c|unknown_symbol|concurrency",
    "title": "spin_lock",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: unknown_symbol. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:1015-1017",
        "net/tquic/tquic_input.c:251-251"
      ],
      "snippets": [
        "spin_lock(&ctx->conn->lock);\n    ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);\n    spin_unlock(&ctx->conn->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"spin_lock\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Change to `spin_lock_bh(&ctx->conn->lock)`.",
    "tests_to_add": [
      "Add regression test for: spin_lock (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-582",
    "fingerprint": "buf-pkt_num-scratch-space-tquic_build_short_header_internal-writ|net/tquic/tquic_output.c|tquic_build_short_header_internal|build",
    "title": "tquic_build_short_header_internal Writes pkt_num to buf+64 Scratch Space",
    "category": "build",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_build_short_header_internal. Category=build, severity=S3.\nEvidence union: 1 file(s), 4 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_build_short_header_internal",
        "tquic_encode_pkt_num"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:818-818",
        "net/tquic/tquic_output.c:1915-1915",
        "net/tquic/tquic_output.c:961-961",
        "net/tquic/tquic_output.c:1982-1982"
      ],
      "snippets": [
        "pkt_num_len = tquic_encode_pkt_num(buf + 64, pkt_num, largest_acked);",
        "u8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_build_short_header_internal\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Allocate a separate scratch buffer or use a function-local buffer:\n```c\nu8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);\n```",
    "tests_to_add": [
      "Add regression test for: tquic_build_short_header_internal Writes pkt_num to buf+64 Scratch Space (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-583",
    "fingerprint": "allocation-integer-overflow-size-tquic_gso_init|net/tquic/tquic_output.c|tquic_gso_init|concurrency",
    "title": "tquic_gso_init Integer Overflow in Allocation Size",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_gso_init. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_gso_init"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1489-1489"
      ],
      "snippets": [
        "gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);",
        "size_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_gso_init\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `size_t` arithmetic with overflow checking:\n```c\nsize_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;\n```",
    "tests_to_add": [
      "Add regression test for: tquic_gso_init Integer Overflow in Allocation Size (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-584",
    "fingerprint": "add-cid-destruction-pool-race-rotation_work|net/tquic/tquic_cid.c|tquic_cid|memory",
    "title": "UAF-ADD-02: - CID pool rotation_work vs pool destruction race window",
    "category": "memory",
    "severity": "S3",
    "confidence": "high",
    "priority_score": 1.0,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_cid.c :: tquic_cid. Category=memory, severity=S3.\nEvidence union: 1 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [
        "net/tquic/tquic_cid.c:980-1180",
        "net/tquic/tquic_cid.c:480-1170",
        "net/tquic/tquic_cid.c:180-375",
        "net/tquic/tquic_cid.c:320-420",
        "net/tquic/tquic_cid.c:1-200"
      ],
      "snippets": [
        "del_timer_sync(&pool->rotation_timer);\ncancel_work_sync(&pool->rotation_work);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid\" \"net/tquic/tquic_cid.c\"",
      "rg -n \"useafterfree\" \"net/tquic/tquic_cid.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: UAF-ADD-02: - CID pool rotation_work vs pool destruction race window (net/tquic/tquic_cid.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-585",
    "fingerprint": "bench_common-calculation-variance|net/quic/tquic/bench/bench_common.c|unknown_symbol|tests",
    "title": "`bench_common.c` Variance Calculation",
    "category": "tests",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/bench/bench_common.c :: unknown_symbol. Category=tests, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/bench/bench_common.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "double variance = (s->sum_sq - s->count * mean * mean) / (s->count - 1);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"bench_common\" \"net/quic/tquic/bench/bench_common.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`bench_common.c` Variance Calculation', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `bench_common.c` Variance Calculation (net/quic/tquic/bench/bench_common.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-586",
    "fingerprint": "bench_common-calculation-code-userspace-variance|unknown_file|unknown_symbol|other",
    "title": "`bench_common.c` Variance Calculation (Userspace Code)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "double variance = (s->sum_sq - s->count * mean * mean) / (s->count - 1);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`bench_common.c` Variance Calculation (Userspace Code)', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `bench_common.c` Variance Calculation (Userspace Code)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-587",
    "fingerprint": "allocation-bench_latency-check-code-overflow-userspace|unknown_file|unknown_symbol|other",
    "title": "`bench_latency.c` Allocation Without Overflow Check (Userspace Code)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 4 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "double *rtt_us = malloc(state->sample_count * sizeof(double));",
        "ret = tquic_decode_varint(ctx->data + ctx->offset,\n                          ctx->len - ctx->offset, &value);",
        "data->flags = (u8)val;      /* line 260 - val is u64 from varint */\ndata->loss_rate = (u32)val;  /* line 276 - val is u64 from varint */",
        "if (val > U8_MAX)\n    return -EINVAL;\ndata->flags = (u8)val;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Validate before truncation:\n```c\nif (val > U8_MAX)\n    return -EINVAL;\ndata->flags = (u8)val;\n```",
    "tests_to_add": [
      "Add regression test for: `bench_latency.c` Allocation Without Overflow Check (Userspace Code)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-588",
    "fingerprint": "lock-nest-pattern-tquic_accept|net/tquic/tquic_socket.c|tquic_accept|concurrency",
    "title": "`tquic_accept()` Nested Locking Pattern",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_accept. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_accept",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_accept\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: `tquic_accept()` Nested Locking Pattern (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-589",
    "fingerprint": "check-init_list_head-redundant-tquic_sock_listen|net/tquic/tquic_socket.c|tquic_sock_listen|correctness",
    "title": "`tquic_sock_listen()` Redundant `INIT_LIST_HEAD` Check",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_socket.c :: tquic_sock_listen. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sock_listen",
        "tquic_socket"
      ],
      "line_ranges": [],
      "snippets": [
        "if (list_empty(&tsk->accept_queue))\n        INIT_LIST_HEAD(&tsk->accept_queue);\n    tsk->accept_queue_len = 0;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_sock_listen\" \"net/tquic/tquic_socket.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for '`tquic_sock_listen()` Redundant `INIT_LIST_HEAD` Check', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: `tquic_sock_listen()` Redundant `INIT_LIST_HEAD` Check (net/tquic/tquic_socket.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-590",
    "fingerprint": "all-constant-iterat-non-time-token|net/tquic/tquic_stateless_reset.c|tquic_stateless_reset_detect|security",
    "title": "`tquic_stateless_reset_detect()` Iterates All Tokens Non-Constant-Time",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_stateless_reset.c :: tquic_stateless_reset_detect. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_detect",
        "tquic_stateless_reset"
      ],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_tokens; i++) {\n        if (crypto_memneq(pkt_token, tokens[i],\n                          TQUIC_STATELESS_RESET_TOKEN_LEN) == 0)\n            return true;   // <--- early return on match\n    }"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stateless_reset_detect\" \"net/tquic/tquic_stateless_reset.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: `tquic_stateless_reset_detect()` Iterates All Tokens Non-Constant-Time (net/tquic/tquic_stateless_reset.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-591",
    "fingerprint": "aggregate-hold-long-scheduler-spinlock|net/tquic/multipath/sched_aggregate.c|ktime_get|concurrency",
    "title": "Aggregate Scheduler Long Spinlock Hold",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_aggregate.c :: ktime_get. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_aggregate.c"
      ],
      "symbols": [
        "ktime_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"ktime_get\" \"net/tquic/multipath/sched_aggregate.c\"",
      "rg -n \"aggregate\" \"net/tquic/multipath/sched_aggregate.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Aggregate Scheduler Long Spinlock Hold (net/tquic/multipath/sched_aggregate.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-592",
    "fingerprint": "benchmark-code-kernel-userspace|net/tquic/bench/|unknown_symbol|other",
    "title": "Benchmark Code: Userspace, Not Kernel",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: net/tquic/bench/ :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bench/"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"benchmark\" \"net/tquic/bench/\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider moving benchmark code to a `tools/` or `tests/` directory to avoid confusion about its execution context.",
    "tests_to_add": [
      "Add regression test for: Benchmark Code: Userspace, Not Kernel (net/tquic/bench/)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-593",
    "fingerprint": "bpm-initializ-metric-min_rtt-path-uint_max|net/tquic/bond/tquic_bpm.c|tquic_bpm|correctness",
    "title": "BPM Path Metrics min_rtt Initialized to UINT_MAX",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_bpm.c :: tquic_bpm. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "tquic_bpm"
      ],
      "line_ranges": [],
      "snippets": [
        "m->min_rtt = UINT_MAX;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bpm\" \"net/tquic/bond/tquic_bpm.c\"",
      "rg -n \"bpm\" \"net/tquic/bond/tquic_bpm.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'BPM Path Metrics min_rtt Initialized to UINT_MAX', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: BPM Path Metrics min_rtt Initialized to UINT_MAX (net/tquic/bond/tquic_bpm.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-594",
    "fingerprint": "c99-declaration-loop-variable|net/tquic/fec/xor_fec.c|tquic_xor_decode|concurrency",
    "title": "C99 Variable Declaration in Loop",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/xor_fec.c :: tquic_xor_decode. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/xor_fec.c"
      ],
      "symbols": [
        "tquic_xor_decode"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_xor_decode\" \"net/tquic/fec/xor_fec.c\"",
      "rg -n \"c99\" \"net/tquic/fec/xor_fec.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: C99 Variable Declaration in Loop (net/tquic/fec/xor_fec.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-595",
    "fingerprint": "comparison-constant-time|net/tquic/cong/cong_data.c|crypto_memneq|security",
    "title": "Constant-Time Comparison",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/cong_data.c :: crypto_memneq. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"net/tquic/cong/cong_data.c\"",
      "rg -n \"constant\" \"net/tquic/cong/cong_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Constant-Time Comparison (net/tquic/cong/cong_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-596",
    "fingerprint": "alpha-chang-coupl-rapid-smooth-suppres|net/tquic/bond/cong_coupled.c|crypto_memneq|api",
    "title": "Coupled CC Alpha Smoothing May Suppress Rapid Changes",
    "category": "api",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/cong_coupled.c :: crypto_memneq. Category=api, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"net/tquic/bond/cong_coupled.c\"",
      "rg -n \"coupl\" \"net/tquic/bond/cong_coupled.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Coupled CC Alpha Smoothing May Suppress Rapid Changes', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Coupled CC Alpha Smoothing May Suppress Rapid Changes (net/tquic/bond/cong_coupled.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-597",
    "fingerprint": "alpha-chang-coupl-rapid-smooth-suppres|** Proper reorder buffer with RTT-spread-based timeout calculation handles out-of-order delivery across paths with different latencies.|unknown_symbol|other",
    "title": "Coupled CC Alpha Smoothing May Suppress Rapid Changes",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: ** Proper reorder buffer with RTT-spread-based timeout calculation handles out-of-order delivery across paths with different latencies. :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "** Proper reorder buffer with RTT-spread-based timeout calculation handles out-of-order delivery across paths with different latencies."
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"coupl\" \"** Proper reorder buffer with RTT-spread-based timeout calculation handles out-of-order delivery across paths with different latencies.\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consider faster convergence when path count changes.",
    "tests_to_add": [
      "Add regression test for: Coupled CC Alpha Smoothing May Suppress Rapid Changes (** Proper reorder buffer with RTT-spread-based timeout calculation handles out-of-order delivery across paths with different latencies.)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-598",
    "fingerprint": "accept-cpu-decoder-max_table_capacity-parameter-peer|net/quic/tquic/http3/qpack_decoder.c|tquic_path|security",
    "title": "CPU-6: The QPACK decoder accepts a `max_table_capacity` parameter from the peer via SETTINGS. While the sysctl caps the local maximum at 1MB, the actual limit used should be `min(peer_requested, local",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/qpack_decoder.c :: tquic_path. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [
        "tquic_path",
        "qpack_decoder"
      ],
      "line_ranges": [],
      "snippets": [
        "// tquic_migration.c:72\n#define TQUIC_ANTI_AMPLIFICATION_LIMIT  3  /* Max 3x amplification */\n\n// tquic_migration.c:85-106\nbool tquic_path_anti_amplification_check(struct tquic_path *path, u64 bytes)\n{\n    received = atomic64_read(&path->anti_amplification.bytes_received);\n    sent = atomic64_read(&"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_path\" \"net/quic/tquic/http3/qpack_decoder.c\"",
      "rg -n \"cpu\" \"net/quic/tquic/http3/qpack_decoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Audit SETTINGS parsing to confirm capacity is clamped",
    "tests_to_add": [
      "Add regression test for: CPU-6: The QPACK decoder accepts a `max_table_capacity` parameter from the peer via SETTINGS. While the sysctl caps the local maximum at 1MB, the actual limit used should be `min(peer_requested, local (net/quic/tquic/http3/qpack_decoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-599",
    "fingerprint": "already-cache-consider-cros-pattern-slab|net/quic/tquic/|tquic_rx_buf_cache|concurrency",
    "title": "CROSS-2: Consider using the `tquic_rx_buf_cache` slab cache pattern (already used at `tquic_input.c:2586`) more broadly for hot-path allocations to reduce GFP_ATOMIC pressure.",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/ :: tquic_rx_buf_cache. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/"
      ],
      "symbols": [
        "tquic_rx_buf_cache",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_rx_buf_cache\" \"net/quic/tquic/\"",
      "rg -n \"cros\" \"net/quic/tquic/\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: CROSS-2: Consider using the `tquic_rx_buf_cache` slab cache pattern (already used at `tquic_input.c:2586`) more broadly for hot-path allocations to reduce GFP_ATOMIC pressure. (net/quic/tquic/)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-600",
    "fingerprint": "content-debug-logg-packet|unknown_file|tquic_dbg|correctness",
    "title": "Debug Logging of Packet Contents",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_dbg. Category=correctness, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_dbg"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Debug Logging of Packet Contents', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Debug Logging of Packet Contents",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-601",
    "fingerprint": "count-failover-negative-packet-sent|net/tquic/bond/tquic_failover.c|tquic_failover|concurrency",
    "title": "Failover Sent Packet Count Can Go Negative",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/bond/tquic_failover.c :: tquic_failover. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover"
      ],
      "line_ranges": [],
      "snippets": [
        "fc->sent_count++;   // in track_sent\nfc->sent_count--;   // in on_ack"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_failover\" \"net/tquic/bond/tquic_failover.c\"",
      "rg -n \"failover\" \"net/tquic/bond/tquic_failover.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Failover Sent Packet Count Can Go Negative (net/tquic/bond/tquic_failover.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-602",
    "fingerprint": "call-connection-include-info-pr_debug-several|unknown_file|tquic_dbg|security",
    "title": "INFO-1: Several `pr_debug`/`tquic_dbg` calls include connection state information. While these are compile-time optional, in debug builds they could leak timing information about connection state to a",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_dbg. Category=security, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_dbg",
        "tquic_input",
        "tquic_warn"
      ],
      "line_ranges": [],
      "snippets": [
        "// tquic_input.c:2664\ntquic_warn(\"key phase change %u->%u failed: %d\\n\",\n           current_phase, ctx.key_phase_bit, ku_ret);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: INFO-1: Several `pr_debug`/`tquic_dbg` calls include connection state information. While these are compile-time optional, in debug builds they could leak timing information about connection state to a",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-603",
    "fingerprint": "65536-connection-has-limit-mem-per|net/quic/tquic/tquic_nf.c|tquic_stream_open_incoming|security",
    "title": "MEM-3: The NF connection tracking limit (65536) has no per-source-IP limit at the netfilter layer. While the TQUIC protocol layer has per-IP limits, the NF `tquic_nf_conn_alloc` at line 497 only check",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_nf.c :: tquic_stream_open_incoming. Category=security, severity=S3.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_nf.c"
      ],
      "symbols": [
        "tquic_stream_open_incoming",
        "tquic_nf_conn_alloc",
        "tquic_nf"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_nf.c:497-497",
        "net/quic/tquic/tquic_nf.c:634-648"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_open_incoming\" \"net/quic/tquic/tquic_nf.c\"",
      "rg -n \"mem\" \"net/quic/tquic/tquic_nf.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add per-IP NF tracking limit (e.g., 256 entries per source IP)",
    "tests_to_add": [
      "Add regression test for: MEM-3: The NF connection tracking limit (65536) has no per-source-IP limit at the netfilter layer. While the TQUIC protocol layer has per-IP limits, the NF `tquic_nf_conn_alloc` at line 497 only check (net/quic/tquic/tquic_nf.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-604",
    "fingerprint": "allocat-both-count-each-limit-mem|net/quic/tquic/tquic_main.c|tquic_main|security",
    "title": "MEM-4: While stream count is limited, each stream allocates both `send_buf` and `recv_buf` skb queues. An attacker opening `max_streams_bidi` streams and sending minimal data to each creates per-strea",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_main.c :: tquic_main. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [
        "tquic_main"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_main\" \"net/quic/tquic/tquic_main.c\"",
      "rg -n \"mem\" \"net/quic/tquic/tquic_main.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Consider lazy initialization of stream buffers",
    "tests_to_add": [
      "Add regression test for: MEM-4: While stream count is limited, each stream allocates both `send_buf` and `recv_buf` skb queues. An attacker opening `max_streams_bidi` streams and sending minimal data to each creates per-strea (net/quic/tquic/tquic_main.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-605",
    "fingerprint": "documentation-lock-order|net/tquic/fec/|tquic_bonding|concurrency",
    "title": "Missing Documentation on Lock Ordering",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/ :: tquic_bonding. Category=concurrency, severity=S3.\nEvidence union: 2 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/",
        "net/tquic/bond/tquic_bonding.h"
      ],
      "symbols": [
        "tquic_bonding"
      ],
      "line_ranges": [],
      "snippets": [
        "/*\n * Lock ordering (outermost first):\n *   1. ctx->lock (bonding context)\n *   2. path->lock (per-path)\n *   3. ctx->reorder_lock (reorder buffer)\n *   Never hold path->lock while acquiring ctx->lock.\n */"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_bonding\" \"net/tquic/fec/\"",
      "rg -n \"documentation\" \"net/tquic/fec/\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Missing Documentation on Lock Ordering (net/tquic/fec/)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-606",
    "fingerprint": "cap_net_admin-group-multicast-requir||tquic_cid_security_check_new_cid|security",
    "title": "Multicast Group Only Requires CAP_NET_ADMIN",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: tquic_cid_security_check_new_cid. Category=security, severity=S3.\nEvidence union: 0 file(s), 5 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_cid_security_check_new_cid",
        "tquic_process_new_connection_id_frame"
      ],
      "line_ranges": [
        ":274-274",
        ":1001-1053",
        ":865-865",
        ":1116-1116",
        ":1145-1145"
      ],
      "snippets": [
        "ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_cid_security_check_new_cid\" \"\"",
      "rg -n \"multicast\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Multicast Group Only Requires CAP_NET_ADMIN ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-607",
    "fingerprint": "coexist-multiple-registration-scheduler-system|unknown_file|tquic_scheduler|concurrency",
    "title": "Multiple Scheduler Registration Systems Coexist",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_scheduler. Category=concurrency, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_scheduler",
        "tquic_sched_list",
        "tquic_sched_list_lock",
        "tquic_new_sched_list"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Multiple Scheduler Registration Systems Coexist",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-608",
    "fingerprint": "implementation-multiple-varint|net/quic/tquic/crypto/extended_key_update.c|tquic_input|correctness",
    "title": "Multiple Varint Implementations",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/crypto/extended_key_update.c :: tquic_input. Category=correctness, severity=S3.\nEvidence union: 10 file(s), 5 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/extended_key_update.c",
        "net/quic/tquic/tquic_input.c",
        "net/quic/tquic/grease.c",
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/fec/fec_encoder.c",
        "net/quic/tquic/tquic_ack_frequency.c",
        "net/quic/tquic/tquic_token.c",
        "net/quic/tquic/tquic_output.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/core/varint.c"
      ],
      "symbols": [
        "tquic_input",
        "tquic_ack_frequency"
      ],
      "line_ranges": [
        "net/quic/tquic/crypto/extended_key_update.c:171-171",
        "net/quic/tquic/crypto/extended_key_update.c:49-131",
        "net/quic/tquic/crypto/extended_key_update.c:164-164",
        "net/quic/tquic/crypto/extended_key_update.c:106-183",
        "net/quic/tquic/crypto/extended_key_update.c:78-117"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_input\" \"net/quic/tquic/crypto/extended_key_update.c\"",
      "rg -n \"multiple\" \"net/quic/tquic/crypto/extended_key_update.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Multiple Varint Implementations', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Multiple Varint Implementations (net/quic/tquic/crypto/extended_key_update.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-609",
    "fingerprint": "address-attribute-binary-netlink-policy-strict|net/tquic/tquic_netlink.c|nla_len|correctness",
    "title": "Netlink Attribute Policy Does Not Use Strict Validation for Binary Addresses",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_netlink.c :: nla_len. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "nla_len",
        "sockaddr_storage",
        "tquic_nl_parse_addr",
        "nla_get_in_addr",
        "nla_get_in6_addr",
        "tquic_netlink"
      ],
      "line_ranges": [],
      "snippets": [
        "[TQUIC_NL_ATTR_PATH_LOCAL_ADDR] = { .type = NLA_BINARY,\n                     .len = sizeof(struct sockaddr_storage) },"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"nla_len\" \"net/tquic/tquic_netlink.c\"",
      "rg -n \"netlink\" \"net/tquic/tquic_netlink.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Netlink Attribute Policy Does Not Use Strict Validation for Binary Addresses', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Netlink Attribute Policy Does Not Use Strict Validation for Binary Addresses (net/tquic/tquic_netlink.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-610",
    "fingerprint": "budget-connection-frame-per-process|unknown_file|tquic_process_frames|correctness",
    "title": "No Per-Connection Frame Processing Budget",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_process_frames. Category=correctness, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_frames"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'No Per-Connection Frame Processing Budget', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: No Per-Connection Frame Processing Budget",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-611",
    "fingerprint": "del_timer-del_timer_sync-path-timer-validation|net/tquic/pm/path_validation.c|del_timer_sync|concurrency",
    "title": "Path Validation Timer del_timer vs del_timer_sync",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/pm/path_validation.c :: del_timer_sync. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "del_timer_sync",
        "del_timer"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"del_timer_sync\" \"net/tquic/pm/path_validation.c\"",
      "rg -n \"path\" \"net/tquic/pm/path_validation.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Path Validation Timer del_timer vs del_timer_sync (net/tquic/pm/path_validation.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-612",
    "fingerprint": "allocation-extension-priority-race|net/quic/tquic/core/priority.c|unknown_symbol|concurrency",
    "title": "Priority Extension Allocation Race",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/priority.c :: unknown_symbol. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ext = stream->ext;\nif (ext)\n    return ext;\next = kzalloc(sizeof(*ext), GFP_ATOMIC);\n...\nstream->ext = ext;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"priority\" \"net/quic/tquic/core/priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: Priority Extension Allocation Race (net/quic/tquic/core/priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-613",
    "fingerprint": "667-674-entire-iterat-loop-proto|unknown_file|tquic_cid|security",
    "title": "PROTO-1: The retire loop at `tquic_cid.c:667-674` iterates the entire remote CID list for each NEW_CONNECTION_ID frame, marking CIDs as retired. While bounded by `active_connection_id_limit`, repeated",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: tquic_cid. Category=security, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: PROTO-1: The retire loop at `tquic_cid.c:667-674` iterates the entire remote CID list for each NEW_CONNECTION_ID frame, marking CIDs as retired. While bounded by `active_connection_id_limit`, repeated",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-614",
    "fingerprint": "data-lifetime-pointer-repair|net/tquic/fec/fec_encoder.c|tquic_fec_get_pending_repair|memory",
    "title": "Repair Data Pointer Lifetime",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/fec/fec_encoder.c :: tquic_fec_get_pending_repair. Category=memory, severity=S3.\nEvidence union: 2 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c",
        "net/tquic/cong/"
      ],
      "symbols": [
        "tquic_fec_get_pending_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_fec_get_pending_repair\" \"net/tquic/fec/fec_encoder.c\"",
      "rg -n \"repair\" \"net/tquic/fec/fec_encoder.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Repair Data Pointer Lifetime (net/tquic/fec/fec_encoder.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-615",
    "fingerprint": "null-potential-send_skb-used-variable||   |-- tquic_parse_long_header_internal [2354]|unknown_symbol|other",
    "title": "send_skb Variable Used After Potential NULL",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: |   |-- tquic_parse_long_header_internal [2354] :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 2 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "|   |-- tquic_parse_long_header_internal [2354]",
        "|   |-- tquic_parse_short_header_internal [2539]"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "UDP Datagram from Network\n    |\n    v\ntquic_encap_recv() [line 3027]\n    |-- __skb_pull(skb, sizeof(struct udphdr))\n    v\ntquic_udp_recv(sk, skb) [line 2718]  <-- MAIN ENTRY POINT\n    |\n    |-- Rate limiting check [2785-2913]\n    |   |-- tquic_decode_varint (token parsing) [2841]\n    |   |-- tquic_ratelimit_check_initial [2862]\n    |   |-- tquic_retry_send [2896]    <-- amplification vector\n    |\n    |-- Stateless reset check [2916-2932]  <-- H-7: expensive\n    |   |-- tquic_lookup_by_dcid [2925]\n    |   |-- tquic_is_stateless_reset_internal [2928]\n    |\n    |-- Version negotiation [2936-2961]\n    |   |-- tquic_process_version_negotiation [2954]\n    |\n    v\ntquic_process_packet() [line 2329]  <-- CORE PROCESSING\n    |\n    |-- Long header path:\n    |   |-- tquic_parse_long_header_internal [2354]\n    |   |-- Version negotiation [2361]\n    |   |-- Retry processing [2380]\n    |   |-- 0-RTT processing [2438]\n    |   |-- Token parsing for Initial [2501]\n    |   |-- Length field parsing [2519]\n    |   |-- pkt_num_len extraction [2529]  <-- C-6: before HP\n    |\n    |-- Short header path:\n    |   |-- tquic_parse_short_header_internal [2539]\n    |   |-- pkt_num_len extraction [2545]  <-- C-6: before HP\n    |\n    |-- tquic_remove_header_protection [2565]\n    |-- tquic_decode_pkt_num [2573]  <-- C-5: no bounds check\n    |\n    |-- Decryption:\n    |   |-- kmem_cache_alloc / kmalloc [2586-2590]\n    |   |-- tquic_zero_rtt_decrypt [2601] or tquic_decrypt_payload [2618]\n    |\n    |-- Key update detection [2656-2670]\n    |\n    v\ntquic_process_frames() [line 1839]  <-- FRAME DEMUX\n    |\n    |-- PADDING [1900]\n    |-- PING [1902]\n    |-- ACK/ACK_ECN [1904]  <-- H-3, H-6, L-4\n    |-- CRYPTO [1915]\n    |-- NEW_TOKEN [1925]\n    |-- STREAM [1935]  <-- H-2\n    |-- MAX_DATA [1945]  <-- L-6\n    |-- PATH_CHALLENGE/RESPONSE [1963,1972]\n    |-- NEW_CONNECTION_ID [1981]\n    |-- CONNECTION_CLOSE [1999]\n    |-- HANDSHAKE_DONE [2003]\n    |-- DATAGRAM [2013]\n    |-- ACK_FREQUENCY [2022]  <-- I-1\n    |-- MP frames [2027-2038]  <-- H-5\n    |-- Unknown frame -> FRAME_ENCODING_ERROR [2040]\n    |\n    |-- Infinite loop guard [2058]"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"send_skb\" \"|   |-- tquic_parse_long_header_internal [2354]\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'send_skb Variable Used After Potential NULL', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: send_skb Variable Used After Potential NULL (|   |-- tquic_parse_long_header_internal [2354])",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-616",
    "fingerprint": "cleanup-key-sensitive|net/tquic/cong/cong_data.c|kfree_sensitive|security",
    "title": "Sensitive Key Cleanup",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/cong/cong_data.c :: kfree_sensitive. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "kfree_sensitive"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"kfree_sensitive\" \"net/tquic/cong/cong_data.c\"",
      "rg -n \"sensitive\" \"net/tquic/cong/cong_data.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Sensitive Key Cleanup (net/tquic/cong/cong_data.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-617",
    "fingerprint": "limit-seen_mask-setting|net/quic/tquic/http3/http3_settings.c|unknown_symbol|correctness",
    "title": "settings seen_mask Limited to 64 Settings",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/http3/http3_settings.c :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_settings.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"setting\" \"net/quic/tquic/http3/http3_settings.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'settings seen_mask Limited to 64 Settings', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: settings seen_mask Limited to 64 Settings (net/quic/tquic/http3/http3_settings.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-618",
    "fingerprint": "1015-1017-lin-spin_lock-spin_lock_bh-tquic_input|unknown_file|tquic_process_max_data_frame|other",
    "title": "spin_lock (Not spin_lock_bh) Used in tquic_process_max_data_frame (tquic_input.c, lines 1015-1017)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_process_max_data_frame. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_max_data_frame",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&ctx->conn->lock);\n    ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);\n    spin_unlock(&ctx->conn->lock);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Change to `spin_lock_bh(&ctx->conn->lock)`.\n\n---",
    "tests_to_add": [
      "Add regression test for: spin_lock (Not spin_lock_bh) Used in tquic_process_max_data_frame (tquic_input.c, lines 1015-1017)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-619",
    "fingerprint": "attacker-complete-connection-consum-handshake-open|net/quic/tquic/tquic_sysctl.c|unknown_symbol|security",
    "title": "STATE-2: An attacker could open connections, complete the handshake (consuming 1 connection per client rate token), then keep them alive by sending a PING frame every 29 seconds. With default 100 conn",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_sysctl.c :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_sysctl.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"state\" \"net/quic/tquic/tquic_sysctl.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Enforce a maximum concurrent connections per-IP limit (distinct from rate limit), e.g., 32 connections per source IP",
    "tests_to_add": [
      "Add regression test for: STATE-2: An attacker could open connections, complete the handshake (consuming 1 connection per client rate token), then keep them alive by sending a PING frame every 29 seconds. With default 100 conn (net/quic/tquic/tquic_sysctl.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-620",
    "fingerprint": "attacker-connection-limit-number-path-per||unknown_symbol|security",
    "title": "STATE-3: No visible limit on the number of paths per connection. If an attacker can trigger path creation (via connection migration or multipath signaling), each new path creates timers and state.",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 0 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":656-656",
        ":617-617"
      ],
      "snippets": [
        "ret = tquic_cid_security_check_new_cid(&pool->security);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"state\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Enforce max paths per connection limit",
    "tests_to_add": [
      "Add regression test for: STATE-3: No visible limit on the number of paths per connection. If an attacker can trigger path creation (via connection migration or multipath signaling), each new path creates timers and state. ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-621",
    "fingerprint": "comparison-reset-stateles-tim-token||crypto_memneq|security",
    "title": "Stateless Reset Token Comparison Timing",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus:  :: crypto_memneq. Category=security, severity=S3.\nEvidence union: 0 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "crypto_memneq",
        "tquic_is_stateless_reset_internal",
        "check_add_overflow",
        "frame_advance_safe",
        "tquic_stateless_reset_detect_conn"
      ],
      "line_ranges": [
        ":980-980"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"crypto_memneq\" \"\"",
      "rg -n \"stateles\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Stateless Reset Token Comparison Timing ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-622",
    "fingerprint": "bound-creation-input-path-stream||tquic_stream_open_incoming|security",
    "title": "Stream Creation Not Bounded in Input Path",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 2 report item(s) from source(s) B.\nPrimary locus:  :: tquic_stream_open_incoming. Category=security, severity=S3.\nEvidence union: 0 file(s), 2 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_stream_open_incoming",
        "tquic_input"
      ],
      "line_ranges": [
        ":681-681",
        ":938-938"
      ],
      "snippets": [
        "u64 bytes_acked = (first_ack_range + 1) * 1200;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_open_incoming\" \"\"",
      "rg -n \"stream\" \"\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Stream Creation Not Bounded in Input Path ()",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-623",
    "fingerprint": "callback-null-timer_setup|net/tquic/sched/deadline_aware.c|unknown_symbol|correctness",
    "title": "timer_setup with NULL Callback",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/sched/deadline_aware.c :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_aware.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/sched/deadline_aware.c:102-117"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"timer_setup\" \"net/tquic/sched/deadline_aware.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'timer_setup with NULL Callback', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: timer_setup with NULL Callback (net/tquic/sched/deadline_aware.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-624",
    "fingerprint": "buf-line-pkt_num-scratch-space-tquic_build_short_header_internal|unknown_file|tquic_build_short_header_internal|other",
    "title": "tquic_build_short_header_internal Writes pkt_num to buf+64 Scratch Space (tquic_output.c, line 818)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_build_short_header_internal. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_build_short_header_internal",
        "tquic_output",
        "tquic_assemble_packet",
        "tquic_send_ack",
        "tquic_send_connection_close",
        "tquic_encode_pkt_num"
      ],
      "line_ranges": [],
      "snippets": [
        "pkt_num_len = tquic_encode_pkt_num(buf + 64, pkt_num, largest_acked);",
        "u8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Allocate a separate scratch buffer or use a function-local buffer:\n```c\nu8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_build_short_header_internal Writes pkt_num to buf+64 Scratch Space (tquic_output.c, line 818)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-625",
    "fingerprint": "double-header-strip-tquic_encap_recv-udp|unknown_file|tquic_encap_recv|other",
    "title": "tquic_encap_recv Double UDP Header Strip",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_encap_recv. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_encap_recv"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_encap_recv Double UDP Header Strip', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_encap_recv Double UDP Header Strip",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-626",
    "fingerprint": "range-tquic_encode_varint-val-validate|net/tquic/tquic_output.c|tquic_encode_varint|correctness",
    "title": "tquic_encode_varint Does Not Validate val Range",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_output.c :: tquic_encode_varint. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_encode_varint",
        "tquic_output"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:164-198"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_encode_varint\" \"net/tquic/tquic_output.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add validation: `if (val >= (1ULL << 62)) return -EINVAL;`",
    "tests_to_add": [
      "Add regression test for: tquic_encode_varint Does Not Validate val Range (net/tquic/tquic_output.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-627",
    "fingerprint": "164-198-lin-range-tquic_encode_varint-tquic_output|unknown_file|tquic_encode_varint|other",
    "title": "tquic_encode_varint Does Not Validate val Range (tquic_output.c, lines 164-198)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_encode_varint. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_encode_varint",
        "tquic_output",
        "tquic_varint_len"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add validation: `if (val >= (1ULL << 62)) return -EINVAL;`\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_encode_varint Does Not Validate val Range (tquic_output.c, lines 164-198)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-628",
    "fingerprint": "1489-allocation-integer-line-overflow-size|unknown_file|tquic_gso_init|other",
    "title": "tquic_gso_init Integer Overflow in Allocation Size (tquic_output.c, line 1489)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_gso_init. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 2 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_gso_init",
        "tquic_output"
      ],
      "line_ranges": [],
      "snippets": [
        "gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);",
        "size_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Use `size_t` arithmetic with overflow checking:\n```c\nsize_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;\n```\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_gso_init Integer Overflow in Allocation Size (tquic_output.c, line 1489)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-629",
    "fingerprint": "first_ack_range-largest_ack-tquic_process_ack_frame-validate|net/tquic/tquic_input.c|tquic_process_ack_frame|correctness",
    "title": "tquic_process_ack_frame Does Not Validate largest_ack vs first_ack_range",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_process_ack_frame. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_ack_frame",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:601-660"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_ack_frame\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add: `if (first_ack_range > largest_ack) return -EINVAL;`",
    "tests_to_add": [
      "Add regression test for: tquic_process_ack_frame Does Not Validate largest_ack vs first_ack_range (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-630",
    "fingerprint": "601-660-first_ack_range-largest_ack-lin-tquic_input|unknown_file|tquic_process_ack_frame|other",
    "title": "tquic_process_ack_frame Does Not Validate largest_ack vs first_ack_range (tquic_input.c, lines 601-660)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_process_ack_frame. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_ack_frame",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add: `if (first_ack_range > largest_ack) return -EINVAL;`\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_process_ack_frame Does Not Validate largest_ack vs first_ack_range (tquic_input.c, lines 601-660)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-631",
    "fingerprint": "guard-infinite-loop-tquic_process_coalesc|net/tquic/tquic_input.c|tquic_process_coalesced|security",
    "title": "tquic_process_coalesced Missing Infinite Loop Guard",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/tquic_input.c :: tquic_process_coalesced. Category=security, severity=S3.\nEvidence union: 1 file(s), 2 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_coalesced",
        "tquic_input"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:3079-3182",
        "net/tquic/tquic_input.c:3169-3169"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_process_coalesced\" \"net/tquic/tquic_input.c\"",
      "rg -n \"tquic_process_coalesc\" \"net/tquic/tquic_input.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add `if (packets > 16) break;` to cap coalesced packets.",
    "tests_to_add": [
      "Add regression test for: tquic_process_coalesced Missing Infinite Loop Guard (net/tquic/tquic_input.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-632",
    "fingerprint": "3079-3182-guard-infinite-lin-loop|unknown_file|tquic_process_coalesced|other",
    "title": "tquic_process_coalesced Missing Infinite Loop Guard (tquic_input.c, lines 3079-3182)",
    "category": "other",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: tquic_process_coalesced. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_coalesced",
        "tquic_input"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add `if (packets > 16) break;` to cap coalesced packets.\n\n---",
    "tests_to_add": [
      "Add regression test for: tquic_process_coalesced Missing Infinite Loop Guard (tquic_input.c, lines 3079-3182)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-633",
    "fingerprint": "but-ext-fre-kfree-lock-sleep|net/quic/tquic/core/priority.c|tquic_sched_release|memory",
    "title": "tquic_sched_release Frees ext Under Lock but kfree Can Sleep",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/priority.c :: tquic_sched_release. Category=memory, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [
        "tquic_sched_release"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_sched_release\" \"net/quic/tquic/core/priority.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: tquic_sched_release Frees ext Under Lock but kfree Can Sleep (net/quic/tquic/core/priority.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-634",
    "fingerprint": "atomic-context-gfp_kernel-potentially-tquic_stream_alloc|net/quic/tquic/tquic_stream.c|tquic_stream_alloc|concurrency",
    "title": "tquic_stream_alloc Uses GFP_KERNEL in Potentially Atomic Context",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_alloc. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_alloc",
        "tquic_stream"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_alloc\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_alloc Uses GFP_KERNEL in Potentially Atomic Context (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-635",
    "fingerprint": "error-return-tquic_stream_release|net/quic/tquic/tquic_stream.c|tquic_stream_release|correctness",
    "title": "tquic_stream_release Missing Error Return",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/tquic_stream.c :: tquic_stream_release. Category=correctness, severity=S3.\nEvidence union: 1 file(s), 1 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream_release",
        "tquic_stream"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:643-643"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream_release\" \"net/quic/tquic/tquic_stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'tquic_stream_release Missing Error Return', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_release Missing Error Return (net/quic/tquic/tquic_stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-636",
    "fingerprint": "lock-protection-tquic_stream_set_priority|net/quic/tquic/core/stream.c|tquic_stream|concurrency",
    "title": "tquic_stream_set_priority Missing Lock Protection",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/quic/tquic/core/stream.c :: tquic_stream. Category=concurrency, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 1 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream",
        "tquic_stream_set_priority"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_stream_set_priority(struct tquic_stream *stream, u8 priority)\n{\n    stream->priority = priority;\n    return 0;\n}"
      ],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"tquic_stream\" \"net/quic/tquic/core/stream.c\"",
      "rg -n \"tquic_stream_set_priority\" \"net/quic/tquic/core/stream.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Establish one synchronization model for this code path and make all state transitions/lookup paths follow it consistently.",
    "tests_to_add": [
      "Add regression test for: tquic_stream_set_priority Missing Lock Protection (net/quic/tquic/core/stream.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Locking/ordering changes can cause deadlocks or throughput regressions if not validated under stress and teardown races."
  },
  {
    "cid": "CF-637",
    "fingerprint": "drr-empty-iterat-slot-weight|net/tquic/multipath/sched_weighted.c|unknown_symbol|perf",
    "title": "Weighted DRR Iterates Over Empty Slots",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "priority_score": 0.7,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: net/tquic/multipath/sched_weighted.c :: unknown_symbol. Category=perf, severity=S3.\nEvidence union: 1 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "rg -n \"weight\" \"net/tquic/multipath/sched_weighted.c\"",
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Weighted DRR Iterates Over Empty Slots', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Weighted DRR Iterates Over Empty Slots (net/tquic/multipath/sched_weighted.c)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-638",
    "fingerprint": "ack-frame-frequency-inconsistency-type|unknown_file|unknown_symbol|other",
    "title": "ACK Frequency Frame Type Inconsistency",
    "category": "other",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Verify the frame type dispatch logic handles multi-byte frame types correctly.",
    "tests_to_add": [
      "Add regression test for: ACK Frequency Frame Type Inconsistency",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-639",
    "fingerprint": "copy_from_sockptr-setsockopt-sizeof-type|unknown_file|unknown_symbol|memory",
    "title": "copy_from_sockptr in setsockopt Always Uses sizeof(type)",
    "category": "memory",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=memory, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: copy_from_sockptr in setsockopt Always Uses sizeof(type)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-640",
    "fingerprint": "counter-diagnostic-wrap|unknown_file|unknown_symbol|correctness",
    "title": "Diagnostic Counter Wraps",
    "category": "correctness",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: unknown_symbol. Category=correctness, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Diagnostic Counter Wraps', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Diagnostic Counter Wraps",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-641",
    "fingerprint": "cod-error-leak-process-state|unknown_file|unknown_symbol|security",
    "title": "Error Codes Leak Processing State",
    "category": "security",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) B.\nPrimary locus: unknown_file :: unknown_symbol. Category=security, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "B"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Add strict validation and bounds checks at parse boundaries, enforce lifetime/ownership rules, and fail closed on malformed input.",
    "tests_to_add": [
      "Add regression test for: Error Codes Leak Processing State",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Fixes in parser/crypto/lifetime code may alter packet acceptance logic. Watch for interoperability regressions and accidental behavior changes in fast-path RX handling."
  },
  {
    "cid": "CF-642",
    "fingerprint": "frame-immediate_ack-similar-type|unknown_file|unknown_symbol|other",
    "title": "IMMEDIATE_ACK Frame Type Similar Issue",
    "category": "other",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'IMMEDIATE_ACK Frame Type Similar Issue', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: IMMEDIATE_ACK Frame Type Similar Issue",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-643",
    "fingerprint": "congestion-inconsistent-layout-state|unknown_file|unknown_symbol|other",
    "title": "Inconsistent Congestion State Layouts",
    "category": "other",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Inconsistent Congestion State Layouts', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Inconsistent Congestion State Layouts",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-644",
    "fingerprint": "code-duplication-implementation-multiple-varint|unknown_file|unknown_symbol|other",
    "title": "Multiple Varint Implementations (Code Duplication Risk)",
    "category": "other",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "** Consolidate to the single canonical implementation in `core/varint.c` and export symbols for all callers.\n\n---",
    "tests_to_add": [
      "Add regression test for: Multiple Varint Implementations (Code Duplication Risk)",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  },
  {
    "cid": "CF-645",
    "fingerprint": "framework-parallel-scheduler-three|unknown_file|unknown_symbol|other",
    "title": "Three Parallel Scheduler Frameworks",
    "category": "other",
    "severity": "S3",
    "confidence": "low",
    "priority_score": 0.4,
    "summary": "Consolidates 1 report item(s) from source(s) C.\nPrimary locus: unknown_file :: unknown_symbol. Category=other, severity=S3.\nEvidence union: 0 file(s), 0 line range(s), 0 snippet(s).",
    "merged_evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "agreement": {
      "count": 1,
      "sources": [
        "C"
      ]
    },
    "conflicts": [
      "Highest severity S3 retained but weakly evidenced in this cluster.",
      "Single-source finding; independent confirmation still needed."
    ],
    "verification_commands": [
      "make M=net/tquic W=1",
      "make M=net/tquic C=1"
    ],
    "recommended_fix": "Implement an RFC-compliant correction for 'Three Parallel Scheduler Frameworks', then add targeted regression coverage to prevent reintroduction.",
    "tests_to_add": [
      "Add regression test for: Three Parallel Scheduler Frameworks",
      "Add malformed-input negative test that validates graceful error handling."
    ],
    "risk_notes": "Protocol correctness fixes can shift timing/state-machine behavior; verify against interop traces and existing retransmission/loss logic."
  }
]