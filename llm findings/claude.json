[
  {
    "id": "F-001",
    "title": "Retry Token Address Validation Uses Non-Constant-Time Comparison",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 1283 **Code:** ```c memcpy(&token_hash, p, sizeof(token_hash)); if (token_hash != expected_hash) { tquic_con",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [
        "memcpy(&token_hash, p, sizeof(token_hash));\nif (token_hash != expected_hash) {\n    tquic_conn_dbg(conn, \"retry token address mismatch\\n\");\n    return -EINVAL;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 1283 **Code:** ```c memcpy(&token_hash, p, sizeof(token_hash)); if (token_hash != expected_hash) { tquic_conn_dbg(conn, \"retry token address mismatch\\n\"); return -EINVAL; } ``` **Description:** The retry toke",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-002",
    "title": "Connection State Transition Not Fully Atomic",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 266-419 **Code:** ```c static int tquic_conn_set_state(struct tquic_connection *conn, enum tquic_conn_state",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_handle_stateless_reset",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "static int tquic_conn_set_state(struct tquic_connection *conn,\n                                enum tquic_conn_state new_state,\n                                enum tquic_state_reason reason)\n{\n    // ... state validation ...\n    conn->state = new_state;\n    // ... entry actions (scheduling work, wa"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 266-419 **Code:** ```c static int tquic_conn_set_state(struct tquic_connection *conn, enum tquic_conn_state new_state, enum tquic_state_reason reason) { // ... state validation ... conn->state = new_state; /",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-003",
    "title": "ECN CE Count Processing Does Not Track Deltas",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 757-768 **Code:** ```c if (has_ecn && ecn_ce > 0) { /* * Track previous ECN-CE count to detect increase. * For ",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cong_on_ecn",
        "tquic_ecn_tracking"
      ],
      "line_ranges": [],
      "snippets": [
        "if (has_ecn && ecn_ce > 0) {\n    /*\n     * Track previous ECN-CE count to detect increase.\n     * For now, treat any reported CE count as new marks.\n     */\n    tquic_cong_on_ecn(ctx->path, ecn_ce);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 757-768 **Code:** ```c if (has_ecn && ecn_ce > 0) { /* * Track previous ECN-CE count to detect increase. * For now, treat any reported CE count as new marks. */ tquic_cong_on_ecn(ctx->path, ecn_ce); ... } ``` **",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-004",
    "title": "RTT Estimation Uses Approximation Instead of Per-Packet Tracking",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 722-724 **Code:** ```c rtt_us = ktime_us_delta(now, ctx->path->last_activity); if (rtt_us > ack_delay_us) rtt_u",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "rtt_us = ktime_us_delta(now, ctx->path->last_activity);\nif (rtt_us > ack_delay_us)\n    rtt_us -= ack_delay_us;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 722-724 **Code:** ```c rtt_us = ktime_us_delta(now, ctx->path->last_activity); if (rtt_us > ack_delay_us) rtt_us -= ack_delay_us; ``` **Description:** The RTT sample is computed using `path->last_activity` as an",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-005",
    "title": "`ack_delay` Exponent Hardcoded to Default",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Line:** 715 **Code:** ```c u64 ack_delay_us = ack_delay * 8;  /* Default exponent = 3 */ ``` **Description:** The ACK de",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 ack_delay_us = ack_delay * 8;  /* Default exponent = 3 */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Line:** 715 **Code:** ```c u64 ack_delay_us = ack_delay * 8;  /* Default exponent = 3 */ ``` **Description:** The ACK delay exponent is hardcoded to 3 (multiplier 8). RFC 9000 Section 18.2 specifies that this value is ne",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-006",
    "title": "`tquic_varint_len()` Returns 0 for Invalid Values Without Error Propagation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines:** 164-168 **Code:** ```c static inline int tquic_varint_len(u64 val) { // ... (declared elsewhere but used here)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_varint_len"
      ],
      "line_ranges": [],
      "snippets": [
        "static inline int tquic_varint_len(u64 val)\n{\n    // ... (declared elsewhere but used here)\n}\n\nstatic inline int tquic_encode_varint(u8 *buf, size_t buf_len, u64 val)\n{\n    int len = tquic_varint_len(val);\n    if (len > buf_len)\n        return -ENOSPC;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines:** 164-168 **Code:** ```c static inline int tquic_varint_len(u64 val) { // ... (declared elsewhere but used here) }",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-007",
    "title": "Stream Frame Without Length Allows Reading Past Decrypted Buffer",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 904-907 **Code:** ```c } else { /* Length extends to end of packet */ length = ctx->len - ctx->offset; } ``` **",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "} else {\n    /* Length extends to end of packet */\n    length = ctx->len - ctx->offset;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 904-907 **Code:** ```c } else { /* Length extends to end of packet */ length = ctx->len - ctx->offset; } ``` **Description:** When a STREAM frame does not have the LENGTH bit set, the code assumes the data exten",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: C-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-008",
    "title": "`bytes_acked` Estimate Based on First ACK Range is Grossly Inaccurate",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 737-738 **Code:** ```c u64 bytes_acked = (first_ack_range + 1) * 1200; ``` **Description:** The bytes acknowled",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 bytes_acked = (first_ack_range + 1) * 1200;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 737-738 **Code:** ```c u64 bytes_acked = (first_ack_range + 1) * 1200; ``` **Description:** The bytes acknowledged calculation multiplies the ACK range count by a fixed 1200-byte MTU estimate. This is incorrect ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-009",
    "title": "Missing `retire_prior_to > seq_num` Validation in NEW_CONNECTION_ID Processing",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 1116-1183 **Description:** When processing NEW_CONNECTION_ID frames, the code does not validate that `retire_pr",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 1116-1183 **Description:** When processing NEW_CONNECTION_ID frames, the code does not validate that `retire_prior_to <= seq_num` as required by RFC 9000 Section 19.15: \"The value in the Retire Prior To field MU",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-010",
    "title": "Stateless Reset Handling Bypasses Connection State Machine",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 391-408 **Code:** ```c static void tquic_handle_stateless_reset(struct tquic_connection *conn) { spin_lock_bh(&",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    // ...\n    spin_unlock_bh(&conn->lock);\n    if (sk)\n        sk->sk_state_change(sk);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 391-408 **Code:** ```c static void tquic_handle_stateless_reset(struct tquic_connection *conn) { spin_lock_bh(&conn->lock); conn->state = TQUIC_CONN_CLOSED; // ... spin_unlock_bh(&conn->lock); if (sk) sk->sk_sta",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-011",
    "title": "`tquic_output.c` Encode Varint Does Not Check for 0 Return from `tquic_varint_len`",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines:** 164-198 **Description:** The `tquic_encode_varint()` inline function calls `tquic_varint_len()` which can retu",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_varint_len",
        "tquic_encode_varint"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines:** 164-198 **Description:** The `tquic_encode_varint()` inline function calls `tquic_varint_len()` which can return 0 for values exceeding `TQUIC_VARINT_MAX`. If `len` is 0, the check `if (len > buf_len)` passes (",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-012",
    "title": "STREAM Frame `length` Validation Allows Up to 65535 Bytes Per Frame",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 909-910 **Code:** ```c if (length > 65535) return -EINVAL; ``` **Description:** This limit is arbitrary and not",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:912-912",
        "net/tquic/tquic_input.c:912-912"
      ],
      "snippets": [
        "if (length > 65535)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 909-910 **Code:** ```c if (length > 65535) return -EINVAL; ``` **Description:** This limit is arbitrary and not from the RFC. RFC 9000 does not impose a per-frame length limit beyond the packet size. While the i",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-013",
    "title": "`tquic_conn_retire_cid()` Does Not Remove CID from Lookup Hash Table",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 598-627 **Description:** When retiring a CID, the code marks `entry->retired = true` but does not remove th",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_conn_retire_cid",
        "rhashtable_remove_fast"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 598-627 **Description:** When retiring a CID, the code marks `entry->retired = true` but does not remove the entry from `cid_lookup_table` (the rhashtable). This means the global lookup table still maps the ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-014",
    "title": "Missing Validation of `first_ack_range` Against `largest_ack`",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 634-639 and `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/frame.c:358-364` **Description:** RFC 900",
    "evidence": {
      "file_paths": [
        "net/tquic/core/frame.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 634-639 and `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/frame.c:358-364` **Description:** RFC 9000 Section 19.3.1 states: \"The First ACK Range value is the value of the Largest Acknowledged field m",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-015",
    "title": "Stream State Machine Allows Unexpected Transitions from OPEN",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 273-279 **Code:** ```c case TQUIC_STREAM_OPEN: /* Can go to SIZE_KNOWN, DATA_SENT, RESET_SENT, RESET_RECVD */ i",
    "evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_STREAM_OPEN:\n    /* Can go to SIZE_KNOWN, DATA_SENT, RESET_SENT, RESET_RECVD */\n    if (new_state != TQUIC_STREAM_SIZE_KNOWN &&\n        new_state != TQUIC_STREAM_DATA_SENT &&\n        new_state != TQUIC_STREAM_RESET_SENT &&\n        new_state != TQUIC_STREAM_RESET_RECVD)\n        return -EIN"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 273-279 **Code:** ```c case TQUIC_STREAM_OPEN: /* Can go to SIZE_KNOWN, DATA_SENT, RESET_SENT, RESET_RECVD */ if (new_state != TQUIC_STREAM_SIZE_KNOWN && new_state != TQUIC_STREAM_DATA_SENT && new_state != TQUIC",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-016",
    "title": "`ext->final_size = -1` Uses Signed Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Line:** 177 **Code:** ```c ext->final_size = -1; ``` **Description:** `final_size` is likely a `u64` field. Assigning `-",
    "evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ext->final_size = -1;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Line:** 177 **Code:** ```c ext->final_size = -1; ``` **Description:** `final_size` is likely a `u64` field. Assigning `-1` produces `U64_MAX` (0xFFFFFFFFFFFFFFFF). While this is a common sentinel pattern, RFC 9000 limits",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-017",
    "title": "Retry Packet Version Encoding Is Hardcoded for v1",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1328-1329 **Code:** ```c *p++ = 0xf0;  /* Long header, Retry type */ memcpy(p, &conn->version, 4); ``` **De",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_encode_packet_type"
      ],
      "line_ranges": [],
      "snippets": [
        "*p++ = 0xf0;  /* Long header, Retry type */\nmemcpy(p, &conn->version, 4);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1328-1329 **Code:** ```c *p++ = 0xf0;  /* Long header, Retry type */ memcpy(p, &conn->version, 4); ``` **Description:** The first byte `0xf0` encodes Retry type as `0b11` (bits 4-5) which is the QUIC v1 enco",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-018",
    "title": "Retry Integrity Tag Uses Wrong Key/Nonce for QUIC v2",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1356-1363 **Description:** The retry integrity key and nonce are hardcoded for QUIC v1. RFC 9369 Section 3.",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1356-1363 **Description:** The retry integrity key and nonce are hardcoded for QUIC v1. RFC 9369 Section 3.4.2 specifies different keys for QUIC v2: - Key: `8fb4b01b56ac48e260fbcbcead7ccc92` - Nonce: `d86969",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-11. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-019",
    "title": "Version Negotiation Packet Missing Randomized First Byte",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 956-957 **Code:** ```c *p++ = 0x80;  /* Long header */ ``` **Description:** RFC 9000 Section 17.2.1 states ",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "*p++ = 0x80;  /* Long header */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 956-957 **Code:** ```c *p++ = 0x80;  /* Long header */ ``` **Description:** RFC 9000 Section 17.2.1 states for Version Negotiation: \"The value of the unused fields is selected randomly.\" The first byte shoul",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: H-12. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-020",
    "title": "`tquic_fc_conn_data_sent()` Race Between Check and Update",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/flow_control.c` **Lines:** 280-300 **Description:** Although the function holds `fc->conn.lock`, the caller may have checked `tquic_",
    "evidence": {
      "file_paths": [
        "net/tquic/core/flow_control.c"
      ],
      "symbols": [
        "tquic_fc_conn_data_sent",
        "tquic_fc_conn_try_send",
        "tquic_fc_conn_can_send"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/flow_control.c` **Lines:** 280-300 **Description:** Although the function holds `fc->conn.lock`, the caller may have checked `tquic_fc_conn_can_send()` and then called `tquic_fc_conn_data_sent()` without atomicity between the two ca",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-021",
    "title": "`kmem_cache_create()` Per Stream Manager Risks Name Collision",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 118-134 **Description:** Each stream manager creates slab caches with fixed names like `\"tquic_stream_ext\"`. `k",
    "evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [
        "kmem_cache_create"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 118-134 **Description:** Each stream manager creates slab caches with fixed names like `\"tquic_stream_ext\"`. `kmem_cache_create()` requires globally unique names; creating multiple stream managers (multiple conn",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-022",
    "title": "`additional_addr_add()` Has TOCTOU Between Duplicate Check and Insert",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/additional_addresses.c` **Lines:** 169-191 **Description:** The function releases `addrs->lock` after the duplicate check (line 188)",
    "evidence": {
      "file_paths": [
        "net/tquic/core/additional_addresses.c"
      ],
      "symbols": [
        "additional_addr_add"
      ],
      "line_ranges": [
        "net/tquic/core/additional_addresses.c:188-188",
        "net/tquic/core/additional_addresses.c:191-191"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/additional_addresses.c` **Lines:** 169-191 **Description:** The function releases `addrs->lock` after the duplicate check (line 188) and before the `kzalloc()` and re-acquisition (line 191 is outside the lock). Another thread could ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-023",
    "title": "`ring_index()` Uses Unbounded While Loop",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/receive_timestamps.c` **Lines:** 96-103 **Code:** ```c static inline u32 ring_index(u32 head, s32 offset, u32 size) { s32 idx = (s32",
    "evidence": {
      "file_paths": [
        "net/tquic/core/receive_timestamps.c"
      ],
      "symbols": [
        "ring_index"
      ],
      "line_ranges": [],
      "snippets": [
        "static inline u32 ring_index(u32 head, s32 offset, u32 size)\n{\n    s32 idx = (s32)head + offset;\n    while (idx < 0)\n        idx += size;\n    return (u32)(idx % size);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/receive_timestamps.c` **Lines:** 96-103 **Code:** ```c static inline u32 ring_index(u32 head, s32 offset, u32 size) { s32 idx = (s32)head + offset; while (idx < 0) idx += size; return (u32)(idx % size); } ``` **Description:** If `si",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-024",
    "title": "Anti-Replay Hash Table Cleanup Iterates All Buckets Under spinlock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/early_data.c` **Lines:** 196-206 **Description:** The anti-replay check iterates over all 4096 hash buckets under `anti_replay_state",
    "evidence": {
      "file_paths": [
        "net/tquic/core/early_data.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/early_data.c` **Lines:** 196-206 **Description:** The anti-replay check iterates over all 4096 hash buckets under `anti_replay_state.lock` to clean expired entries. This is O(buckets) per check, executed for every 0-RTT packet.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-025",
    "title": "`tquic_process_stream_frame()` Does Not Check Final Size Consistency",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 986-987 **Code:** ```c if (fin) stream->fin_received = true; ``` **Description:** RFC 9000 Section 4.5 requires",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_stream_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "if (fin)\n    stream->fin_received = true;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 986-987 **Code:** ```c if (fin) stream->fin_received = true; ``` **Description:** RFC 9000 Section 4.5 requires: \"Once a final size for a stream is known, it cannot change.\" The code does not check whether a pre",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-026",
    "title": "Connection Close Does Not Validate Reason Phrase Encoding",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 1248-1250 **Description:** RFC 9000 Section 19.19 states the reason phrase \"SHOULD be a UTF-8 encoded string.\" ",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:1248-1248"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 1248-1250 **Description:** RFC 9000 Section 19.19 states the reason phrase \"SHOULD be a UTF-8 encoded string.\" While not mandatory to validate, the reason_len is used to advance the offset without any sanity che",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-027",
    "title": "`tquic_accept()` Holding `sk_lock.slock` Improperly",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 462-481 **Description:** The accept function acquires `sk->sk_lock.slock` (the BH spinlock) while already hold",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "lock_sock",
        "tquic_accept"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 462-481 **Description:** The accept function acquires `sk->sk_lock.slock` (the BH spinlock) while already holding `sk_lock` (from `lock_sock()`). This nesting is technically valid (socket lock ordering allows t",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-028",
    "title": "`tquic_poll()` Checks Stream Data Without Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 574-577 **Code:** ```c if (conn && stream) { if (!skb_queue_empty(&stream->recv_buf)) mask |= EPOLLIN | EPOLLR",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "READ_ONCE",
        "skb_queue_len",
        "skb_queue_empty",
        "tquic_poll"
      ],
      "line_ranges": [],
      "snippets": [
        "if (conn && stream) {\n    if (!skb_queue_empty(&stream->recv_buf))\n        mask |= EPOLLIN | EPOLLRDNORM;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 574-577 **Code:** ```c if (conn && stream) { if (!skb_queue_empty(&stream->recv_buf)) mask |= EPOLLIN | EPOLLRDNORM; } ``` **Description:** `stream->recv_buf` is checked without holding any lock. While `skb_que",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: M-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-029",
    "title": "Multiple Redundant Varint Implementations",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**Files:** `frame.c`, `transport_params.c`, `reliable_reset.c`, `tquic_input.c`, `tquic_output.c`, `varint.h`, `varint.c` **Description:** There are at least 6 separate varint encode/decode implementa",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** `frame.c`, `transport_params.c`, `reliable_reset.c`, `tquic_input.c`, `tquic_output.c`, `varint.h`, `varint.c` **Description:** There are at least 6 separate varint encode/decode implementations across the codebase. This increases maintenance burden and the chance of inconsistent behavior",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-1. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-030",
    "title": "`established_time` Set Twice in Connection State Machine",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 329, 334 **Description:** `conn->stats.established_time = ktime_get()` is set in both CONNECTING and CONNEC",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "ktime_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 329, 334 **Description:** `conn->stats.established_time = ktime_get()` is set in both CONNECTING and CONNECTED entry actions. The CONNECTING value is immediately overwritten when transitioning to CONNECTED.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-031",
    "title": "`tquic_cid_compare()` Marked `__maybe_unused`",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 451 **Description:** The function is marked as possibly unused, suggesting dead code. Either it should be us",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid_compare"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 451 **Description:** The function is marked as possibly unused, suggesting dead code. Either it should be used or removed.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-032",
    "title": "Version Negotiation Packet Size Not Validated Against 256-Byte Buffer",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 951-973 **Description:** The VN packet is built in a 256-byte stack buffer. With two CIDs at maximum 20 byt",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 951-973 **Description:** The VN packet is built in a 256-byte stack buffer. With two CIDs at maximum 20 bytes each and version list, the maximum size is `5 + 1 + 20 + 1 + 20 + 8 = 55` bytes, well within the ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-033",
    "title": "`tquic_sysctl_prefer_v2()` Function Not Declared in Visible Header",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 883 **Description:** `tquic_sysctl_prefer_v2()` is called but not visible in any included header, relying on",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_sysctl_prefer_v2"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 883 **Description:** `tquic_sysctl_prefer_v2()` is called but not visible in any included header, relying on implicit declaration.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-034",
    "title": "`sk->sk_err = -ret` Stores Negative Error Code",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 329 **Code:** ```c sk->sk_err = -ret;  /* Store error for getsockopt */ ``` **Description:** `sk_err` is conven",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "sk->sk_err = -ret;  /* Store error for getsockopt */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 329 **Code:** ```c sk->sk_err = -ret;  /* Store error for getsockopt */ ``` **Description:** `sk_err` is conventionally a positive errno value. The code negates `ret` (which is already negative), producing a pos",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-035",
    "title": "`tquic_store_session_ticket()` Does Not Store ALPN or Transport Parameters",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_handshake.c` **Lines:** 295-296 **Code:** ```c plaintext.alpn_len = 0; plaintext.transport_params_len = 0; ``` **Description:** The",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_handshake.c"
      ],
      "symbols": [
        "tquic_store_session_ticket",
        "tquic_validate_zero_rtt_transport_params"
      ],
      "line_ranges": [],
      "snippets": [
        "plaintext.alpn_len = 0;\nplaintext.transport_params_len = 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_handshake.c` **Lines:** 295-296 **Code:** ```c plaintext.alpn_len = 0; plaintext.transport_params_len = 0; ``` **Description:** The session ticket does not save the ALPN or transport parameters. RFC 9001 Section 4.6.1 requires that",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-036",
    "title": "Slab Cache Names Are Not Module-Prefixed",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 118-134 **Description:** Slab cache names like `\"tquic_stream_ext\"` should use a consistent prefix to avoid col",
    "evidence": {
      "file_paths": [
        "net/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/stream.c` **Lines:** 118-134 **Description:** Slab cache names like `\"tquic_stream_ext\"` should use a consistent prefix to avoid collisions with other kernel modules.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CORE_CORRECTNESS.md. Original finding ID: L-8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-037",
    "title": "Buffer Overflow in ClientHello Extension Building",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~1076 (tquic_hs_build_ch_extensions) - **Description:** The function `tquic_hs_build_ch_extensions()` w",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_build_ch_extensions"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~1076 (tquic_hs_build_ch_extensions) - **Description:** The function `tquic_hs_build_ch_extensions()` writes extension data into `buf` without consistently checking against `buf_len`. When multiple exten",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: C1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-038",
    "title": "Stack Buffer Overflow in HKDF-Expand-Label",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~735 (tquic_hs_hkdf_expand_label) - **Description:** The function uses a 512-byte stack buffer `hkdf_la",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:238-238"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~735 (tquic_hs_hkdf_expand_label) - **Description:** The function uses a 512-byte stack buffer `hkdf_label` but does not adequately validate the combined size of `label_len + context_len` before writing ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: C2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-039",
    "title": "Fragile Hardcoded Offset for Key Update State Access",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Line:** ~1143 (tquic_crypto_get_key_update_state) - **Description:** The function `tquic_crypto_get_key_update",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "container_of",
        "tquic_key_update_state",
        "tquic_crypto_get_key_update_state"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Line:** ~1143 (tquic_crypto_get_key_update_state) - **Description:** The function `tquic_crypto_get_key_update_state()` uses a hardcoded byte offset (304 bytes) to access the `key_update` pointer from an opaque",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: C3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-040",
    "title": "Per-Call crypto_aead_setkey in Encrypt/Decrypt Hot Path",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` - **Line:** Throughout encrypt/decrypt functions - **Description:** `crypto_aead_setkey()` is called on every encrypt and",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "crypto_aead_setkey"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` - **Line:** Throughout encrypt/decrypt functions - **Description:** `crypto_aead_setkey()` is called on every encrypt and decrypt operation. In the kernel crypto API, `setkey` may trigger key expansion (AES key schedule),",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-041",
    "title": "Per-Call crypto_alloc_aead in 0-RTT Encrypt/Decrypt",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` - **Lines:** ~1523 (tquic_zero_rtt_encrypt), ~1753 (tquic_zero_rtt_decrypt) - **Description:** Both `tquic_zero_rtt_",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "tquic_zero_rtt_attempt",
        "tquic_zero_rtt_init",
        "tquic_zero_rtt_encrypt",
        "tquic_zero_rtt_decrypt",
        "crypto_alloc_aead"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` - **Lines:** ~1523 (tquic_zero_rtt_encrypt), ~1753 (tquic_zero_rtt_decrypt) - **Description:** Both `tquic_zero_rtt_encrypt()` and `tquic_zero_rtt_decrypt()` call `crypto_alloc_aead()` on every invocation. This alloc",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-042",
    "title": "Custom ASN.1 Parser - High Attack Surface",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 139-192 (asn1_get_length, asn1_get_tag_length) - **Description:** The certificate verification modul",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 139-192 (asn1_get_length, asn1_get_tag_length) - **Description:** The certificate verification module implements a custom ASN.1/DER parser rather than using the kernel's existing ASN.1 infrastructure ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-043",
    "title": "OCSP Stapling Accepted Without Verification",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2094-2131 (tquic_check_revocation) - **Description:** When OCSP stapling data is present, the functi",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2094-2131 (tquic_check_revocation) - **Description:** When OCSP stapling data is present, the function immediately returns success without parsing or verifying the OCSP response. The comment says \"For",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-044",
    "title": "Race Condition in Key Update Secret Installation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Line:** ~854 (tquic_key_update_install_secrets) - **Description:** The function installs secrets under the spi",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Line:** ~854 (tquic_key_update_install_secrets) - **Description:** The function installs secrets under the spinlock, then drops the lock to perform key derivation (which may sleep), then re-acquires the lock to",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-045",
    "title": "Client Certificate Verification Uses Server Logic",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2586-2594 (tquic_hs_verify_client_cert) - **Description:** `tquic_hs_verify_client_cert()` directly ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_hs_verify_client_cert",
        "tquic_hs_verify_server_cert",
        "verify_chain",
        "tquic_handshake",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2586-2594 (tquic_hs_verify_client_cert) - **Description:** `tquic_hs_verify_client_cert()` directly calls `tquic_hs_verify_server_cert()`, which always passes `true` for `is_server` in the chain verif",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: H6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-046",
    "title": "Transcript Buffer Not Zeroized Before Free",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~3251 (tquic_hs_cleanup) - **Description:** The handshake cleanup function zeroizes most cryptographic ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "kfree_sensitive",
        "memzero_explicit"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Line:** ~3251 (tquic_hs_cleanup) - **Description:** The handshake cleanup function zeroizes most cryptographic secrets but does not zeroize the transcript buffer before freeing it. The transcript contains the fu",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-047",
    "title": "Bloom Filter False Negatives Allow Replay",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` - **Lines:** 755-922 (replay filter) - **Description:** The bloom filter anti-replay mechanism is probabilistic. Wit",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` - **Lines:** 755-922 (replay filter) - **Description:** The bloom filter anti-replay mechanism is probabilistic. With a 64K-bit filter and 4 hash functions, the false positive rate is reasonable, but rotation clears ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-048",
    "title": "Per-Call crypto_alloc_shash in Stateless Reset Token Generation",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` - **Description:** `tquic_stateless_reset_generate_token()` allocates a new `crypto_shash` transform on every ",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_generate_token"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` - **Description:** `tquic_stateless_reset_generate_token()` allocates a new `crypto_shash` transform on every call. Under a stateless reset flood attack, this creates excessive memory allocation pressure. - **I",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-049",
    "title": "RSA-PSS Hash Algorithm Always Defaults to SHA-256",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 228-232 (identify_sig_algo) - **Description:** When an RSA-PSS signature algorithm OID is detected, ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 228-232 (identify_sig_algo) - **Description:** When an RSA-PSS signature algorithm OID is detected, the hash algorithm always defaults to SHA-256 without parsing the RSA-PSS parameters that specify th",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-050",
    "title": "Time Parsing Does Not Validate Digit Characters",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 1210-1254 (parse_time) - **Description:** The `parse_time()` function converts ASCII digit character",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "parse_time"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 1210-1254 (parse_time) - **Description:** The `parse_time()` function converts ASCII digit characters to integers using subtraction (`t[0] - '0'`) without verifying the characters are actually digits.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-051",
    "title": "Missing Bounds Check on tbs Pointer in Signature Parse",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 1616-1618 (tquic_x509_cert_parse, after parse_tbs_certificate) - **Description:** After `parse_tbs_c",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "parse_tbs_certificate",
        "parse_signature"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 1616-1618 (tquic_x509_cert_parse, after parse_tbs_certificate) - **Description:** After `parse_tbs_certificate()`, the code computes `after_tbs = cert->tbs + cert->tbs_len` and `remaining = content_le",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-052",
    "title": "EKU Request ID Increment Outside Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` - **Lines:** 437-440 (tquic_eku_request) - **Description:** The `next_request_id` is incremented under th",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/extended_key_update.c:440-440",
        "net/tquic/crypto/extended_key_update.c:451-451"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` - **Lines:** 437-440 (tquic_eku_request) - **Description:** The `next_request_id` is incremented under the lock, but then the lock is dropped before the request is fully constructed and re-inserted. Betwee",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-053",
    "title": "QAT Encrypt Sets Key on Every Call",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 919 (tquic_qat_encrypt) - **Description:** `tquic_qat_encrypt()` calls `crypto_aead_setkey()` on ever",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [
        "tquic_qat_encrypt",
        "crypto_aead_setkey"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 919 (tquic_qat_encrypt) - **Description:** `tquic_qat_encrypt()` calls `crypto_aead_setkey()` on every encryption operation. For QAT hardware, key setup involves sending the key to the hardware acceler",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-054",
    "title": "Shared Exporter and Resumption Secrets Not Zeroized",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Description:** The `exporter_secret` and `resumption_secret` derived during the handshake are stored for later ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "memzero_explicit"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` - **Description:** The `exporter_secret` and `resumption_secret` derived during the handshake are stored for later use but are not zeroized in the cleanup path after they are no longer needed. These secrets could en",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M9. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-055",
    "title": "Self-Signed Certificate Check Uses memcmp Instead of crypto_memneq",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Line:** 1928 (tquic_x509_verify_signature) - **Description:** The self-signed detection in `tquic_x509_verify",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_x509_verify_signature",
        "crypto_memneq",
        "tquic_x509_cert_parse"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:1628-1628"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Line:** 1928 (tquic_x509_verify_signature) - **Description:** The self-signed detection in `tquic_x509_verify_signature()` uses `memcmp()` for comparing issuer and subject DNs, while the same check in `tquic_x",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: M10. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-056",
    "title": "Unused HKDF-Expand Output in Extended Key Update",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` - **Lines:** 829-850 (tquic_eku_derive_keys) - **Description:** When PSK is included, the function derive",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` - **Lines:** 829-850 (tquic_eku_derive_keys) - **Description:** When PSK is included, the function derives a `mixed_secret` via HKDF-Extract but then zeroizes it immediately without actually using it in th",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-057",
    "title": "Header Protection Mask Not Zeroized in All Error Paths",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` - **Description:** While the main code path properly zeroizes the mask buffer after use, some error return ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "memzero_explicit"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` - **Description:** While the main code path properly zeroizes the mask buffer after use, some error return paths may leave partial mask data on the stack. - **Impact:** Minimal - mask data is not directly se",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-058",
    "title": "Per-CPU Stats Not Protected Against Torn Reads on 32-bit",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 992-1005 (tquic_crypto_get_stats) - **Description:** The 64-bit per-CPU statistics are read with `REA",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [
        "READ_ONCE"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 992-1005 (tquic_crypto_get_stats) - **Description:** The 64-bit per-CPU statistics are read with `READ_ONCE()` but on 32-bit architectures, a 64-bit read is not atomic and can produce torn values. - **",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-059",
    "title": "Procfs trusted_cas File Writable Without Capability Check",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2862-2863 - **Description:** The `/proc/net/tquic_cert/trusted_cas` file is created with mode 0644, ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_proc_trusted_cas_write"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2862-2863 - **Description:** The `/proc/net/tquic_cert/trusted_cas` file is created with mode 0644, making it writable by root. However, there is no explicit capability check (e.g., `CAP_NET_ADMIN`) i",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-060",
    "title": "Module Parameters Expose Security Configuration",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 121-126 (sysctl tunables) - **Description:** Security-critical parameters like `tquic_cert_verify_mo",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 121-126 (sysctl tunables) - **Description:** Security-critical parameters like `tquic_cert_verify_mode` and `tquic_cert_revocation_mode` are controlled via sysctl. A privileged attacker could disable ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-061",
    "title": "Batch Crypto Allocates Per-Packet Temporary Buffer",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 694-727 (tquic_crypto_batch_encrypt) - **Description:** The batch encryption function allocates a tem",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` - **Lines:** 694-727 (tquic_crypto_batch_encrypt) - **Description:** The batch encryption function allocates a temporary `ct_buf` via `kmalloc(GFP_ATOMIC)` for each packet in the batch, then copies the result back.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-062",
    "title": "Key Update Timeout Revert Could Race With Concurrent Update",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Description:** The key update timeout/revert mechanism (3*PTO timeout) could race with a legitimate late key p",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` - **Description:** The key update timeout/revert mechanism (3*PTO timeout) could race with a legitimate late key phase acknowledgment from the peer. If the timeout fires just as the peer's response arrives, both pa",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-063",
    "title": "Certificate Chain Length Limit Checked Late",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2362-2427 (tquic_verify_cert_chain) - **Description:** The certificate chain parsing loop checks `TQ",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.h",
        "net/tquic/crypto/handshake.c",
        "net/tquic/crypto/cert_verify.c",
        "net/tquic/tquic_stateless_reset.c",
        "net/tquic/crypto/zero_rtt.h",
        "net/tquic/crypto/header_protection.c",
        "net/tquic/crypto/crypto_module.c",
        "net/tquic/core/quic_crypto.c",
        "net/tquic/crypto/key_update.h",
        "net/tquic/crypto/key_update.c",
        "net/tquic/crypto/tls.c",
        "net/tquic/crypto/hw_offload.c",
        "net/tquic/crypto/extended_key_update.h",
        "net/tquic/crypto/zero_rtt.c",
        "net/tquic/crypto/hw_offload.h",
        "net/tquic/tquic_token.c",
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "memzero_explicit",
        "get_random_bytes",
        "crypto_memneq",
        "tquic_zero_rtt_decrypt"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` - **Lines:** 2362-2427 (tquic_verify_cert_chain) - **Description:** The certificate chain parsing loop checks `TQUIC_MAX_CERT_CHAIN_LEN` at the end of the loop body, meaning it will parse and allocate one certific",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_CRYPTO_SECURITY.md. Original finding ID: L8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-064",
    "title": "QPACK Dynamic Table Duplicate: Use-After-Free via Lock Drop",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_dynamic.c` - **Lines:** ~345-356 - **Description:** `qpack_dynamic_table_duplicate()` looks up a source entry pointer under",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_dynamic.c"
      ],
      "symbols": [
        "qpack_dynamic_table_duplicate"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_dynamic.c` - **Lines:** ~345-356 - **Description:** `qpack_dynamic_table_duplicate()` looks up a source entry pointer under the table spinlock, then drops the lock to perform a `kmalloc(GFP_KERNEL)` allocation, then re-acqu",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: C1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-065",
    "title": "HTTP/3 Stream Lookup: Use-After-Free",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** `h3_stream_lookup()` function - **Description:** `h3_stream_lookup()` returns a raw pointer to an `h",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "h3_stream_lookup",
        "h3_stream_put"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** `h3_stream_lookup()` function - **Description:** `h3_stream_lookup()` returns a raw pointer to an `h3_stream` without incrementing its reference count. Callers use this pointer outside the lock that p",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: C2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-066",
    "title": "Connection Destroy Calls Sleeping Function Under Spinlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** `h3_connection_destroy()` function - **Description:** `h3_connection_destroy()` iterates over stream",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "h3_connection_destroy",
        "tquic_stream_close"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** `h3_connection_destroy()` function - **Description:** `h3_connection_destroy()` iterates over streams under a spinlock and calls `tquic_stream_close()` for each. `tquic_stream_close()` may invoke allo",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: C3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-067",
    "title": "Path Metrics Netlink: Unbounded Allocation from Attacker-Influenced Value",
    "category": "perf",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** ~469 (`tquic_nl_get_all_paths()`) - **Description:** The function allocates `nlmsg_new(NLMSG_DEFAULT_",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [
        "tquic_nl_get_all_paths"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** ~469 (`tquic_nl_get_all_paths()`) - **Description:** The function allocates `nlmsg_new(NLMSG_DEFAULT_SIZE * conn->num_paths, GFP_KERNEL)`. `conn->num_paths` is influenced by the number of paths on a co",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: C4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-068",
    "title": "Path Metrics Netlink: Missing CAP_NET_ADMIN Permission Check",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** All netlink handler functions - **Description:** The genetlink operations for path metrics export (`t",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** All netlink handler functions - **Description:** The genetlink operations for path metrics export (`tquic_nl_get_path_metrics`, `tquic_nl_get_all_paths`, `tquic_nl_subscribe_events`) do not require `CA",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-069",
    "title": "QPACK Decoder: Unbounded Blocked Stream Memory Exhaustion",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_decoder.c` - **Lines:** ~320 - **Description:** When a header block references a dynamic table entry that has not yet been ",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_decoder.c` - **Lines:** ~320 - **Description:** When a header block references a dynamic table entry that has not yet been received (insert count > known received count), the decoder stores the entire header block data via ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-070",
    "title": "WebTransport Context Destroy: Lock Drop During Iteration",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** `context_destroy()` function - **Description:** During WebTransport context destruction, the functio",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [
        "context_destroy"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** `context_destroy()` function - **Description:** During WebTransport context destruction, the function iterates over sessions and drops/re-acquires the lock for cleanup operations. This creates a windo",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-071",
    "title": "WebTransport: Unbounded Capsule Buffer Growth",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** Capsule buffer accumulation - **Description:** The capsule parsing code accumulates incoming capsule",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** Capsule buffer accumulation - **Description:** The capsule parsing code accumulates incoming capsule data into `capsule_buf` without enforcing a maximum total size. A remote peer can send an arbitrari",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-072",
    "title": "HTTP/3 Settings Frame Length Truncation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** ~1127 (`h3_connection_send_settings()`) - **Description:** The settings frame length is cast to `u8`",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "h3_connection_send_settings"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_stream.c` - **Lines:** ~1127 (`h3_connection_send_settings()`) - **Description:** The settings frame length is cast to `u8`: `*len_pos = (u8)settings_len;`. If the total settings payload exceeds 255 bytes, the length field ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-073",
    "title": "QPACK Encoder: Insert Count Increment Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_encoder.c` - **Lines:** ~704 - **Description:** The Insert Count Increment instruction handler adds the received value to `",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_encoder.c` - **Lines:** ~704 - **Description:** The Insert Count Increment instruction handler adds the received value to `known_received_count` without overflow checking: `known_received_count += value;`. An attacker can s",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-074",
    "title": "HTTP/3 Request: TOCTOU Between State Check and Send",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_request.c` - **Lines:** ~156-173 (`h3_request_send_headers()`) - **Description:** The function checks the stream state unde",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_request_send_headers"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_request.c` - **Lines:** ~156-173 (`h3_request_send_headers()`) - **Description:** The function checks the stream state under a lock, releases the lock, then performs the actual send operation without the lock. Between the c",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: H7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-075",
    "title": "HTTP/3 Frame Parsing: 16MB Maximum Frame Payload",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_frame.c` - **Lines:** `H3_MAX_FRAME_PAYLOAD_SIZE` definition - **Description:** `H3_MAX_FRAME_PAYLOAD_SIZE` is set to 16MB.",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_frame.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_frame.c` - **Lines:** `H3_MAX_FRAME_PAYLOAD_SIZE` definition - **Description:** `H3_MAX_FRAME_PAYLOAD_SIZE` is set to 16MB. While this is a valid limit, it means a single frame can cause a 16MB kernel allocation. Under memo",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-076",
    "title": "QPACK Huffman Decoder: O(n*256) Complexity",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack.c` - **Lines:** Huffman decode function - **Description:** The Huffman decoder uses a brute-force O(n * 256) algorithm that",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack.c` - **Lines:** Huffman decode function - **Description:** The Huffman decoder uses a brute-force O(n * 256) algorithm that iterates over all 256 possible symbols for each input byte. This is significantly slower than a pro",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-077",
    "title": "QPACK Integer Decode: Shift Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack.c` - **Lines:** QPACK integer decode function - **Description:** The QPACK integer decode loop accumulates `value |= (byte ",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack.c` - **Lines:** QPACK integer decode function - **Description:** The QPACK integer decode loop accumulates `value |= (byte & 0x7f) << shift` and increments `shift` by 7 each iteration. If the input contains many continuatio",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-078",
    "title": "QPACK Encoder/Decoder: Excessive Stack Usage",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_encoder.c`, `qpack_decoder.c` - **Lines:** Various encode/decode functions - **Description:** Multiple functions allocate l",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/qpack_encoder.c"
      ],
      "symbols": [
        "qpack_encoder_insert_literal",
        "qpack_encoder_insert_name_ref"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/qpack_encoder.c`, `qpack_decoder.c` - **Lines:** Various encode/decode functions - **Description:** Multiple functions allocate large buffers on the stack: - `qpack_decoder`: `name_buf[256]` + `value_buf[8192]` = 8448 bytes - `qp",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-079",
    "title": "HTTP/3 Settings Parser: TOCTOU on Settings Count",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_frame.c` - **Lines:** Settings parsing function - **Description:** The settings parser checks the count/length of settings,",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_frame.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_frame.c` - **Lines:** Settings parsing function - **Description:** The settings parser checks the count/length of settings, then processes them in a separate pass. If the underlying data can change between the check and the",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-080",
    "title": "HTTP/3 Connection: O(n) Push Entry Counting",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_conn.c` - **Lines:** Push stream management functions - **Description:** The connection counts push entries by iterating th",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_conn.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_conn.c` - **Lines:** Push stream management functions - **Description:** The connection counts push entries by iterating the entire push list on each operation, resulting in O(n) complexity. An attacker can create many push",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-081",
    "title": "WebTransport: TOCTOU in Datagram Queue Push",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** Datagram queue management - **Description:** The datagram queue checks its current size, then pushes",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/webtransport.c` - **Lines:** Datagram queue management - **Description:** The datagram queue checks its current size, then pushes a new element. If two threads push concurrently, both may see the queue as under-limit and both pus",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-082",
    "title": "Qlog Ring Buffer: Not Truly Lock-Free",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** Ring buffer implementation - **Description:** The qlog ring buffer is documented as lock-free but actually us",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** Ring buffer implementation - **Description:** The qlog ring buffer is documented as lock-free but actually uses a spinlock for write operations. Under high event rates, this creates contention on the hot path.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-083",
    "title": "Qlog: JSON Strings Not Escaped",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** JSON emission functions - **Description:** When emitting JSON-formatted qlog events, string values (such as r",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** JSON emission functions - **Description:** When emitting JSON-formatted qlog events, string values (such as reason phrases from CONNECTION_CLOSE frames) are included without JSON escaping. If a reason phrase c",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M9. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-084",
    "title": "Path Metrics Subscription: Timer/Connection Lifetime Race",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** Subscription timer callback - **Description:** A metrics subscription timer can fire after the associ",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/path_metrics.c"
      ],
      "symbols": [
        "tquic_metrics_unsubscribe_conn",
        "del_timer_sync"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/path_metrics.c` - **Lines:** Subscription timer callback - **Description:** A metrics subscription timer can fire after the associated connection has been freed, if `tquic_metrics_unsubscribe_conn()` races with the timer callback.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: M10. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-085",
    "title": "Duplicate Static Functions: h3_varint_encode/decode",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_request.c`, `http3_stream.c` - **Lines:** Static `h3_varint_encode()` and `h3_varint_decode()` functions - **Description:**",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_varint_encode",
        "h3_varint_decode"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_request.c`, `http3_stream.c` - **Lines:** Static `h3_varint_encode()` and `h3_varint_decode()` functions - **Description:** Both files contain independent static implementations of varint encode/decode functions. If one is ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: L1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-086",
    "title": "HTTP/3 Priority: push_buckets Not Initialized",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_priority.c` - **Lines:** `push_buckets[]` array - **Description:** The `push_buckets[]` array used for server push scheduli",
    "evidence": {
      "file_paths": [
        "net/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/http3/http3_priority.c` - **Lines:** `push_buckets[]` array - **Description:** The `push_buckets[]` array used for server push scheduling is not explicitly initialized in the priority scheduler initialization path. It relies on the str",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: L2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-087",
    "title": "Qlog: Lock Drop Around copy_to_user",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** Ring buffer read path - **Description:** The qlog read path drops the ring buffer lock before calling `copy_t",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/qlog.c"
      ],
      "symbols": [
        "copy_to_user"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/qlog.c` - **Lines:** Ring buffer read path - **Description:** The qlog read path drops the ring buffer lock before calling `copy_to_user()` (which may sleep). This is correct behavior (you cannot hold a spinlock across `copy_to_us",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: L3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-088",
    "title": "Benchmark Code: Userspace, Not Kernel",
    "category": "build",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bench/bench_common.c` and related files - **Lines:** All benchmark files - **Description:** The benchmark code in `net/tquic/bench/` is",
    "evidence": {
      "file_paths": [
        "net/tquic/bench/bench_common.c",
        "net/tquic/bench/"
      ],
      "symbols": [
        "qpack_static_get",
        "min_t",
        "quic_trace_conn_id"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bench/bench_common.c` and related files - **Lines:** All benchmark files - **Description:** The benchmark code in `net/tquic/bench/` is userspace code using libc functions (`printf`, `malloc`, `FILE *`, `math.h`). It does not run in ke",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_HTTP3_MISC.md. Original finding ID: L4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-089",
    "title": "Redundant Scheduler Deduplication Uses Only 8-bit Sequence Hash -- Trivial Collision",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1308-1332 - **Code:** ```c bool tquic_redundant_is_duplicate(struct tquic_connection *conn, u",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "bool tquic_redundant_is_duplicate(struct tquic_connection *conn, u64 seq)\n{\n    seq_byte = (u8)(seq & 0xFF);\n    for (i = 0; i < 256; i++) {\n        if (rd->dedup_window[i] == seq_byte) {\n            return true;  /* Duplicate found */\n        }\n    }\n    rd->dedup_window[rd->dedup_head] = seq_byte;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1308-1332 - **Code:** ```c bool tquic_redundant_is_duplicate(struct tquic_connection *conn, u64 seq) { seq_byte = (u8)(seq & 0xFF); for (i = 0; i < 256; i++) { if (rd->dedup_window[i] == seq_by",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: C-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-090",
    "title": "Adaptive Scheduler CWND Underflow in Score Calculation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1473-1478 - **Code:** ```c if (path->cc.cwnd == 0) cwnd_score = 0; else { cwnd_avail = path->",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (path->cc.cwnd == 0)\n    cwnd_score = 0;\nelse {\n    cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight;\n    cwnd_score = (cwnd_avail * 1000) / path->cc.cwnd;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1473-1478 - **Code:** ```c if (path->cc.cwnd == 0) cwnd_score = 0; else { cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight; cwnd_score = (cwnd_avail * 1000) / path->cc.cwnd; } ``` - **Impa",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: C-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-091",
    "title": "ACK Range Failover Can Iterate Over Unbounded Packet Number Range",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 534-549 - **Code:** ```c int tquic_failover_on_ack_range(struct tquic_failover_ctx *fc, u64 first, ",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover_ctx"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_failover_on_ack_range(struct tquic_failover_ctx *fc,\n                                u64 first, u64 last)\n{\n    for (pkt_num = first; pkt_num <= last; pkt_num++) {\n        if (tquic_failover_on_ack(fc, pkt_num) == 0)\n            count++;\n    }\n    return count;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 534-549 - **Code:** ```c int tquic_failover_on_ack_range(struct tquic_failover_ctx *fc, u64 first, u64 last) { for (pkt_num = first; pkt_num <= last; pkt_num++) { if (tquic_failover_on_ack(fc, pkt_nu",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: C-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-092",
    "title": "Path Validation Timeout Accesses Path State Without Lock After Unlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 144-158 - **Code:** ```c /* Retry validation */ path->validation.retries++; spin_unlock_bh(&conn->pa",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "tquic_path_handle_response"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Retry validation */\npath->validation.retries++;\nspin_unlock_bh(&conn->paths_lock);\n\n/* Resend PATH_CHALLENGE */\nif (tquic_path_send_challenge(conn, path) == 0) {\n    u32 timeout_us = tquic_validation_timeout_us(path);\n    // ... accesses path->stats after lock release"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 144-158 - **Code:** ```c /* Retry validation */ path->validation.retries++; spin_unlock_bh(&conn->paths_lock);",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-093",
    "title": "Migration State Stores Raw Path Pointers Without Reference Counting",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 199-215, 858-870 - **Code:** ```c struct tquic_migration_state { struct tquic_path *old_path; struct tq",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migration_state",
        "tquic_path",
        "tquic_migration_work_handler",
        "tquic_migration_timeout"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_migration_state {\n    struct tquic_path *old_path;\n    struct tquic_path *new_path;\n    // ...\n};\n// ...\nms->old_path = conn->active_path;\nms->new_path = best_path;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 199-215, 858-870 - **Code:** ```c struct tquic_migration_state { struct tquic_path *old_path; struct tquic_path *new_path; // ... }; // ... ms->old_path = conn->active_path; ms->new_path = best_path; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-094",
    "title": "Failover Retransmit Queue Can Exceed Memory Limits",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 600-611 - **Code:** ```c if (requeued >= TQUIC_FAILOVER_MAX_QUEUED) { pr_warn_ratelimited(...); bre",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (requeued >= TQUIC_FAILOVER_MAX_QUEUED) {\n    pr_warn_ratelimited(...);\n    break;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 600-611 - **Code:** ```c if (requeued >= TQUIC_FAILOVER_MAX_QUEUED) { pr_warn_ratelimited(...); break; } ``` - **Impact:** The TQUIC_FAILOVER_MAX_QUEUED limit (1024 packets) is enforced per path fail",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-095",
    "title": "Hysteresis Counters Use Non-Atomic READ_ONCE/WRITE_ONCE Without Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 198-199, 688-689 - **Code:** ```c WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + ",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "tquic_failover_timeout_work",
        "tquic_failover_update_path_ack"
      ],
      "line_ranges": [],
      "snippets": [
        "WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1);\nWRITE_ONCE(pt->consec_successes, 0);\n// ... and in update_path_ack:\nWRITE_ONCE(pt->consec_successes, READ_ONCE(pt->consec_successes) + 1);\nWRITE_ONCE(pt->consec_failures, 0);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 198-199, 688-689 - **Code:** ```c WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1); WRITE_ONCE(pt->consec_successes, 0); // ... and in update_path_ack: WRITE_ONCE(pt->consec_succes",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-096",
    "title": "Path Manager Uses init_net Instead of Per-Connection Net Namespace",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 424 - **Code:** ```c for_each_netdev(&init_net, dev) { ``` - **Impact:** In a containerized environment",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [
        "tquic_pm_discover_addresses",
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "for_each_netdev(&init_net, dev) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 424 - **Code:** ```c for_each_netdev(&init_net, dev) { ``` - **Impact:** In a containerized environment, `tquic_pm_discover_addresses()` iterates over devices in the init namespace rather than the connec",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-097",
    "title": "Bonding State Machine Missing Lock on State Transition Checks",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` - **Lines:** 221-247 - **Code:** ```c static void tquic_bonding_set_state(struct tquic_bonding_ctx *bc, enum tqui",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_ctx",
        "tquic_bonding_set_state"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_bonding_set_state(struct tquic_bonding_ctx *bc,\n                                    enum tquic_bonding_state new_state)\n{\n    enum tquic_bonding_state old_state = bc->state;\n    // ... no lock acquisition ...\n    bc->state = new_state;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` - **Lines:** 221-247 - **Code:** ```c static void tquic_bonding_set_state(struct tquic_bonding_ctx *bc, enum tquic_bonding_state new_state) { enum tquic_bonding_state old_state = bc->state; // ... no lock acquisit",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-098",
    "title": "CID Lookup Returns Connection Without Reference Count",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` - **Lines:** 530-542 - **Code:** ```c struct tquic_connection *tquic_cid_lookup(const struct tquic_cid *cid) { entry = rha",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "kfree_rcu",
        "tquic_cid",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_connection *tquic_cid_lookup(const struct tquic_cid *cid)\n{\n    entry = rhashtable_lookup_fast(&tquic_cid_table, cid, cid_rht_params);\n    if (entry && entry->state == CID_STATE_ACTIVE)\n        return entry->conn;\n    return NULL;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` - **Lines:** 530-542 - **Code:** ```c struct tquic_connection *tquic_cid_lookup(const struct tquic_cid *cid) { entry = rhashtable_lookup_fast(&tquic_cid_table, cid, cid_rht_params); if (entry && entry->state == CID_STATE_A",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-099",
    "title": "Weighted Scheduler Index Assumption Breaks After Path Removal",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 820-855 - **Code:** ```c list_for_each_entry_rcu(path, &conn->paths, list) { if (idx == path_",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "list_for_each_entry_rcu(path, &conn->paths, list) {\n    if (idx == path_idx) {\n        pd = &wd->path_data[path_idx];\n        pd->deficit += ...;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 820-855 - **Code:** ```c list_for_each_entry_rcu(path, &conn->paths, list) { if (idx == path_idx) { pd = &wd->path_data[path_idx]; pd->deficit += ...; ``` - **Impact:** The weighted scheduler u",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: H-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-100",
    "title": "Path Creation Uses static atomic_t for path_id -- Not Per-Connection",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 394, 409 - **Code:** ```c static atomic_t path_id_gen = ATOMIC_INIT(0); path->path_id = atomic_inc_retu",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static atomic_t path_id_gen = ATOMIC_INIT(0);\npath->path_id = atomic_inc_return(&path_id_gen);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 394, 409 - **Code:** ```c static atomic_t path_id_gen = ATOMIC_INIT(0); path->path_id = atomic_inc_return(&path_id_gen); ``` - **Impact:** Path IDs are globally unique across all connections rather than ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-101",
    "title": "Round-Robin Scheduler Iterates Path List Without Position Stability",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 655-725 - **Impact:** The round-robin scheduler finds its starting point by matching `path_id",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 655-725 - **Impact:** The round-robin scheduler finds its starting point by matching `path_id >= rr->next_path_id`. If the previously-selected path is removed and a new path is added with a low",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-102",
    "title": "Anti-Amplification Check Has TOCTOU Race",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 85-105 - **Code:** ```c received = atomic64_read(&path->anti_amplification.bytes_received); sent = atom",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_anti_amplification_sent"
      ],
      "line_ranges": [],
      "snippets": [
        "received = atomic64_read(&path->anti_amplification.bytes_received);\nsent = atomic64_read(&path->anti_amplification.bytes_sent);\nlimit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;\nif (sent + bytes > limit) { return false; }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 85-105 - **Code:** ```c received = atomic64_read(&path->anti_amplification.bytes_received); sent = atomic64_read(&path->anti_amplification.bytes_sent); limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT; ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-103",
    "title": "Path Manager discover_addresses Holds rtnl_lock While Accessing inet6_dev",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 422-482 - **Impact:** The function holds `rtnl_lock()` for the entire iteration over all network device",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [
        "rtnl_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 422-482 - **Impact:** The function holds `rtnl_lock()` for the entire iteration over all network devices and their addresses. It then also takes `idev->lock` (read_lock_bh) for IPv6. This has lock orderi",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-104",
    "title": "Coupled CC Alpha Calculation Has Precision Loss",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` - **Lines:** 199-213 - **Impact:** When `sum_cwnd_rtt > 2^32`, the code shifts down before squaring. The shift_cou",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "mul_u64_u64_div"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` - **Lines:** 199-213 - **Impact:** When `sum_cwnd_rtt > 2^32`, the code shifts down before squaring. The shift_count calculation `(fls64(sum_cwnd_rtt) - 32 + 1) / 2 + 1` may over-shift in some cases, losing signifi",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-105",
    "title": "Scheduler Change Race Between State Check and Modification",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 554-607 - **Code:** ```c if (conn->state != TQUIC_CONN_IDLE) return -EISCONN; // ... RCU look",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (conn->state != TQUIC_CONN_IDLE)\n    return -EISCONN;\n// ... RCU lookup, module_get ...\nspin_lock_bh(&conn->lock);\nold_sched = conn->sched;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 554-607 - **Code:** ```c if (conn->state != TQUIC_CONN_IDLE) return -EISCONN; // ... RCU lookup, module_get ... spin_lock_bh(&conn->lock); old_sched = conn->sched; ``` - **Impact:** The connect",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-106",
    "title": "Missing Bounds Check on tquic_hyst_state_names Array Access",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 155-159 - **Code:** ```c pr_info(\"path %u hysteresis: %s -> %s ...\\n\", pt->path_id, tquic_hyst_stat",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pr_info(\"path %u hysteresis: %s -> %s ...\\n\",\n    pt->path_id,\n    tquic_hyst_state_names[old_state],\n    tquic_hyst_state_names[new_state], ...);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 155-159 - **Code:** ```c pr_info(\"path %u hysteresis: %s -> %s ...\\n\", pt->path_id, tquic_hyst_state_names[old_state], tquic_hyst_state_names[new_state], ...); ``` - **Impact:** If `old_state` or `ne",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-107",
    "title": "Netlink PM Commands Missing CAP_NET_ADMIN Checks",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/pm_netlink.c` - **Lines:** 226-341 - **Impact:** The `tquic_pm_nl_add_path()` and `tquic_pm_nl_del_path()` netlink command handlers ",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/pm_netlink.c"
      ],
      "symbols": [
        "tquic_pm_nl_add_path",
        "tquic_pm_nl_del_path"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/pm_netlink.c` - **Lines:** 226-341 - **Impact:** The `tquic_pm_nl_add_path()` and `tquic_pm_nl_del_path()` netlink command handlers do not appear to require `CAP_NET_ADMIN`. While the genl_ops definition may set `.flags = GENL_ADMIN",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-108",
    "title": "Path Score Computation Can Overflow in Migration Target Selection",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 287-318 - **Code:** ```c u64 score = 1000000; score = score * 1000 / stats->rtt_smoothed; score = (scor",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 score = 1000000;\nscore = score * 1000 / stats->rtt_smoothed;\nscore = (score * stats->bandwidth) >> 20;\nscore = score * (100 - min(loss_pct, 90ULL)) / 100;\nscore = score * (256 - path->priority) / 256;\nscore = score * path->weight;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` - **Lines:** 287-318 - **Code:** ```c u64 score = 1000000; score = score * 1000 / stats->rtt_smoothed; score = (score * stats->bandwidth) >> 20; score = score * (100 - min(loss_pct, 90ULL)) / 100; score = score * (25",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-109",
    "title": "Path Manager netdev_event Shadows Variable 'i'",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 325-327 - **Code:** ```c int num_addrs, i;    // outer 'i' // ... for (i = 0; i < num_addrs; i++) {  //",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "int num_addrs, i;    // outer 'i'\n// ...\nfor (i = 0; i < num_addrs; i++) {  // shadows outer 'i'"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` - **Lines:** 325-327 - **Code:** ```c int num_addrs, i;    // outer 'i' // ... for (i = 0; i < num_addrs; i++) {  // shadows outer 'i' ``` - **Impact:** The inner variable `i` shadows the outer `i` declared at functi",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-110",
    "title": "BPM Path Manager Uses Workqueue Without Connection Lifetime Guard",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` - **Lines:** 307-311 - **Code:** ```c struct work_struct discover_work; struct work_struct failover_work; struct dela",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "delayed_work",
        "cancel_delayed_work_sync",
        "work_struct",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "struct work_struct discover_work;\nstruct work_struct failover_work;\nstruct delayed_work probe_work;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` - **Lines:** 307-311 - **Code:** ```c struct work_struct discover_work; struct work_struct failover_work; struct delayed_work probe_work; ``` - **Impact:** The path manager schedules work items that reference the conn",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-111",
    "title": "NAT Keepalive Config Pointer Not Protected Against Concurrent Free",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/nat_keepalive.c` - **Lines:** 99-103, 155-158 - **Code:** ```c if (!state || !state->initialized || state->suspended) return false; ",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/nat_keepalive.c"
      ],
      "symbols": [
        "rcu_assign_pointer",
        "rcu_dereference"
      ],
      "line_ranges": [],
      "snippets": [
        "if (!state || !state->initialized || state->suspended)\n    return false;\nif (!state->config || !state->config->enabled)\n    return false;\n// ...\nconfig = state->config;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/nat_keepalive.c` - **Lines:** 99-103, 155-158 - **Code:** ```c if (!state || !state->initialized || state->suspended) return false; if (!state->config || !state->config->enabled) return false; // ... config = state->config; ``` - **",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: M-12. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-112",
    "title": "Defensive Check Missing for TQUIC_MAX_PATHS in Path Add",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 935-939 - **Code:** ```c idx = conn->num_paths - 1; if (idx >= 0 && idx < TQUIC_MAX_PATHS) { ",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "idx = conn->num_paths - 1;\nif (idx >= 0 && idx < TQUIC_MAX_PATHS) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 935-939 - **Code:** ```c idx = conn->num_paths - 1; if (idx >= 0 && idx < TQUIC_MAX_PATHS) { ``` - **Impact:** `idx` is computed as `num_paths - 1` but `num_paths` could be 0 if called at the w",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-113",
    "title": "Path Validation Timer del_timer vs del_timer_sync",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 131, 397 - **Impact:** `del_timer()` is used inside spinlock-protected regions (appropriate since `d",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "del_timer_sync",
        "del_timer"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 131, 397 - **Impact:** `del_timer()` is used inside spinlock-protected regions (appropriate since `del_timer_sync()` can sleep), but it means the timer callback could still be executing on another CPU",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-114",
    "title": "Scheduler get_info Callback Could Write Past Buffer",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 258-259 - **Code:** ```c size_t (*get_info)(struct tquic_connection *conn, char *buf, size_t ",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "size_t (*get_info)(struct tquic_connection *conn, char *buf, size_t len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 258-259 - **Code:** ```c size_t (*get_info)(struct tquic_connection *conn, char *buf, size_t len); ``` - **Impact:** The get_info callback signature passes a buffer and length but there is no e",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-115",
    "title": "Failover Sent Packet Count Can Go Negative",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 469, 503 - **Code:** ```c fc->sent_count++;   // in track_sent fc->sent_count--;   // in on_ack ```",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_failover.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "fc->sent_count++;   // in track_sent\nfc->sent_count--;   // in on_ack"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_failover.c` - **Lines:** 469, 503 - **Code:** ```c fc->sent_count++;   // in track_sent fc->sent_count--;   // in on_ack ``` - **Impact:** `sent_count` is a plain integer modified under `sent_packets_lock`. If a bug causes d",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-116",
    "title": "BPM Path Metrics min_rtt Initialized to UINT_MAX",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` - **Lines:** 536-537 - **Code:** ```c m->min_rtt = UINT_MAX; ``` - **Impact:** Using `UINT_MAX` as sentinel is functi",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "m->min_rtt = UINT_MAX;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` - **Lines:** 536-537 - **Code:** ```c m->min_rtt = UINT_MAX; ``` - **Impact:** Using `UINT_MAX` as sentinel is functional but could cause misleading path scores if min_rtt is used in calculations before the first RTT ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-117",
    "title": "Path Validation Response Queue Uses Two Tracking Mechanisms",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 259, 278-279 - **Code:** ```c if (atomic_read(&path->response.count) >= TQUIC_MAX_PENDING_RESPONSES)",
    "evidence": {
      "file_paths": [
        "net/tquic/pm/path_validation.c"
      ],
      "symbols": [
        "skb_queue_len"
      ],
      "line_ranges": [],
      "snippets": [
        "if (atomic_read(&path->response.count) >= TQUIC_MAX_PENDING_RESPONSES) {\n// ...\nskb_queue_tail(&path->response.queue, skb);\natomic_inc(&path->response.count);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_validation.c` - **Lines:** 259, 278-279 - **Code:** ```c if (atomic_read(&path->response.count) >= TQUIC_MAX_PENDING_RESPONSES) { // ... skb_queue_tail(&path->response.queue, skb); atomic_inc(&path->response.count); ``` - **Imp",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-118",
    "title": "Coupled CC Alpha Smoothing May Suppress Rapid Changes",
    "category": "api",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` - **Lines:** 96-97 - **Impact:** `COUPLED_ALPHA_SMOOTHING = 8` means alpha changes by only 1/8 per update. When a ",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` - **Lines:** 96-97 - **Impact:** `COUPLED_ALPHA_SMOOTHING = 8` means alpha changes by only 1/8 per update. When a path is suddenly added or removed, it takes many RTTs for alpha to converge, causing unfair bandwidt",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_MULTIPATH_BONDING.md. Original finding ID: L-7. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-119",
    "title": "Busy-poll per-packet lock/unlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:460-465` ```c while (work_done < budget) { spin_lock_irqsave(&tn->lock, flags); skb = __skb_dequeue(&tn->rx_queue); if (skb) atomi",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_busy_poll",
        "tquic_napi_poll",
        "skb_queue_splice_init"
      ],
      "line_ranges": [
        "net/tquic/napi.c:317-317"
      ],
      "snippets": [
        "while (work_done < budget) {\n    spin_lock_irqsave(&tn->lock, flags);\n    skb = __skb_dequeue(&tn->rx_queue);\n    if (skb)\n        atomic_dec(&tn->rx_queue_len);\n    spin_unlock_irqrestore(&tn->lock, flags);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:460-465` ```c while (work_done < budget) { spin_lock_irqsave(&tn->lock, flags); skb = __skb_dequeue(&tn->rx_queue); if (skb) atomic_dec(&tn->rx_queue_len); spin_unlock_irqrestore(&tn->lock, flags); ... } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-120",
    "title": "conn->lock held during path selection on every TX packet",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1121-1132` ```c struct tquic_path *tquic_select_path(...) { spin_lock_bh(&conn->lock); if (conn->scheduler) selected = tqu",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_path"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_path *tquic_select_path(...)\n{\n    spin_lock_bh(&conn->lock);\n    if (conn->scheduler)\n        selected = tquic_bond_select_path(conn, skb);\n    else\n        selected = conn->active_path;\n    spin_unlock_bh(&conn->lock);\n    return selected;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1121-1132` ```c struct tquic_path *tquic_select_path(...) { spin_lock_bh(&conn->lock); if (conn->scheduler) selected = tquic_bond_select_path(conn, skb); else selected = conn->active_path; spin_unlock_bh(&conn->lock); retu",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-121",
    "title": "conn->paths_lock in RX path for every packet",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:251-258` ```c static struct tquic_path *tquic_find_path_by_addr(...) { spin_lock_bh(&conn->paths_lock); list_for_each_entry",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_path"
      ],
      "line_ranges": [],
      "snippets": [
        "static struct tquic_path *tquic_find_path_by_addr(...)\n{\n    spin_lock_bh(&conn->paths_lock);\n    list_for_each_entry(path, &conn->paths, list) {\n        if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) {\n            ..."
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:251-258` ```c static struct tquic_path *tquic_find_path_by_addr(...) { spin_lock_bh(&conn->paths_lock); list_for_each_entry(path, &conn->paths, list) { if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) { ... ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-122",
    "title": "conn->streams_lock for RB-tree walk on every STREAM frame",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:917-934` ```c spin_lock_bh(&ctx->conn->streams_lock); { struct rb_node *node = ctx->conn->streams.rb_node; while (node) { .",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "rb_node"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&ctx->conn->streams_lock);\n{\n    struct rb_node *node = ctx->conn->streams.rb_node;\n    while (node) { ... }\n}\nspin_unlock_bh(&ctx->conn->streams_lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:917-934` ```c spin_lock_bh(&ctx->conn->streams_lock); { struct rb_node *node = ctx->conn->streams.rb_node; while (node) { ... } } spin_unlock_bh(&ctx->conn->streams_lock); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-123",
    "title": "FEC encoder double lock nesting",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c:275-283` ```c spin_lock_bh(&enc->lock); ... spin_lock(&block->lock); list_add_tail(&symbol->list, &block->source_symbol",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&enc->lock);\n...\n    spin_lock(&block->lock);\n    list_add_tail(&symbol->list, &block->source_symbols);\n    ...\n    spin_unlock(&block->lock);\n...\nspin_unlock_bh(&enc->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c:275-283` ```c spin_lock_bh(&enc->lock); ... spin_lock(&block->lock); list_add_tail(&symbol->list, &block->source_symbols); ... spin_unlock(&block->lock); ... spin_unlock_bh(&enc->lock); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-124",
    "title": "GRO flush drops and reacquires lock in loop",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2303-2310` ```c while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) { spin_unlock(&gro->lock); deliver(skb); flushed++;",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n    spin_unlock(&gro->lock);\n    deliver(skb);\n    flushed++;\n    spin_lock(&gro->lock);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2303-2310` ```c while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) { spin_unlock(&gro->lock); deliver(skb); flushed++; spin_lock(&gro->lock); } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-125",
    "title": "Per-packet kmalloc for frame data in TX path",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1806-1826` ```c frame = kzalloc(sizeof(*frame), GFP_ATOMIC);  /* struct allocation */ ... frame->data = kmalloc(chunk, GFP",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_assemble_packet",
        "tquic_gen_stream_frame",
        "tquic_xmit",
        "is",
        "tquic_coalesce_frames",
        "allocation"
      ],
      "line_ranges": [],
      "snippets": [
        "frame = kzalloc(sizeof(*frame), GFP_ATOMIC);  /* struct allocation */\n...\nframe->data = kmalloc(chunk, GFP_ATOMIC);     /* data copy */\nmemcpy(frame->data, data + offset, chunk);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1806-1826` ```c frame = kzalloc(sizeof(*frame), GFP_ATOMIC);  /* struct allocation */ ... frame->data = kmalloc(chunk, GFP_ATOMIC);     /* data copy */ memcpy(frame->data, data + offset, chunk); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-126",
    "title": "Per-STREAM-frame skb allocation in RX path",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` ```c data_skb = alloc_skb(length, GFP_ATOMIC); if (!data_skb) return -ENOMEM; skb_put_data(data_skb, ctx->data + c",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);\nif (!data_skb)\n    return -ENOMEM;\nskb_put_data(data_skb, ctx->data + ctx->offset, length);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` ```c data_skb = alloc_skb(length, GFP_ATOMIC); if (!data_skb) return -ENOMEM; skb_put_data(data_skb, ctx->data + ctx->offset, length); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-127",
    "title": "CONNECTION_CLOSE uses kmalloc for small buffer",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1950-1951` ```c buf = kmalloc(256, GFP_ATOMIC); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_send_ack"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1877-1877"
      ],
      "snippets": [
        "buf = kmalloc(256, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1950-1951` ```c buf = kmalloc(256, GFP_ATOMIC); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-128",
    "title": "Slab cache for RX decryption is good practice",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2585-2590` ```c if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) { decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) {\n    decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC);\n    decrypted_from_slab = true;\n} else {\n    decrypted = kmalloc(payload_len, GFP_ATOMIC);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2585-2590` ```c if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) { decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC); decrypted_from_slab = true; } else { decrypted = kmalloc(payload_len, GFP_ATOMIC); } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-129",
    "title": "io_uring async data uses kzalloc per request",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:139` ```c data = kzalloc(sizeof(*data), GFP_KERNEL); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/io_uring.c"
      ],
      "symbols": [
        "io_alloc_async_data",
        "io_kiocb_to_cmd"
      ],
      "line_ranges": [],
      "snippets": [
        "data = kzalloc(sizeof(*data), GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:139` ```c data = kzalloc(sizeof(*data), GFP_KERNEL); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-130",
    "title": "Double data copy in TX path",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1819-1825` then `365`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_gen_stream_frame",
        "tquic_xmit"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1819-1825` then `365`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: CRITICAL. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-131",
    "title": "Full sockaddr_storage memcmp for path lookup",
    "category": "perf",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:253` ```c if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "sockaddr_storage"
      ],
      "line_ranges": [],
      "snippets": [
        "if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:253` ```c if (memcmp(&path->remote_addr, addr, sizeof(*addr)) == 0) ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-132",
    "title": "Zerocopy sendmsg chunks at 1200 bytes",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:293` ```c size_t chunk = min_t(size_t, len - copied, 1200); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "size_t chunk = min_t(size_t, len - copied, 1200);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:293` ```c size_t chunk = min_t(size_t, len - copied, 1200); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-133",
    "title": "Dual global atomic + per-CPU stats in NAPI poll",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:307-308` ```c this_cpu_inc(tquic_napi_pcpu_stats.total_polls); atomic64_inc(&tquic_napi_global_stats.total_polls); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_napi_aggregate_pcpu_stats"
      ],
      "line_ranges": [
        "net/tquic/napi.c:346-347",
        "net/tquic/napi.c:75-75"
      ],
      "snippets": [
        "this_cpu_inc(tquic_napi_pcpu_stats.total_polls);\natomic64_inc(&tquic_napi_global_stats.total_polls);",
        "this_cpu_add(tquic_napi_pcpu_stats.total_packets, work_done);\natomic64_add(work_done, &tquic_napi_global_stats.total_packets);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:307-308` ```c this_cpu_inc(tquic_napi_pcpu_stats.total_polls); atomic64_inc(&tquic_napi_global_stats.total_polls); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-134",
    "title": "GRO stats use global atomic64 on every packet",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:295` ```c atomic64_inc(&tquic_gro_stats.coalesced_packets); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_offload.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "atomic64_inc(&tquic_gro_stats.coalesced_packets);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:295` ```c atomic64_inc(&tquic_gro_stats.coalesced_packets); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-135",
    "title": "MIB counter updates on every packet in RX/TX paths",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**Files:** Multiple locations in `tquic_input.c` (lines 2692-2693) and `tquic_output.c` (lines 1740-1741): ```c TQUIC_INC_STATS(sock_net(conn->sk), TQUIC_MIB_PACKETSRX); TQUIC_ADD_STATS(sock_net(conn-",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "ktime_get"
      ],
      "line_ranges": [
        ":2692-2693",
        ":1740-1741"
      ],
      "snippets": [
        "TQUIC_INC_STATS(sock_net(conn->sk), TQUIC_MIB_PACKETSRX);\nTQUIC_ADD_STATS(sock_net(conn->sk), TQUIC_MIB_BYTESRX, len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** Multiple locations in `tquic_input.c` (lines 2692-2693) and `tquic_output.c` (lines 1740-1741): ```c TQUIC_INC_STATS(sock_net(conn->sk), TQUIC_MIB_PACKETSRX); TQUIC_ADD_STATS(sock_net(conn->sk), TQUIC_MIB_BYTESRX, len); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-136",
    "title": "Multiple ktime_get() calls per packet",
    "category": "perf",
    "severity": "S1",
    "confidence": "high",
    "impact": "**Locations:** - `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:305` -- NAPI poll start - `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:713` -- ACK frame RTT calculat",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_input.c",
        "net/tquic/napi.c"
      ],
      "symbols": [
        "already",
        "ktime_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Locations:** - `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:305` -- NAPI poll start - `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:713` -- ACK frame RTT calculation - `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:2687` -- path last_activity",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: HIGH. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-137",
    "title": "tquic_napi struct layout",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.h:112-143`",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.h"
      ],
      "symbols": [
        "contains",
        "sk_buff_head",
        "napi_struct",
        "layout",
        "tquic_napi_stats"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.h:112-143`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-138",
    "title": "Per-path stats updated from both RX and TX",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**Files:** `tquic_input.c:2685-2687` and `tquic_output.c:1734-1736`",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** `tquic_input.c:2685-2687` and `tquic_output.c:1734-1736`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-139",
    "title": "BBRv3 uses ktime_get_ns() for every bandwidth sample",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/bbrv3.c:206` ```c static void bbrv3_update_bw(struct bbrv3 *bbr, u64 acked, u64 rtt_us) { u64 now = ktime_get_ns(); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/bbrv3.c"
      ],
      "symbols": [
        "bbrv3",
        "ktime_get_ns"
      ],
      "line_ranges": [],
      "snippets": [
        "static void bbrv3_update_bw(struct bbrv3 *bbr, u64 acked, u64 rtt_us)\n{\n    u64 now = ktime_get_ns();"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/bbrv3.c:206` ```c static void bbrv3_update_bw(struct bbrv3 *bbr, u64 acked, u64 rtt_us) { u64 now = ktime_get_ns(); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-140",
    "title": "Prague RTT scaling division on every ACK",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/prague.c:154` ```c scaled = (value * rtt_us) / p->params.rtt_target_us; ```",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/prague.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "scaled = (value * rtt_us) / p->params.rtt_target_us;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/prague.c:154` ```c scaled = (value * rtt_us) / p->params.rtt_target_us; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-141",
    "title": "Zerocopy entry refcount uses atomic_t",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:58-59` ```c atomic_t        refcnt;         /* Reference count */ ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "refcount_inc",
        "refcount_dec_and_test"
      ],
      "line_ranges": [],
      "snippets": [
        "atomic_t        refcnt;         /* Reference count */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:58-59` ```c atomic_t        refcnt;         /* Reference count */ ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-142",
    "title": "SmartNIC offload takes dev->lock for every key operation",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c:326-328` ```c spin_lock(&dev->lock); ret = dev->ops->add_key(dev, &key); spin_unlock(&dev->lock); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&dev->lock);\nret = dev->ops->add_key(dev, &key);\nspin_unlock(&dev->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c:326-328` ```c spin_lock(&dev->lock); ret = dev->ops->add_key(dev, &key); spin_unlock(&dev->lock); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-143",
    "title": "AF_XDP frame pool uses spinlock for every frame alloc/free",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c:222-238`",
    "evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c:222-238`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-144",
    "title": "Pacing work function drops and reacquires lock per packet",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1396-1421` ```c while (...) { skb = __skb_dequeue(&pacing->queue); spin_unlock_bh(&pacing->lock); tquic_output_packet(NULL",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (...) {\n    skb = __skb_dequeue(&pacing->queue);\n    spin_unlock_bh(&pacing->lock);\n    tquic_output_packet(NULL, pacing->path, skb);\n    spin_lock_bh(&pacing->lock);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1396-1421` ```c while (...) { skb = __skb_dequeue(&pacing->queue); spin_unlock_bh(&pacing->lock); tquic_output_packet(NULL, pacing->path, skb); spin_lock_bh(&pacing->lock); ... } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-145",
    "title": "pacing_calc_gap uses division",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1360` ```c gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate; ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1360` ```c gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-146",
    "title": "GRO header parsing re-parses every held packet",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:235-253` ```c list_for_each_entry(p, head, list) { ... ret = tquic_gro_parse_header(p->data + skb_gro_offset(p), p->len, ",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_offload.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "list_for_each_entry(p, head, list) {\n    ...\n    ret = tquic_gro_parse_header(p->data + skb_gro_offset(p),\n                                 p->len, &held_hdr);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:235-253` ```c list_for_each_entry(p, head, list) { ... ret = tquic_gro_parse_header(p->data + skb_gro_offset(p), p->len, &held_hdr); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-147",
    "title": "GRO hardcodes 8-byte CID for short headers",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:148` ```c hdr->dcid_len = TQUIC_DEFAULT_CID_LEN; ```",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_offload.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "hdr->dcid_len = TQUIC_DEFAULT_CID_LEN;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_offload.c:148` ```c hdr->dcid_len = TQUIC_DEFAULT_CID_LEN; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-148",
    "title": "FEC encoder allocates per-symbol in GFP_ATOMIC",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c:111-115` ```c symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC); ... symbol->data = kmalloc(length, GFP_ATOMIC); ```",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC);\n...\nsymbol->data = kmalloc(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c:111-115` ```c symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC); ... symbol->data = kmalloc(length, GFP_ATOMIC); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-149",
    "title": "XOR FEC encoding is efficient",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The XOR FEC scheme (single repair symbol per block) is computationally lightweight. Reed-Solomon encoding is heavier but only used when explicitly enabled.",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The XOR FEC scheme (single repair symbol per block) is computationally lightweight. Reed-Solomon encoding is heavier but only used when explicitly enabled.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-150",
    "title": "Minimal tracepoint overhead",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/trace.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/trace.c"
      ],
      "symbols": [
        "ktime_get",
        "skb_queue_splice_init",
        "tquic_find_path_by_addr"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/trace.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERFORMANCE.md. Original finding ID: LOW. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-151",
    "title": "NAPI busy_poll per-skb lock/unlock cycle",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:460-465` - **Code:** ```c while (work_done < budget) { spin_lock_irqsave(&tn->lock, flags); skb = __skb_dequeue(&tn->rx_queue); ",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_busy_poll",
        "tquic_napi_poll",
        "skb_queue_splice_init"
      ],
      "line_ranges": [
        "net/tquic/napi.c:295-295"
      ],
      "snippets": [
        "while (work_done < budget) {\n    spin_lock_irqsave(&tn->lock, flags);\n    skb = __skb_dequeue(&tn->rx_queue);\n    if (skb)\n        atomic_dec(&tn->rx_queue_len);\n    spin_unlock_irqrestore(&tn->lock, flags);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:460-465` - **Code:** ```c while (work_done < budget) { spin_lock_irqsave(&tn->lock, flags); skb = __skb_dequeue(&tn->rx_queue); if (skb) atomic_dec(&tn->rx_queue_len); spin_unlock_irqrestore(&tn->lock, flags); ... } ``` - **Desc",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-152",
    "title": "conn->lock released and reacquired during output flush stream iteration",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:2058-2072` - **Code:** ```c spin_lock_bh(&conn->lock); if (conn->data_sent >= conn->max_data_remote) { spin_unlock_bh(&c",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_output_flush"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nif (conn->data_sent >= conn->max_data_remote) {\n    spin_unlock_bh(&conn->lock);\n    ...\n}\nconn_credit = conn->max_data_remote - conn->data_sent;\nspin_unlock_bh(&conn->lock);\n\nspin_lock_bh(&conn->lock);\nfor (node = rb_first(&conn->streams); node && packets_sent < 16;\n     "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:2058-2072` - **Code:** ```c spin_lock_bh(&conn->lock); if (conn->data_sent >= conn->max_data_remote) { spin_unlock_bh(&conn->lock); ... } conn_credit = conn->max_data_remote - conn->data_sent; spin_unlock_bh(&conn->lock)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-153",
    "title": "io_uring buffer ring spinlock per get/put operation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:804-838` - **Code:** ```c void *tquic_io_buf_ring_get(struct tquic_io_buf_ring *br, u16 *bid) { spin_lock(&br->lock); ... sp",
    "evidence": {
      "file_paths": [
        "net/tquic/io_uring.c"
      ],
      "symbols": [
        "tquic_io_buf_ring"
      ],
      "line_ranges": [],
      "snippets": [
        "void *tquic_io_buf_ring_get(struct tquic_io_buf_ring *br, u16 *bid)\n{\n    spin_lock(&br->lock);\n    ...\n    spin_unlock(&br->lock);\n}\n\nvoid tquic_io_buf_ring_put(struct tquic_io_buf_ring *br, u16 bid)\n{\n    spin_lock(&br->lock);\n    ...\n    spin_unlock(&br->lock);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:804-838` - **Code:** ```c void *tquic_io_buf_ring_get(struct tquic_io_buf_ring *br, u16 *bid) { spin_lock(&br->lock); ... spin_unlock(&br->lock); }",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-154",
    "title": "Multiple lock acquisitions in RX hot path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` (throughout packet processing) - **Description:** Processing a single incoming packet requires acquiring `conn->lock`, `",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` (throughout packet processing) - **Description:** Processing a single incoming packet requires acquiring `conn->lock`, `conn->paths_lock`, `conn->streams_lock`, and potentially `conn->datagram.lock` at various points. Ea",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-155",
    "title": "Per-frame kzalloc + kmalloc in TX path",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1806-1825` - **Code:** ```c /* Create pending frame */ frame = kzalloc(sizeof(*frame), GFP_ATOMIC); if (unlikely(!frame)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_xmit",
        "tquic_pending_frame",
        "for"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Create pending frame */\nframe = kzalloc(sizeof(*frame), GFP_ATOMIC);\nif (unlikely(!frame)) {\n    ret = -ENOMEM;\n    break;\n}\n\nframe->type = TQUIC_FRAME_STREAM;\n...\nif (chunk > 0) {\n    frame->data = kmalloc(chunk, GFP_ATOMIC);\n    if (!frame->data) {\n        kfree(frame);\n        ret = -ENOMEM;\n "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1806-1825` - **Code:** ```c /* Create pending frame */ frame = kzalloc(sizeof(*frame), GFP_ATOMIC); if (unlikely(!frame)) { ret = -ENOMEM; break; }",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-156",
    "title": "Per-STREAM-frame skb allocation in RX path",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` - **Code:** ```c data_skb = alloc_skb(length, GFP_ATOMIC); if (!data_skb) return -ENOMEM;",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "skb_clone",
        "alloc_skb"
      ],
      "line_ranges": [],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);\nif (!data_skb)\n    return -ENOMEM;\n\nskb_put_data(data_skb, ctx->data + ctx->offset, length);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` - **Code:** ```c data_skb = alloc_skb(length, GFP_ATOMIC); if (!data_skb) return -ENOMEM;",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-157",
    "title": "kmalloc(path->mtu) per datagram send",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:2508` - **Code:** ```c buf = kmalloc(path->mtu, GFP_ATOMIC); if (!buf) return -ENOMEM; ``` - **Description:** `tquic_sen",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_send_datagram"
      ],
      "line_ranges": [],
      "snippets": [
        "buf = kmalloc(path->mtu, GFP_ATOMIC);\nif (!buf)\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:2508` - **Code:** ```c buf = kmalloc(path->mtu, GFP_ATOMIC); if (!buf) return -ENOMEM; ``` - **Description:** `tquic_send_datagram()` allocates a temporary buffer of `path->mtu` bytes (typically 1200-1500 bytes) for ever",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-158",
    "title": "Per-chunk skb allocation in zerocopy path",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:297` - **Code:** ```c while (copied < len) { size_t chunk = min_t(size_t, len - copied, 1200);",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "alloc_skb_with_frags",
        "napi_alloc_skb"
      ],
      "line_ranges": [],
      "snippets": [
        "while (copied < len) {\n    size_t chunk = min_t(size_t, len - copied, 1200);\n\n    new_skb = alloc_skb(0, GFP_KERNEL);\n    if (!new_skb) {\n        err = -ENOMEM;\n        goto out_err;\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:297` - **Code:** ```c while (copied < len) { size_t chunk = min_t(size_t, len - copied, 1200);",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-159",
    "title": "kzalloc per io_uring async request",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:139` - **Code:** ```c data = kzalloc(sizeof(*data), GFP_KERNEL); if (!data) return NULL;",
    "evidence": {
      "file_paths": [
        "net/tquic/io_uring.c"
      ],
      "symbols": [
        "io_alloc_async_data",
        "fits"
      ],
      "line_ranges": [],
      "snippets": [
        "data = kzalloc(sizeof(*data), GFP_KERNEL);\nif (!data)\n    return NULL;\n\nreq->async_data = data;\nreq->flags |= REQ_F_ASYNC_DATA;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:139` - **Code:** ```c data = kzalloc(sizeof(*data), GFP_KERNEL); if (!data) return NULL;",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-160",
    "title": "struct tquic_napi mixes hot and cold fields",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.h` - **Description:** The `struct tquic_napi` packs frequently-written fields (stats counters, `rx_queue_len` atomic, `state`) alo",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.h"
      ],
      "symbols": [
        "with",
        "itself",
        "tquic_napi"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.h` - **Description:** The `struct tquic_napi` packs frequently-written fields (stats counters, `rx_queue_len` atomic, `state`) alongside rarely-changed configuration fields (coalesce parameters, `busy_poll_enabled`) and the NAPI s",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-161",
    "title": "Global atomic64 stats counters shared across CPUs",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:308,477` - **Code:** ```c atomic64_inc(&tquic_napi_global_stats.total_polls);     // line 308 atomic64_add(work_done, &tquic_nap",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_napi_aggregate_pcpu_stats"
      ],
      "line_ranges": [
        "net/tquic/napi.c:308-308",
        "net/tquic/napi.c:477-477"
      ],
      "snippets": [
        "atomic64_inc(&tquic_napi_global_stats.total_polls);     // line 308\natomic64_add(work_done, &tquic_napi_global_stats.busy_poll_packets); // line 477"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:308,477` - **Code:** ```c atomic64_inc(&tquic_napi_global_stats.total_polls);     // line 308 atomic64_add(work_done, &tquic_napi_global_stats.busy_poll_packets); // line 477 ``` - **Description:** Global `atomic64` counters are",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-162",
    "title": "Double copy in RX STREAM frame processing",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` - **Code:** ```c data_skb = alloc_skb(length, GFP_ATOMIC); ... skb_put_data(data_skb, ctx->data + ctx->offset, l",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "get_page",
        "skb_copy_bits",
        "skb_put_data",
        "skb_fill_page_desc"
      ],
      "line_ranges": [],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);\n...\nskb_put_data(data_skb, ctx->data + ctx->offset, length);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c:944-948` - **Code:** ```c data_skb = alloc_skb(length, GFP_ATOMIC); ... skb_put_data(data_skb, ctx->data + ctx->offset, length); ``` - **Description:** Data arriving from the network is first decrypted into a slab-allocat",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-163",
    "title": "memcpy of TX frame data from userspace into frame, then into skb",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1825` - **Code:** ```c memcpy(frame->data, data + offset, chunk); ``` - **Description:** In `tquic_xmit()`, data is copi",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_xmit",
        "copy_from_iter"
      ],
      "line_ranges": [],
      "snippets": [
        "memcpy(frame->data, data + offset, chunk);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1825` - **Code:** ```c memcpy(frame->data, data + offset, chunk); ``` - **Description:** In `tquic_xmit()`, data is copied from the source buffer into `frame->data` (a newly kmalloc'd buffer), then later when the packet ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-164",
    "title": "Infinite retry loop on EMSGSIZE/EEXIST",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:315-318` - **Code:** ```c if (err == -EMSGSIZE || err == -EEXIST) { /* Try with a new skb */ continue; } ``` - **Descr",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "TQUIC_SKB_ZEROCOPY_ITER_STREAM"
      ],
      "line_ranges": [],
      "snippets": [
        "if (err == -EMSGSIZE || err == -EEXIST) {\n    /* Try with a new skb */\n    continue;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:315-318` - **Code:** ```c if (err == -EMSGSIZE || err == -EEXIST) { /* Try with a new skb */ continue; } ``` - **Description:** When `TQUIC_SKB_ZEROCOPY_ITER_STREAM()` returns `-EMSGSIZE` or `-EEXIST`, the loop frees t",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-165",
    "title": "Hardcoded 1200-byte chunk size ignores path MTU",
    "category": "perf",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:293` - **Code:** ```c size_t chunk = min_t(size_t, len - copied, 1200); ``` - **Description:** The zerocopy path hardc",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "size_t chunk = min_t(size_t, len - copied, 1200);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c:293` - **Code:** ```c size_t chunk = min_t(size_t, len - copied, 1200); ``` - **Description:** The zerocopy path hardcodes 1200 bytes as the chunk size (QUIC minimum MTU), ignoring the actual path MTU which could be 14",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-166",
    "title": "Redundant triple-counting of statistics",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:306-308` - **Code:** ```c tn->stats.poll_cycles++; this_cpu_inc(tquic_napi_pcpu_stats.total_polls); atomic64_inc(&tquic_napi_glo",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_napi_aggregate_pcpu_stats"
      ],
      "line_ranges": [],
      "snippets": [
        "tn->stats.poll_cycles++;\nthis_cpu_inc(tquic_napi_pcpu_stats.total_polls);\natomic64_inc(&tquic_napi_global_stats.total_polls);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:306-308` - **Code:** ```c tn->stats.poll_cycles++; this_cpu_inc(tquic_napi_pcpu_stats.total_polls); atomic64_inc(&tquic_napi_global_stats.total_polls); ``` - **Description:** Every NAPI poll cycle increments three separate count",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-167",
    "title": "atomic_inc/dec for rx_queue_len on every enqueue/dequeue",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:464,689` - **Description:** `rx_queue_len` is maintained as an `atomic_t` and incremented on every enqueue, decremented on every",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "skb_queue_len",
        "skb_queue_splice_init"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:464,689` - **Description:** `rx_queue_len` is maintained as an `atomic_t` and incremented on every enqueue, decremented on every dequeue. However, in the NAPI poll path the queue is drained via `skb_queue_splice_init()` which al",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-168",
    "title": "Kernel address stored as u64 in buffer ring entries",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:833` - **Code:** ```c br->br->bufs[tail].addr = (u64)(br->buf_base + bid * br->buf_size); ``` - **Description:** A kernel vi",
    "evidence": {
      "file_paths": [
        "net/tquic/io_uring.c"
      ],
      "symbols": [
        "field",
        "is"
      ],
      "line_ranges": [],
      "snippets": [
        "br->br->bufs[tail].addr = (u64)(br->buf_base + bid * br->buf_size);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:833` - **Code:** ```c br->br->bufs[tail].addr = (u64)(br->buf_base + bid * br->buf_size); ``` - **Description:** A kernel virtual address is cast to `u64` and stored in a buffer ring entry struct field named `addr`. If this ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-169",
    "title": "Missing batch API for buffer ring operations",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:799-838` - **Description:** `tquic_io_buf_ring_get()` and `tquic_io_buf_ring_put()` acquire and release the spinlock for eve",
    "evidence": {
      "file_paths": [
        "net/tquic/io_uring.c"
      ],
      "symbols": [
        "tquic_io_buf_ring_get",
        "tquic_io_buf_ring_put"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/io_uring.c:799-838` - **Description:** `tquic_io_buf_ring_get()` and `tquic_io_buf_ring_put()` acquire and release the spinlock for every single buffer operation. When processing a batch of I/O completions, this means N lock/unlock pai",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-170",
    "title": "atomic64_inc_return for packet number on every TX",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1785` - **Code:** ```c pkt_num = atomic64_inc_return(&conn->pkt_num_tx) - 1; ``` - **Description:** Every packet sent us",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "atomic64_inc_return"
      ],
      "line_ranges": [],
      "snippets": [
        "pkt_num = atomic64_inc_return(&conn->pkt_num_tx) - 1;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c:1785` - **Code:** ```c pkt_num = atomic64_inc_return(&conn->pkt_num_tx) - 1; ``` - **Description:** Every packet sent uses `atomic64_inc_return()` to generate a packet number. This is a full memory barrier atomic RMW ope",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-171",
    "title": "Multiple atomic operations in NAPI enqueue path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:689` (and surrounding) - **Description:** Enqueuing a single packet into the NAPI RX queue involves: `spin_lock_irqsave` (atomic",
    "evidence": {
      "file_paths": [
        "net/tquic/napi.c"
      ],
      "symbols": [
        "tquic_napi"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c:689` (and surrounding) - **Description:** Enqueuing a single packet into the NAPI RX queue involves: `spin_lock_irqsave` (atomic CAS), `__skb_queue_tail` (increments qlen), `atomic_inc(&tn->rx_queue_len)`, `spin_unlock_irqrestor",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_PERF_HOTPATH.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-172",
    "title": "Tunnel Uses init_net -- Namespace Escape",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "Complete network namespace isolation bypass. Container escape for network traffic. Attacker in a restricted namespace can reach any host reachable from the root namespace.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP,\n                       &sock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The tunnel subsystem creates TCP sockets in `init_net` (the root network namespace) regardless of which namespace the calling QUIC connection belongs to. This is a namespace escape vulnerability. A user in a container or non-root network namespace who can open a QUIC tunnel will have TCP connections",
    "fix_suggestion": "Use the network namespace from the QUIC connection's socket (`sock_net(conn->sk)`) instead of `&init_net`. Pass the correct `struct net *` through the client and tunnel structures.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: CRIT-01."
  },
  {
    "id": "F-173",
    "title": "SSRF via IPv4-Mapped IPv6 Addresses Bypasses Address Filtering",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "Full SSRF bypass. Attacker can connect to localhost services, cloud metadata endpoints (169.254.169.254), and internal networks via the tunnel.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "ipv6_addr_v4mapped",
        "ipv6_addr_is_isatap"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv6_addr_loopback(&addr6) ||\n    ipv6_addr_is_multicast(&addr6) ||\n    ipv6_addr_type(&addr6) & IPV6_ADDR_LINKLOCAL) {\n    return -EACCES;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The IPv6 address filter does not check for IPv4-mapped IPv6 addresses (`::ffff:127.0.0.1`), IPv4-compatible IPv6 addresses (`::127.0.0.1`), 6to4 addresses that embed private IPv4 ranges, or Teredo addresses. An attacker can use `::ffff:127.0.0.1` to connect to localhost, or `::ffff:10.0.0.1` to reac",
    "fix_suggestion": "Add checks for `ipv6_addr_v4mapped()`, `ipv6_addr_is_isatap()`, private RFC 1918 ranges within mapped addresses, and the unspecified address (`::` / `in6addr_any`). Also check for `::ffff:169.254.169.254` (cloud metadata).",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: CRIT-02."
  },
  {
    "id": "F-174",
    "title": "Missing RFC 1918 / Private Network Filtering in IPv4 SSRF Checks",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "SSRF to internal networks, cloud metadata endpoints, and management interfaces.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "the",
        "ipv4_is_linklocal_169",
        "ipv4_is_private_192",
        "ipv4_is_private_172",
        "ipv4_is_private_10"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv4_is_loopback(addr4) ||\n    ipv4_is_multicast(addr4) ||\n    ipv4_is_lbcast(addr4) ||\n    ipv4_is_zeronet(addr4)) {\n    return -EACCES;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The IPv4 SSRF filter does not block RFC 1918 private addresses (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), link-local (169.254.0.0/16 including the cloud metadata endpoint 169.254.169.254), or other reserved ranges. A remote attacker controlling QUIC stream data can instruct the VPS to connect to i",
    "fix_suggestion": "Add checks for `ipv4_is_private_10()`, `ipv4_is_private_172()`, `ipv4_is_private_192()`, `ipv4_is_linklocal_169()`, and other reserved ranges per RFC 5737 (192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24).",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: CRIT-03."
  },
  {
    "id": "F-175",
    "title": "Load Balancer Plaintext Mode Exposes Server ID",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "Server ID disclosure to any on-path observer. Enables targeted attacks against specific backend servers, load balancer topology mapping, and connection tracking/correlation.",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "pr_warn_once"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_LB_MODE_PLAINTEXT:\n    memcpy(cid->payload, plaintext, payload_len);\n    break;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "In plaintext mode (`encryption_key == NULL`), the server ID is embedded directly in the connection ID without any obfuscation. Any network observer can extract the server ID by reading bytes from the CID. The draft-ietf-quic-load-balancers specification explicitly warns that plaintext mode is only f",
    "fix_suggestion": "Log a `pr_warn_once()` when plaintext mode is selected. Consider requiring `CAP_NET_ADMIN` to create plaintext configs, or removing plaintext mode entirely. At minimum, add a prominent `IS THIS REALLY WHAT YOU WANT` style warning.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: CRIT-04."
  },
  {
    "id": "F-176",
    "title": "Function Pointer Stored in skb->cb Without Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "If `skb->cb` is corrupted (by another network layer or a bug), calling the stored function pointer leads to arbitrary code execution in kernel context.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "sk_buff"
      ],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:71-71",
        "net/tquic/security/quic_exfil.c:533-533"
      ],
      "snippets": [
        "/* Store send function in skb->cb */\n*(unsigned long *)skb->cb = (unsigned long)send_fn;\n\n/* Later, retrieve and call */\nvoid (*send_fn)(struct sk_buff *) =\n    (void (*)(struct sk_buff *))(*(unsigned long *)skb->cb);\nsend_fn(skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Function pointers are stored in `skb->cb` (the control buffer) and later retrieved and called without validation. The `skb->cb` area is 48 bytes and is used by multiple layers; if any intermediate processing corrupts or overwrites `cb[0]`, an attacker could achieve code execution. The check `if (skb",
    "fix_suggestion": "Do not store raw function pointers in `skb->cb`. Instead, use a dedicated structure with a magic number for validation, or use a callback registration mechanism that does not rely on `skb->cb`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-01."
  },
  {
    "id": "F-177",
    "title": "No CAP_NET_ADMIN Check for Tunnel Creation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "Unprivileged users can open arbitrary TCP connections via the tunnel mechanism, potentially circumventing local firewall rules and creating unauthorized network flows.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "tquic_tunnel_create_tproxy",
        "tquic_tunnel",
        "the",
        "tquic_stream",
        "tquic_tunnel_create",
        "tquic_client"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_tunnel *tquic_tunnel_create(struct tquic_client *client,\n                                         struct tquic_stream *stream,\n                                         const u8 *header_data,\n                                         size_t header_len)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "`tquic_tunnel_create()` and `tquic_tunnel_create_tproxy()` do not perform any capability checks. Any process that can open a QUIC stream can instruct the kernel to create outbound TCP connections to arbitrary destinations (subject to the incomplete SSRF filter). Tunnel creation should require `CAP_N",
    "fix_suggestion": "Add `capable(CAP_NET_ADMIN)` check at the entry point of tunnel creation, or ensure the calling path enforces this.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-02."
  },
  {
    "id": "F-178",
    "title": "Load Balancer Encryption Key Not Zeroized on Destroy",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "Encryption key material remains in freed memory, potentially recoverable via heap spraying or other memory disclosure techniques.",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "kmem_cache_free",
        "tquic_lb_config"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_lb_config_destroy(struct tquic_lb_config *cfg)\n{\n    if (!cfg)\n        return;\n\n    if (cfg->aes_tfm)\n        crypto_free_sync_skcipher(cfg->aes_tfm);\n\n    kmem_cache_free(lb_config_cache, cfg);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The AES-128 encryption key stored in `cfg->encryption_key[16]` is not zeroized before the config structure is freed. The SLAB allocator may reuse this memory for other allocations, potentially exposing the key material through information disclosure vulnerabilities in other subsystems. The `server_i",
    "fix_suggestion": "Add `memzero_explicit(cfg->encryption_key, sizeof(cfg->encryption_key))` and `memzero_explicit(cfg->server_id, sizeof(cfg->server_id))` before `kmem_cache_free()`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-03."
  },
  {
    "id": "F-179",
    "title": "Constant-Time CID Validation Has Branching on Lengths",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "Potential out-of-bounds read if `cid_len != expected_len`. The timing variation from branches may leak length information.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "bool tquic_ct_validate_cid(const u8 *cid, size_t cid_len,\n                           const u8 *expected, size_t expected_len)\n{\n    ...\n    /* Compare lengths without branching */\n    len_match = !(cid_len ^ expected_len);\n\n    /* Use the larger length to ensure constant-time */\n    max_len = cid_le"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Despite the comment \"without branching,\" the ternary `cid_len > expected_len ? cid_len : expected_len` is a branch on secret data. The comparison `max_len > sizeof(dummy_buf)` is also a branch. More critically, `tquic_ct_memcmp(cid, expected, max_len)` reads `max_len` bytes from both `cid` and `expe",
    "fix_suggestion": "Read exactly `min(cid_len, expected_len)` bytes with bounds checking, use `ct_select` for branchless max, and ensure both buffers are adequately sized or copy to fixed-size local buffers first.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-04."
  },
  {
    "id": "F-180",
    "title": "Unbounded Connection Creation via Netlink",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "Denial of service via kernel memory exhaustion by creating millions of connection info objects.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_nl_cmd_path_add",
        "tquic_net"
      ],
      "line_ranges": [],
      "snippets": [
        "conn = tquic_conn_lookup(net, conn_id);\nif (!conn) {\n    conn = tquic_conn_info_create(net, conn_id);\n    if (!conn)\n        return -ENOMEM;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "In `tquic_nl_cmd_path_add()`, a new connection is automatically created if the specified `conn_id` does not exist. There is no limit on the number of connections that can be created per namespace. While paths per connection are limited to 256, an attacker with `CAP_NET_ADMIN` can create unlimited co",
    "fix_suggestion": "Add a per-namespace limit on the number of connections (e.g., via an `atomic_t conn_count` in `struct tquic_net`).",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-05."
  },
  {
    "id": "F-181",
    "title": "Timing Normalization Can Block in Packet Processing Path",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "Kernel panic if called from softirq context. Denial of service via intentional latency injection (attacker sends many packets, each causing 2ms delay on the receiver).",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "usleep_range",
        "tquic_timing_normalize_process",
        "might_sleep"
      ],
      "line_ranges": [],
      "snippets": [
        "if (delay_us <= 10) {\n    udelay(delay_us);\n} else if (delay_us <= 1000) {\n    usleep_range(delay_us, delay_us + 10);\n} else {\n    msleep(delay_us / 1000);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "`tquic_timing_normalize_process()` is called during incoming packet processing (`tquic_exfil_process_incoming`). The function uses `usleep_range()` and `msleep()` which sleep and can only be called from process context. If called from softirq/BH context (typical for incoming packet processing), this",
    "fix_suggestion": "Never sleep in packet processing paths. Use `udelay()` only for very short delays, or defer processing to a workqueue. Add a `might_sleep()` annotation and ensure callers are in sleepable context.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: HIGH-06."
  },
  {
    "id": "F-182",
    "title": "Decoy Packet Size Calculation Can Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Potential large memory allocation attempt (though allocation will fail). If MTU is exactly 64, `rand_val % 1` = 0, so `decoy_size = 64`, which is correct. Values below 64 are the problem.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_traffic_shaper_set_mtu",
        "alloc_skb"
      ],
      "line_ranges": [],
      "snippets": [
        "decoy_size = 64 + (rand_val % (shaper->mtu - 64 + 1));",
        "if (mtu < 64) mtu = 64;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "If `shaper->mtu` is set to a value less than 64 (e.g., via `tquic_traffic_shaper_set_mtu()` with no lower bound check), `shaper->mtu - 64 + 1` wraps around to a very large number due to unsigned arithmetic (both are `u32`). This would produce a decoy_size of up to ~4GB, and `alloc_skb()` with such a",
    "fix_suggestion": "Add minimum MTU validation in `tquic_traffic_shaper_set_mtu()`:\n```c\nif (mtu < 64) mtu = 64;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-01."
  },
  {
    "id": "F-183",
    "title": "Load Balancer Feistel Network Half-Length Overlap",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "For `len > 30` (which is rejected by the `len > 32` check), the round number would overwrite data, causing decryption to fail. With current bounds (`len <= 32`, `half_len <= 16`), the last byte of `right` at index 15 can be overwritten. For `len = 31`, `half_len = 16`, and `right` has 15 bytes with `right[15]` being zero-pad, so `tmp[15] = round` overwrites zero-pad -- but for `len = 32`, both halves are 16 bytes, and `tmp[15] = round` overwrites `right[15]`, a real data byte.",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "half_len = (len + 1) / 2;\nmemcpy(left, plaintext, half_len);\nmemcpy(right, plaintext + half_len, len - half_len);\n...\ntmp[15] = round;  /* Include round number */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "When `len` is odd, `half_len > len - half_len`, so the left and right halves overlap by one byte in the middle of the plaintext. This is handled correctly for the Feistel network itself, but `tmp[15] = round` could overwrite meaningful data if `half_len > 15`. Given `TQUIC_LB_CID_PAYLOAD_MAX = 19`, ",
    "fix_suggestion": "Use a separate byte position for the round number that does not conflict with data, or XOR the round number rather than overwriting.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-02."
  },
  {
    "id": "F-184",
    "title": "Sysctl Variables Lack Range Validation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Invalid configuration states. Not exploitable for code execution but can disable security protections or cause unexpected behavior.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int exfil_protection_level = TQUIC_EXFIL_LEVEL_MEDIUM;\nstatic int exfil_timing_delay_us = TQUIC_EXFIL_DELAY_MEDIUM_MAX_US;\nstatic int exfil_padding_strategy = TQUIC_PAD_RANDOM;\nstatic int exfil_pad_probability = TQUIC_PAD_PROBABILITY_DEFAULT;\nstatic int exfil_spin_mode = TQUIC_SPIN_RANDOM_PRO"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "These module parameters are exposed via sysctl but no sysctl table with `.extra1`/`.extra2` range validation is registered anywhere in the code. The sysctl accessor functions cast these raw `int` values to enum types without range checking. A root user could set `exfil_protection_level = 99`, and th",
    "fix_suggestion": "Register a proper sysctl table with `proc_dointvec_minmax` handlers and range limits, or add range validation in the accessor functions.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-03."
  },
  {
    "id": "F-185",
    "title": "Netlink Path Dump Reads conn_id on Every Iteration",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Low -- no actual reference leak, but redundant work on each iteration.\n\n---",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_nl_cmd_path_dump",
        "tquic_conn_lookup"
      ],
      "line_ranges": [],
      "snippets": [
        "if (!attrs[TQUIC_NL_ATTR_CONN_ID]) {\n    NL_SET_ERR_MSG(cb->extack, \"Connection ID required\");\n    return -EINVAL;\n}\n\nctx->conn_id = nla_get_u64(attrs[TQUIC_NL_ATTR_CONN_ID]);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "In `tquic_nl_cmd_path_dump()`, the connection ID is re-read from attributes on every dump iteration (netlink dump callbacks are called repeatedly). The `ctx->conn_id` is overwritten each time. This is a correctness issue rather than a security issue, but if the attributes could theoretically change ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-186",
    "title": "Load Balancer Nonce Counter Wraps Without Re-keying",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "After counter wrap or module reload, CID collisions could allow connection correlation by a passive observer.",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&cfg->lock);\ncounter = cfg->nonce_counter++;\nspin_unlock(&cfg->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The nonce counter is a `u64` that increments monotonically. While a 64-bit counter will not wrap in practice for a single config lifetime, the counter is initialized with a random value (`get_random_bytes`), so depending on the starting value, it could wrap sooner than expected. More concerning: in ",
    "fix_suggestion": "Detect counter wrap and refuse to generate nonces, or use a larger state that combines counter with additional randomness.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-05."
  },
  {
    "id": "F-187",
    "title": "Tunnel Port Allocation Unsigned Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "None (correctly handled by bounds check), but defense-in-depth could be improved.\n\n---",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "bit = ntohs(port) - ntohs(client->port_range_start);\nif (bit >= TQUIC_PORTS_PER_CLIENT)\n    return;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The variable `bit` is `unsigned long`. If `ntohs(port) < ntohs(client->port_range_start)`, the subtraction wraps to a very large positive value. The `>= TQUIC_PORTS_PER_CLIENT` check catches this case correctly (the wrapped value will be much larger than 1000), so the function returns safely. Howeve",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-188",
    "title": "Exfil Context set_level Destroys and Reinitializes Without Lock",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Use-after-free, double-free, or crash if the protection level is changed while packets are being processed.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_exfil_ctx_set_level",
        "tquic_exfil_ctx"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The context has a `spinlock_t lock` field, but `tquic_exfil_ctx_set_level()` does not acquire it. Destroying and reinitializing the shaper, spin randomizer, and jitter while other threads may be using them (via `tquic_exfil_process_outgoing`) creates a use-after-free / use-during-reinit race conditi",
    "fix_suggestion": "Acquire `ctx->lock` around the destroy/init sequence, or use RCU to swap in a new configuration atomically.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: MED-07. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-189",
    "title": "Duplicate MODULE_DESCRIPTION/MODULE_LICENSE in quic_exfil.c",
    "category": "build",
    "severity": "S3",
    "confidence": "medium",
    "impact": "None (build warning only).\n\n---",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "MODULE_DESCRIPTION(\"TQUIC QUIC-Exfil Mitigation (draft-iab-quic-exfil)\");\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Linux Foundation\");"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The MODULE_DESCRIPTION, MODULE_LICENSE, and MODULE_AUTHOR macros are declared twice in the same file. This is a code quality issue that may cause build warnings.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: LOW-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-190",
    "title": "Netlink Events Do Not Include Timestamp",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Reduced observability, no security impact.\n\n---",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Netlink event notifications for path up/down/change/migration do not include a kernel timestamp. Userspace tools cannot determine the exact time of events, making debugging and correlation with other log sources difficult.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-191",
    "title": "Volatile Qualifiers in Constant-Time Functions May Be Insufficient",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Timing side-channel may still be exploitable despite the `volatile` annotation, particularly on architectures with speculative execution.",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [
        "const volatile unsigned char *aa = a;\nconst volatile unsigned char *bb = b;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The `volatile` qualifier prevents the compiler from optimizing away reads, but does not prevent speculative execution or microarchitectural side channels. Modern compilers and CPUs may still optimize the loop or execute it speculatively in ways that leak timing information. The kernel provides `cryp",
    "fix_suggestion": "Use `crypto_memneq()` from `<crypto/algapi.h>` instead of a custom implementation.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: LOW-03."
  },
  {
    "id": "F-192",
    "title": "Load Balancer Stack Buffers for Feistel Not Zeroized on Error",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Minor information disclosure risk in specialized attack scenarios.",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [
        "memzero_explicit",
        "tquic_lb_decrypt_four_pass",
        "tquic_lb_encrypt_four_pass"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The `left[16]`, `right[16]`, `tmp[16]`, and `round_out[16]` buffers in `tquic_lb_encrypt_four_pass()` and `tquic_lb_decrypt_four_pass()` are not zeroized on error return paths. While stack memory is less persistent than heap, in a kernel with KASAN or stack reuse, residual plaintext/key-derived data",
    "fix_suggestion": "Add `memzero_explicit()` calls in error paths and at function exit.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: LOW-04. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-193",
    "title": "Netlink Family Exported as EXPORT_SYMBOL_GPL",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Other kernel modules could send spoofed TQUIC events to userspace listeners.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "EXPORT_SYMBOL_GPL(tquic_genl_family);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Exporting the entire `genl_family` structure allows other modules to directly manipulate the netlink family or send events on its behalf. This is unusual; typically only specific helper functions are exported.",
    "fix_suggestion": "Export only the specific notification helper functions, not the family structure itself.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: AUDIT_SECURITY_NETLINK_LB.md. Original finding ID: LOW-05."
  },
  {
    "id": "F-194",
    "title": "Integer Overflow in Coupled CC Increase Calculation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** ~477-478",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "coupled_cc_increase"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Compute with overflow protection: reorder to divide early */\nu64 increase = div64_u64((u64)alpha * acked_bytes, total_cwnd * COUPLED_ALPHA_SCALE);\nincrease = increase * mss; /* Now safe: increase is small after division */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** ~477-478",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: CRITICAL-B1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-195",
    "title": "Same Overflow in OLIA Increase Path",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** ~941-942",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "olia_cc_increase"
      ],
      "line_ranges": [],
      "snippets": [
        "s64 eps_increase = div64_s64((s64)epsilon * (s64)acked_bytes, (s64)total_cwnd);\neps_increase *= mss;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** ~941-942",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: CRITICAL-B2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-196",
    "title": "TOCTOU Race in Bonding State Transition",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` **Line:** ~456-483",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_update_state"
      ],
      "line_ranges": [],
      "snippets": [
        "u32 gen = ctx->state_generation;\nspin_unlock_bh(&ctx->lock);\ntquic_bond_reorder_flush(ctx); /* may sleep */\nspin_lock_bh(&ctx->lock);\nif (ctx->state_generation != gen) {\n    /* State changed while lock was dropped, re-evaluate */\n    goto retry;\n}\nctx->state_generation++;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` **Line:** ~456-483",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-B1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-197",
    "title": "Weight Accumulation Without Overflow Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_select_weighted()`",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "tquic_select_weighted",
        "get_random_u32"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 total_weight = 0;\nfor_each_path(path) {\n    total_weight += path->weight;\n    if (total_weight > U32_MAX) {\n        /* Normalize weights by shifting all down */\n        ...\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_select_weighted()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-B2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-198",
    "title": "Expensive Operation in Loss Path",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` **Line:** `tquic_bonding_on_loss_detected()`",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_on_loss_detected"
      ],
      "line_ranges": [],
      "snippets": [
        "if (time_after(jiffies, ctx->last_weight_update + msecs_to_jiffies(ctx->min_rtt_ms))) {\n    tquic_bonding_derive_weights(ctx);\n    ctx->last_weight_update = jiffies;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.c` **Line:** `tquic_bonding_on_loss_detected()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-B3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-199",
    "title": "In-Flight Calculation Signed Arithmetic",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_calc_path_quality()`",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "tquic_calc_path_quality"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 acked_and_lost = (u64)rx_bytes + (u64)lost_packets * 1200;\ns64 in_flight = (s64)tx_bytes - (s64)acked_and_lost;\nif (in_flight < 0) in_flight = 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_calc_path_quality()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-B1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-200",
    "title": "Reorder Buffer Sequence in skb->cb Alignment",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_bond_reorder_insert()`",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/bonding.c"
      ],
      "symbols": [
        "put_unaligned",
        "tquic_skb_cb",
        "tquic_bond_reorder_insert",
        "get_unaligned",
        "overlay"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_skb_cb {\n    u64 sequence;\n    /* other fields */\n};\n#define TQUIC_SKB_CB(skb) ((struct tquic_skb_cb *)(skb)->cb)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/bonding.c` **Line:** `tquic_bond_reorder_insert()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-B2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-201",
    "title": "Alpha Precision Loss in Coupled CC",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** `coupled_calc_alpha()`",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/cong_coupled.c"
      ],
      "symbols": [
        "coupled_calc_alpha"
      ],
      "line_ranges": [],
      "snippets": [
        "u32 shift = max(ilog2(max_cwnd_rtt2), ilog2(sum_cwnd_rtt_sq));\nshift = (shift > 30) ? shift - 30 : 0;\n/* ... after division ... */\nalpha = clamp(alpha, COUPLED_ALPHA_MIN, COUPLED_ALPHA_MAX);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/cong_coupled.c` **Line:** `coupled_calc_alpha()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-B3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-202",
    "title": "Missing Documentation on Lock Ordering",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.h`",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/",
        "net/tquic/bond/tquic_bonding.h"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/*\n * Lock ordering (outermost first):\n *   1. ctx->lock (bonding context)\n *   2. path->lock (per-path)\n *   3. ctx->reorder_lock (reorder buffer)\n *   Never hold path->lock while acquiring ctx->lock.\n */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bonding.h`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-B1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-203",
    "title": "Excessive Stack Usage in RS Recovery",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~411-417",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "attempt_rs_recovery",
        "rs_recovery_ctx"
      ],
      "line_ranges": [],
      "snippets": [
        "u8 *symbols[255];       /* 255 * 8 = 2040 bytes (64-bit) */\nu16 lengths[255];       /* 255 * 2 = 510 bytes */\nu8 erasure_pos[255];    /* 255 bytes */\nu8 *recovered[255];     /* 2040 bytes */\nu16 recovered_lens[255]; /* 510 bytes */",
        "struct rs_recovery_ctx {\n    u8 *symbols[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u16 lengths[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u8 erasure_pos[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u8 *recovered[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n    u16 recovered_lens[TQUIC_FEC_MAX_SOURCE_SYMBOLS];\n};\n\nstruct rs_recovery_ctx *"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~411-417",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: CRITICAL-F1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-204",
    "title": "Large Stack Allocation in XOR Recovery",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~337",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "attempt_xor_recovery"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~337",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-F1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-205",
    "title": "Same Stack Issue in Encoder",
    "category": "perf",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c` **Line:** ~312-314, ~353-356",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c"
      ],
      "symbols": [
        "generate_rs_repair",
        "generate_xor_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c` **Line:** ~312-314, ~353-356",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-F2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-206",
    "title": "Repair Frame Field Truncation Without Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~764",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "tquic_fec_decode_repair_frame"
      ],
      "line_ranges": [],
      "snippets": [
        "frame->repair_length = (u16)value;",
        "if (value > U16_MAX) {\n    return -EOVERFLOW;\n}\nframe->repair_length = (u16)value;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~764",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-F3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-207",
    "title": "FEC Scheme ID Not Validated From Wire",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~758",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (scheme >= __TQUIC_FEC_SCHEME_MAX) {\n    return -EINVAL;\n}\nframe->scheme = scheme;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** ~758",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-F4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-208",
    "title": "Nested Locking in Repair Reception",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** `tquic_fec_receive_repair()`",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "tquic_fec_receive_repair"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_nested(&block->lock, SINGLE_DEPTH_NESTING);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_decoder.c` **Line:** `tquic_fec_receive_repair()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-F1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-209",
    "title": "Lock Ordering Between Encoder and Scheduler",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_scheduler.c` **Line:** ~278-279",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [
        "tquic_fec_should_send_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_scheduler.c` **Line:** ~278-279",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-F2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-210",
    "title": "Loss Rate Cast Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_scheduler.c` **Line:** ~113",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [
        "update_loss_rate"
      ],
      "line_ranges": [],
      "snippets": [
        "(int)new_rate - (int)sched->current_loss_rate",
        "s64 diff = (s64)new_rate - (s64)sched->current_loss_rate;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_scheduler.c` **Line:** ~113",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-F3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-211",
    "title": "C99 Variable Declaration in Loop",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/xor_fec.c` **Line:** ~157",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/xor_fec.c"
      ],
      "symbols": [
        "tquic_xor_decode"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/xor_fec.c` **Line:** ~157",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-F1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-212",
    "title": "Repair Data Pointer Lifetime",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c` **Line:** `tquic_fec_get_pending_repair()`",
    "evidence": {
      "file_paths": [
        "net/tquic/fec/fec_encoder.c",
        "net/tquic/cong/"
      ],
      "symbols": [
        "tquic_fec_get_pending_repair"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/fec/fec_encoder.c` **Line:** `tquic_fec_get_pending_repair()`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-F2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-213",
    "title": "Use-After-Free in Algorithm Name Return",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Line:** ~896-906",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "tquic_cong_get_default_name",
        "rcu_read_unlock",
        "rcu_read_lock"
      ],
      "line_ranges": [],
      "snippets": [
        "const char *tquic_cong_get_default_name(void)\n{\n    const char *name;\n    rcu_read_lock();\n    ca = rcu_dereference(default_ca);\n    name = ca->name;\n    rcu_read_unlock();\n    return name; /* <-- ca may be freed here */\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Line:** ~896-906",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: CRITICAL-C1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-214",
    "title": "Unprotected Global Loss Tracker Array",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Line:** ~74",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "tquic_loss_tracker"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Per-connection loss tracker */\nstruct tquic_loss_tracker *tracker = &conn->path[path_id].loss_tracker;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Line:** ~74",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-C1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-215",
    "title": "Global Congestion Data Cache Without Namespace Isolation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~47",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_cache",
        "cong_data_entry"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_cong_data_cache {\n    spinlock_t lock;\n    struct cong_data_entry entries[CONG_DATA_CACHE_SIZE];\n};\n/* Register in net_generic */\nstatic unsigned int cong_data_net_id;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~47",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: HIGH-C2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-216",
    "title": "Sort Modifies Caller's Lost Packets Array",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/persistent_cong.c` **Line:** ~221",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/persistent_cong.c"
      ],
      "symbols": [
        "tquic_lost_packet",
        "tquic_check_persistent_cong"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_lost_packet *sorted;\nsorted = kmemdup(lost_packets, count * sizeof(*sorted), GFP_ATOMIC);\nif (!sorted) return false;\nsort(sorted, count, sizeof(*sorted), cmp_lost_pkt, NULL);\n/* ... use sorted ... */\nkfree(sorted);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/persistent_cong.c` **Line:** ~221",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-C1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-217",
    "title": "Division Safety in Congestion Data Validation",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~636",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_on_ack"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 vrtt = READ_ONCE(state->validated_rtt);\nif (vrtt > 0) {\n    rtt_ratio = (rtt_us * 100) / vrtt;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~636",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-C2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-218",
    "title": "ECN State Tracking Per-Round Limitation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.h`",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.h"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.h`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-C3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-219",
    "title": "HMAC Stack Buffer Size",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~811",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "tquic_cong_data_compute_hmac"
      ],
      "line_ranges": [],
      "snippets": [
        "size_t offset = 0;\n#define HMAC_APPEND(ptr, len) do {          \\\n    if (offset + (len) > sizeof(msg))       \\\n        return -EOVERFLOW;                  \\\n    memcpy(msg + offset, (ptr), (len));     \\\n    offset += (len);                        \\\n} while (0)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c` **Line:** ~811",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: MEDIUM-C4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-220",
    "title": "Constant-Time Comparison",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "crypto_memneq"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-C1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-221",
    "title": "Sensitive Key Cleanup",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/cong_data.c"
      ],
      "symbols": [
        "kfree_sensitive"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/cong_data.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-C2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-222",
    "title": "BBR Auto-Selection for High-RTT Paths",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.h`",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.h"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.h`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_BOND_FEC_CONG_AUDIT.md. Original finding ID: LOW-C3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-223",
    "title": "Server Accept CID Parsing Missing Bounds Checks -- Buffer Over-Read",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2449-2515",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:2450-2450",
        "net/tquic/core/connection.c:2509-2509",
        "net/tquic/core/connection.c:2450-2450",
        "net/tquic/core/connection.c:2450-2450"
      ],
      "snippets": [
        "/* tquic_conn_server_accept */\noffset = 5;\ndcid_len = data[offset++];     // Line 2450: No check that offset < len\nmemcpy(dcid.id, data + offset, dcid_len);  // No check dcid_len <= TQUIC_MAX_CID_LEN\ndcid.len = dcid_len;\noffset += dcid_len;\n\nscid_len = data[offset++];     // Line 2509: No check that",
        "if (offset >= len) goto err_free;\ndcid_len = data[offset++];\nif (dcid_len > TQUIC_MAX_CID_LEN) goto err_free;\nif (offset + dcid_len > len) goto err_free;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2449-2515",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: CRIT-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-224",
    "title": "Version Negotiation Packet Overflow -- Unsanitized CID Lengths in tquic_send_version_negotiation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 947-997",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:961-961",
        "net/tquic/core/connection.c:965-965",
        "net/tquic/core/connection.c:971-971"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 947-997",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: CRIT-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-225",
    "title": "Handshake Packet Parsing with Unvalidated Offsets",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1921-1971",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_parse_long_header"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:1932-1932",
        "net/tquic/core/connection.c:1934-1934",
        "net/tquic/core/connection.c:1938-1938",
        "net/tquic/core/connection.c:1947-1947",
        "net/tquic/core/connection.c:1950-1950"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1921-1971",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: CRIT-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-226",
    "title": "Retry Token Validation -- Plaintext Buffer Overread",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1226-1282",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:1195-1195"
      ],
      "snippets": [
        "/* Copy ciphertext to plaintext buffer for in-place decryption */\nmemcpy(plaintext, token + TQUIC_RETRY_TOKEN_IV_LEN, ciphertext_len);",
        "u8 plaintext[128];\nciphertext_len = token_len - TQUIC_RETRY_TOKEN_IV_LEN;",
        "token_len >= TQUIC_RETRY_TOKEN_IV_LEN + sizeof(ktime_t) + 1 + sizeof(u32) + TQUIC_RETRY_TOKEN_TAG_LEN"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1226-1282",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: CRIT-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-227",
    "title": "Retry Packet Stack Buffer Overflow",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1303-1408",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:1379-1379",
        "net/tquic/core/connection.c:1401-1401"
      ],
      "snippets": [
        "int tquic_send_retry(...)\n{\n    u8 packet[512];\n    u8 *p = packet;\n    u8 token[TQUIC_RETRY_TOKEN_MAX_LEN];  // 256 bytes\n    ...\n    u8 pseudo_packet[512];\n    u8 *pp = pseudo_packet;\n    ...\n    *pp++ = original_dcid->len;\n    memcpy(pp, original_dcid->id, original_dcid->len);\n    pp += original_"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1303-1408",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-228",
    "title": "Retry Token AEAD Key Set Under Non-IRQ-Safe Spinlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1122-1148",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&tquic_retry_aead_lock);\nret = crypto_aead_setkey(tquic_retry_aead, tquic_retry_token_key, ...);\n...\nret = crypto_aead_encrypt(req);\nspin_unlock(&tquic_retry_aead_lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1122-1148",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-229",
    "title": "Return Pointer to Stack/Lock-Protected Data in tquic_conn_get_active_cid",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 636-655",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_cid *tquic_conn_get_active_cid(struct tquic_connection *conn)\n{\n    ...\n    spin_lock_bh(&conn->lock);\n    list_for_each_entry(entry, &cs->remote_cids, list) {\n        if (!entry->retired) {\n            result = &entry->cid;\n            break;\n        }\n    }\n    spin_unlock_bh(&conn->l"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 636-655",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-230",
    "title": "Anti-Amplification Integer Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2639-2645",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (cs->is_server) {\n    u64 limit = cs->bytes_received_unvalidated * cs->amplification_limit;\n    if (cs->bytes_sent_unvalidated + bytes > limit) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2639-2645",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-231",
    "title": "Coalesced Packet Splitting Assumes v1 Packet Type Encoding",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 1275-1276, 1320-1321",
    "evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [
        "tquic_decode_packet_type"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Check for Initial packet (has token) */\nif ((data[offset] & QUIC_LONG_HEADER_TYPE_MASK) ==\n    (QUIC_PACKET_TYPE_INITIAL << QUIC_LONG_HEADER_TYPE_SHIFT)) {",
        "if ((data[offset] & QUIC_LONG_HEADER_TYPE_MASK) ==\n    (QUIC_PACKET_TYPE_RETRY << QUIC_LONG_HEADER_TYPE_SHIFT)) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 1275-1276, 1320-1321",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-232",
    "title": "payload_len Subtraction Underflow in Long Header Parsing",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 618-619",
    "evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/packet.c:590-601",
        "net/tquic/core/packet.c:619-619"
      ],
      "snippets": [
        "hdr->header_len = offset;\n/* Adjust payload_len to not include packet number */\nhdr->payload_len -= hdr->pn_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 618-619",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-233",
    "title": "Retry Token Address Validation Uses Weak Hash",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1093-1104, 1270-1286",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u32 hash = jhash(&sin->sin_addr, sizeof(sin->sin_addr), sin->sin_port);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1093-1104, 1270-1286",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-234",
    "title": "Token Hash Comparison Not Constant-Time",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1283",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (token_hash != expected_hash) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1283",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-235",
    "title": "CID Sequence Number Rollback on rhashtable Insert Failure",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 536",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/connection.c:502-502"
      ],
      "snippets": [
        "cs->next_local_cid_seq--;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 536",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-236",
    "title": "Version Negotiation Packet Not Authenticated",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1012-1048",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "int tquic_handle_version_negotiation(...)\n{\n    ...\n    if (cs->version_negotiation_done) {\n        tquic_conn_warn(conn, \"duplicate version negotiation\\n\");\n        return -EPROTO;\n    }\n    new_version = tquic_version_select(versions, num_versions);\n    ...\n    conn->version = new_version;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1012-1048",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-237",
    "title": "Unbounded Pending Path Challenges",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1440-1464",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_challenge",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_send_path_challenge(struct tquic_connection *conn, struct tquic_path *path)\n{\n    ...\n    challenge = kzalloc(sizeof(*challenge), GFP_ATOMIC);\n    ...\n    list_add_tail(&challenge->list, &cs->pending_challenges);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1440-1464",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-238",
    "title": "ACK Frame Range Count Uses u64 Loop Variable Against size_t max_ranges",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/frame.c` **Lines:** 355-356",
    "evidence": {
      "file_paths": [
        "net/tquic/core/frame.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/core/frame.c:370-370"
      ],
      "snippets": [
        "if (frame->ack.ack_range_count > max_ranges)\n    return -EOVERFLOW;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/frame.c` **Lines:** 355-356",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-239",
    "title": "Packet Number Decode Returns 0 on Invalid Input",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 335-336",
    "evidence": {
      "file_paths": [
        "net/tquic/core/packet.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (len < 1 || len > 4)\n    return 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/packet.c` **Lines:** 335-336",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-240",
    "title": "Connection State Not Checked in tquic_conn_handle_close",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2138-2164",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_conn_handle_close(struct tquic_connection *conn,\n                            u64 error_code, u64 frame_type,\n                            const char *reason, bool is_app)\n{\n    ...\n    /* Enter draining state */\n    tquic_conn_enter_draining(conn);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2138-2164",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: MED-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-241",
    "title": "Retry Integrity Tag Computed with Potentially-Failing AEAD",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1383-1407",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "aead = crypto_alloc_aead(\"gcm(aes)\", 0, 0);\nif (!IS_ERR(aead)) {\n    ...\n    ret = crypto_aead_encrypt(req);\n    if (ret == 0) {\n        memcpy(p, tag, 16);\n        p += 16;\n    }\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 1383-1407",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: LOW-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-242",
    "title": "close_work Repurposes drain_work for Retransmit Scheduling",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2214-2216",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "work_struct"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_close_work_handler(struct work_struct *work)\n{\n    ...\n    if (cs->close_retries < 3) {\n        tquic_send_close_frame(conn);\n        schedule_delayed_work(&cs->drain_work,\n                              msecs_to_jiffies(1000));\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 2214-2216",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: LOW-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-243",
    "title": "HMAC Output Not Zeroized on Fallback Path",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 730-733",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "fallback:\n    kfree(desc);\n    crypto_free_shash(tfm);\n    tquic_stateless_reset_generate_token(cid, static_key, token);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 730-733",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: LOW-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-244",
    "title": "Version Negotiation First Byte Missing Fixed Bit Randomization",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 956",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "get_random_u8"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:807-807"
      ],
      "snippets": [
        "*p++ = 0x80;  /* Long header */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Line:** 956",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: LOW-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-245",
    "title": "Duplicate CID Not Checked in tquic_conn_add_remote_cid",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 559-587",
    "evidence": {
      "file_paths": [
        "net/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_cid",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/core/connection.c:275-310"
      ],
      "snippets": [
        "int tquic_conn_add_remote_cid(struct tquic_connection *conn,\n                              const struct tquic_cid *cid, u64 seq, ...)\n{\n    ...\n    entry = tquic_cid_entry_create(cid, seq);\n    ...\n    list_add_tail(&entry->list, &cs->remote_cids);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/connection.c` **Lines:** 559-587",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CORE_PROTOCOL_AUDIT.md. Original finding ID: LOW-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-246",
    "title": "OCSP Stapling Response Accepted Without Any Verification",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2094-2131",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_cert_verify_ctx",
        "tquic_x509_cert"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2094-2131",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: CRITICAL-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-247",
    "title": "Hard-Fail Revocation Mode Does Not Actually Fail",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2118-2130",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (ctx->check_revocation == TQUIC_REVOKE_HARD_FAIL) {\n        pr_warn(\"tquic_cert: Revocation check required but no OCSP stapling available\\n\");\n        /* In production, this should return an error.\n         * For now, allow to support existing deployments.\n         */\n    }\n\n    return 0;  // <--"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2118-2130",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: CRITICAL-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-248",
    "title": "Client Certificate Verification Uses Server Logic",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2586-2594",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_connection",
        "tquic_handshake"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2450-2450",
        "net/tquic/crypto/cert_verify.c:2243-2243"
      ],
      "snippets": [
        "int tquic_hs_verify_client_cert(struct tquic_handshake *hs,\n                                struct tquic_connection *conn)\n{\n    /* Client certificate verification uses same logic\n     * but checks for client auth EKU instead of server auth\n     */\n    return tquic_hs_verify_server_cert(hs, conn);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2586-2594",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: CRITICAL-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-249",
    "title": "Self-Signed Certificate Comparison Uses Non-Constant-Time memcmp in One Path",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1626-1630 vs 1926-1929",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "tquic_x509_cert"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:1626-1628",
        "net/tquic/crypto/cert_verify.c:1926-1928",
        "net/tquic/crypto/cert_verify.c:1929-1929"
      ],
      "snippets": [
        "if (cert->issuer_raw && cert->subject_raw &&\n        cert->issuer_raw_len == cert->subject_raw_len &&\n        !crypto_memneq(cert->issuer_raw, cert->subject_raw, cert->issuer_raw_len)) {\n        cert->self_signed = true;\n    }",
        "if (cert->issuer_raw && cert->subject_raw &&\n        cert->issuer_raw_len == cert->subject_raw_len &&\n        memcmp(cert->issuer_raw, cert->subject_raw, cert->issuer_raw_len) == 0) {\n        ((struct tquic_x509_cert *)cert)->self_signed = true;\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1626-1630 vs 1926-1929",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: CRITICAL-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-250",
    "title": "ASN.1 Time Parsing Does Not Validate Character Ranges",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1210-1254",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1210-1254",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: CRITICAL-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-251",
    "title": "RSA Signature Algorithm Hardcoded to SHA-256 Regardless of Certificate",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1951-1954",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "the"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_PUBKEY_ALGO_RSA:\n        alg_name = \"pkcs1pad(rsa,sha256)\";\n        break;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1951-1954",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-252",
    "title": "RSA-PSS Hash Algorithm Hardcoded to SHA-256",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 228-232",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "} else if (oid_len == sizeof(oid_rsa_pss) &&\n               memcmp(oid, oid_rsa_pss, oid_len) == 0) {\n        /* RSA-PSS: hash algo determined from parameters */\n        *hash_algo = TQUIC_HASH_SHA256;\n        *pubkey_algo = TQUIC_PUBKEY_ALGO_RSA;\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 228-232",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-253",
    "title": "Bloom Filter Has High False Positive Rate at Scale",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.h` **Lines:** 59-61",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.h"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.h:913-916"
      ],
      "snippets": [
        "#define TQUIC_REPLAY_BLOOM_BITS         (1 << 16)    /* 64K bits */\n#define TQUIC_REPLAY_BLOOM_HASHES       4             /* 4 hash functions */\n#define TQUIC_REPLAY_TTL_SECONDS        3600          /* 1 hour */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.h` **Lines:** 59-61",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-254",
    "title": "Ticket Store Free-After-Remove Race Condition",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 497-500",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [
        "tquic_zero_rtt_ticket"
      ],
      "line_ranges": [],
      "snippets": [
        "old = ticket_store_find_locked(&global_ticket_store,\n                                   server_name, server_name_len);\n    if (old) {\n        ticket_store_remove_locked(&global_ticket_store, old);\n        ticket_free(old);  // <-- frees while refcount may be > 1\n    }",
        "static void ticket_free(struct tquic_zero_rtt_ticket *ticket)\n{\n    if (!ticket)\n        return;\n    kfree(ticket->ticket);\n    memzero_explicit(&ticket->plaintext, sizeof(ticket->plaintext));\n    kfree(ticket);  // <-- unconditional free\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 497-500",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-255",
    "title": "Session Ticket Decode Missing Bounds Check on PSK Copy",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 1154-1164",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.c:1160-1160",
        "net/tquic/crypto/zero_rtt.c:1143-1143",
        "net/tquic/crypto/zero_rtt.c:1147-1147"
      ],
      "snippets": [
        "out->psk_len = *p++;\n    if (out->psk_len == 0 ||\n        out->psk_len > TQUIC_ZERO_RTT_SECRET_MAX_LEN) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    if (payload_len < 1 + out->psk_len + 4 + 8 + 2 + 1) {\n        ret = -EINVAL;\n        goto out_free;\n    }\n    memcpy(out->psk, p, out->psk"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 1154-1164",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-256",
    "title": "0-RTT Keys Derived With Empty Transcript",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 636-637",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* For simplicity, we use an empty transcript here. The actual\n     * implementation should include the ClientHello hash.\n     */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 636-637",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-257",
    "title": "Procfs trusted_cas Writable Without Privilege Check",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2862",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [
        "current_cred"
      ],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2772-2808",
        "net/tquic/crypto/cert_verify.c:2615-2615"
      ],
      "snippets": [
        "proc_create(\"trusted_cas\", 0644, tquic_cert_proc_dir,\n                &tquic_proc_trusted_cas_ops);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2862",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: HIGH-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-258",
    "title": "asn1_get_length Does Not Handle Length 0x84+",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 139-167",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:186-186",
        "net/tquic/crypto/cert_verify.c:155-155"
      ],
      "snippets": [
        "static int asn1_get_length(const u8 *data, u32 data_len, u32 *len, u32 *hdr_len)\n{\n    ...\n    } else if (data[0] == 0x83) {\n        if (data_len < 4)\n            return -EINVAL;\n        *len = (data[1] << 16) | (data[2] << 8) | data[3];\n        *hdr_len = 4;\n    } else {\n        return -EINVAL;\n   "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 139-167",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-259",
    "title": "SAN DNS Names Not Validated for Embedded NUL Characters",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 465-471",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "names[name_count] = kmalloc(content_len + 1, GFP_KERNEL);\n    if (!names[name_count])\n        goto err_free;\n\n    memcpy(names[name_count], p + 1 + hdr_len, content_len);\n    names[name_count][content_len] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 465-471",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-260",
    "title": "Hostname Wildcard Matching Allows Wildcards in Non-Leftmost Position",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1816-1829",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (pattern_len >= 2 && pattern[0] == '*' && pattern[1] == '.') {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 1816-1829",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-261",
    "title": "Path Length Constraint Check Off-By-One",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2259-2264",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (cert->path_len_constraint >= 0 &&\n        (int)(depth - 1) > cert->path_len_constraint) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2259-2264",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-262",
    "title": "0-RTT Encrypt Allocates AEAD Per-Packet",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 1522-1531",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "aead = crypto_alloc_aead(tquic_cipher_to_aead_name(state->cipher_suite), 0, 0);\n    if (IS_ERR(aead))\n        return PTR_ERR(aead);\n\n    ret = crypto_aead_setkey(aead, state->keys.key, state->keys.key_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 1522-1531",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-263",
    "title": "Bloom Filter Seeds Never Rotated",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 96-103",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/*\n * Seeds are NOT rotated after initialization because rotating seeds\n * invalidates all existing bloom filter entries...\n */\nstatic u32 replay_hash_seed1 __read_mostly;\nstatic u32 replay_hash_seed2 __read_mostly;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 96-103",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-264",
    "title": "Key Material Not Zeroized on All Error Paths in tquic_zero_rtt_derive_keys",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 596-707",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/zero_rtt.c:662-662",
        "net/tquic/crypto/zero_rtt.c:698-698"
      ],
      "snippets": [
        "out:\n    memzero_explicit(early_secret, sizeof(early_secret));\n    crypto_free_shash(hash);\n    return ret;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 596-707",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-265",
    "title": "Certificate Chain Parsing Does Not Verify Issuer-Subject Linkage Before Trust Check",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2300-2305",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2319-2319"
      ],
      "snippets": [
        "/* Check if this certificate is a trust anchor */\n    ret = find_trust_anchor(ctx, cert);\n    if (ret == 0) {\n        /* Found trust anchor, chain is valid */\n        return 0;\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2300-2305",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: MEDIUM-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-266",
    "title": "parse_basic_constraints Hardcoded BOOLEAN Length",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 633-638",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (p < end && p[0] == 0x01) {  /* BOOLEAN */\n        if (p + 3 <= end) {\n            *is_ca = (p[2] != 0);\n            p += 3;\n        }\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 633-638",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: LOW-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-267",
    "title": "server_ticket_key Is Static Global Without Rotation",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 88-89",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static u8 server_ticket_key[TQUIC_SESSION_TICKET_KEY_LEN];\nstatic bool server_ticket_key_valid;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 88-89",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: LOW-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-268",
    "title": "Empty Hash Computed Without Algorithm Validation",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 648-657",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/zero_rtt.c` **Lines:** 648-657",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: LOW-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-269",
    "title": "Inconsistent Error Return From verify_chain",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2318-2326",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/cert_verify.c:2332-2332"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 2318-2326",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: LOW-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-270",
    "title": "SAN Parsing Capacity Limit Check Could Be Tighter",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 454",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (name_capacity >= 10000)\n        goto err_free;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/cert_verify.c` **Lines:** 454",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_CERT_0RTT.md. Original finding ID: LOW-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-271",
    "title": "Hardcoded Struct Offset to Access Key Update State -- Memory Corruption Risk",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 1143-1172",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "layout",
        "tquic_crypto_state_ku_accessor",
        "tquic_key_update_state",
        "tquic_crypto_state"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_crypto_state_ku_accessor {\n    char _before_key_update[304];    /* Approximate offset */\n    struct tquic_key_update_state *key_update;\n} *accessor;\n\nif (!crypto_state)\n    return NULL;\n\nif (header->cipher_suite == 0)\n    return NULL;\n\naccessor = crypto_state;\nreturn accessor->key_updat",
        "/* In tls.c, where tquic_crypto_state is fully defined: */\nstruct tquic_key_update_state *tquic_crypto_get_key_update_state(\n    struct tquic_crypto_state *crypto)\n{\n    return crypto ? crypto->key_update : NULL;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 1143-1172",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: C1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-272",
    "title": "Per-Packet crypto_aead_setkey on Shared AEAD Handle -- Race Condition",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 622, 679",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "tquic_decrypt_packet",
        "tquic_encrypt_packet",
        "crypto_aead_setkey"
      ],
      "line_ranges": [
        "net/tquic/crypto/tls.c:622-622",
        "net/tquic/crypto/tls.c:679-679"
      ],
      "snippets": [
        "/* In tquic_encrypt_packet(), line 622: */\nret = crypto_aead_setkey(crypto->aead, keys->key, keys->key_len);\n\n/* In tquic_decrypt_packet(), line 679: */\nret = crypto_aead_setkey(crypto->aead, keys->key, keys->key_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 622, 679",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: C2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-273",
    "title": "Install Secrets Accesses State Without Lock After Unlock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 878-898",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "tquic_ku_derive_keys"
      ],
      "line_ranges": [
        "net/tquic/crypto/key_update.c:878-878",
        "net/tquic/crypto/key_update.c:881-881",
        "net/tquic/crypto/key_update.c:885-885",
        "net/tquic/crypto/key_update.c:890-890",
        "net/tquic/crypto/key_update.c:868-878"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 878-898",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: C3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-274",
    "title": "EKU Derives Keys Using KU hash_tfm Without KU Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` **Lines:** 829-834",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "eku_hkdf_extract"
      ],
      "line_ranges": [
        "net/tquic/crypto/extended_key_update.c:821-821",
        "net/tquic/crypto/extended_key_update.c:829-829",
        "net/tquic/crypto/extended_key_update.c:830-830",
        "net/tquic/crypto/extended_key_update.c:821-821"
      ],
      "snippets": [
        "spin_unlock_irqrestore(&state->lock, flags);    /* line 821 */\n\n/* Access ku_state->hash_tfm WITHOUT ku_state->lock */\nif (ku_state->hash_tfm) {                       /* line 829 */\n    ret = eku_hkdf_extract(ku_state->hash_tfm,  /* line 830 */\n                           current_secret, secret_len,\n"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` **Lines:** 829-834",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: H1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-275",
    "title": "EKU Semantic Mismatch: get_current_keys Returns Key, Not Secret",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` **Lines:** 808-815",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/extended_key_update.c"
      ],
      "symbols": [
        "tquic_key_update_get_current_keys"
      ],
      "line_ranges": [],
      "snippets": [
        "size_t secret_len = 32;  /* SHA-256 default */\nu8 current_secret[48];\nu32 key_len;\n\n/* Get current secret from base key update state */\nret = tquic_key_update_get_current_keys(ku_state, 1,\n                                        current_secret, &key_len,\n                                        NULL,"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/extended_key_update.c` **Lines:** 808-815",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: H2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-276",
    "title": "memset Instead of memzero_explicit for Old Key Material",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 435, 627-628",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "memzero_explicit"
      ],
      "line_ranges": [
        "net/tquic/crypto/key_update.c:435-435",
        "net/tquic/crypto/key_update.c:627-628",
        "net/tquic/crypto/key_update.c:404-404"
      ],
      "snippets": [
        "/* Line 435: After key rotation in tquic_initiate_key_update */\nmemset(&state->next_write, 0, sizeof(state->next_write));\n\n/* Lines 627-628: After peer key phase change */\nmemset(&state->next_read, 0, sizeof(state->next_read));\nmemset(&state->next_write, 0, sizeof(state->next_write));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 435, 627-628",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: H3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-277",
    "title": "Per-Call skcipher_request Allocation in HP Mask Hot Path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 164, 211",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/header_protection.c:164-164",
        "net/tquic/crypto/header_protection.c:211-211"
      ],
      "snippets": [
        "/* AES path, line 164: */\nreq = skcipher_request_alloc(hp_key->tfm, GFP_ATOMIC);\nif (!req)\n    return -ENOMEM;\n\n/* ChaCha20 path, line 211: */\nreq = skcipher_request_alloc(hp_key->tfm, GFP_ATOMIC);\nif (!req)\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 164, 211",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-278",
    "title": "Per-Packet kmalloc in Batch Encrypt/Decrypt",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` **Lines:** 708, 773",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/hw_offload.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/hw_offload.c:708-708",
        "net/tquic/crypto/hw_offload.c:703-703"
      ],
      "snippets": [
        "/* Encrypt path, line 708: */\nct_buf = kmalloc(ct_buf_len, GFP_ATOMIC);\nif (!ct_buf) {\n    pkt->result = -ENOMEM;\n    continue;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/hw_offload.c` **Lines:** 708, 773",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-279",
    "title": "Hardcoded 8-Byte CID in Short Header Unprotect",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/quic_crypto.c` **Line:** 1453",
    "evidence": {
      "file_paths": [
        "net/tquic/core/quic_crypto.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* Short header - DCID starts at byte 1 */\n*pn_offset = 1 + 8;  /* Assume 8-byte connection ID */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/core/quic_crypto.c` **Line:** 1453",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-280",
    "title": "HP Key Rotation Swaps Old Keys Without Zeroization",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 890-898",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "memzero_explicit"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Rotate read key */\ntmp = ctx->read_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->read_keys[TQUIC_HP_LEVEL_APPLICATION] = ctx->next_read_key;\nctx->next_read_key = tmp;    /* Old key is now \"next\" -- not zeroized */\n\n/* Rotate write key */\ntmp = ctx->write_keys[TQUIC_HP_LEVEL_APPLICATION];\nctx->write_keys"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 890-898",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-281",
    "title": "Token Key Rotation Does Not Zeroize Old Key",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_token.c` **Lines:** 222-233",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_token.c"
      ],
      "symbols": [
        "memzero_explicit",
        "tquic_token_key"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_token_rotate_key(struct tquic_token_key *old_key,\n                           struct tquic_token_key *new_key)\n{\n    if (!new_key)\n        return -EINVAL;\n\n    get_random_bytes(new_key->key, TQUIC_TOKEN_KEY_LEN);\n    new_key->generation = old_key ? old_key->generation + 1 : 1;\n    new_key->"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_token.c` **Lines:** 222-233",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-282",
    "title": "No Token Replay Protection Beyond Timestamp",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_token.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_token.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_token.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: M6. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-283",
    "title": "Lock Drop/Re-acquire Pattern in Key Derivation",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 397-412",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/key_update.c"
      ],
      "symbols": [
        "tquic_ku_derive_next_generation"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/key_update.c` **Lines:** 397-412",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: L1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-284",
    "title": "CRYPTO_TFM_REQ_MAY_BACKLOG in Atomic Context",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 172-173, 216-217",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/header_protection.c"
      ],
      "symbols": [
        "tquic_hp_mask_aes",
        "crypto_wait_req",
        "tquic_hp_mask_chacha20"
      ],
      "line_ranges": [],
      "snippets": [
        "skcipher_request_set_callback(req, CRYPTO_TFM_REQ_MAY_BACKLOG,\n                              crypto_req_done, &wait);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/header_protection.c` **Lines:** 172-173, 216-217",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: L2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-285",
    "title": "crypto_wait_req May Sleep in Encrypt/Decrypt Hot Path",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 637, 694",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/tls.c:637-637",
        "net/tquic/crypto/tls.c:694-694"
      ],
      "snippets": [
        "ret = crypto_wait_req(crypto_aead_encrypt(req), &wait);  /* line 637 */\nret = crypto_wait_req(crypto_aead_decrypt(req), &wait);  /* line 694 */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 637, 694",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: L3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-286",
    "title": "Multipath Nonce Construction -- Potential Nonce Reuse Across Paths",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 590-592",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/tls.c"
      ],
      "symbols": [
        "tquic_crypto_ctx_destroy",
        "offset",
        "tquic_initiate_key_update"
      ],
      "line_ranges": [
        "net/tquic/crypto/tls.c:392-423",
        "net/tquic/crypto/tls.c:645-645",
        "net/tquic/crypto/tls.c:966-983",
        "net/tquic/crypto/tls.c:1307-1372",
        "net/tquic/crypto/tls.c:183-183"
      ],
      "snippets": [
        "/* XOR path_id into nonce bytes 4..7 for path separation */\nfor (i = 0; i < 4; i++)\n    nonce[7 - i] ^= (path_id >> (i * 8)) & 0xff;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/tls.c` **Lines:** 590-592",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_CRYPTO_KEYS_TLS.md. Original finding ID: L4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-287",
    "title": "Stack buffer overflow in `tquic_hs_build_ch_extensions` -- no bounds checking on output buffer",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1076-1253",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_handshake",
        "tquic_hs_set_sni",
        "tquic_hs_generate_client_hello",
        "tquic_hs_setup_psk",
        "tquic_hs_set_alpn"
      ],
      "line_ranges": [],
      "snippets": [
        "static int tquic_hs_build_ch_extensions(struct tquic_handshake *hs,\n                                        u8 *buf, u32 buf_len, u32 *out_len)\n{\n    u8 *p = buf;\n    // ...\n    /* Supported Versions extension */\n    *p++ = (TLS_EXT_SUPPORTED_VERSIONS >> 8) & 0xff;\n    *p++ = TLS_EXT_SUPPORTED_VERSI"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1076-1253",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-288",
    "title": "Stack buffer overflow in `tquic_hs_hkdf_expand_label` -- unbounded label/context write to 512-byte stack buffer",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 735-809",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_handshake"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:762-762"
      ],
      "snippets": [
        "/* Validate that hkdf_label fits in the stack buffer */\nif (3 + 6 + label_len + 1 + context_len > sizeof(hkdf_label))\n    return -EINVAL;\nif (context_len > 255)\n    return -EINVAL;  /* TLS context is at most 255 bytes */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 735-809",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-289",
    "title": "No bounds checking on `buf` output in `tquic_hs_generate_client_hello`",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1258-1380",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_handshake"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1258-1380",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-3. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-290",
    "title": "Integer overflow in `tquic_hs_build_ch_extensions` PSK identity length calculations",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1206-1244",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1224-1234",
        "net/tquic/crypto/handshake.c:1217-1218"
      ],
      "snippets": [
        "if (hs->psk_count > 0) {\n    u32 identities_len = 0;\n    u32 binders_len = 0;\n    u32 i;\n\n    for (i = 0; i < hs->psk_count; i++) {\n        identities_len += 2 + hs->psk_identities[i].identity_len + 4;\n        binders_len += 1 + hs->hash_len;\n    }\n\n    *p++ = (TLS_EXT_PRE_SHARED_KEY >> 8) & 0xff;\n "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1206-1244",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-291",
    "title": "`tquic_hs_process_certificate` -- integer underflow in `certs_len` tracking",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1769-1807",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1778-1778",
        "net/tquic/crypto/handshake.c:1780-1780",
        "net/tquic/crypto/handshake.c:1800-1800"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1769-1807",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-292",
    "title": "`tquic_hs_process_new_session_ticket` -- nonce overflow into session ticket",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2583-2597",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_session_ticket",
        "ever"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:76-77"
      ],
      "snippets": [
        "/* Ticket nonce */\nnonce_len = *p++;\nif (p + nonce_len > end)\n    return -EINVAL;\n\n/* ... allocate session_ticket ... */\n\nhs->session_ticket->nonce_len = nonce_len;\nmemcpy(hs->session_ticket->nonce, p, nonce_len);",
        "struct tquic_session_ticket {\n    // ...\n    u8 nonce[255];\n    u8 nonce_len;\n    // ...\n};",
        "p += session_id_len;\n\n    /* Cipher suite */\n    cipher_suite = (p[0] << 8) | p[1];\n    p += 2;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2583-2597",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-293",
    "title": "`tquic_hs_process_server_hello` -- missing bounds check before compression byte read",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1477-1481",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* Compression (must be null) */\n    compression = *p++;\n    if (compression != 0) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1477-1481",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: CRITICAL-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-294",
    "title": "`tquic_hs_hkdf_expand_label` -- `context_len` truncated to u8",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 760",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:762-762"
      ],
      "snippets": [
        "*p++ = context_len;     // context_len is u32, written as u8",
        "if (context_len > 255)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 760",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-295",
    "title": "`tquic_hs_generate_client_hello` -- output buffer `buf` not validated for minimum size",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1319-1357",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1320-1320"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1319-1357",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-296",
    "title": "`tquic_hs_process_server_hello` -- session ID comparison not fully bounds-safe",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1443-1455",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1423-1423",
        "net/tquic/crypto/handshake.c:1426-1426"
      ],
      "snippets": [
        "session_id_len = *p++;\n    if (session_id_len > TLS_SESSION_ID_MAX_LEN)\n        return -EINVAL;\n    if (p + session_id_len > end)\n        return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1443-1455",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-297",
    "title": "Secrets not zeroized on error paths in key derivation functions",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 935-990 (`tquic_hs_derive_handshake_secrets`)",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "memzero_explicit",
        "tquic_handshake"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:995-1045",
        "net/tquic/crypto/handshake.c:1050-1071",
        "net/tquic/crypto/handshake.c:895-930",
        "net/tquic/crypto/handshake.c:2379-2462",
        "net/tquic/crypto/handshake.c:2467-2536"
      ],
      "snippets": [
        "static int tquic_hs_derive_handshake_secrets(struct tquic_handshake *hs)\n{\n    u8 derived[TLS_SECRET_MAX_LEN];\n    u8 transcript_hash[TLS_SECRET_MAX_LEN];\n    // ...\n    ret = tquic_hs_derive_secret(hs, hs->early_secret, \"derived\",\n                                 NULL, 0, derived, hash_len);\n    if"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 935-990 (`tquic_hs_derive_handshake_secrets`)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-298",
    "title": "`tquic_hs_setup_psk` -- integer overflow in ticket age calculation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2688-2691",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "age = (now - ticket->creation_time) * 1000;  /* Convert to ms */\n    obfuscated_age = age + ticket->age_add;\n    psk->obfuscated_ticket_age = obfuscated_age;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2688-2691",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-299",
    "title": "`tquic_hs_build_ch_extensions` -- ALPN extension length written as 2-byte but can overflow u16",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1144-1163",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_set_alpn"
      ],
      "line_ranges": [],
      "snippets": [
        "if (hs->alpn_count > 0) {\n        u32 alpn_total_len = 0;\n\n        for (i = 0; i < hs->alpn_count; i++)\n            alpn_total_len += 1 + strlen(hs->alpn_list[i]);\n\n        *p++ = ((alpn_total_len + 2) >> 8) & 0xff;\n        *p++ = (alpn_total_len + 2) & 0xff;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1144-1163",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-300",
    "title": "`tquic_hs_process_encrypted_extensions` -- ALPN validation insufficient",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1671-1684",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "case TLS_EXT_ALPN:\n        if (ext_data_len >= 3) {\n            u16 list_len = (p[0] << 8) | p[1];\n            u8 proto_len = p[2];\n\n            if (list_len >= proto_len + 1 && proto_len > 0) {\n                kfree(hs->alpn_selected);\n                hs->alpn_selected = kmalloc(proto_len + 1, GFP_",
        "if (ext_data_len >= 3 && proto_len > 0 && 3 + proto_len <= ext_data_len) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1671-1684",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-301",
    "title": "`tquic_hs_cleanup` -- potential double-free of session ticket",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3284-3287 and 2701-2702",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "tquic_hs_setup_psk",
        "tquic_hs_cleanup"
      ],
      "line_ranges": [],
      "snippets": [
        "if (hs->session_ticket) {\n        kfree(hs->session_ticket->ticket);\n        kfree(hs->session_ticket);\n    }",
        "/* Store session ticket for early data */\n    hs->session_ticket = ticket;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3284-3287 and 2701-2702",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-302",
    "title": "`tquic_hs_process_new_session_ticket` -- memory leak of old ticket data on re-entry",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2588-2612",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:2609-2609",
        "net/tquic/crypto/handshake.c:2610-2610",
        "net/tquic/crypto/handshake.c:2609-2609"
      ],
      "snippets": [
        "if (!hs->session_ticket) {\n        hs->session_ticket = kzalloc(sizeof(*hs->session_ticket), GFP_KERNEL);\n        if (!hs->session_ticket)\n            return -ENOMEM;\n    }\n    // ... writes to hs->session_ticket fields ...\n\n    kfree(hs->session_ticket->ticket);\n    hs->session_ticket->ticket = kma"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2588-2612",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: HIGH-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-303",
    "title": "`tquic_hs_generate_client_hello` -- `hkdf_label` stack buffer on sensitive crypto path",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 741",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 741",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-304",
    "title": "`hs_varint_encode` -- no bounds check on output buffer",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 292-319",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static int hs_varint_encode(u64 val, u8 *buf, u32 *len)\n{\n    if (val < 0x40) {\n        buf[0] = val;\n        *len = 1;\n    } else if (val < 0x4000) {\n        buf[0] = 0x40 | (val >> 8);\n        buf[1] = val & 0xff;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 292-319",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-305",
    "title": "`tquic_hs_process_server_hello` -- extension parsing loop bound mismatch",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1493",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1486-1486",
        "net/tquic/crypto/handshake.c:1655-1655"
      ],
      "snippets": [
        "while (p < data + 4 + msg_len) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1493",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-306",
    "title": "`tquic_hs_process_certificate` -- unbounded certificate allocation",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1784-1789",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (!hs->peer_cert && cert_len > 0) {\n        hs->peer_cert = kmalloc(cert_len, GFP_KERNEL);\n        if (!hs->peer_cert)\n            return -ENOMEM;\n        memcpy(hs->peer_cert, p, cert_len);\n        hs->peer_cert_len = cert_len;\n    }",
        "if (cert_len > TLS_CERT_MAX_LEN)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1784-1789",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-307",
    "title": "`tquic_hs_process_new_session_ticket` -- `ticket_len` is u16, can be up to 65535",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2601-2612",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2601-2612",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-308",
    "title": "`tquic_hs_derive_early_secrets` -- `memzero_explicit` called before error check",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 923-927",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_hs_derive_secret(hs, hs->early_secret,\n                                     \"ext binder\", NULL, 0,\n                                     binder_key, hash_len);\n        memzero_explicit(binder_key, sizeof(binder_key));\n        if (ret)\n            return ret;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 923-927",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-309",
    "title": "`tquic_hs_process_certificate_verify` -- `content[200]` stack buffer could overflow with large hash",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2180-2220",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u8 content[200];\n    u8 *cp = content;\n    // ...\n    memset(cp, 0x20, 64);   // 64 bytes\n    cp += 64;\n    memcpy(cp, \"TLS 1.3, server CertificateVerify\", 33);  // 33 bytes\n    cp += 33;\n    *cp++ = 0x00;            // 1 byte = 98 total\n    memcpy(cp, transcript_hash, hash_len);  // hash_len up to "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2180-2220",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-310",
    "title": "`tquic_hs_process_server_hello` -- `static const` inside function body",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1430-1435",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static const u8 hrr_random[32] = {\n        0xcf, 0x21, 0xad, 0x74, ...\n    };"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 1430-1435",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: MEDIUM-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-311",
    "title": "`tquic_hs_cleanup` -- does not zeroize exporter_secret and resumption_secret",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3304-3314",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "memzero_explicit(hs->early_secret, sizeof(hs->early_secret));\n    memzero_explicit(hs->handshake_secret, sizeof(hs->handshake_secret));\n    memzero_explicit(hs->master_secret, sizeof(hs->master_secret));\n    // ... other secrets ...\n    memzero_explicit(hs->shared_secret, sizeof(hs->shared_secret));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3304-3314",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-312",
    "title": "`tquic_hs_get_handshake_secrets` and `tquic_hs_get_app_secrets` -- no output buffer size validation",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3086-3131",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 3086-3131",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-313",
    "title": "`tquic_hs_set_alpn` -- missing `hs->alpn_count = 0` on cleanup",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2958-2962",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:2964-2964"
      ],
      "snippets": [
        "if (hs->alpn_list) {\n        for (i = 0; i < hs->alpn_count; i++)\n            kfree(hs->alpn_list[i]);\n        kfree(hs->alpn_list);\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2958-2962",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-314",
    "title": "`tquic_hs_generate_client_hello` -- client random not checked for all-zero",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 1273",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "get_random_bytes"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 1273",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-315",
    "title": "`tquic_hs_process_certificate_verify` hardcodes \"server CertificateVerify\" string",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 2203",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Line:** 2203",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-316",
    "title": "`tquic_hs_process_new_session_ticket` -- ignores extensions",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2624-2625",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "crypto_memneq",
        "kfree_sensitive",
        "memzero_explicit",
        "tquic_hs_cleanup"
      ],
      "line_ranges": [
        "net/tquic/crypto/handshake.c:1076-1253",
        "net/tquic/crypto/handshake.c:735-809",
        "net/tquic/crypto/handshake.c:1258-1380",
        "net/tquic/crypto/handshake.c:1206-1244",
        "net/tquic/crypto/handshake.c:1769-1807"
      ],
      "snippets": [
        "/* Parse extensions (early_data max size, etc.) */\n    /* Skip for now */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/crypto/handshake.c` **Lines:** 2624-2625",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HANDSHAKE_AUDIT.md. Original finding ID: LOW-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-317",
    "title": "Huffman Decoder O(n*256) Algorithmic Complexity DoS",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack.c` **Lines:** 398-457",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (decoded < out_len && bit_offset < total_bits) {\n    /* Try each symbol to find match */\n    for (sym = 0; sym < 256; sym++) {\n        u32 code = qpack_huffman_encode_table[sym].code;\n        u8 nbits = qpack_huffman_encode_table[sym].nbits;\n        ...\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack.c` **Lines:** 398-457",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-318",
    "title": "Stream Lookup Returns Pointer Without Refcount -- Use-After-Free",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` **Lines:** h3_stream_lookup (exact line in stream RB-tree search)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c",
        "net/quic/tquic/core/stream.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_stream",
        "tquic_stream_put",
        "rcu_read_lock"
      ],
      "line_ranges": [
        "net/quic/tquic/core/priority.c:497-524",
        "net/quic/tquic/core/priority.c:1461-1489",
        "net/quic/tquic/core/priority.c:339-358",
        "net/quic/tquic/core/priority.c:60-85"
      ],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nnode = conn->streams.rb_node;\nwhile (node) {\n    stream = rb_entry(node, struct tquic_stream, node);\n    if (stream_id < stream->id)\n        node = node->rb_left;\n    else if (stream_id > stream->id)\n        node = node->rb_right;\n    else {\n        spin_unlock_bh(&conn->l"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` **Lines:** h3_stream_lookup (exact line in stream RB-tree search)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-319",
    "title": "QPACK Dynamic Table Duplicate TOCTOU Race",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_dynamic.c` **Lines:** ~335-382 (qpack_dynamic_table_duplicate)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_dynamic.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "spin_lock_irqsave(&table->lock, flags);\nentry = qpack_dynamic_table_get(table, index);\nif (!entry) { unlock; return error; }\nmemcpy(name_buf, entry->name, entry->name_len);  /* Copy while locked */\nmemcpy(value_buf, entry->value, entry->value_len);\nname_len = entry->name_len;\nvalue_len = entry->valu"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_dynamic.c` **Lines:** ~335-382 (qpack_dynamic_table_duplicate)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-320",
    "title": "QPACK Decoder Stack Buffer Overflow via Large Headers",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_decoder.c` **Lines:** ~Lines in qpack_decode_headers and qpack_decoder_process_encoder_stream",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "char name_buf[QPACK_MAX_HEADER_NAME_LEN];   /* 256 bytes on stack */\nchar value_buf[QPACK_MAX_HEADER_VALUE_LEN];  /* 8192 bytes on stack */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_decoder.c` **Lines:** ~Lines in qpack_decode_headers and qpack_decoder_process_encoder_stream",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-321",
    "title": "WebTransport Close Capsule Large Stack Allocation",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c` **Line:** ~473",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u8 buf[128 + WEBTRANSPORT_MAX_URL_LEN];  /* 128 + 8192 = 8320 bytes */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c` **Line:** ~473",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-322",
    "title": "tquic_stream_sendmsg Writes to Stream Without Connection Refcount on Stream",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 889-1062",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 889-1062",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-323",
    "title": "Priority PRIORITY_UPDATE Parsing Off-by-Two in Loop Bound",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 630",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/priority.c:633-633",
        "net/quic/tquic/core/priority.c:637-637"
      ],
      "snippets": [
        "for (i = 0; i < pf_len - 2; i++) {\n    if (pf_start[i] == 'u' && pf_start[i + 1] == '=') {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 630",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: CRIT-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-324",
    "title": "h3_stream_lookup_by_push_id Linear Scan Under Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 871-892",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [
        "h3_stream"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock(&h3conn->lock);\nfor (node = rb_first(&h3conn->streams); node; node = rb_next(node)) {\n    h3s = rb_entry(node, struct h3_stream, node);\n    if (h3s->type == H3_STREAM_TYPE_PUSH && h3s->push_id == push_id) {\n        spin_unlock(&h3conn->lock);\n        return h3s;\n    }\n}\nspin_unlock(&h3conn"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 871-892",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-325",
    "title": "tquic_stream_check_flow_control TOCTOU with sendmsg",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 677-707 (check), 933-994 (use in sendmsg)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:690-690",
        "net/quic/tquic/tquic_stream.c:980-994",
        "net/quic/tquic/tquic_stream.c:980-994"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 677-707 (check), 933-994 (use in sendmsg)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-326",
    "title": "Memory Exhaustion via Unbounded QPACK Header Lists",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack.c` **Lines:** qpack_header_list_add function",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack.c` **Lines:** qpack_header_list_add function",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-327",
    "title": "h3_request_send_headers State Check TOCTOU",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** Early portion of h3_request_send_headers",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** Early portion of h3_request_send_headers",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-328",
    "title": "qpack_encoder known_received_count Overflow via Insert Count Increment",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_encoder.c` **Lines:** 700-708",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* Insert Count Increment: 00xxxxxx */\nret = qpack_decode_integer(data + offset, len - offset,\n                           6, &value, &consumed);\n...\nenc->known_received_count += value;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_encoder.c` **Lines:** 700-708",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-329",
    "title": "tquic_stream_ext Uses GFP_ATOMIC for Large Allocation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 154-184",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ext = kmem_cache_zalloc(mgr->stream_cache, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 154-184",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-330",
    "title": "atomic_sub on sk_rmem_alloc Incompatible with refcount_t",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 795, 1948, 2033",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "skb_set_owner_r"
      ],
      "line_ranges": [],
      "snippets": [
        "atomic_sub(skb->truesize, &sk->sk_rmem_alloc);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 795, 1948, 2033",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-331",
    "title": "tquic_stream_send_allowed Missing Underflow Check",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 838-846",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "stream_limit = stream->max_send_data - stream->send_offset;\n...\nconn_limit = mgr->max_data_remote - mgr->data_sent;",
        "if (stream->send_offset >= stream->max_send_data) { blocked; return 0; }\nstream_limit = stream->max_send_data - stream->send_offset;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 838-846",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-332",
    "title": "tquic_stream_recv_data Potential Integer Overflow in Flow Control Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1152-1158",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/stream.c:697-699"
      ],
      "snippets": [
        "if (offset + skb->len > stream->max_recv_data) {\n    ...\n}\nif (mgr->data_received + skb->len > mgr->max_data_local) {\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1152-1158",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-09. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-333",
    "title": "tquic_stream_socket_create Double-Free on fd Failure",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 596-604",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:213-231",
        "net/quic/tquic/tquic_stream.c:219-219",
        "net/quic/tquic/tquic_stream.c:224-224",
        "net/quic/tquic/tquic_stream.c:591-591"
      ],
      "snippets": [
        "fd = tquic_sock_map_fd(sock, O_CLOEXEC);\nif (fd < 0) {\n    /* Note: tquic_sock_map_fd calls sock_release on failure */\n    tquic_stream_remove_from_conn(conn, stream);\n    kfree(ss);\n    tquic_stream_free(stream);\n    return fd;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 596-604",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-334",
    "title": "h3_control_recv_frame Does Not Parse Frame Payloads",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 813-856",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "case H3_FRAME_SETTINGS:\n    pr_debug(\"h3: received SETTINGS frame\\n\");\n    /* Parse settings - implementation would extract parameters */\n    break;\ncase H3_FRAME_GOAWAY:\n    pr_debug(\"h3: received GOAWAY frame\\n\");\n    /* Parse stream ID from GOAWAY */\n    break;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 813-856",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-335",
    "title": "tquic_stream_count_by_type O(n) Scan for Critical Stream Enforcement",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 1502-1529",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 1502-1529",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: HIGH-12. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-336",
    "title": "Triplicated Varint Encode/Decode Implementations",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**Files:** - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` - `/Users/justinadams/Down",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/http3/http3_request.c",
        "net/quic/tquic/http3/http3_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-337",
    "title": "h3_parse_settings_frame u64 to Pointer Cast",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` **Lines:** In settings frame parsing",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "end = p->buf + frame_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` **Lines:** In settings frame parsing",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-338",
    "title": "h3_parser_advance Missing Bounds Check",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.h`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.h"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.h`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-339",
    "title": "WebTransport Datagram Queue Double-Checked Locking Anti-Pattern",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-340",
    "title": "Priority State No Limit on stream_count",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_priority.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_priority.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-341",
    "title": "Push Entry Count O(n) Iteration",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_conn.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_conn.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_conn.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-342",
    "title": "tquic_fc_stream_can_send Missing Overflow Check",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/flow_control.c` **Lines:** 610-612",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/flow_control.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/flow_control.c:291-292"
      ],
      "snippets": [
        "can_send = (stream->data_sent + bytes) <= stream->max_data_remote;",
        "can_send = bytes <= (stream->max_data_remote - stream->data_sent);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/flow_control.c` **Lines:** 610-612",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-343",
    "title": "tquic_fc_reserve_credit Does Not Actually Reserve",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/flow_control.c` **Lines:** 1487-1503 and 1514-1521",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/flow_control.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "int tquic_fc_reserve_credit(..., u64 bytes)\n{\n    tquic_fc_get_credit(fc, stream, &credit);\n    if (bytes > credit.effective_credit)\n        return -ENOSPC;\n    return 0;  /* \"Credit will be committed when transmission succeeds\" */\n}\n\nvoid tquic_fc_release_credit(...)\n{\n    /* This is a no-op in our"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/flow_control.c` **Lines:** 1487-1503 and 1514-1521",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-344",
    "title": "tquic_stream_write Holds mgr->lock for Entire Copy Loop",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 876-931",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 876-931",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-09. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-345",
    "title": "kmem_cache Names Not Unique Per Connection",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 118-134",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "mgr->stream_cache = kmem_cache_create(\"tquic_stream_ext\", ...);\nmgr->gap_cache = kmem_cache_create(\"tquic_stream_gap\", ...);\nmgr->chunk_cache = kmem_cache_create(\"tquic_recv_chunk\", ...);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 118-134",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-346",
    "title": "h3_stream_recv_headers Does Not Validate payload_len Against H3_MAX_FRAME_PAYLOAD_SIZE",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 532-588",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (payload_len > len)\n    return -ENOBUFS;\nret = tquic_stream_recv(h3s->base, buf, payload_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 532-588",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-347",
    "title": "tquic_stream_trigger_output Inflight Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 773-774",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "inflight = path->stats.tx_bytes - path->stats.acked_bytes;\ncan_send = (inflight < path->stats.cwnd);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 773-774",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-12. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-348",
    "title": "WebTransport Session Refcount Not Checked After Accept",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/webtransport.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-13. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-349",
    "title": "tquic_stream_memory_pressure Frees Without ext Cleanup",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1919-1960",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (stream->state == TQUIC_STREAM_CLOSED) {\n    tquic_stream_remove(mgr, stream);\n    /* ... purge buffers ... */\n    kfree(stream);  /* ext is NOT freed! */\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1919-1960",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-14. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-350",
    "title": "h3_stream_recv_data frame_hdr Buffer Partial Read",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 617-622",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_stream_recv(h3s->base, frame_hdr, sizeof(frame_hdr));\nif (ret <= 0)\n    return ret ? ret : -EAGAIN;\nhdr_len = h3_parse_frame_header(frame_hdr, ret, &frame_type, &payload_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Lines:** 617-622",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-15. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-351",
    "title": "tquic_stream_sendfile Reads Only Into First Page",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1810",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = kernel_read(file, page_address(pages[0]), chunk, offset);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1810",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: MED-16. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-352",
    "title": "H3_STREAM_TYPE_IS_GREASE Macro Acceptance Too Broad",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Line:** 1410",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:1409-1410"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Line:** 1410",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-353",
    "title": "settings seen_mask Limited to 64 Settings",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_settings.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_settings.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_settings.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-354",
    "title": "tquic_stream_alloc Uses GFP_KERNEL in Potentially Atomic Context",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 299",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 299",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-355",
    "title": "tquic_stream_release Missing Error Return",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 638-663",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:643-643"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Lines:** 638-663",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-356",
    "title": "Priority Extension Allocation Race",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 146-173",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ext = stream->ext;\nif (ext)\n    return ext;\next = kzalloc(sizeof(*ext), GFP_ATOMIC);\n...\nstream->ext = ext;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 146-173",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-357",
    "title": "tquic_sched_release Frees ext Under Lock but kfree Can Sleep",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 696-713",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/priority.c` **Lines:** 696-713",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-358",
    "title": "tquic_stream_set_priority Missing Lock Protection",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1431-1436",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/stream.c"
      ],
      "symbols": [
        "tquic_stream"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_stream_set_priority(struct tquic_stream *stream, u8 priority)\n{\n    stream->priority = priority;\n    return 0;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 1431-1436",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-359",
    "title": "h3_varint_len Defined Multiple Times as Static",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Line:** 787",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_request.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_request.c` **Line:** 787",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-08. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-360",
    "title": "tquic_stream_manager_destroy Does Not Free Extended State for All Streams",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 2038",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_conn.c",
        "net/quic/tquic/http3/qpack.h",
        "net/quic/tquic/http3/qpack_static.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/http3/qpack_encoder.c",
        "net/quic/tquic/core/priority.c",
        "net/quic/tquic/http3/http3_request.c",
        "net/quic/tquic/http3/qpack.c",
        "net/quic/tquic/http3/http3_settings.c",
        "net/quic/tquic/http3/http3_frame.h",
        "net/quic/tquic/http3/webtransport.h",
        "net/quic/tquic/tquic_stream.c",
        "net/quic/tquic/http3/qpack_decoder.c",
        "net/quic/tquic/http3/http3_module.c",
        "net/quic/tquic/http3/http3_priority.c",
        "net/quic/tquic/core/flow_control.c",
        "net/quic/tquic/http3/http3_stream.h",
        "net/quic/tquic/http3/qpack_dynamic.c",
        "net/quic/tquic/http3/http3_priority.h",
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/core/stream.c",
        "net/quic/tquic/http3/webtransport.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/stream.c` **Lines:** 2038",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_HTTP3_STREAMS_AUDIT.md. Original finding ID: LOW-09. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-361",
    "title": "Use-After-Free in Path Lookup",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "Kernel heap use-after-free leading to arbitrary code execution (privilege escalation), kernel crash (DoS).",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "sockaddr_storage",
        "tquic_path",
        "tquic_path_put",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:245-261",
        "net/tquic/tquic_input.c:2562-2562"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\nstatic struct tquic_path *tquic_find_path_by_addr(struct tquic_connection *conn,\n                                                  struct sockaddr_storage *addr)\n{\n    struct tquic_path *path;\n    struct tquic_path *found = NULL;\n\n    spin_lock_bh(&conn->paths_lock);\n    list_for_each_entry(pat",
    "fix_suggestion": "Implement reference counting on `tquic_path` objects. The lookup function should atomically increment the refcount under `paths_lock` before returning. Callers must call `tquic_path_put()` when done.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-1. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-362",
    "title": "Stale skb->len Read After ip_local_out",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "Reading freed memory. In the best case, corrupted statistics. In the worst case, the freed memory is reallocated and attacker-controlled data is read as `skb->len`, potentially corrupting `tx_bytes` (u64 stat counter).",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "ip_local_out",
        "ktime_get"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1730-1736"
      ],
      "snippets": [
        "/* Send via IP */\n    ret = ip_local_out(&init_net, NULL, skb);\n\n    /* Update path statistics */\n    if (ret >= 0) {\n        path->stats.tx_packets++;\n        path->stats.tx_bytes += skb->len;   /* <-- skb may be freed */\n        path->last_activity = ktime_get();",
        "u32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    /* Send via IP */\n    ret = ip_local_out(&init_net, NULL, skb);\n\n    /* Update path statistics */\n    if (ret >= 0) {\n        path->stats.tx_packets++;\n        path->stats.tx_bytes += skb->len;   /* <-- skb may be freed */\n        path->last_activity = ktime_get();\n```",
    "fix_suggestion": "Save `skb->len` in a local variable before calling `ip_local_out()`:\n```c\nu32 pkt_len = skb->len;\nret = ip_local_out(&init_net, NULL, skb);\nif (ret >= 0) {\n    path->stats.tx_bytes += pkt_len;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-2."
  },
  {
    "id": "F-363",
    "title": "Wrong Network Namespace in ip_local_out",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "Network namespace escape. Containers can send traffic through the host network. This violates a fundamental Linux security boundary. Firewall rules in the container's namespace are bypassed.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1730-1730",
        "net/tquic/tquic_output.c:1681-1681"
      ],
      "snippets": [
        "ret = ip_local_out(&init_net, NULL, skb);",
        "ret = ip_local_out(net, conn->sk, skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    ret = ip_local_out(&init_net, NULL, skb);\n```",
    "fix_suggestion": "Use `sock_net(conn->sk)` instead of `&init_net`. The correct network namespace was already computed at line 1681 in the `rt` lookup:\n```c\nret = ip_local_out(net, conn->sk, skb);\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-3."
  },
  {
    "id": "F-364",
    "title": "conn->sk Accessed Without Lock After Stateless Reset",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "Use-after-free on the socket structure, leading to privilege escalation or kernel crash.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_connection",
        "sock",
        "tquic_release"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:397-407"
      ],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    conn->error_code = EQUIC_NO_ERROR;\n\n    /* Read sk under lock to prevent use-after-free */\n    sk = READ_ONCE(conn->sk);\n    spin_un"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\nstatic void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;\n    conn->error_code = EQUIC_NO_ERROR;\n\n    /* Read sk under lock to prevent use-after-free */\n    sk = READ_ONCE(conn->sk);\n    sp",
    "fix_suggestion": "Hold a reference to the socket (`sock_hold(sk)`) under the lock, then call `sk_state_change`, then release the reference (`sock_put(sk)`).",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-4."
  },
  {
    "id": "F-365",
    "title": "PADDING Frame Infinite Skip Without Bound on Encrypted Payload",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "Out-of-bounds read of 1-4 bytes past the packet buffer. On a SLUB-allocated buffer, this reads from adjacent slab objects, potentially leaking sensitive data (heap information disclosure). If the packet data is in an skb's linear data area, this could read past `skb->tail`.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_rx_ctx"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:565-571",
        "net/tquic/tquic_input.c:1901-1901",
        "net/tquic/tquic_input.c:2058-2058",
        "net/tquic/tquic_input.c:1900-1900",
        "net/tquic/tquic_input.c:2528-2529"
      ],
      "snippets": [
        "static int tquic_process_padding_frame(struct tquic_rx_ctx *ctx)\n{\n    /* Just skip padding bytes */\n    while (ctx->offset < ctx->len && ctx->data[ctx->offset] == 0)\n        ctx->offset++;\n\n    return 0;\n}",
        "if (ctx.offset == prev_offset)\n    return -EPROTO;",
        "/* Packet number length from first byte */\n    pkt_num_len = (data[0] & 0x03) + 1;   /* line 2529 or 2545 */\n    ...\n    /* Decode packet number */\n    pkt_num = tquic_decode_pkt_num(data + ctx.offset, pkt_num_len, 0); /* line 2573 */\n    ctx.offset += pkt_num_len;  /* line 2574 */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\nstatic int tquic_process_padding_frame(struct tquic_rx_ctx *ctx)\n{\n    /* Just skip padding bytes */\n    while (ctx->offset < ctx->len && ctx->data[ctx->offset] == 0)\n        ctx->offset++;\n\n    return 0;\n}\n```",
    "fix_suggestion": "Add a bounds check before decoding the packet number:\n```c\nif (ctx.offset + pkt_num_len > len)\n    return -EINVAL;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-5."
  },
  {
    "id": "F-366",
    "title": "Packet Number Length Extracted Before Header Unprotection",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "Protocol confusion leading to frame processing of attacker-controlled data at wrong offsets. Combined with C-5 (no bounds check), this is a high-impact logic error.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_remove_header_protection"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:2529-2529",
        "net/tquic/tquic_input.c:2529-2529",
        "net/tquic/tquic_input.c:2545-2545",
        "net/tquic/tquic_input.c:2565-2565"
      ],
      "snippets": [
        "// Long header path (line 2529):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Short header path (line 2545):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Header protection removal (line 2565):\n    ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);",
        "ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    // Long header path (line 2529):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Short header path (line 2545):\n    pkt_num_len = (data[0] & 0x03) + 1;\n\n    // Header protection removal (line 2565):\n    ret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\n```",
    "fix_suggestion": "Move the `pkt_num_len` extraction to AFTER `tquic_remove_header_protection()`:\n```c\nret = tquic_remove_header_protection(conn, data, ctx.offset, ...);\nif (ret < 0) return ret;\npkt_num_len = (data[0] & 0x03) + 1;  // Now reads unprotected bits\nif (ctx.offset + pkt_num_len > len) return -EINVAL;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: C-6."
  },
  {
    "id": "F-367",
    "title": "GRO Coalesce Uses Hardcoded 8-byte CID Comparison",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "Out-of-bounds read (heap info leak / crash). Incorrect coalescing could mix packets from different connections, causing frame processing confusion.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:2249-2253"
      ],
      "snippets": [
        "/* For short headers, compare DCID */\n    if (!(h1[0] & TQUIC_HEADER_FORM_LONG)) {\n        /* Assume 8-byte CID for now */\n        return memcmp(h1 + 1, h2 + 1, 8) == 0;\n    }",
        "if (skb1->len < 1 + cid_len || skb2->len < 1 + cid_len)\n    return false;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    /* For short headers, compare DCID */\n    if (!(h1[0] & TQUIC_HEADER_FORM_LONG)) {\n        /* Assume 8-byte CID for now */\n        return memcmp(h1 + 1, h2 + 1, 8) == 0;\n    }\n```",
    "fix_suggestion": "The GRO coalesce function needs to know the actual CID length. Pass it via skb metadata or look it up from connection state. Also add length checks:\n```c\nif (skb1->len < 1 + cid_len || skb2->len < 1 + cid_len)\n    return false;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-1."
  },
  {
    "id": "F-368",
    "title": "tquic_process_stream_frame Allocates skb Based on Attacker-Controlled length",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "Memory exhaustion (kernel OOM) by flooding STREAM frames from multiple connections.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "alloc_skb",
        "tquic_stream_open_incoming"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:944-944",
        "net/tquic/tquic_input.c:909-909",
        "net/tquic/tquic_input.c:963-963",
        "net/tquic/tquic_input.c:944-944",
        "net/tquic/tquic_input.c:938-938"
      ],
      "snippets": [
        "if (length > 65535)\n        return -EINVAL;\n    ...\n    /* Copy data to stream receive buffer */\n    data_skb = alloc_skb(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    if (length > 65535)\n        return -EINVAL;\n    ...\n    /* Copy data to stream receive buffer */\n    data_skb = alloc_skb(length, GFP_ATOMIC);\n```",
    "fix_suggestion": "Move the `sk_rmem_alloc` check BEFORE the `alloc_skb()` call to avoid the allocation entirely when the buffer is full. Also consider a global receive buffer cap.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-2."
  },
  {
    "id": "F-369",
    "title": "ECN Counter Values Passed Directly to TQUIC_ADD_STATS Without Overflow Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "Congestion control manipulation. An attacker spoofing ACK_ECN frames can cause the sender to dramatically reduce its congestion window, effectively performing a denial of service by throttling legitimate traffic.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:702-707",
        "net/tquic/tquic_input.c:764-764",
        "net/tquic/tquic_input.c:759-763"
      ],
      "snippets": [
        "if (ecn_ect0 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT0RX, ecn_ect0);\n    if (ecn_ect1 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT1RX, ecn_ect1);\n    if (ecn_ce > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNCEMARKSRX, ecn_ce);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    if (ecn_ect0 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT0RX, ecn_ect0);\n    if (ecn_ect1 > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNECT1RX, ecn_ect1);\n    if (ecn_ce > 0)\n        TQUIC_ADD_STATS(net, TQUIC_MIB_ECNCEMARKSRX, ecn_ce);\n```",
    "fix_suggestion": "Validate that ECN counts are monotonically increasing from previous values. Store previous ECN counts per-path and only react to the *increase*, not the absolute value (as RFC 9002 Section 7.1 requires). The comment at line 759-763 acknowledges this is missing.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-3."
  },
  {
    "id": "F-370",
    "title": "Connection Close Reason Phrase Skipped Without Content Validation",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "Reading freed memory for pacing calculation. Could result in incorrect pacing timing or kernel crash if slab is reallocated.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c",
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_output_packet"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:1248-1250",
        "net/tquic/tquic_output.c:1252-1252",
        "net/tquic/tquic_output.c:1413-1418"
      ],
      "snippets": [
        "if (reason_len > ctx->len - ctx->offset)\n        return -EINVAL;\n    ctx->offset += (size_t)reason_len;",
        "skb = __skb_dequeue(&pacing->queue);\n        spin_unlock_bh(&pacing->lock);\n\n        /* Actually send the packet */\n        tquic_output_packet(NULL, pacing->path, skb);\n\n        spin_lock_bh(&pacing->lock);\n\n        /* Update next send time */\n        gap = tquic_pacing_calc_gap(pacing, skb->len); "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    if (reason_len > ctx->len - ctx->offset)\n        return -EINVAL;\n    ctx->offset += (size_t)reason_len;\n```",
    "fix_suggestion": "Save `skb->len` before calling `tquic_output_packet()`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-4."
  },
  {
    "id": "F-371",
    "title": "Multipath Frame Processing Lacks Encryption Level Validation",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "State manipulation via forged multipath frames in weakly-authenticated Initial/Handshake packets. Could cause path confusion, CID manipulation, or denial of service.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:2027-2038"
      ],
      "snippets": [
        "} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n#ifdef CONFIG_TQUIC_MULTIPATH\n        } else if (frame_type == 0x40) {\n            /* MP_NEW_CONNECTION_ID (RFC 9369) */\n            ret = tquic_process_mp_new_connection_id_frame(&ctx);\n        } else if (frame_type == 0x41) {\n            /* MP_RETIRE_CONNECTION_ID (RFC 9369) */\n            re",
    "fix_suggestion": "Add encryption level checks for all multipath frame types. They should only be accepted in 1-RTT packets (and possibly 0-RTT):\n```c\n} else if (frame_type == 0x40) {\n    if (is_initial || is_handshake) {\n        conn->error_code = EQUIC_FRAME_ENCODING;\n        return -EPROTO;\n    }\n    ret = tquic_process_mp_new_connection_id_frame(&ctx);\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-5."
  },
  {
    "id": "F-372",
    "title": "ACK Frame bytes_acked Calculation Can Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "Congestion control manipulation. The sender may suddenly increase its sending rate based on bogus ACK data, potentially contributing to network congestion or enabling amplification.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:736-738"
      ],
      "snippets": [
        "{\n        u64 bytes_acked = (first_ack_range + 1) * 1200;\n\n        /* Dispatch ACK event to congestion control */\n        tquic_cong_on_ack(ctx->path, bytes_acked, rtt_us);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    {\n        u64 bytes_acked = (first_ack_range + 1) * 1200;\n\n        /* Dispatch ACK event to congestion control */\n        tquic_cong_on_ack(ctx->path, bytes_acked, rtt_us);\n```",
    "fix_suggestion": "Cap `first_ack_range` to a reasonable value (e.g., the maximum number of packets in flight) before the multiplication. Alternatively, cap `bytes_acked` to the actual bytes in flight.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-6."
  },
  {
    "id": "F-373",
    "title": "tquic_udp_recv Processes Stateless Reset Before Authenticating Packet",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "CPU exhaustion via stateless reset token scanning on every incoming short-header packet. In a multipath scenario with many CIDs, this becomes expensive.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:2916-2932"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    /* Check for stateless reset (received from peer) */\n    if (len < TQUIC_STATELESS_RESET_MIN_LEN)\n        goto not_reset;\n\n    if (data[0] & TQUIC_HEADER_FORM_LONG)\n        goto not_reset;\n\n    /* Try to find connection for reset check */\n    if (len > 1) {\n        u8 dcid_len = min_t(size_",
    "fix_suggestion": "Only check for stateless reset AFTER regular decryption fails (RFC 9000 Section 10.3.1 recommends this order). The check should be a last resort, not a first check.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-7. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-374",
    "title": "tquic_output_packet Passes NULL conn to ip_local_out",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "Statistics and security state (key update tracking) are silently skipped for pacing-deferred packets. The namespace escape (C-3) is always triggered.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1413-1413",
        "net/tquic/tquic_output.c:1662-1663",
        "net/tquic/tquic_output.c:1730-1730",
        "net/tquic/tquic_output.c:1735-1735",
        "net/tquic/tquic_output.c:1739-1739"
      ],
      "snippets": [
        "/* Actually send the packet */\n    tquic_output_packet(NULL, pacing->path, skb);",
        "ret = ip_local_out(&init_net, NULL, skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    /* Actually send the packet */\n    tquic_output_packet(NULL, pacing->path, skb);\n```",
    "fix_suggestion": "Store a reference to `conn` in `tquic_pacing_state` and pass it through.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: H-8."
  },
  {
    "id": "F-375",
    "title": "ktime_get_ts64 Written to skb->cb May Exceed cb Size",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Logic confusion if skbs are mishandled between datagram and stream paths. Low exploitability but a correctness issue.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "for",
        "timespec64"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:1471-1471",
        "net/tquic/tquic_input.c:951-951"
      ],
      "snippets": [
        "/* Store receive timestamp in SKB cb */\n    ktime_get_ts64((struct timespec64 *)dgram_skb->cb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    /* Store receive timestamp in SKB cb */\n    ktime_get_ts64((struct timespec64 *)dgram_skb->cb);\n```",
    "fix_suggestion": "Use a typed union or dedicated struct for `skb->cb` usage, documented per frame type.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: M-1."
  },
  {
    "id": "F-376",
    "title": "tquic_recv_datagram Can Loop Forever Under Signal Pressure",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "A blocking `tquic_recv_datagram` call without SO_RCVTIMEO can be held in a tight retry loop if a racing consumer steals datagrams, consuming CPU.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:2706-2743"
      ],
      "snippets": [
        "int retries = 0;\n...\nretry:\n    if (++retries > 3) return -EAGAIN;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\nretry:\n    spin_lock_irqsave(&conn->datagram.lock, irqflags);\n    skb = skb_peek(&conn->datagram.recv_queue);\n    if (!skb) {\n        spin_unlock_irqrestore(&conn->datagram.lock, irqflags);\n        if (flags & MSG_DONTWAIT)\n            return -EAGAIN;\n        if (timeo == 0)\n            return ",
    "fix_suggestion": "Add a retry counter to prevent excessive looping:\n```c\nint retries = 0;\n...\nretry:\n    if (++retries > 3) return -EAGAIN;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: M-2."
  },
  {
    "id": "F-377",
    "title": "Version Negotiation Versions Logged Without Rate Limiting",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Log flooding (minor DoS of logging infrastructure).",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:473-477"
      ],
      "snippets": [
        "for (i = 0; i + 4 <= versions_len; i += 4) {\n        u32 version = ...;\n        tquic_dbg(\"  version 0x%08x\\n\", version);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    for (i = 0; i + 4 <= versions_len; i += 4) {\n        u32 version = ...;\n        tquic_dbg(\"  version 0x%08x\\n\", version);\n```",
    "fix_suggestion": "Either remove the per-version debug line or cap the number of logged versions.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: M-3."
  },
  {
    "id": "F-378",
    "title": "tquic_gro_flush Drops and Re-acquires Lock Per Packet",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Incorrect `held_count` could cause GRO to hold more packets than intended, or to prematurely stop holding, affecting performance but not security directly.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:2303-2310"
      ],
      "snippets": [
        "while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n        spin_unlock(&gro->lock);\n        deliver(skb);\n        flushed++;\n        spin_lock(&gro->lock);\n    }\n\n    gro->held_count = 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    while ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n        spin_unlock(&gro->lock);\n        deliver(skb);\n        flushed++;\n        spin_lock(&gro->lock);\n    }\n\n    gro->held_count = 0;\n```",
    "fix_suggestion": "After the loop, set `held_count = skb_queue_len(&gro->hold_queue)`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: M-4."
  },
  {
    "id": "F-379",
    "title": "Coalesced Packet Processing Silently Truncates on Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Could cause frame parsing errors or incomplete CRYPTO frame data being fed to the TLS state machine, potentially triggering TLS parsing bugs.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:3172-3173"
      ],
      "snippets": [
        "if (offset + pkt_len > total_len)\n            pkt_len = total_len - offset;",
        "if (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n        if (offset + pkt_len > total_len)\n            pkt_len = total_len - offset;\n```",
    "fix_suggestion": "Instead of silently truncating, reject the coalesced packet entirely when the claimed length exceeds remaining data:\n```c\nif (offset + pkt_len > total_len)\n    break;  /* Malformed coalesced packet -- stop */\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: M-5."
  },
  {
    "id": "F-380",
    "title": "tquic_encode_varint Does Not Validate val Range",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "If any code path passes a value >= 2^62, the encoded varint would decode to a different (smaller) value. This is a correctness issue that could cause protocol violations.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:164-198"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines**: 164-198",
    "fix_suggestion": "Add validation: `if (val >= (1ULL << 62)) return -EINVAL;`",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-1. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-381",
    "title": "tquic_build_short_header_internal Writes pkt_num to buf+64 Scratch Space",
    "category": "build",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Stack buffer overflow. The 4 bytes at `header[64..67]` overwrite whatever is next on the stack. Depending on stack layout, this could corrupt the return address or other local variables. However, the overwritten data is then never used (it's just scratch for determining `pkt_num_len`), so the written values don't matter as long as the stack frame can absorb 4 extra bytes.\n\nIn practice, the compiler's stack frame is likely larger than 64 bytes due to other local variables. But this is undefined b",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:818-818",
        "net/tquic/tquic_output.c:1915-1915",
        "net/tquic/tquic_output.c:961-961",
        "net/tquic/tquic_output.c:1915-1915",
        "net/tquic/tquic_output.c:1982-1982"
      ],
      "snippets": [
        "pkt_num_len = tquic_encode_pkt_num(buf + 64, pkt_num, largest_acked);",
        "u8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    pkt_num_len = tquic_encode_pkt_num(buf + 64, pkt_num, largest_acked);\n```",
    "fix_suggestion": "Allocate a separate scratch buffer or use a function-local buffer:\n```c\nu8 pn_scratch[4];\npkt_num_len = tquic_encode_pkt_num(pn_scratch, pkt_num, largest_acked);\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-2."
  },
  {
    "id": "F-382",
    "title": "tquic_gso_init Integer Overflow in Allocation Size",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Allocation of undersized buffer if overflow occurs, leading to heap buffer overflow when GSO segments are added.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1489-1489"
      ],
      "snippets": [
        "gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);",
        "size_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);\n```",
    "fix_suggestion": "Use `size_t` arithmetic with overflow checking:\n```c\nsize_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size))\n    return -EINVAL;\n```",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-3."
  },
  {
    "id": "F-383",
    "title": "tquic_process_ack_frame Does Not Validate largest_ack vs first_ack_range",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Protocol confusion in the congestion control / loss detection subsystem. An attacker could cause the CC to mark incorrect packets as acknowledged.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:601-660"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines**: 601-660",
    "fix_suggestion": "Add: `if (first_ack_range > largest_ack) return -EINVAL;`",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-4. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-384",
    "title": "tquic_process_coalesced Missing Infinite Loop Guard",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Bounded CPU consumption (at most ~214 iterations for a 1500-byte datagram).",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:3079-3182",
        "net/tquic/tquic_input.c:3169-3169"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines**: 3079-3182",
    "fix_suggestion": "Add `if (packets > 16) break;` to cap coalesced packets.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-5. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-385",
    "title": "spin_lock",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Potential deadlock if `conn->lock` is acquired from both softirq and process context on the same CPU.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:1015-1017",
        "net/tquic/tquic_input.c:251-251"
      ],
      "snippets": [
        "spin_lock(&ctx->conn->lock);\n    ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);\n    spin_unlock(&ctx->conn->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c\n    spin_lock(&ctx->conn->lock);\n    ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);\n    spin_unlock(&ctx->conn->lock);\n```",
    "fix_suggestion": "Change to `spin_lock_bh(&ctx->conn->lock)`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-6."
  },
  {
    "id": "F-386",
    "title": "tquic_output_flush Holds conn->lock While Calling GFP_ATOMIC Allocation",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Potential latency spike from holding `conn->lock` through multiple iterations of the stream loop with GFP_ATOMIC allocations.",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_encap_recv",
        "tquic_process_frames",
        "tquic_process_packet",
        "udphdr"
      ],
      "line_ranges": [
        "net/tquic/tquic_output.c:2071-2117",
        "net/tquic/tquic_output.c:2071-2071",
        "net/tquic/tquic_output.c:2117-2117",
        "net/tquic/tquic_output.c:2132-2132",
        "net/tquic/tquic_output.c:2148-2148"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Lines**: 2071-2117",
    "fix_suggestion": "Consider pre-allocating frame structures outside the lock, or batching frame preparation.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_INPUT_OUTPUT_AUDIT.md. Original finding ID: L-7. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-387",
    "title": "Complete SSRF in CONNECT-UDP -- No Address Validation",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Lines:** 500-543",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [
        "resolve_target",
        "tquic_connect_udp_tunnel",
        "sockaddr_in6",
        "ipv4_is_loopback",
        "ipv4_is_private_192",
        "ipv4_is_zeronet",
        "ipv4_is_lbcast",
        "ipv4_is_multicast",
        "ipv4_is_private_172",
        "tquic_connect_udp_target"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Lines:** 500-543",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: CRITICAL-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-388",
    "title": "Hardcoded init_net Namespace Bypass in Socket Creation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Line:** 459",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c",
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "ret = sock_create_kern(&init_net, family, SOCK_DGRAM, IPPROTO_UDP, &sock);",
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP, &sock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Line:** 459",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: CRITICAL-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-389",
    "title": "Unbounded Memory Allocation from Attacker-Controlled Capsule Length",
    "category": "perf",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/capsule.c` **Lines:** 241-257 (capsule_alloc) and 427-430 (parser feed)",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/capsule.c"
      ],
      "symbols": [
        "capsule_alloc",
        "capsule"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Header complete, allocate capsule */\nparser->cur_capsule = capsule_alloc(\n    parser->header.type,\n    parser->header.length,  /* <-- attacker-controlled u64 */\n    GFP_ATOMIC);",
        "struct capsule *capsule_alloc(u64 type, size_t payload_len, gfp_t gfp)\n{\n    struct capsule *cap;\n    /* ... allocate cap ... */\n    cap->type = type;\n    cap->length = payload_len;\n\n    if (payload_len > 0) {\n        cap->value = kmalloc(payload_len, gfp);  /* <-- NO UPPER BOUND CHECK */\n        if"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/capsule.c` **Lines:** 241-257 (capsule_alloc) and 427-430 (parser feed)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: CRITICAL-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-390",
    "title": "No Address Validation in CONNECT-IP Packet Injection",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Lines:** 1029-1071 (connect_ip_validate_ip_header) and 2047-2084 (tquic_connect_ip_inject_packet)",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "netif_rx",
        "tquic_connect_ip_inject_packet",
        "connect_ip_validate_ip_header",
        "sk_buff",
        "tquic_connect_ip_tunnel"
      ],
      "line_ranges": [],
      "snippets": [
        "static int connect_ip_validate_ip_header(struct sk_buff *skb, u8 *version)\n{\n    /* Only checks: version, IHL >= 5, length consistency */\n    /* NO check on source address, destination address */\n    /* NO check on protocol field */\n    /* NO check for RFC1918, loopback, multicast, link-local */\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Lines:** 1029-1071 (connect_ip_validate_ip_header) and 2047-2084 (tquic_connect_ip_inject_packet)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: CRITICAL-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-391",
    "title": "Authentication Bypass in QUIC-Aware Proxy",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Line:** 524",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [
        "tquic_quic_proxy_register_conn"
      ],
      "line_ranges": [],
      "snippets": [
        "proxy->config.require_auth = false;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Line:** 524",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: CRITICAL-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-392",
    "title": "Function Pointer Stored in skb->cb Without Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 71-75 (read), 271 (write), 1090-1094 (read), 1310 (write)",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "__is_kernel_text",
        "sk_buff"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Store send function in skb->cb */\n*(unsigned long *)skb->cb = (unsigned long)send_fn;",
        "if (skb->cb[0]) {\n    void (*send_fn)(struct sk_buff *) =\n        (void (*)(struct sk_buff *))\n        (*(unsigned long *)skb->cb);\n    send_fn(skb);  /* <-- calling unvalidated function pointer */\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 71-75 (read), 271 (write), 1090-1094 (read), 1310 (write)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-393",
    "title": "Integer Overflow in iovec Total Length Calculation",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Lines:** 1029-1030",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [
        "check_add_overflow",
        "tquic_connect_udp_sendv"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Calculate total length */\nfor (i = 0; i < iovcnt; i++)\n    total_len += iov[i].iov_len;  /* <-- can overflow on 32-bit */\n\nif (total_len > TQUIC_CONNECT_UDP_MAX_PAYLOAD)\n    return -EMSGSIZE;\n\n/* Allocate and copy to contiguous buffer */\nbuf = kmalloc(total_len, GFP_KERNEL);  /* small due to over"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Lines:** 1029-1030",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-394",
    "title": "Incomplete SSRF Protection in TCP-over-QUIC Tunnel",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 164-169 (IPv4), 202-206 (IPv6)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "ipv6_addr_v4mapped",
        "ipv4_is_private_192",
        "ipv4_is_private_172",
        "ipv4_is_private",
        "ipv4_is_private_10"
      ],
      "line_ranges": [],
      "snippets": [
        "if (ipv4_is_loopback(addr4) ||\n    ipv4_is_multicast(addr4) ||\n    ipv4_is_lbcast(addr4) ||\n    ipv4_is_zeronet(addr4)) {\n    return -EACCES;\n}\n/* MISSING: ipv4_is_private_10, ipv4_is_private_172, ipv4_is_private_192 */\n/* MISSING: link-local (169.254.0.0/16) including cloud metadata */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 164-169 (IPv4), 202-206 (IPv6)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-395",
    "title": "Weak CID Hash Function Enables Hash Flooding",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Lines:** 145-154",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static inline u32 cid_hash_key(const u8 *cid, u8 len)\n{\n    u32 hash = 0;\n    int i;\n\n    for (i = 0; i < len; i++)\n        hash = (hash * 31) + cid[i];\n\n    return hash;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Lines:** 145-154",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-396",
    "title": "Race Condition in Idle Timer Connection Processing",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Lines:** 419-424",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy.c"
      ],
      "symbols": [
        "proxied_conn_put"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_unlock_bh(&proxy->lock);\n\n/* Process removals outside lock */\nlist_for_each_entry_safe(pconn, tmp, &to_remove, list) {\n    list_del(&pconn->list);\n    tquic_quic_proxy_deregister_conn(pconn, QUIC_PROXY_DEREG_TIMEOUT, 0);\n    proxied_conn_put(pconn);  /* <-- pconn may already be freed by concurr"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy.c` **Lines:** 419-424",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-397",
    "title": "const-Correctness Violation in Proxy Packet Decode",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy_capsules.c` **Line:** 686",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/quic_proxy_capsules.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "capsule->packet = (u8 *)(buf + offset);  /* discards const from buf */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/quic_proxy_capsules.c` **Line:** 686",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-398",
    "title": "TPROXY Capability Check Logic Inversion",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 363-383",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 363-383",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: HIGH-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-399",
    "title": "Request ID Truncation from u64 to int",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Line:** 931",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "tquic_connect_ip_request_address"
      ],
      "line_ranges": [],
      "snippets": [
        "return (int)request_id;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Line:** 931",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-400",
    "title": "Constant-Time CID Validation Leaks Length via Branch",
    "category": "build",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 379-405",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_ct_validate_cid"
      ],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:394-394"
      ],
      "snippets": [
        "/* Use the larger length to ensure constant-time */\nmax_len = cid_len > expected_len ? cid_len : expected_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 379-405",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-401",
    "title": "No Flow Count Limit in HTTP Datagram Manager",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/http_datagram.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/http_datagram.c"
      ],
      "symbols": [
        "http_datagram_flow"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/http_datagram.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-402",
    "title": "Decoy Traffic Uses Easily Fingerprinted All-Zero Padding",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-403",
    "title": "Missing skb->dev Assignment in Packet Injection",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Line:** 2064",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_ip.c"
      ],
      "symbols": [
        "tquic_connect_ip_inject_packet",
        "netif_rx"
      ],
      "line_ranges": [],
      "snippets": [
        "skb->dev = NULL;  /* Would be set to virtual interface */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_ip.c` **Line:** 2064",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-404",
    "title": "Gaussian Random Approximation Produces Biased Distribution",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1058-1074",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "gaussian_random",
        "timing"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1058-1074",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: MEDIUM-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-405",
    "title": "Missing Error Check for init_net Reference",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**Files:** Multiple (connect_udp.c, tquic_tunnel.c)",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** Multiple (connect_udp.c, tquic_tunnel.c)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: LOW-01. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-406",
    "title": "Duplicate MODULE_DESCRIPTION in quic_exfil.c",
    "category": "build",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1684 and 1763",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/security/quic_exfil.c:1684-1686"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1684 and 1763",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-407",
    "title": "Context Set Level Does Not Check init Return Values",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1457-1464",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_exfil_ctx_set_level"
      ],
      "line_ranges": [],
      "snippets": [
        "tquic_traffic_shaper_destroy(&ctx->shaper);\ntquic_traffic_shaper_init(&ctx->shaper, level);  /* return value ignored */\n\ntquic_spin_randomizer_destroy(&ctx->spin_rand);\ntquic_spin_randomizer_init(&ctx->spin_rand, level);  /* return value ignored */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 1457-1464",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: LOW-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-408",
    "title": "Workqueue Not Validated Before Use",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 279-281",
    "evidence": {
      "file_paths": [
        "net/tquic/security/quic_exfil.c"
      ],
      "symbols": [
        "tquic_validate_target_address",
        "tquic_timing_normalize_send",
        "net"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security/quic_exfil.c` **Lines:** 279-281",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_MASQUE_TUNNEL_AUDIT.md. Original finding ID: LOW-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-409",
    "title": "ECF Scheduler Declares Lock But Never Uses It",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_ecf.c` - **Lines:** 75 (lock declaration), 212-294 (ecf_get_path), 334-352 (ecf_path_added), 361-379 (ecf_path_removed)",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_ecf.c"
      ],
      "symbols": [
        "spin_lock_irqsave"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_ecf.c` - **Lines:** 75 (lock declaration), 212-294 (ecf_get_path), 334-352 (ecf_path_added), 361-379 (ecf_path_removed), 390-409 (ecf_packet_sent), 419-441 (ecf_ack_received), 451-473 (ecf_loss_detected) - **Description",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: CRIT-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-410",
    "title": "BLEST Inconsistent Locking -- 3 of 6 Callbacks Lack Lock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_blest.c` - **Lines:** 445-463 (blest_path_removed), 515-549 (blest_ack_received), 559-581 (blest_loss_detected) - **Des",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_blest.c"
      ],
      "symbols": [
        "blest_get_path",
        "blest_path_removed",
        "blest_ack_received",
        "blest_loss_detected",
        "blest_packet_sent"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_blest.c` - **Lines:** 445-463 (blest_path_removed), 515-549 (blest_ack_received), 559-581 (blest_loss_detected) - **Description:** BLEST's `blest_get_path()` and `blest_packet_sent()` correctly acquire `sd->lock`. Howev",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: CRIT-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-411",
    "title": "Redundant Scheduler Dedup Uses Only 8 Bits of Sequence Number",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1308-1332 (tquic_redundant_is_duplicate) - **Description:** The deduplication window truncate",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "seq_byte = (u8)(seq & 0xFF);\n\nfor (i = 0; i < 256; i++) {\n    if (rd->dedup_window[i] == seq_byte)\n        return true;  /* False positive: seq 0 and seq 256 both map to 0 */\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1308-1332 (tquic_redundant_is_duplicate) - **Description:** The deduplication window truncates the 64-bit QUIC sequence number to 8 bits: `seq_byte = (u8)(seq & 0xFF)`. It then searches a 256-b",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: CRIT-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-412",
    "title": "Adaptive Scheduler cwnd_avail Underflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1475-1478 (tquic_adaptive_calc_score) - **Description:** The CWND availability score is compu",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (path->cc.cwnd == 0)\n    cwnd_score = 0;\nelse {\n    cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight;  // u32 underflow!\n    cwnd_score = (cwnd_avail * 1000) / path->cc.cwnd;        // garbage\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1475-1478 (tquic_adaptive_calc_score) - **Description:** The CWND availability score is computed as `cwnd_avail = path->cc.cwnd - path->cc.bytes_in_flight`. Both are `u32` fields. If `bytes_in_",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: CRIT-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-413",
    "title": "Adaptive Feedback Uses Path After list_for_each_entry Exit",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1625-1634 (tquic_adaptive_feedback) - **Description:** After `list_for_each_entry_rcu()` exit",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_int_connection",
        "list_for_each_entry_rcu",
        "rcu_read_unlock",
        "tquic_update_rtt"
      ],
      "line_ranges": [],
      "snippets": [
        "list_for_each_entry_rcu(path, &conn->paths, list) {\n    if (path->path_id == fb->path_id)\n        break;\n    path_idx++;\n}\n\nif (path->path_id != fb->path_id) {  // path may be &conn->paths (list head)!\n    rcu_read_unlock();\n    return;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1625-1634 (tquic_adaptive_feedback) - **Description:** After `list_for_each_entry_rcu()` exits (either by finding the path or exhausting the list), the code checks `if (path->path_id != fb->pat",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: CRIT-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-414",
    "title": "Weighted Scheduler Has No Lock Protection",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 51-54, 65-157 - **Description:** `weighted_sched_data` has no spinlock. `weighted_get_path()` ",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [
        "weighted_get_path"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 51-54, 65-157 - **Description:** `weighted_sched_data` has no spinlock. `weighted_get_path()` reads and modifies `paths[].weight`, `paths[].deficit`, and `current_path_idx` without synchronizati",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-415",
    "title": "TOCTOU in Round-Robin Path Count vs Selection",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_minrtt.c` - **Lines:** 427-461 (rr_get_path) - **Description:** The RR scheduler traverses the path list twice: once to",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_minrtt.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_minrtt.c` - **Lines:** 427-461 (rr_get_path) - **Description:** The RR scheduler traverses the path list twice: once to count active paths, once to select one. A path removal between traversals makes the count stale, ca",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-416",
    "title": "TQUIC_MAX_PATHS Mismatch",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_sched.h` line 40 vs `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` line 46 - **Descr",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c",
        "net/tquic/multipath/tquic_sched.h"
      ],
      "symbols": [
        "at"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:40-40",
        "net/tquic/multipath/tquic_scheduler.c:46-46",
        "net/tquic/multipath/tquic_scheduler.c:222-222",
        "net/tquic/multipath/tquic_scheduler.c:1243-1243"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_sched.h` line 40 vs `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` line 46 - **Description:** External schedulers allocate 16-element arrays; internal schedulers use 8-element arrays. ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-417",
    "title": "Type Shadowing Creates Memory Corruption Risk",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 191-199, 2158-2164 - **Description:** `#define tquic_path tquic_int_path` causes all code in ",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_mp_sched_notify_sent",
        "fields"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:2158-2164"
      ],
      "snippets": [
        "{\n    void *c = conn;   // tquic_int_connection *, not tquic_connection *\n    void *p = path;   // tquic_int_path *, not tquic_path *\n    tquic_mp_sched_notify_sent(c, p, bytes);  // ABI mismatch!\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 191-199, 2158-2164 - **Description:** `#define tquic_path tquic_int_path` causes all code in this file to use internal types. At line 2158-2164, the code explicitly casts through `void *` to ca",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-418",
    "title": "Stale Path Pointer Returned After rcu_read_unlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **Files:** All scheduler `get_path`/`select_path` functions - **Description:** Every scheduler stores a path pointer in `result->primary` or `result->backup` while holding `rcu_read_lock()`, then re",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_path_remove",
        "rcu_read_lock",
        "synchronize_rcu"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **Files:** All scheduler `get_path`/`select_path` functions - **Description:** Every scheduler stores a path pointer in `result->primary` or `result->backup` while holding `rcu_read_lock()`, then releases the lock before returning. The path could be freed by `synchronize_rcu()` in `tquic_path_remo",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-05. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-419",
    "title": "Aggregate Scheduler Unfair Minimum Weight Floor",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_aggregate.c` - **Lines:** 128-146 (update_capacities_locked, second pass) - **Description:** The 5% minimum weight floo",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_aggregate.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_aggregate.c` - **Lines:** 128-146 (update_capacities_locked, second pass) - **Description:** The 5% minimum weight floor is computed as `(total * 50) / 1000`. As paths get boosted, `total` increases, making subsequent m",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-420",
    "title": "Internal Round-Robin Scheduler Missing Bounds Check",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 822, 838 - **Description:** `tquic_weighted_select_path()` computes `start_idx = wd->current_",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [
        "tquic_weighted_select_path"
      ],
      "line_ranges": [
        "net/tquic/multipath/tquic_scheduler.c:817-817"
      ],
      "snippets": [
        "if (!wd || conn->num_paths == 0)\n    return -ENOENT;\n// ... conn->num_paths could become 0 here via concurrent path_remove ...\nstart_idx = wd->current_path_idx % conn->num_paths;  // div by zero"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 822, 838 - **Description:** `tquic_weighted_select_path()` computes `start_idx = wd->current_path_idx % conn->num_paths`. If `conn->num_paths` is 0, this is a division by zero. The check on lin",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-421",
    "title": "sched/scheduler.c rr_select TOCTOU on num_paths",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 277-285 (rr_select) - **Description:** `target = atomic_inc_return(&data->counter) % conn->num_paths`. ",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "target = atomic_inc_return(&data->counter) % conn->num_paths;\n// num_paths could be 0 -> div by zero"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 277-285 (rr_select) - **Description:** `target = atomic_inc_return(&data->counter) % conn->num_paths`. If `conn->num_paths` is 0 or changes between reads, this produces a division-by-zero or out-of-range",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-422",
    "title": "sched/scheduler.c wrr_select Stale total_weight",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 357-378 (wrr_select) - **Description:** `total_weight` is computed once at init time and never updated.",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 357-378 (wrr_select) - **Description:** `total_weight` is computed once at init time and never updated. When paths are added or removed, `total_weight` becomes stale. The modulo `target = counter % data-",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: HIGH-09. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-423",
    "title": "All MP Scheduler init() Functions Silently Fail on OOM",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **Files:** All `sched_*.c` init functions - **Description:** `minrtt_init()`, `aggregate_init()`, `blest_init()`, `ecf_init()`, `weighted_init()`, `rr_init()` all have void return type. If `kzalloc(",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "aggregate_init",
        "ecf_init",
        "get_path",
        "weighted_init",
        "blest_init",
        "minrtt_init"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **Files:** All `sched_*.c` init functions - **Description:** `minrtt_init()`, `aggregate_init()`, `blest_init()`, `ecf_init()`, `weighted_init()`, `rr_init()` all have void return type. If `kzalloc()` fails, `conn->sched_priv` remains NULL. `get_path()` returns -EINVAL but no error is logged. - **",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-01. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-424",
    "title": "Weighted Scheduler Weight Not Validated",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 88-89, 121 - **Description:** `path->weight` from netlink is used directly. No upper bound. `T",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 88-89, 121 - **Description:** `path->weight` from netlink is used directly. No upper bound. `TQUIC_DRR_QUANTUM * ps->weight` (1500 * huge_weight) overflows u32. - **Severity:** MEDIUM",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-425",
    "title": "Duplicate ECF Path State Allocation Race",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_ecf.c` - **Lines:** 241-246 - **Description:** Without lock, two threads can allocate duplicate path states for the sam",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_ecf.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_ecf.c` - **Lines:** 241-246 - **Description:** Without lock, two threads can allocate duplicate path states for the same path_id. - **Severity:** MEDIUM",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-426",
    "title": "Adaptive Scheduler Score Manipulation via Crafted Loss",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1677-1686 - **Description:** A remote peer can selectively drop packets to trigger `recent_lo",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1677-1686 - **Description:** A remote peer can selectively drop packets to trigger `recent_loss_count >= 3`, activating the penalty mechanism (`in_penalty = true, score / 4`) for a specific pat",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-427",
    "title": "LIA Alpha Calculation Precision Loss",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1530-1554 (tquic_adaptive_update_alpha) - **Description:** `sum_rtt_cwnd += path->cc.cwnd / r",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/tquic_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/tquic_scheduler.c` - **Lines:** 1530-1554 (tquic_adaptive_update_alpha) - **Description:** `sum_rtt_cwnd += path->cc.cwnd / rtt` -- integer division truncates when cwnd < rtt. For a path with cwnd=1200 and rtt=100000, `1200/1",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-428",
    "title": "Deadline Scheduler in_flight Underflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_aware.c` - **Lines:** 297-298 (deadline_estimate_delivery_time) - **Description:** `in_flight = path->stats.tx_bytes - p",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_aware.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/sched/deadline_aware.c:299-299"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_aware.c` - **Lines:** 297-298 (deadline_estimate_delivery_time) - **Description:** `in_flight = path->stats.tx_bytes - path->stats.acked_bytes` can underflow if ACK processing updates `acked_bytes` ahead of the tx accoun",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-429",
    "title": "sched/scheduler.c ECF Loss Rate Division by Zero",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 604-610 - **Description:** `loss_rate_pct = (path->stats.lost_packets * 100) / path->stats.tx_packets`.",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 604-610 - **Description:** `loss_rate_pct = (path->stats.lost_packets * 100) / path->stats.tx_packets`. If `lost_packets * 100` overflows u64, the division produces wrong results. More importantly, `comp",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-430",
    "title": "sched/scheduler.c Debug Logging Leaks Kernel Pointers",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 152-155, 198-220 - **Description:** `tquic_sched_default()` and `tquic_sched_init_conn()` use `pr_warn(",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/scheduler.c"
      ],
      "symbols": [
        "tquic_sched_default",
        "tquic_sched_init_conn"
      ],
      "line_ranges": [],
      "snippets": [
        "pr_warn(\"tquic_sched: default_scheduler='%s' owner=%px\\n\",\n        ops->name, ops->owner);\npr_warn(\"tquic_sched: init_conn called, ops=%px conn=%px\\n\", ops, conn);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/scheduler.c` - **Lines:** 152-155, 198-220 - **Description:** `tquic_sched_default()` and `tquic_sched_init_conn()` use `pr_warn()` to print raw kernel pointers (`%px` format): `pr_warn(\"tquic_sched: default_scheduler='%s' owner=",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-431",
    "title": "EDF Scheduler edf_select_path Called Without Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_scheduler.c` - **Lines:** 590-591 (in tquic_edf_enqueue) - **Description:** `edf_select_path()` is called at line 591 be",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_scheduler.c"
      ],
      "symbols": [
        "edf_select_path"
      ],
      "line_ranges": [
        "net/tquic/sched/deadline_scheduler.c:591-591",
        "net/tquic/sched/deadline_scheduler.c:594-594",
        "net/tquic/sched/deadline_scheduler.c:595-595"
      ],
      "snippets": [
        "entry->selected_path = edf_select_path(sched, entry);  // NO LOCK\nspin_lock_bh(&sched->lock);\nedf_tree_insert(&sched->edf_tree, entry);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_scheduler.c` - **Lines:** 590-591 (in tquic_edf_enqueue) - **Description:** `edf_select_path()` is called at line 591 before the lock is acquired at line 594. The path selection reads `sched->conn->paths` without RCU or ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: MED-09. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-432",
    "title": "Diagnostic Counter Wraps",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **Files:** `sched_minrtt.c:225`, `sched_ecf.c:286` - **Description:** `switch_count` and `path_switches` are u32 diagnostics that wrap. - **Severity:** LOW",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **Files:** `sched_minrtt.c:225`, `sched_ecf.c:286` - **Description:** `switch_count` and `path_switches` are u32 diagnostics that wrap. - **Severity:** LOW",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: LOW-01. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-433",
    "title": "Aggregate Scheduler Long Spinlock Hold",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_aggregate.c` - **Lines:** 172-230 - **Description:** Spinlock held across entire capacity recalculation including `ktim",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_aggregate.c"
      ],
      "symbols": [
        "ktime_get"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_aggregate.c` - **Lines:** 172-230 - **Description:** Spinlock held across entire capacity recalculation including `ktime_get()`. - **Severity:** LOW",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-434",
    "title": "Weighted DRR Iterates Over Empty Slots",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 101-138 - **Description:** The DRR loop iterates over all 16 `TQUIC_MAX_PATHS` slots even if o",
    "evidence": {
      "file_paths": [
        "net/tquic/multipath/sched_weighted.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/multipath/sched_weighted.c` - **Lines:** 101-138 - **Description:** The DRR loop iterates over all 16 `TQUIC_MAX_PATHS` slots even if only 2 paths exist. For each slot, it traverses the full path list to find the path at that index. Th",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: LOW-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-435",
    "title": "Multiple Scheduler Registration Systems Coexist",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **Files:** `tquic_scheduler.c` (3 separate list/lock pairs), `sched/scheduler.c` (1 more) - **Description:** There are at least 4 independent scheduler registration systems: (1) `tquic_sched_list` +",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **Files:** `tquic_scheduler.c` (3 separate list/lock pairs), `sched/scheduler.c` (1 more) - **Description:** There are at least 4 independent scheduler registration systems: (1) `tquic_sched_list` + `tquic_sched_list_lock` for internal schedulers, (2) `tquic_new_sched_list` + `tquic_new_sched_list",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: LOW-04. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-436",
    "title": "timer_setup with NULL Callback",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_aware.c` - **Line:** 475 - **Description:** `timer_setup(&state->scheduler_timer, NULL, 0)` sets up a timer with a NULL ",
    "evidence": {
      "file_paths": [
        "net/tquic/sched/deadline_aware.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/sched/deadline_aware.c:102-117"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/sched/deadline_aware.c` - **Line:** 475 - **Description:** `timer_setup(&state->scheduler_timer, NULL, 0)` sets up a timer with a NULL callback. If this timer ever fires, it will call through a NULL function pointer, causing a kernel p",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SCHEDULERS_AUDIT.md. Original finding ID: LOW-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-437",
    "title": "Use-After-Free in `tquic_migrate_auto()` -- RCU-Protected Path Used After RCU Unlock",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 830-898",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migrate_auto",
        "rcu_read_lock",
        "rcu_read_unlock",
        "tquic_path_free",
        "synchronize_rcu"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 830-898",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-01. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-438",
    "title": "Use-After-Free in `tquic_migrate_explicit()` -- Path Used Without Reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 968-983",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_find_by_addr",
        "rcu_read_unlock",
        "tquic_migrate_explicit",
        "rcu_read_lock"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Check if we already have a path with this local address */\n    rcu_read_lock();\n    new_path = tquic_path_find_by_addr(conn, new_local);\n    rcu_read_unlock();             // <--- RCU unlocked\n\n    if (!new_path) {\n        /* Create new path ... */\n    }\n    /* ... continues to use new_path witho"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 968-983",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-439",
    "title": "State Machine Type Confusion via `conn->state_machine` Void Pointer",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 858-863, 986-993, 1425-1444",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "could",
        "tquic_conn_get_migration_state",
        "tquic_migrate_auto",
        "tquic_server_start_session_ttl",
        "tquic_conn_get_session_state"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 858-863, 986-993, 1425-1444",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-440",
    "title": "Race Condition Between `tquic_destroy_sock()` and Poll/Sendmsg/Recvmsg",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 155-176 (destroy), 551-602 (poll), 1904-1997 (sendmsg), 2131-2185 (recvmsg)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "READ_ONCE",
        "tquic_sock",
        "sock",
        "WRITE_ONCE",
        "tquic_destroy_sock",
        "tquic_poll"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:568-568"
      ],
      "snippets": [
        "void tquic_destroy_sock(struct sock *sk)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    /* ... */\n    if (tsk->conn) {\n        /* ... */\n        tquic_conn_destroy(tsk->conn);\n        tsk->conn = NULL;\n    }\n}",
        "conn = READ_ONCE(tsk->conn);\n    stream = READ_ONCE(tsk->default_stream);\n    if (conn && stream) {\n        if (!skb_queue_empty(&stream->recv_buf))  // <--- stream may be freed"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 155-176 (destroy), 551-602 (poll), 1904-1997 (sendmsg), 2131-2185 (recvmsg)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-441",
    "title": "Missing Lock in `tquic_sock_bind()` -- Race with `tquic_connect()`",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 182-197",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "copies",
        "tquic_sock_bind",
        "tquic_sock",
        "sockaddr_storage",
        "socket",
        "tquic_connect",
        "lock_sock",
        "sock",
        "sockaddr",
        "sockaddr_in"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:246-246"
      ],
      "snippets": [
        "int tquic_sock_bind(struct socket *sock, TQUIC_SOCKADDR *uaddr, int addr_len)\n{\n    struct sockaddr *addr = (struct sockaddr *)uaddr;\n    struct sock *sk = sock->sk;\n    struct tquic_sock *tsk = tquic_sk(sk);\n\n    if (addr_len < sizeof(struct sockaddr_in))\n        return -EINVAL;\n\n    memcpy(&tsk->b"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 182-197",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-442",
    "title": "Anti-Amplification Bypass via Atomic Counter Race",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 85-105",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_anti_amplification_sent"
      ],
      "line_ranges": [],
      "snippets": [
        "bool tquic_path_anti_amplification_check(struct tquic_path *path, u64 bytes)\n{\n    u64 limit;\n    u64 sent, received;\n\n    if (!path->anti_amplification.active)\n        return true;\n\n    received = atomic64_read(&path->anti_amplification.bytes_received);\n    sent = atomic64_read(&path->anti_amplific"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 85-105",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-443",
    "title": "`tquic_shutdown()` Missing `lock_sock()` -- Race on Connection State",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 608-623",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_shutdown",
        "tquic_sock",
        "socket",
        "tquic_sock_shutdown",
        "lock_sock",
        "sock"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_sock_shutdown(struct socket *sock, int how)\n{\n    struct sock *sk = sock->sk;\n    struct tquic_sock *tsk = tquic_sk(sk);\n    int ret = 0;\n\n    if (tsk->conn && tsk->conn->state == TQUIC_CONN_CONNECTED) {\n        ret = tquic_conn_shutdown(tsk->conn);\n    }\n    // NO lock_sock() -- concurren"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 608-623",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-444",
    "title": "`tquic_close()` Does Not Hold `lock_sock()` During Connection Teardown",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 628-648",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sock",
        "tquic_conn_close_with_error",
        "tquic_pm_conn_release",
        "lock_sock",
        "sock",
        "tquic_close"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_close(struct sock *sk, long timeout)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n\n    if (tsk->conn) {\n        tquic_pm_conn_release(tsk->conn);\n        if (tsk->conn->state == TQUIC_CONN_CONNECTED ||\n            tsk->conn->state == TQUIC_CONN_CONNECTING) {\n            tquic_conn_close_w"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 628-648",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: CRITICAL-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-445",
    "title": "Missing Address Family Validation in `tquic_path_create()`",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 413-419",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "sockaddr_in6",
        "tquic_path_create",
        "sockaddr_in"
      ],
      "line_ranges": [],
      "snippets": [
        "memcpy(&path->local_addr, local,\n           local->ss_family == AF_INET ?\n           sizeof(struct sockaddr_in) : sizeof(struct sockaddr_in6));\n    memcpy(&path->remote_addr, remote,\n           remote->ss_family == AF_INET ?\n           sizeof(struct sockaddr_in) : sizeof(struct sockaddr_in6));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 413-419",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-446",
    "title": "`tquic_connect()` Stores Error in `sk->sk_err` as Positive Value Wrongly",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 329",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_connect"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:260-274"
      ],
      "snippets": [
        "out_close:\n    inet_sk_set_state(sk, TCP_CLOSE);\n    sk->sk_err = -ret;  /* Store error for getsockopt */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 329",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-447",
    "title": "Double `tquic_nl_path_put()` in `tquic_path_remove_and_free()` Assumes refcnt==2",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 631-642",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_path_remove_and_free",
        "tquic_nl_cmd_path_add",
        "tquic_nl_path_put",
        "tquic_nl_path_info",
        "tquic_nl_conn_info",
        "refcount_inc_not_zero",
        "tquic_nl_path_lookup"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_path_remove_and_free(struct tquic_nl_conn_info *conn,\n                                       struct tquic_nl_path_info *path)\n{\n    spin_lock_bh(&conn->lock);\n    list_del_rcu(&path->list);\n    conn->path_count--;\n    spin_unlock_bh(&conn->lock);\n\n    /* Drop the caller's reference"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 631-642",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-448",
    "title": "`tquic_nl_cmd_path_remove()` Double Put on Path",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 789-798",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "kfree_rcu",
        "tquic_nl_cmd_path_dump",
        "list_del_rcu",
        "tquic_nl_path_put",
        "tquic_nl_cmd_path_remove",
        "refcount_inc_not_zero",
        "tquic_nl_path_lookup"
      ],
      "line_ranges": [],
      "snippets": [
        "/* Remove path from connection */\n    spin_lock_bh(&conn->lock);\n    list_del_rcu(&path->list);\n    conn->path_count--;\n    spin_unlock_bh(&conn->lock);\n\n    /* Drop the lookup reference and the list reference */\n    tquic_nl_path_put(path);\n    tquic_nl_path_put(path);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 789-798",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-449",
    "title": "Session TTL Timer Fires on Freed Connection",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 1383-1406",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_conn_get_migration_state",
        "timer_list",
        "tquic_migration_cleanup",
        "tquic_pref_addr_client_cleanup",
        "tquic_connection",
        "tquic_session_state"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1098-1098"
      ],
      "snippets": [
        "static void tquic_session_ttl_expired(struct timer_list *t)\n{\n    struct tquic_session_state *state;\n    struct tquic_connection *conn;\n\n    state = from_timer(state, t, timer);\n    conn = state->conn;\n\n    /* Close connection - all paths failed and TTL expired */\n    tquic_conn_close_with_error(con"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 1383-1406",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-450",
    "title": "Unvalidated `addr_len` Passed to `memcpy` in `tquic_connect()`",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 236-243",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_connect",
        "sockaddr_in",
        "sockaddr_storage"
      ],
      "line_ranges": [],
      "snippets": [
        "if (addr_len < sizeof(struct sockaddr_in))\n        return -EINVAL;\n\n    lock_sock(sk);\n    memcpy(&tsk->connect_addr, addr,\n           min_t(size_t, addr_len, sizeof(struct sockaddr_storage)));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 236-243",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-451",
    "title": "`tquic_sendmsg()` Accesses `tsk->conn` Without Lock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 1904-1997",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sock",
        "tquic_stream",
        "lock_sock",
        "tquic_sendmsg",
        "sock",
        "tquic_connection",
        "msghdr"
      ],
      "line_ranges": [],
      "snippets": [
        "int tquic_sendmsg(struct sock *sk, struct msghdr *msg, size_t len)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    struct tquic_connection *conn = tsk->conn;  // no lock\n    struct tquic_stream *stream;\n    /* ... */\n    if (!conn || conn->state != TQUIC_CONN_CONNECTED)\n        return -ENOTCONN;\n\n "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 1904-1997",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-452",
    "title": "`tquic_recvmsg()` Same Issue as HIGH-07",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 2131-2185",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_recvmsg"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 2131-2185",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-08. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-453",
    "title": "`tquic_poll()` Can Report Stale State After Close",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 561-602",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "READ_ONCE",
        "skb_queue_empty",
        "tquic_poll"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 561-602",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-09. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-454",
    "title": "Missing Validation of `TQUIC_MIGRATE` sockopt Address",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 803-821",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_path_find_by_addr",
        "tquic_migrate_args",
        "tquic_migrate_explicit",
        "tquic_path_create"
      ],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_MIGRATE: {\n        struct tquic_migrate_args args;\n\n        if (optlen < sizeof(args))\n            return -EINVAL;\n\n        if (copy_from_sockptr(&args, optval, sizeof(args)))\n            return -EFAULT;\n\n        if (args.reserved != 0)\n            return -EINVAL;\n\n        if (tsk->conn)\n"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 803-821",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-455",
    "title": "`tquic_cid_pool_destroy()` Removes from rhashtable Under BH spinlock",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 355-374",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "kfree_rcu",
        "rhashtable_lookup_fast",
        "tquic_cid_pool_destroy",
        "rhashtable_remove_fast",
        "synchronize_rcu"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&pool->lock);\n    list_for_each_entry_safe(entry, tmp, &pool->local_cids, list) {\n        if (cid_table_initialized && entry->state == CID_STATE_ACTIVE)\n            rhashtable_remove_fast(&tquic_cid_table, &entry->node,\n                                   cid_rht_params);\n        list_de"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 355-374",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: HIGH-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-456",
    "title": "`tquic_sock_setsockopt()` Reads `int` for Some Options But Accepts `optlen >= sizeof(int)` Without Capping",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 726-740",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "definition",
        "tquic_sock_setsockopt"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:840-840",
        "net/tquic/tquic_socket.c:899-899",
        "net/tquic/tquic_socket.c:942-942",
        "net/tquic/tquic_socket.c:1185-1185",
        "net/tquic/tquic_socket.c:942-956"
      ],
      "snippets": [
        "if (optlen < sizeof(int))\n        return -EINVAL;\n\n    if (copy_from_sockptr(&val, optval, sizeof(val)))\n        return -EFAULT;",
        "if (optlen < 1 || optlen > 64)\n        return -EINVAL;\n    if (copy_from_sockptr(identity, optval, optlen))\n        return -EFAULT;\n    lock_sock(sk);\n    memcpy(tsk->psk_identity, identity, optlen);\n    tsk->psk_identity_len = optlen;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 726-740",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-457",
    "title": "`tquic_path_compute_score()` Integer Overflow in Score Calculation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 287-319",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_compute_score"
      ],
      "line_ranges": [],
      "snippets": [
        "u64 score = 1000000;\n\n    if (stats->rtt_smoothed > 0)\n        score = score * 1000 / stats->rtt_smoothed;\n\n    if (stats->bandwidth > 0)\n        score = (score * stats->bandwidth) >> 20;\n\n    /* ... */\n    score = score * path->weight;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 287-319",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-458",
    "title": "`tquic_path_is_degraded()` Division by Zero Possible",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 272-273",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_is_degraded"
      ],
      "line_ranges": [],
      "snippets": [
        "if (stats->tx_packets > 100) {\n        loss_rate = (stats->lost_packets * 100) / stats->tx_packets;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 272-273",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-459",
    "title": "PSK Identity Logged with `tquic_dbg()` -- Sensitive Data in Kernel Logs",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 954",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_dbg"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:1202-1202"
      ],
      "snippets": [
        "tquic_dbg(\"PSK identity set (%d bytes)\\n\", optlen);",
        "tquic_dbg(\"Expected hostname set to '%s'\\n\", hostname);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Line:** 954",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-460",
    "title": "`tquic_nl_cmd_path_dump()` Incorrect Cast of `cb->ctx`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 986",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "tquic_dump_ctx",
        "tquic_nl_cmd_path_dump",
        "grows"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_dump_ctx *ctx = (struct tquic_dump_ctx *)cb->ctx;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 986",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-461",
    "title": "`tquic_migrate_validate_all_additional()` Lock Drop/Reacquire Pattern",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 2035-2062",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_migrate_validate_all_additional"
      ],
      "line_ranges": [],
      "snippets": [
        "spin_lock_bh(&remote_addrs->lock);\n    list_for_each_entry(entry, &remote_addrs->addresses, list) {\n        if (entry->validated || !entry->active)\n            continue;\n\n        spin_unlock_bh(&remote_addrs->lock);\n\n        /* Create probe path */\n        probe_path = tquic_path_create(conn, &local"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 2035-2062",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-462",
    "title": "`tquic_sendmsg_datagram()` Allocates Kernel Buffer Sized by User-Controlled `len`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 1883-1886",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sendmsg_datagram"
      ],
      "line_ranges": [],
      "snippets": [
        "if (len > conn->datagram.max_send_size)\n        return -EMSGSIZE;\n\n    buf = kmalloc(len, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 1883-1886",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-463",
    "title": "Stateless Reset Static Key Accessible via `tquic_stateless_reset_get_static_key()` Export",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 712-719",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_get_static_key"
      ],
      "line_ranges": [],
      "snippets": [
        "const u8 *tquic_stateless_reset_get_static_key(void)\n{\n    if (!global_ctx_initialized)\n        return NULL;\n\n    return global_reset_ctx.static_key;\n}\nEXPORT_SYMBOL_GPL(tquic_stateless_reset_get_static_key);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 712-719",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-464",
    "title": "HMAC Transform Allocated Per-Token in `tquic_stateless_reset_generate_token()`",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 98-158",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "get_random_bytes",
        "tquic_stateless_reset_generate_token",
        "tquic_cid_issue"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 98-158",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: MED-09. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-465",
    "title": "`tquic_sock_listen()` Redundant `INIT_LIST_HEAD` Check",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 364-366",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sock_listen"
      ],
      "line_ranges": [],
      "snippets": [
        "if (list_empty(&tsk->accept_queue))\n        INIT_LIST_HEAD(&tsk->accept_queue);\n    tsk->accept_queue_len = 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 364-366",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-466",
    "title": "`tquic_accept()` Nested Locking Pattern",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 451-512",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_accept"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 451-512",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-467",
    "title": "Netlink Attribute Policy Does Not Use Strict Validation for Binary Addresses",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 284-289",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "nla_len",
        "sockaddr_storage",
        "tquic_nl_parse_addr",
        "nla_get_in_addr",
        "nla_get_in6_addr"
      ],
      "line_ranges": [],
      "snippets": [
        "[TQUIC_NL_ATTR_PATH_LOCAL_ADDR] = { .type = NLA_BINARY,\n                     .len = sizeof(struct sockaddr_storage) },"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 284-289",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-468",
    "title": "`tquic_stateless_reset_detect()` Iterates All Tokens Non-Constant-Time",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 520-525",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [
        "tquic_stateless_reset_detect"
      ],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_tokens; i++) {\n        if (crypto_memneq(pkt_token, tokens[i],\n                          TQUIC_STATELESS_RESET_TOKEN_LEN) == 0)\n            return true;   // <--- early return on match\n    }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Lines:** 520-525",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-469",
    "title": "`tquic_server_check_path_recovery()` Uses `goto restart` Pattern",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 1525-1561",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path_start_validation",
        "tquic_server_check_path_recovery"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 1525-1561",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-470",
    "title": "CID Table Initialization Not Thread-Safe",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 308-316, 150-151",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "static bool cid_table_initialized;  // not atomic\n\n    if (cid_table_initialized) {\n        ret = rhashtable_insert_fast(...);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 308-316, 150-151",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-471",
    "title": "`tquic_cid_retire()` Sends RETIRE_CONNECTION_ID After Retirement",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 480-518",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [
        "release_sock",
        "atomic64_cmpxchg",
        "tquic_migration_cleanup",
        "tquic_path_create",
        "rcu_read_lock",
        "lock_sock",
        "tquic_send_retire_connection_id",
        "tquic_cid_retire",
        "rcu_read_unlock",
        "tquic_conn_get_session_state"
      ],
      "line_ranges": [
        "net/tquic/tquic_cid.c:516-516"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 480-518",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: DEEP_SOCKET_NETLINK_MIGRATION_AUDIT.md. Original finding ID: LOW-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-472",
    "title": "Stateless Reset Bypasses State Machine",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_input.c:398`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_close_with_error",
        "tquic_conn_set_state",
        "sock",
        "tquic_connection"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_handle_stateless_reset(struct tquic_connection *conn)\n{\n    struct sock *sk;\n\n    spin_lock_bh(&conn->lock);\n    conn->state = TQUIC_CONN_CLOSED;  //  DIRECT ASSIGNMENT\n    conn->error_code = EQUIC_NO_ERROR;\n\n    sk = READ_ONCE(conn->sk);\n    spin_unlock_bh(&conn->lock);\n\n    if ("
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_input.c:398`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-473",
    "title": "Use-After-Free in Connect",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_socket.c:230333`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "sock",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:230-230",
        "net/tquic/tquic_socket.c:285-285",
        "net/tquic/tquic_socket.c:291-291",
        "net/tquic/tquic_socket.c:293-293",
        "net/tquic/tquic_socket.c:309-309"
      ],
      "snippets": [
        "int tquic_connect(struct sock *sk, ...) {\n    struct tquic_connection *conn = tsk->conn;  // line 230: cache pointer\n    ...\n    release_sock(sk);                           // line 285: drop lock\n    ret = tquic_wait_for_handshake(...);        // line 291: SLEEP\n    lock_sock(sk);                   ",
        "conn = tsk->conn;\nif (!conn) { ret = -ECONNABORTED; goto out_close; }"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_socket.c:230333`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-474",
    "title": "Sleep-in-Atomic Context",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_migration.c:503`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_session_ttl_expired",
        "tquic_conn_close_with_error",
        "tquic_path_free",
        "synchronize_rcu"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1395-1395",
        "net/tquic/tquic_migration.c:503-503",
        "net/tquic/tquic_migration.c:503-503"
      ],
      "snippets": [
        "tquic_session_ttl_expired()           timer callback (softirq context)\n   tquic_conn_close_with_error()     line 1395\n     (connection teardown)\n       tquic_path_free()             line 503\n         synchronize_rcu()           BLOCKING CALL IN ATOMIC CONTEXT",
        "void tquic_path_free(struct tquic_path *path) {\n    ...\n    synchronize_rcu();  // line 503: SLEEPS\n    kfree(path);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_migration.c:503`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-475",
    "title": "Refcount Underflow in Netlink Path Creation",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_netlink.c:439641`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_netlink.c:427-427",
        "net/tquic/tquic_netlink.c:439-439",
        "net/tquic/tquic_netlink.c:445-445",
        "net/tquic/tquic_netlink.c:449-449",
        "net/tquic/tquic_netlink.c:631-631"
      ],
      "snippets": [
        "// tquic_nl_path_create (line 427):\nrefcount_set(&path->refcnt, 1);       // line 439: refcount = 1\nlist_add_tail_rcu(&path->list, ...);   // line 445: list owns it (needs ref)\nreturn path;                           // line 449: caller owns it (needs ref)\n// TWO owners, ONE refcount\n\n// tquic_path_r"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_netlink.c:439641`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-476",
    "title": "Stream Data Queued Before Validation Check",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_input.c:971 vs 980`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_input.c:971-971",
        "net/tquic/tquic_input.c:980-980",
        "net/tquic/tquic_input.c:982-982",
        "net/tquic/tquic_input.c:971-971",
        "net/tquic/tquic_input.c:980-980"
      ],
      "snippets": [
        "skb_queue_tail(&stream->recv_buf, data_skb);  // line 971: DATA QUEUED\n\n// ... then LATER ...\n\nif (offset > ((1ULL << 62) - 1) - length) {   // line 980: VALIDATION\n    return -EPROTO;                            // line 982: ERROR, but skb\n}                                              //           "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** CRITICAL **Location:** `net/tquic/tquic_input.c:971 vs 980`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-477",
    "title": "Unlocked Connection Access in IOCTL",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**Severity:** HIGH **Location:** `net/tquic/tquic_socket.c:660`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "socket",
        "tquic_sock",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/tquic/tquic_socket.c:660-660",
        "net/tquic/tquic_socket.c:672-672",
        "net/tquic/tquic_socket.c:660-660"
      ],
      "snippets": [
        "int tquic_sock_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg)\n{\n    struct tquic_sock *tsk = tquic_sk(sk);\n    struct tquic_connection *conn = tsk->conn;  // line 660: NO LOCK\n\n    switch (cmd) {\n    case TQUIC_NEW_STREAM:\n        if (!conn || conn->state != TQUIC_CONN_CONNECTED)  /"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** HIGH **Location:** `net/tquic/tquic_socket.c:660`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-478",
    "title": "Data Race in Server Migration Check",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**Severity:** HIGH **Location:** `net/tquic/tquic_migration.c:1261`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_migration.c:1261-1261",
        "net/tquic/tquic_migration.c:1270-1270",
        "net/tquic/tquic_migration.c:1261-1261",
        "net/tquic/tquic_migration.c:1270-1270",
        "net/tquic/tquic_migration.c:1261-1261"
      ],
      "snippets": [
        "// line 1261: READ WITHOUT LOCK\nif (!sockaddr_equal(&path->remote_addr, new_remote)) {\n    ...\n    // line 1270: LOCK ACQUIRED LATER\n    spin_lock_bh(&conn->paths_lock);\n    memcpy(&path->remote_addr, new_remote, sizeof(*new_remote));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** HIGH **Location:** `net/tquic/tquic_migration.c:1261`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-479",
    "title": "HANDSHAKE_DONE Bypasses State Machine",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**Severity:** MEDIUM **Location:** `net/tquic/tquic_input.c:1308`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_conn_set_state",
        "tquic_rx_ctx"
      ],
      "line_ranges": [
        "net/tquic/tquic_input.c:1308-1308"
      ],
      "snippets": [
        "static int tquic_process_handshake_done_frame(struct tquic_rx_ctx *ctx)\n{\n    ...\n    spin_lock(&ctx->conn->lock);\n    if (ctx->conn->state == TQUIC_CONN_CONNECTING) {\n        ctx->conn->state = TQUIC_CONN_CONNECTED;  // line 1308: DIRECT\n        ctx->conn->handshake_complete = true;\n    }\n    spin_"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Severity:** MEDIUM **Location:** `net/tquic/tquic_input.c:1308`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: EXTREME_CODE_REVIEW.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-480",
    "title": "Attacker-Controlled Allocation Sizes",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "See description",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":909-909"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Attacker-Controlled Allocation Sizes",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: CRITICAL. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-481",
    "title": "MEM-1: `tquic_handshake.c` lines 605 and 1136 allocate skbs based on computed handshake message lengths (`ch_len`, `resp_len`). While these are internally computed (not directly from network), a malfo",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Server could allocate large handshake response buffers if attacker sends carefully crafted CRYPTO data\n- **Recommendation**: Enforce a hard cap on `ch_len` and `resp_len` (e.g., 16KB max for any single handshake message)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_handshake.c:605-605",
        "net/quic/tquic/tquic_handshake.c:963-963",
        "net/quic/tquic/tquic_handshake.c:259-259",
        "net/quic/tquic/tquic_handshake.c:266-266",
        "net/quic/tquic/tquic_handshake.c:656-656"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_handshake.c` - **Lines**: 605, 1136 - **Impact**: Server could allocate large handshake response buffers if attacker sends carefully crafted CRYPTO data - **Recommendation**: Enforce a hard cap on `ch_len` and `resp_len` (e.",
    "fix_suggestion": "Enforce a hard cap on `ch_len` and `resp_len` (e.g., 16KB max for any single handshake message)",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-482",
    "title": "MEM-2: The `crypto_buffer[space]` queue per connection is only bounded by the global pre-handshake memory budget, not by a per-connection limit. An attacker establishing many connections, each sending",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Distributed attack from many IPs could exhaust crypto buffer memory\n- **Recommendation**: Add per-connection crypto buffer limit (e.g., 256KB per connection per PN space)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_handshake.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_handshake.c` - **Line**: 615 - **Impact**: Distributed attack from many IPs could exhaust crypto buffer memory - **Recommendation**: Add per-connection crypto buffer limit (e.g., 256KB per connection per PN space)",
    "fix_suggestion": "Add per-connection crypto buffer limit (e.g., 256KB per connection per PN space)",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-483",
    "title": "MEM-3: The NF connection tracking limit (65536) has no per-source-IP limit at the netfilter layer. While the TQUIC protocol layer has per-IP limits, the NF `tquic_nf_conn_alloc` at line 497 only check",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "NF tracking table exhaustion from distributed sources\n- **Recommendation**: Add per-IP NF tracking limit (e.g., 256 entries per source IP)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_nf.c"
      ],
      "symbols": [
        "tquic_stream_open_incoming"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_nf.c:497-497",
        "net/quic/tquic/tquic_nf.c:634-648"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_nf.c` - **Lines**: 494-497 - **Impact**: NF tracking table exhaustion from distributed sources - **Recommendation**: Add per-IP NF tracking limit (e.g., 256 entries per source IP)",
    "fix_suggestion": "Add per-IP NF tracking limit (e.g., 256 entries per source IP)",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-484",
    "title": "MEM-4: While stream count is limited, each stream allocates both `send_buf` and `recv_buf` skb queues. An attacker opening `max_streams_bidi` streams and sending minimal data to each creates per-strea",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Memory overhead of ~1KB per empty stream x max_streams\n- **Recommendation**: Consider lazy initialization of stream buffers\n\n---\n\n## Section 2: CPU EXHAUSTION VECTORS",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_main.c` - **Lines**: 651-665 - **Impact**: Memory overhead of ~1KB per empty stream x max_streams - **Recommendation**: Consider lazy initialization of stream buffers",
    "fix_suggestion": "Consider lazy initialization of stream buffers",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-485",
    "title": "CPU-1: ACK range processing loop.",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Moderate CPU consumption from crafted ACK-heavy packets\n- **Recommendation**: Limit ACK frames per packet to 1 (which RFC 9000 already expects)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:642-642"
      ],
      "snippets": [
        "// tquic_input.c:646\nfor (i = 0; i < ack_range_count; i++) {\n    // varint decode for gap and range (2 varints per iteration)\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // tquic_input.c:646 for (i = 0; i < ack_range_count; i++) { // varint decode for gap and range (2 varints per iteration) } ```",
    "fix_suggestion": "Limit ACK frames per packet to 1 (which RFC 9000 already expects)",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM."
  },
  {
    "id": "F-486",
    "title": "CPU-2: FEC decoder block search is a linear list walk.",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "O(n^2) symbol dedup within FEC blocks\n- **Recommendation**: Use a bitmap or hash set for symbol ID dedup within blocks",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/fec_decoder.c:285-285"
      ],
      "snippets": [
        "// fec/fec_decoder.c:220\nlist_for_each_entry(block, &dec->active_blocks, list) {\n    if (block->block_id == block_id)\n        return block;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // fec/fec_decoder.c:220 list_for_each_entry(block, &dec->active_blocks, list) { if (block->block_id == block_id) return block; } ```",
    "fix_suggestion": "Use a bitmap or hash set for symbol ID dedup within blocks",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM."
  },
  {
    "id": "F-487",
    "title": "CPU-3: CID pool active count enumeration.",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Lock contention under CID flood\n- **Recommendation**: Maintain running `active_count` counter to avoid list traversal",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_cid.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_cid.c:617-617"
      ],
      "snippets": [
        "// tquic_cid.c:652\nlist_for_each_entry(iter, &pool->remote_cids, list) {\n    if (iter->state == CID_STATE_ACTIVE)\n        active_count++;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // tquic_cid.c:652 list_for_each_entry(iter, &pool->remote_cids, list) { if (iter->state == CID_STATE_ACTIVE) active_count++; } ```",
    "fix_suggestion": "Maintain running `active_count` counter to avoid list traversal",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW."
  },
  {
    "id": "F-488",
    "title": "CPU-4: Attacker can trigger expensive decrypt attempts cheaply.",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "CPU exhaustion via garbage packet flood (each packet costs 2 AEAD operations)\n- **Recommendation**: Track consecutive decryption failures per CID and temporarily blacklist CIDs with excessive failures. Also, the rate limiting at the UDP receive entry point should cover short-header packets, not just Initial packets.",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:2631-2631"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The packet reception path at `tquic_input.c:2618` attempts decryption on every received packet. If decryption fails for short-header packets, the code at line 2631 attempts a second decryption with old keys (`tquic_try_decrypt_with_old_keys`). An attacker sending garbage short-header packets to a va",
    "fix_suggestion": "Track consecutive decryption failures per CID and temporarily blacklist CIDs with excessive failures. Also, the rate limiting at the UDP receive entry point should cover short-header packets, not just Initial packets.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: HIGH. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-489",
    "title": "CPU-5: All hash tables use `jhash` with a **fixed seed of 0**.",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "Hash collision attack can degrade multiple subsystems simultaneously\n- **Recommendation**: Use `siphash` with a per-boot random key (from `net_get_random_once`) instead of `jhash` with seed 0. This is the standard kernel approach since Linux 4.1.",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":848-848"
      ],
      "snippets": [
        "// tquic_nf.c:147\nreturn jhash(cid->id, cid->len, 0);\n\n// tquic_ratelimit.c:97\nreturn jhash_1word(sin->sin_addr.s_addr, 0);\n\n// security_hardening.c:73\nreturn jhash(&sin->sin_addr, sizeof(sin->sin_addr), 0);\n\n// tquic_forward.c:157\nhash = jhash(&sin->sin_addr, sizeof(sin->sin_addr), 0);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // tquic_nf.c:147 return jhash(cid->id, cid->len, 0);",
    "fix_suggestion": "Use `siphash` with a per-boot random key (from `net_get_random_once`) instead of `jhash` with seed 0. This is the standard kernel approach since Linux 4.1.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: HIGH. Note: file paths not explicitly specified in finding."
  },
  {
    "id": "F-490",
    "title": "CPU-6: The QPACK decoder accepts a `max_table_capacity` parameter from the peer via SETTINGS. While the sysctl caps the local maximum at 1MB, the actual limit used should be `min(peer_requested, local",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Peer could request oversized table\n- **Recommendation**: Audit SETTINGS parsing to confirm capacity is clamped\n\n---\n\n## Section 3: AMPLIFICATION VECTORS",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/qpack_decoder.c"
      ],
      "symbols": [
        "tquic_path"
      ],
      "line_ranges": [],
      "snippets": [
        "// tquic_migration.c:72\n#define TQUIC_ANTI_AMPLIFICATION_LIMIT  3  /* Max 3x amplification */\n\n// tquic_migration.c:85-106\nbool tquic_path_anti_amplification_check(struct tquic_path *path, u64 bytes)\n{\n    received = atomic64_read(&path->anti_amplification.bytes_received);\n    sent = atomic64_read(&"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/qpack_decoder.c` - **Line**: 41-63 - **Impact**: Peer could request oversized table - **Recommendation**: Audit SETTINGS parsing to confirm capacity is clamped",
    "fix_suggestion": "Audit SETTINGS parsing to confirm capacity is clamped",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW."
  },
  {
    "id": "F-491",
    "title": "AMP-1: The anti-amplification check uses `atomic64` operations for `bytes_received` and `bytes_sent`, but the check-then-add pattern is not atomic as a whole:",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Marginal amplification limit bypass (could exceed 3x briefly under concurrency)\n- **Recommendation**: Use `atomic64_add_return` to atomically check-and-add, or serialize under a spinlock",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_migration.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_migration.c:271-271"
      ],
      "snippets": [
        "// Check:\nsent + bytes <= received * TQUIC_ANTI_AMPLIFICATION_LIMIT\n// Then later:\natomic64_add(bytes, &path->anti_amplification.bytes_sent);",
        "// tquic_stateless_reset.c:211\n// \"than the packet it received to avoid being used for amplification.\"",
        "// pm/path_manager.c:169\nTQUIC_MAX_CHALLENGE_RESPONSES_PER_RTT\n\n// pm/path_validation.c:259\nTQUIC_MAX_PENDING_RESPONSES"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // Check: sent + bytes <= received * TQUIC_ANTI_AMPLIFICATION_LIMIT // Then later: atomic64_add(bytes, &path->anti_amplification.bytes_sent); ```",
    "fix_suggestion": "Use `atomic64_add_return` to atomically check-and-add, or serialize under a spinlock",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM."
  },
  {
    "id": "F-492",
    "title": "AMP-2: The `tquic_path_handle_challenge` function in `pm/path_validation.c:249` does not check anti-amplification limits before queuing the PATH_RESPONSE. Per RFC 9000 Section 8.1, data sent on unvali",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "PATH_CHALLENGE flood could bypass amplification limits\n- **Recommendation**: Check `tquic_path_anti_amplification_check` before queuing response; charge response bytes to `bytes_sent`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/pm/path_validation.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/pm/path_validation.c` - **Lines**: 249-314 - **Impact**: PATH_CHALLENGE flood could bypass amplification limits - **Recommendation**: Check `tquic_path_anti_amplification_check` before queuing response; charge response bytes to `b",
    "fix_suggestion": "Check `tquic_path_anti_amplification_check` before queuing response; charge response bytes to `bytes_sent`",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-493",
    "title": "AMP-3: The MASQUE CONNECT-UDP tunnel implementation in `masque/connect_udp.c` creates UDP sockets to forward proxied traffic. There is **no visible limit on the number of tunnels per connection or per",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Kernel socket and memory exhaustion through tunnel flooding\n- **Recommendation**: Add per-connection and per-client tunnel limits (e.g., max 16 tunnels per connection)\n\n---\n\n## Section 4: TIMER AND STATE EXHAUSTION",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/masque/connect_udp.c:374-374"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The `tunnel_alloc` function at line 374 allocates tunnel structures without checking any limit. If a MASQUE client can open unlimited tunnels (each with its own kernel UDP socket), this is a resource exhaustion vector consuming both memory (tunnel structs, socket buffers) and file descriptors.",
    "fix_suggestion": "Add per-connection and per-client tunnel limits (e.g., max 16 tunnels per connection)",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-494",
    "title": "STATE-1: The transition to \"attack mode\" (TQUIC_RL_COOKIE_REQUIRED) appears to be reactive -- it triggers when rate limits are exceeded. During the ramp-up period before attack mode activates, an atta",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Slow-ramp attack can exhaust pre-handshake memory before defense escalation\n- **Recommendation**: Consider proactive cookie validation when pre-handshake memory exceeds 50% of budget, independent of rate limit triggers",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/rate_limit.c",
        "net/quic/tquic/tquic_ratelimit.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "With 10,000 connections/sec global limit and 64MB pre-handshake budget, an attacker sending Initial packets at 9,999/sec from diverse IPs could sustain a connection flood below the detection threshold while steadily consuming memory.",
    "fix_suggestion": "Consider proactive cookie validation when pre-handshake memory exceeds 50% of budget, independent of rate limit triggers",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-495",
    "title": "STATE-2: An attacker could open connections, complete the handshake (consuming 1 connection per client rate token), then keep them alive by sending a PING frame every 29 seconds. With default 100 conn",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Idle connection accumulation consuming memory\n- **Recommendation**: Enforce a maximum concurrent connections per-IP limit (distinct from rate limit), e.g., 32 connections per source IP",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_sysctl.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Each connection consumes kernel memory (connection struct, crypto state, timer state, etc.). The aggregate memory across many idle connections could be significant.",
    "fix_suggestion": "Enforce a maximum concurrent connections per-IP limit (distinct from rate limit), e.g., 32 connections per source IP",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-496",
    "title": "STATE-3: No visible limit on the number of paths per connection. If an attacker can trigger path creation (via connection migration or multipath signaling), each new path creates timers and state.",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Timer and path state accumulation\n- **Recommendation**: Enforce max paths per connection limit\n\n---\n\n## Section 5: PROTOCOL-SPECIFIC DoS VECTORS",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":656-656",
        ":617-617"
      ],
      "snippets": [
        "ret = tquic_cid_security_check_new_cid(&pool->security);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **Impact**: Timer and path state accumulation - **Recommendation**: Enforce max paths per connection limit",
    "fix_suggestion": "Enforce max paths per connection limit",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: file paths not explicitly specified in finding."
  },
  {
    "id": "F-497",
    "title": "PROTO-1: The retire loop at `tquic_cid.c:667-674` iterates the entire remote CID list for each NEW_CONNECTION_ID frame, marking CIDs as retired. While bounded by `active_connection_id_limit`, repeated",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "See description",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "PROTO-1: The retire loop at `tquic_cid.c:667-674` iterates the entire remote CID list for each NEW_CONNECTION_ID frame, marking CIDs as retired. While bounded by `active_connection_id_limit`, repeated retire-and-reissue cycles could generate a storm of RETIRE_CONNECTION_ID frames in the outbound direction, consuming output queue space.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-498",
    "title": "PROTO-2: The `tquic_stream_open_incoming` function checks `stream_seq >= conn->max_streams_*` but the peer can send frames referencing stream IDs in any order. An attacker could send a STREAM frame fo",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The security hardening module references optimistic ACK defense via packet number skipping. The `bytes_acked` calculation at `tquic_input.c:737` uses an estimation: ```c u64 bytes_acked = (first_ack_r",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":681-681"
      ],
      "snippets": [
        "u64 bytes_acked = (first_ack_range + 1) * 1200;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The security hardening module references optimistic ACK defense via packet number skipping. The `bytes_acked` calculation at `tquic_input.c:737` uses an estimation: ```c u64 bytes_acked = (first_ack_range + 1) * 1200; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-499",
    "title": "PROTO-3: This estimation-based ACK processing means an attacker can send ACK frames claiming to acknowledge packets that were never sent, inflating the `bytes_acked` value and causing the congestion c",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "Attacker can inflate congestion window via optimistic ACKs, potentially causing network congestion or self-DoS\n- **Recommendation**: Implement proper sent-packet tracking to validate ACK ranges\n\n---\n\n## Section 6: INFORMATION DISCLOSURE VIA DoS RESPONSE",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:733-733"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "- **File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` - **Lines**: 732-744 - **Impact**: Attacker can inflate congestion window via optimistic ACKs, potentially causing network congestion or self-DoS - **Recommendation**: Implement proper sent-packet tracking to valida",
    "fix_suggestion": "Implement proper sent-packet tracking to validate ACK ranges",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-500",
    "title": "INFO-1: Several `pr_debug`/`tquic_dbg` calls include connection state information. While these are compile-time optional, in debug builds they could leak timing information about connection state to a",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "```c // tquic_input.c:2664 tquic_warn(\"key phase change %u->%u failed: %d\\n\", current_phase, ctx.key_phase_bit, ku_ret); ```",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "// tquic_input.c:2664\ntquic_warn(\"key phase change %u->%u failed: %d\\n\",\n           current_phase, ctx.key_phase_bit, ku_ret);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c // tquic_input.c:2664 tquic_warn(\"key phase change %u->%u failed: %d\\n\", current_phase, ctx.key_phase_bit, ku_ret); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-501",
    "title": "CROSS-1: The systematic use of `jhash` with seed 0 across 15+ call sites creates a coordinated attack vector. An attacker who can determine CID values and IP addresses can craft inputs that degrade:",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "1. Connection lookup 2. Rate limiting 3. Pre-handshake defense 4. PMTU cache 5. Hairpin detection",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "1. Connection lookup 2. Rate limiting 3. Pre-handshake defense 4. PMTU cache 5. Hairpin detection",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: HIGH. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-502",
    "title": "CROSS-2: Consider using the `tquic_rx_buf_cache` slab cache pattern (already used at `tquic_input.c:2586`) more broadly for hot-path allocations to reduce GFP_ATOMIC pressure.",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "---",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "---",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_DOS_RESOURCE_AUDIT.md. Original finding ID: LOW. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-503",
    "title": "tquic_send_connection_close() -- SKB leak and unencrypted packet on header failure",
    "category": "build",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1980-1992",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_send_connection_close",
        "tquic_build_short_header_internal",
        "tquic_output_packet"
      ],
      "line_ranges": [],
      "snippets": [
        "if (header_len > 0)\n    skb_put_data(skb, header, header_len);\n}\n\nskb_put_data(skb, buf, ctx.offset);\nkfree(buf);\n\nreturn tquic_output_packet(conn, path, skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1980-1992",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: CRIT-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-504",
    "title": "tquic_conn_server_accept() -- err_free leaks registered CIDs, work items, timers, crypto state",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/connection.c` **Lines:** 2496-2611",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_crypto_init_versioned",
        "tquic_conn_server_accept",
        "tquic_conn_add_remote_cid",
        "tquic_conn_set_state",
        "tquic_conn_add_local_cid"
      ],
      "line_ranges": [
        "net/quic/tquic/core/connection.c:2518-2518",
        "net/quic/tquic/core/connection.c:2524-2524",
        "net/quic/tquic/core/connection.c:2573-2573",
        "net/quic/tquic/core/connection.c:2492-2494",
        "net/quic/tquic/core/connection.c:2545-2545"
      ],
      "snippets": [
        "conn->state_machine = cs;  // set BEFORE error paths below\n\n// ... tquic_conn_add_remote_cid, tquic_conn_add_local_cid, crypto_init ...\n\nerr_free:\n    kfree(cs);\n    conn->state_machine = NULL;\n    return -EINVAL;",
        "err_free_crypto:\n    tquic_crypto_free(conn->crypto_state);\n    conn->crypto_state = NULL;\nerr_free_cids:\n    /* remove added CIDs */\nerr_free_cs:\n    skb_queue_purge(&cs->zero_rtt_buffer);\n    kfree(cs);\n    conn->state_machine = NULL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/connection.c` **Lines:** 2496-2611",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: CRIT-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-505",
    "title": "tquic_conn_server_accept() -- overrides actual error code with -EINVAL",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/connection.c` **Line:** 2611",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/connection.c"
      ],
      "symbols": [
        "tquic_conn_server_accept"
      ],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    kfree(cs);\n    conn->state_machine = NULL;\n    return -EINVAL;  // BUG: discards actual 'ret' value"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/connection.c` **Line:** 2611",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: CRIT-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-506",
    "title": "FEC encoder repair symbol generation -- partial resource leak on kzalloc failure",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_encoder.c` **Lines:** 394-410",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_repair; i++) {\n    repair_sym = kzalloc(sizeof(*repair_sym), GFP_ATOMIC);\n    if (!repair_sym) {\n        kfree(repair_bufs[i]);\n        continue;    // BUG: leaks remaining repair_bufs[i+1..num_repair-1]\n    }\n    repair_sym->data = repair_bufs[i];\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_encoder.c` **Lines:** 394-410",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-507",
    "title": "FEC decoder recovery -- partial recovery leaks on kzalloc failure",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_decoder.c` **Lines:** 484-501",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for (i = 0; i < num_erasures; i++) {\n    symbol = kzalloc(sizeof(*symbol), GFP_ATOMIC);\n    if (!symbol) {\n        kfree(recovered[i]);\n        continue;    // BUG: same pattern as encoder\n    }\n    symbol->data = recovered[i];\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_decoder.c` **Lines:** 484-501",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-508",
    "title": "reed_solomon.c -- four-allocation group without individual NULL checks",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/reed_solomon.c` **Lines:** 583-591",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/reed_solomon.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/reed_solomon.c:590-590"
      ],
      "snippets": [
        "decode_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\ninv_matrix = kmalloc_array(num_erasures, num_erasures, GFP_ATOMIC);\nsyndrome = kmalloc_array(num_erasures, max_len, GFP_ATOMIC);\nrepair_used = kmalloc_array(num_erasures, sizeof(int), GFP_ATOMIC);\n\nif (!decode_matrix || !inv_matr",
        "out:\n    kfree(decode_matrix);\n    kfree(inv_matrix);\n    kfree(syndrome);\n    kfree(repair_used);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/reed_solomon.c` **Lines:** 583-591",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-509",
    "title": "tquic_zerocopy_sendmsg -- uarg leak on partial send",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_zerocopy.c` **Lines:** 270-368",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_zerocopy.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_zerocopy.c:360-360"
      ],
      "snippets": [
        "while (copied < len) {\n    new_skb = alloc_skb(0, GFP_KERNEL);\n    if (!new_skb) {\n        err = -ENOMEM;\n        goto out_err;\n    }\n    ...\n    skb_queue_tail(&stream->send_buf, new_skb);\n    copied += chunk;\n}\n...\nout_err:\n    if (uarg && !msg->msg_ubuf)\n        net_zcopy_put(uarg);\n    return er"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_zerocopy.c` **Lines:** 270-368",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-510",
    "title": "Missing kfree_sensitive for key material in crypto/handshake.c extensions buffer",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/handshake.c` **Lines:** 1268-1278",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/handshake.c"
      ],
      "symbols": [
        "kfree_sensitive"
      ],
      "line_ranges": [
        "net/quic/tquic/crypto/handshake.c:1280-1280",
        "net/quic/tquic/crypto/handshake.c:3260-3260"
      ],
      "snippets": [
        "extensions = kzalloc(2048, GFP_KERNEL);\n...\nhs->key_share.public_key = kzalloc(32, GFP_KERNEL);\nhs->key_share.private_key = kzalloc(32, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/handshake.c` **Lines:** 1268-1278",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-511",
    "title": "tquic_output.c:tquic_xmit -- pkt_num consumed but not tracked on send failure",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1846-1848",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1851-1851"
      ],
      "snippets": [
        "ret = tquic_output_packet(conn, path, skb);\nif (ret < 0)\n    break;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1846-1848",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: HIGH-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-512",
    "title": "tquic_cid_pool_init -- timer initialized but not cancelled on later failure",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_cid.c` **Lines:** 247-277",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_cid.c"
      ],
      "symbols": [
        "INIT_WORK",
        "timer_setup",
        "del_timer_sync",
        "cancel_work_sync"
      ],
      "line_ranges": [],
      "snippets": [
        "pool = kzalloc(sizeof(*pool), GFP_KERNEL);\n...\nINIT_WORK(&pool->rotation_work, tquic_cid_rotation_work);\ntimer_setup(&pool->rotation_timer, tquic_cid_rotation_timer_cb, 0);\n...\nentry = kzalloc(sizeof(*entry), GFP_KERNEL);\nif (!entry) {\n    kfree(pool);   // BUG: timer and work not cancelled\n    retu"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_cid.c` **Lines:** 247-277",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-513",
    "title": "tquic_main.c init/exit -- conditional cleanup mismatch for NAPI/io_uring",
    "category": "api",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_main.c` **Lines:** 1009-1021 and 1086-1093",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [
        "tquic_napi_subsys_exit",
        "tquic_io_uring_init",
        "tquic_server_exit",
        "tquic_napi_subsys_init",
        "tquic_io_uring_exit"
      ],
      "line_ranges": [],
      "snippets": [
        "// Init:\n#if IS_ENABLED(CONFIG_TQUIC_NAPI)\n    err = tquic_napi_subsys_init();\n    if (err)\n        goto err_napi;\n#endif\n\n#if IS_ENABLED(CONFIG_TQUIC_IO_URING)\n    err = tquic_io_uring_init();\n    if (err)\n        goto err_io_uring;\n#endif\n\n// Error path:\nerr_netlink:\n#if IS_ENABLED(CONFIG_TQUIC_IO"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_main.c` **Lines:** 1009-1021 and 1086-1093",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-514",
    "title": "tquic_conn_create -- loss_detection_init failure doesn't clean up timers",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_connection.c` **Lines:** 494-510",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_connection.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/quic_connection.c:495-501",
        "net/quic/tquic/core/quic_connection.c:504-506"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_connection.c` **Lines:** 494-510",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-03. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-515",
    "title": "cert_verify.c parse_san_extension -- error code not propagated",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/cert_verify.c` **Lines:** 519-531",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    {\n        u32 j;\n        for (j = 0; j < name_count; j++)\n            kfree(names[j]);\n        kfree(names);\n        for (j = 0; j < addr_count; j++)\n            kfree(ips[j]);\n    }\n    kfree(ips);\n    kfree(ip_lengths);\n    return -ENOMEM;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/cert_verify.c` **Lines:** 519-531",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-516",
    "title": "tquic_output_flush -- spin_unlock_bh after acquiring spin_lock_bh, but lock dropped mid-loop",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 2148",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* Release lock while sending (may sleep in crypto) */\nspin_unlock_bh(&conn->lock);\n\n/* Assemble and send packet */\nsend_skb = tquic_assemble_packet(conn, path, -1, pkt_num, &frames);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 2148",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-517",
    "title": "tquic_handshake.c tquic_start_handshake -- hs freed with memzero_explicit but no kfree_sensitive",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_handshake.c` **Lines:** 703-707",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_handshake.c"
      ],
      "symbols": [
        "kfree_sensitive",
        "at"
      ],
      "line_ranges": [],
      "snippets": [
        "err_free:\n    tsk->handshake_state = NULL;\n    memzero_explicit(hs, sizeof(*hs));\n    kfree(hs);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_handshake.c` **Lines:** 703-707",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-518",
    "title": "tquic_retry.c -- integrity_aead_lock held across AEAD operations",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Lines:** 279-343",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "mutex_lock(&integrity_aead_lock);\naead = tquic_retry_get_integrity_aead(version);\n...\nret = crypto_aead_encrypt(req);\n...\nout_unlock:\n    mutex_unlock(&integrity_aead_lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Lines:** 279-343",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: MED-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-519",
    "title": "Consistent use of kfree_sensitive for key material -- GOOD",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The codebase demonstrates thorough use of `kfree_sensitive` for: - Private keys (`crypto/handshake.c:3260`) - Client connection state (`tquic_server.c:269,343,352,779`) - Congestion state containing s",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The codebase demonstrates thorough use of `kfree_sensitive` for: - Private keys (`crypto/handshake.c:3260`) - Client connection state (`tquic_server.c:269,343,352,779`) - Congestion state containing session data (`cong/cong_data.c:132`)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-01. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-520",
    "title": "tquic_timer_state_alloc -- cleanup loop is correct",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Lines:** 520-575",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Lines:** 520-575",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-02. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-521",
    "title": "tquic_pacing_cleanup -- correct ordering",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1214-1223",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "hrtimer_cancel(&pacing->timer);\ncancel_work_sync(&pacing->work);\nskb_queue_purge(&pacing->queue);\nkfree(pacing);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1214-1223",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-522",
    "title": "tquic_timer_state_free -- thorough and correct",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Lines:** 583-636",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Lines:** 583-636",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-04. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-523",
    "title": "tquic_main.c init -- correct cascading cleanup",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_main.c` **Lines:** 755-1196",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_main.c"
      ],
      "symbols": [
        "tquic_exit"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_main.c:1198-1198"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_main.c` **Lines:** 755-1196",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-524",
    "title": "tquic_conn_destroy -- thorough cleanup",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_connection.c` **Lines:** 555-593+",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_connection.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_connection.c` **Lines:** 555-593+",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-06. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-525",
    "title": "bench/benchmark.c -- kvmalloc used correctly with kvfree",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The benchmark code uses `kvmalloc_array`/`kvmalloc` for potentially large buffers and cleans up with `kvfree`. This is correct.",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c",
        "net/quic/tquic/fec/fec_decoder.c"
      ],
      "symbols": [
        "free",
        "allocation"
      ],
      "line_ranges": [
        "net/quic/tquic/fec/fec_encoder.c:349-350",
        "net/quic/tquic/fec/fec_encoder.c:341-342"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The benchmark code uses `kvmalloc_array`/`kvmalloc` for potentially large buffers and cleans up with `kvfree`. This is correct.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_ERROR_PATH_AUDIT.md. Original finding ID: LOW-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-526",
    "title": "Integer Overflow in bytes_acked Calculation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c u64 bytes_acked = (first_ack_range + 1) * 1200; ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_cong_on_ack",
        "check_mul_overflow",
        "tquic_process_ack_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:737-737",
        "net/quic/tquic/tquic_input.c:737-737"
      ],
      "snippets": [
        "u64 bytes_acked = (first_ack_range + 1) * 1200;",
        "if (first_ack_range > 100000) /* Sanity: no packet contains >100K ranges */\n    first_ack_range = 100000;\nu64 bytes_acked = (first_ack_range + 1) * 1200;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c u64 bytes_acked = (first_ack_range + 1) * 1200; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-527",
    "title": "Potential Integer Overflow in CRYPTO Frame on 32-bit",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c if (length > ctx->len || ctx->offset + (size_t)length > ctx->len) return -EINVAL; ```",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":806-806"
      ],
      "snippets": [
        "if (length > ctx->len || ctx->offset + (size_t)length > ctx->len)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c if (length > ctx->len || ctx->offset + (size_t)length > ctx->len) return -EINVAL; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-02. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-528",
    "title": "Missing Bounds Check Before Frame Type Read",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c while (ctx.offset < ctx.len) { prev_offset = ctx.offset; frame_type = ctx.data[ctx.offset];  // Line 1873 ```",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":1873-1873",
        ":1873-1873",
        ":579-579"
      ],
      "snippets": [
        "while (ctx.offset < ctx.len) {\n    prev_offset = ctx.offset;\n    frame_type = ctx.data[ctx.offset];  // Line 1873"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c while (ctx.offset < ctx.len) { prev_offset = ctx.offset; frame_type = ctx.data[ctx.offset];  // Line 1873 ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-03. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-529",
    "title": "ACK Range Processing Without Semantic Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "```c for (i = 0; i < ack_range_count; i++) { u64 gap, range; ret = tquic_decode_varint(ctx->data + ctx->offset, ctx->len - ctx->offset, &gap); ... ret = tquic_decode_varint(ctx->data + ctx->offset, ct",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_ack_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:646-660",
        "net/quic/tquic/tquic_input.c:642-642",
        "net/quic/tquic/tquic_input.c:646-660"
      ],
      "snippets": [
        "for (i = 0; i < ack_range_count; i++) {\n    u64 gap, range;\n    ret = tquic_decode_varint(ctx->data + ctx->offset,\n                  ctx->len - ctx->offset, &gap);\n    ...\n    ret = tquic_decode_varint(ctx->data + ctx->offset,\n                  ctx->len - ctx->offset, &range);\n    ...\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c for (i = 0; i < ack_range_count; i++) { u64 gap, range; ret = tquic_decode_varint(ctx->data + ctx->offset, ctx->len - ctx->offset, &gap); ... ret = tquic_decode_varint(ctx->data + ctx->offset, ctx->len - ctx->offset, &range); ... } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: HIGH-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-530",
    "title": "STREAM Frame Unbounded Allocation with GFP_ATOMIC",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "```c data_skb = alloc_skb(length, GFP_ATOMIC); ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_stream_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:944-944",
        "net/quic/tquic/tquic_input.c:909-909",
        "net/quic/tquic/tquic_input.c:963-968",
        "net/quic/tquic/tquic_input.c:944-944"
      ],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c data_skb = alloc_skb(length, GFP_ATOMIC); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: HIGH-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-531",
    "title": "Race Condition on path->last_activity",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "```c rtt_us = ktime_us_delta(now, ctx->path->last_activity); ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_packet",
        "tquic_process_coalesced",
        "tquic_process_ack_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:723-723",
        "net/quic/tquic/tquic_input.c:2687-2687",
        "net/quic/tquic/tquic_input.c:723-723",
        "net/quic/tquic/tquic_input.c:3070-3070"
      ],
      "snippets": [
        "rtt_us = ktime_us_delta(now, ctx->path->last_activity);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c rtt_us = ktime_us_delta(now, ctx->path->last_activity); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: HIGH-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-532",
    "title": "Missing Upper Bound on Coalesced Packet Count",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c while (offset < total_len) { ... offset += pkt_len; packets++; } ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_udp_recv",
        "tquic_parse_short_header_internal",
        "check_add_overflow",
        "tquic_parse_long_header_internal",
        "tquic_process_version_negotiation",
        "tquic_process_coalesced"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:3079-3079",
        "net/quic/tquic/tquic_input.c:3079-3079",
        "net/quic/tquic/tquic_input.c:2080-2080",
        "net/quic/tquic/tquic_input.c:2129-2129",
        "net/quic/tquic/tquic_input.c:437-437"
      ],
      "snippets": [
        "while (offset < total_len) {\n    ...\n    offset += pkt_len;\n    packets++;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c while (offset < total_len) { ... offset += pkt_len; packets++; } ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-533",
    "title": "Connection Lookup with Variable-Length DCID for Reset Check",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c u8 dcid_len = min_t(size_t, len - 1, TQUIC_MAX_CID_LEN); conn = tquic_lookup_by_dcid(data + 1, dcid_len); ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_udp_recv"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:2924-2924",
        "net/quic/tquic/tquic_input.c:2923-2925"
      ],
      "snippets": [
        "u8 dcid_len = min_t(size_t, len - 1, TQUIC_MAX_CID_LEN);\nconn = tquic_lookup_by_dcid(data + 1, dcid_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c u8 dcid_len = min_t(size_t, len - 1, TQUIC_MAX_CID_LEN); conn = tquic_lookup_by_dcid(data + 1, dcid_len); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-534",
    "title": "Anti-Amplification Overflow",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;  /* received * 3 */ ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c",
        "net/quic/tquic/tquic_migration.c"
      ],
      "symbols": [
        "lock_sock",
        "copy_from_sockptr",
        "tquic_sock_setsockopt"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:95-95",
        "net/quic/tquic/tquic_socket.c:95-95",
        "net/quic/tquic/tquic_socket.c:2841-2854",
        "net/quic/tquic/tquic_socket.c:726-726"
      ],
      "snippets": [
        "limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;  /* received * 3 */",
        "if (vlen > 0 &&\n    tlen <= TQUIC_MAX_TOKEN_LEN &&\n    (size_t)vlen <= len - offset &&\n    tlen <= len - offset - vlen)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c limit = received * TQUIC_ANTI_AMPLIFICATION_LIMIT;  /* received * 3 */ ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-535",
    "title": "TQUIC_IDLE_TIMEOUT Missing Range Validation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c case TQUIC_IDLE_TIMEOUT: if (tsk->conn) tsk->conn->idle_timeout = val; break; ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:768-768",
        "net/quic/tquic/tquic_socket.c:768-768"
      ],
      "snippets": [
        "case TQUIC_IDLE_TIMEOUT:\n    if (tsk->conn)\n        tsk->conn->idle_timeout = val;\n    break;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c case TQUIC_IDLE_TIMEOUT: if (tsk->conn) tsk->conn->idle_timeout = val; break; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-536",
    "title": "TQUIC_PSK_IDENTITY Off-by-One Potential",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c if (optlen < 1 || optlen > 64) return -EINVAL; copy_from_sockptr(identity, optval, optlen); lock_sock(sk); memcpy(tsk->psk_identity, identity, optlen); tsk->psk_identity_len = optlen; ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:942-942",
        "net/quic/tquic/tquic_socket.c:942-951"
      ],
      "snippets": [
        "if (optlen < 1 || optlen > 64)\n    return -EINVAL;\ncopy_from_sockptr(identity, optval, optlen);\nlock_sock(sk);\nmemcpy(tsk->psk_identity, identity, optlen);\ntsk->psk_identity_len = optlen;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c if (optlen < 1 || optlen > 64) return -EINVAL; copy_from_sockptr(identity, optval, optlen); lock_sock(sk); memcpy(tsk->psk_identity, identity, optlen); tsk->psk_identity_len = optlen; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-537",
    "title": "TQUIC_SCHEDULER Race on tquic_sched_find",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c rcu_read_lock(); if (!tquic_sched_find(name)) { rcu_read_unlock(); return -ENOENT; } rcu_read_unlock();",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_sched_ops",
        "rcu_read_lock",
        "rcu_read_unlock",
        "tquic_sock_getsockopt",
        "tquic_sock_ioctl"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:848-848",
        "net/quic/tquic/tquic_socket.c:848-872",
        "net/quic/tquic/tquic_socket.c:1307-1307",
        "net/quic/tquic/tquic_socket.c:656-656"
      ],
      "snippets": [
        "rcu_read_lock();\nif (!tquic_sched_find(name)) {\n    rcu_read_unlock();\n    return -ENOENT;\n}\nrcu_read_unlock();\n\nlock_sock(sk);\n/* ... */\nstruct tquic_sched_ops *sched_ops = tquic_sched_find(name);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c rcu_read_lock(); if (!tquic_sched_find(name)) { rcu_read_unlock(); return -ENOENT; } rcu_read_unlock();",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-538",
    "title": "TQUIC_NEW_STREAM Missing Reserved Field Zeroing Check",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c if (args.flags > TQUIC_STREAM_UNIDI || args.reserved != 0) return -EINVAL; ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [
        "tquic_conn_get"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_stream.c:680-680"
      ],
      "snippets": [
        "if (args.flags > TQUIC_STREAM_UNIDI || args.reserved != 0)\n    return -EINVAL;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c if (args.flags > TQUIC_STREAM_UNIDI || args.reserved != 0) return -EINVAL; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-539",
    "title": "conn->data_sent Underflow on Error Path",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c spin_lock_bh(&conn->lock); conn->data_sent -= (len - copied); spin_unlock_bh(&conn->lock); ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_netlink.c:1008-1015",
        "net/quic/tquic/tquic_netlink.c:993-993",
        "net/quic/tquic/tquic_netlink.c:699-699",
        "net/quic/tquic/tquic_netlink.c:603-603"
      ],
      "snippets": [
        "spin_lock_bh(&conn->lock);\nconn->data_sent -= (len - copied);\nspin_unlock_bh(&conn->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c spin_lock_bh(&conn->lock); conn->data_sent -= (len - copied); spin_unlock_bh(&conn->lock); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-540",
    "title": "Multicast Group Only Requires CAP_NET_ADMIN",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The event multicast group uses `GENL_MCAST_CAP_NET_ADMIN`, which is correct -- only privileged users can subscribe to connection state change events that could leak connection metadata.",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_cid_security_check_new_cid",
        "tquic_process_new_connection_id_frame"
      ],
      "line_ranges": [
        ":274-274",
        ":1001-1053",
        ":865-865",
        ":1116-1116",
        ":1145-1145"
      ],
      "snippets": [
        "ctx->conn->max_data_remote = max(ctx->conn->max_data_remote, max_data);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The event multicast group uses `GENL_MCAST_CAP_NET_ADMIN`, which is correct -- only privileged users can subscribe to connection state change events that could leak connection metadata.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-01. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-541",
    "title": "Retire Prior To Not Validated Against Sequence Number",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "In `tquic_process_new_connection_id_frame()` (tquic_input.c), there is no check that `retire_prior_to <= seq_num`. The frame parser in `core/frame.c` (line 1045) does check this, but the separate inpu",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_retire_connection_id_frame",
        "tquic_process_new_connection_id_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1045-1045",
        "net/quic/tquic/tquic_input.c:1126-1138",
        "net/quic/tquic/tquic_input.c:1138-1138",
        "net/quic/tquic/tquic_input.c:1188-1188"
      ],
      "snippets": [
        "if (retire_prior_to > seq_num) return -EPROTO;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "In `tquic_process_new_connection_id_frame()` (tquic_input.c), there is no check that `retire_prior_to <= seq_num`. The frame parser in `core/frame.c` (line 1045) does check this, but the separate input path parser in tquic_input.c does NOT. This means the input path will accept an invalid `retire_pr",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: HIGH-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-542",
    "title": "No Validation of Retired Sequence Number",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "The function decodes `seq_num` but does not validate it against the maximum sequence number ever issued by this endpoint. Per RFC 9000 Section 19.16: \"An endpoint that receives a RETIRE_CONNECTION_ID ",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_retire_connection_id_frame",
        "tquic_path_handle_challenge",
        "tquic_path_handle_response"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1195-1195",
        "net/quic/tquic/tquic_input.c:1188-1207",
        "net/quic/tquic/tquic_input.c:1066-1066"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The function decodes `seq_num` but does not validate it against the maximum sequence number ever issued by this endpoint. Per RFC 9000 Section 19.16: \"An endpoint that receives a RETIRE_CONNECTION_ID frame containing a sequence number greater than any previously sent to the peer MUST treat this as a",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-543",
    "title": "No ACK Frame Frequency Limit Per Packet",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "A single packet can contain multiple ACK frames. The processing loop does not track whether an ACK frame was already processed in this packet. A malicious peer could pack a packet with hundreds of ACK",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_frames",
        "tquic_process_datagram_frame",
        "tquic_process_connection_close_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1900-1914",
        "net/quic/tquic/tquic_input.c:1871-2060",
        "net/quic/tquic/tquic_input.c:1391-1391",
        "net/quic/tquic/tquic_input.c:1212-1212"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "A single packet can contain multiple ACK frames. The processing loop does not track whether an ACK frame was already processed in this packet. A malicious peer could pack a packet with hundreds of ACK frames, each with 256 ranges.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: HIGH-05. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-544",
    "title": "Reason Length Underflow on 32-bit",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "```c if (reason_len > ctx->len - ctx->offset) return -EINVAL; ctx->offset += (size_t)reason_len; ```",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":1248-1248"
      ],
      "snippets": [
        "if (reason_len > ctx->len - ctx->offset)\n    return -EINVAL;\nctx->offset += (size_t)reason_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c if (reason_len > ctx->len - ctx->offset) return -EINVAL; ctx->offset += (size_t)reason_len; ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-06. Note: file paths not explicitly specified in finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-545",
    "title": "MP Frame Type Range Check Too Broad",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "```c return (frame_type >= 0x15c0 && frame_type <= 0x15cff); ```",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1623-1623",
        "net/quic/tquic/tquic_input.c:1652-1652",
        "net/quic/tquic/tquic_input.c:1623-1623",
        "net/quic/tquic/tquic_input.c:1292-1292",
        "net/quic/tquic/tquic_input.c:1886-2039"
      ],
      "snippets": [
        "return (frame_type >= 0x15c0 && frame_type <= 0x15cff);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "```c return (frame_type >= 0x15c0 && frame_type <= 0x15cff); ```",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: MEDIUM-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-546",
    "title": "Potential Deadlock Between paths_lock and conn->lock",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "The code uses multiple locks: - `conn->lock` - protects connection state - `conn->paths_lock` - protects path list - `conn->streams_lock` - protects stream tree",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_process_stream_frame",
        "tquic_find_path_by_addr",
        "tquic_process_max_data_frame"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:1015-1015",
        "net/quic/tquic/tquic_input.c:917-917",
        "net/quic/tquic/tquic_input.c:251-251",
        "net/quic/tquic/tquic_input.c:245-245",
        "net/quic/tquic/tquic_input.c:245-261"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The code uses multiple locks: - `conn->lock` - protects connection state - `conn->paths_lock` - protects path list - `conn->streams_lock` - protects stream tree",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: CRITICAL-07. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-547",
    "title": "Debug Logging of Packet Contents",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "Functions like `tquic_dbg()` throughout the input path log frame types, stream IDs, packet numbers, and other protocol metadata. While these are `pr_debug` level and disabled by default, if enabled (e",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_dbg"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "Functions like `tquic_dbg()` throughout the input path log frame types, stream IDs, packet numbers, and other protocol metadata. While these are `pr_debug` level and disabled by default, if enabled (e.g., via dyndbg), they could leak sensitive information to dmesg which may be readable by non-root u",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-02. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-548",
    "title": "Error Codes Leak Processing State",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The error returns from frame processing (e.g., `-EPROTO` vs `-EINVAL`) allow an attacker to distinguish between \"frame too short\" and \"frame semantically invalid,\" potentially aiding protocol fuzzing.",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The error returns from frame processing (e.g., `-EPROTO` vs `-EINVAL`) allow an attacker to distinguish between \"frame too short\" and \"frame semantically invalid,\" potentially aiding protocol fuzzing.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-03. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-549",
    "title": "No Per-Connection Frame Processing Budget",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The `tquic_process_frames()` loop has no CPU budget. A single large packet filled with valid but useless frames (e.g., interleaved PADDING and PING) could consume excessive CPU in softirq context.",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_process_frames"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The `tquic_process_frames()` loop has no CPU budget. A single large packet filled with valid but useless frames (e.g., interleaved PADDING and PING) could consume excessive CPU in softirq context.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-04. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-550",
    "title": "Stream Creation Not Bounded in Input Path",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "`tquic_stream_open_incoming()` (line 938) creates new streams on receiving STREAM frames for unknown stream IDs. The MAX_STREAMS check is delegated to this function. If the check is missing or too len",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_stream_open_incoming"
      ],
      "line_ranges": [
        ":938-938"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "`tquic_stream_open_incoming()` (line 938) creates new streams on receiving STREAM frames for unknown stream IDs. The MAX_STREAMS check is delegated to this function. If the check is missing or too lenient, an attacker could create thousands of streams with a single packet containing many STREAM fram",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-05. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-551",
    "title": "Stateless Reset Token Comparison Timing",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The stateless reset detection in `tquic_is_stateless_reset_internal()` delegates to `tquic_stateless_reset_detect_conn()`. The timing safety of the token comparison depends on the implementation of th",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "crypto_memneq",
        "tquic_is_stateless_reset_internal",
        "check_add_overflow",
        "FRAME_ADVANCE_SAFE",
        "tquic_stateless_reset_detect_conn"
      ],
      "line_ranges": [
        ":980-980"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The stateless reset detection in `tquic_is_stateless_reset_internal()` delegates to `tquic_stateless_reset_detect_conn()`. The timing safety of the token comparison depends on the implementation of that function -- it should use `crypto_memneq()` for constant-time comparison. Without examining that ",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INPUT_VALIDATION_AUDIT.md. Original finding ID: LOW-06. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-552",
    "title": "GSO SKB Allocation Multiplication Overflow",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Line:** 1489",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "gso->gso_skb = alloc_skb(gso->gso_size * max_segs + MAX_HEADER, GFP_ATOMIC);",
        "size_t alloc_size;\nif (check_mul_overflow((size_t)gso->gso_size, (size_t)max_segs, &alloc_size) ||\n    check_add_overflow(alloc_size, (size_t)MAX_HEADER, &alloc_size))\n    return -EOVERFLOW;\ngso->gso_skb = alloc_skb(alloc_size, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Line:** 1489",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: C-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-553",
    "title": "Capsule Buffer Size Addition Overflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/capsule.c` **Lines:** 850, 894",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/masque/capsule.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/masque/capsule.c:850-850",
        "net/quic/tquic/masque/capsule.c:894-894"
      ],
      "snippets": [
        "buf_len = CAPSULE_MAX_HEADER_SIZE + cap->length;      /* line 850 */\nbuf_len = CAPSULE_MAX_HEADER_SIZE + payload_len;       /* line 894 */",
        "if (cap->length > SIZE_MAX - CAPSULE_MAX_HEADER_SIZE)\n    return -EOVERFLOW;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/capsule.c` **Lines:** 850, 894",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: C-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-554",
    "title": "Transcript Buffer Reallocation Doubling Overflow",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/handshake.c` **Line:** 849",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/handshake.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/crypto/handshake.c:842-842",
        "net/quic/tquic/crypto/handshake.c:849-849",
        "net/quic/tquic/crypto/handshake.c:859-859"
      ],
      "snippets": [
        "u32 new_alloc = max(new_len * 2, 4096U);",
        "u32 new_alloc;\nif (check_mul_overflow(new_len, 2U, &new_alloc))\n    new_alloc = TQUIC_MAX_TRANSCRIPT_SIZE;\nnew_alloc = max(new_alloc, 4096U);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/handshake.c` **Line:** 849",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: C-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-555",
    "title": "Rate Calculation Integer Overflow",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/rate_limit.c` **Line:** 604",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/rate_limit.c",
        "net/quic/tquic/tquic_ratelimit.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "count = atomic_xchg(&state->rate_window_count, 0);\nrate = (count * 1000) / elapsed_ms;",
        "count = atomic_xchg(&state->rate_window_count, 0);\nrate = (count * 1000) / elapsed_ms;",
        "rate = (u64)count * 1000 / elapsed_ms;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/rate_limit.c` **Line:** 604",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: C-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-556",
    "title": "PTO Duration Exponential Shift Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Line:** 1003",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pto_duration *= (1 << rs->pto_count);",
        "u32 shift = min_t(u32, rs->pto_count, 30);\npto_duration *= (1ULL << shift);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Line:** 1003",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-557",
    "title": "Prague Congestion Control: `ecn_ce_count * mss` Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/prague.c` **Line:** 293",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/cong/prague.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ce_bytes = ecn_ce_count * mss;",
        "ecn_ce_count = min_t(u64, ecn_ce_count, U32_MAX);\nce_bytes = ecn_ce_count * mss;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/prague.c` **Line:** 293",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-558",
    "title": "BBRv2 Inflight Calculation Truncation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/bbrv2.c` **Line:** 187-189",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/cong/bbrv2.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "inflight = bbr_bdp(bbr);\ninflight = (inflight * gain) >> BBR_SCALE;\nreturn max((u32)inflight, (u32)(BBR_MIN_CWND * mss));",
        "return (u32)min_t(u64, inflight, U32_MAX);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/bbrv2.c` **Line:** 187-189",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-559",
    "title": "FEC Scheduler Loss Rate Overflow",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_scheduler.c` **Line:** 109",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "new_rate = (sched->loss_count * 1000) / sched->packet_count;",
        "new_rate = (u32)((u64)sched->loss_count * 1000 / sched->packet_count);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_scheduler.c` **Line:** 109",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-560",
    "title": "FEC Repair Count Computation: `block_size * target_fec_rate` Truncation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_scheduler.c` **Line:** 455",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "repair_count = ((u32)block_size * sched->target_fec_rate + 99) / 100;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_scheduler.c` **Line:** 455",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-561",
    "title": "`quic_offload.c` Version Field Shift Without Cast",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/quic_offload.c` **Line:** 167-168",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/quic_offload.c",
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/quic_offload.c:429-429",
        "net/quic/tquic/quic_offload.c:474-475"
      ],
      "snippets": [
        "version = (data[1] << 24) | (data[2] << 16) | (data[3] << 8) | data[4];",
        "version = ((u32)data[1] << 24) | ((u32)data[2] << 16) |\n          ((u32)data[3] << 8) | data[4];"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/quic_offload.c` **Line:** 167-168",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: H-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-562",
    "title": "Potential 32-bit Truncation in Stream Frame `alloc_skb`",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Line:** 944",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:909-909",
        "net/quic/tquic/tquic_input.c:909-909"
      ],
      "snippets": [
        "data_skb = alloc_skb(length, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Line:** 944",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-563",
    "title": "`tquic_proc.c` Buffer Overflow in Hex CID Formatting",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Lines:** 416-417",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_proc.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_proc.c:414-414",
        "net/quic/tquic/tquic_proc.c:604-604",
        "net/quic/tquic/tquic_proc.c:207-207"
      ],
      "snippets": [
        "for (i = 0; i < scid_len; i++)\n    sprintf(&scid_hex[i * 2], \"%02x\", conn->scid.id[i]);\nscid_hex[scid_len * 2] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Lines:** 416-417",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-564",
    "title": "`tquic_cong.c` ECN Byte Calculation Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/tquic_cong.c` **Line:** 1181",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/cong/tquic_cong.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 ecn_bytes = ecn_ce_count * 1200;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/tquic_cong.c` **Line:** 1181",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-565",
    "title": "`quic_packet.c` ACK Range Count Estimation Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Line:** 1252",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/quic_packet.c:1248-1248"
      ],
      "snippets": [
        "estimated_min_bytes = (1 + ack_range_count * 2);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Line:** 1252",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-566",
    "title": "`transport_params.c` Memcpy with `count * sizeof(u32)` Without Overflow Check",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/transport_params.c` **Line:** 2527",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/transport_params.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/transport_params.c:2513-2513"
      ],
      "snippets": [
        "memcpy(params->version_info->available_versions, available,\n       count * sizeof(u32));"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/transport_params.c` **Line:** 2527",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-567",
    "title": "Pacing Rate Division by Potentially Small Value",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Line:** 1360",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1356-1356"
      ],
      "snippets": [
        "gap_ns = (u64)pkt_size * NSEC_PER_SEC / pacing->pacing_rate;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Line:** 1360",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-568",
    "title": "Signed/Unsigned Mismatch in Scheduler Queue Delay",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/sched/scheduler.c` **Line:** 454",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/sched/scheduler.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "u64 queue_delay = (skb->len * path->stats.rtt_smoothed) /"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/sched/scheduler.c` **Line:** 454",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-569",
    "title": "`bbrv3.c` CE Ratio Potential Division by Zero",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/bbrv3.c` **Line:** 439",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/cong/bbrv3.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ce_ratio = (ce_count * 100) / (bbr->ecn_ect_count + ce_count);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/cong/bbrv3.c` **Line:** 439",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-570",
    "title": "`http3_frame.c` Settings Frame Parser: No Bounds on `count`",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` **Lines:** 262, 285",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_frame.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (p->buf < end && count < max_entries) {\n    ...\n    entries_buf[count].id = id;\n    entries_buf[count].value = value;\n    count++;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_frame.c` **Lines:** 262, 285",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: M-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-571",
    "title": "Multiple Varint Implementations",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**Files:** - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/varint.c` (canonical) - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` line 171 (inline copy) - `/",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/extended_key_update.c",
        "net/quic/tquic/tquic_input.c",
        "net/quic/tquic/grease.c",
        "net/quic/tquic/http3/http3_frame.c",
        "net/quic/tquic/fec/fec_encoder.c",
        "net/quic/tquic/tquic_ack_frequency.c",
        "net/quic/tquic/tquic_token.c",
        "net/quic/tquic/tquic_output.c",
        "net/quic/tquic/http3/http3_stream.c",
        "net/quic/tquic/core/varint.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/crypto/extended_key_update.c:171-171",
        "net/quic/tquic/crypto/extended_key_update.c:49-131",
        "net/quic/tquic/crypto/extended_key_update.c:164-164",
        "net/quic/tquic/crypto/extended_key_update.c:106-183",
        "net/quic/tquic/crypto/extended_key_update.c:78-117"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/varint.c` (canonical) - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` line 171 (inline copy) - `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_ack_frequency.c` lines 49-131 - `/User",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: L-1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-572",
    "title": "`tquic_debug.c` CID Hex Loop Bound",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_debug.c` **Lines:** 207, 216",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_debug.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for (i = conn->scid.len * 2; i < 34; i++)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_debug.c` **Lines:** 207, 216",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: L-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-573",
    "title": "Stream ID Right-Shift Comparison",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Line:** 1250",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_stream.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if ((next_id >> 2) < max_streams)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_stream.c` **Line:** 1250",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: L-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-574",
    "title": "`bench_common.c` Variance Calculation",
    "category": "tests",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/bench_common.c` **Line:** 61",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bench/bench_common.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "double variance = (s->sum_sq - s->count * mean * mean) / (s->count - 1);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/bench_common.c` **Line:** 61",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: L-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-575",
    "title": "`bench_latency.c` Allocation Without Overflow Check",
    "category": "perf",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/tquic_bench_latency.c` **Line:** 216",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bench/tquic_bench_latency.c",
        "net/quic/tquic/cong/cong_data.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/bench/tquic_bench_latency.c:980-980",
        "net/quic/tquic/bench/tquic_bench_latency.c:840-840",
        "net/quic/tquic/bench/tquic_bench_latency.c:260-260",
        "net/quic/tquic/bench/tquic_bench_latency.c:276-276"
      ],
      "snippets": [
        "double *rtt_us = malloc(state->sample_count * sizeof(double));",
        "ret = tquic_decode_varint(ctx->data + ctx->offset,\n                          ctx->len - ctx->offset, &value);",
        "data->flags = (u8)val;      /* line 260 - val is u64 from varint */\ndata->loss_rate = (u32)val;  /* line 276 - val is u64 from varint */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/tquic_bench_latency.c` **Line:** 216",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_INTEGER_OVERFLOW_AUDIT.md. Original finding ID: L-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-576",
    "title": "List Iterator Invalidation in BPM Netdev Notifier",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "After dropping `pm->lock` and calling `tquic_bpm_path_set_state()`, another thread could remove or free `path` from the list. When the lock is reacquired, the `list_for_each_entry` macro continues using `path->list.next` which may point to freed memory. This is a **use-after-free** that can be triggered by concurrent netdev events.\n\nThe same pattern repeats for `NETDEV_CHANGE` at lines 1876-1898 with TWO separate unlock/relock windows inside the inner loop.",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [
        "rcu_read_unlock",
        "list_for_each_entry_safe",
        "tquic_bpm_path_set_state",
        "rcu_read_lock"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bpm.c:1876-1898"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_bpm.c` **Lines**: 1850-1898",
    "fix_suggestion": "Use `list_for_each_entry_safe()` is NOT sufficient here since the iteration continues after relock. Instead, collect paths to process into a separate list under the lock, then process them after releasing the lock.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: CRITICAL-1. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-577",
    "title": "TOCTOU Race in Failover Hysteresis",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "`READ_ONCE + 1 + WRITE_ONCE` is NOT atomic. Two concurrent timeout callbacks (from different timer expirations) could both read the same value and write the same incremented value, losing an increment. While individual increments being lost is not catastrophic, the combined pattern at lines 198-229 uses the result to make failover decisions:\n\n```c\nswitch (READ_ONCE(pt->hyst_state)) {        // Line 207\ncase TQUIC_PATH_HYST_DEGRADED:\n    if (READ_ONCE(pt->consec_failures) >= TQUIC_HYST_FAIL_THRES",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_failover.c"
      ],
      "symbols": [
        "atomic_set",
        "atomic_inc_return"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_failover.c:198-229",
        "net/quic/tquic/bond/tquic_failover.c:207-207",
        "net/quic/tquic/bond/tquic_failover.c:230-230",
        "net/quic/tquic/bond/tquic_failover.c:688-688"
      ],
      "snippets": [
        "WRITE_ONCE(pt->consec_failures, READ_ONCE(pt->consec_failures) + 1);\nWRITE_ONCE(pt->consec_successes, 0);",
        "switch (READ_ONCE(pt->hyst_state)) {        // Line 207\ncase TQUIC_PATH_HYST_DEGRADED:\n    if (READ_ONCE(pt->consec_failures) >= TQUIC_HYST_FAIL_THRESHOLD)\n        goto do_failover;                     // Line 230",
        "WRITE_ONCE(pt->consec_successes, READ_ONCE(pt->consec_successes) + 1);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_failover.c` **Line**: 198",
    "fix_suggestion": "Either protect these operations with a per-path spinlock, or use `atomic_inc_return()` / `atomic_set()` with `atomic_t` fields instead of plain integers + READ_ONCE/WRITE_ONCE.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: CRITICAL-2."
  },
  {
    "id": "F-578",
    "title": "Path Pointer Use After Lock Release",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines**: 245-261",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "sockaddr_storage",
        "tquic_path",
        "tquic_path_put",
        "tquic_connection"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:242-243",
        "net/quic/tquic/tquic_input.c:268-285"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines**: 245-261",
    "fix_suggestion": "Take a reference on the path before releasing the lock: `tquic_path_get(found)` and require callers to call `tquic_path_put()`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: CRITICAL-3. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-579",
    "title": "Nested Lock Hierarchy Violation in Timer Code",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "The lock ordering is `ts->lock -> pns->lock -> rs->lock` in `tquic_timer_update_pto`, but `pns->lock -> rs->lock` (without ts->lock) in `tquic_timer_detect_lost`. This is not a direct ordering violation, but the triple nesting combined with the fact that `tquic_timer_pto_expired` runs from timer softirq means that if any of these locks are also taken from process context with `_bh` disabled, a softirq deadlock can occur.\n\nAdditionally, at line 1628-1677:\n```c\nspin_lock_bh(&pns->lock);\n    list_f",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_timer.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_timer.c:975-1029",
        "net/quic/tquic/tquic_timer.c:820-870",
        "net/quic/tquic/tquic_timer.c:1628-1677",
        "net/quic/tquic/tquic_timer.c:1782-1782",
        "net/quic/tquic/tquic_timer.c:842-842"
      ],
      "snippets": [
        "// tquic_timer_pto_expired (timer callback, softirq context)\nspin_lock_bh(&ts->lock);           // Lock #1: ts->lock\n    spin_lock(&rs->lock);           // Lock #2: rs->lock (nested)\n    rs->pto_count++;\n    spin_unlock(&rs->lock);\nspin_unlock_bh(&ts->lock);",
        "spin_lock_bh(&ts->lock);           // Lock #1: ts->lock\n    for (i = 0; i < TQUIC_PN_SPACE_COUNT; i++) {\n        spin_lock(&pns->lock);      // Lock #2: pns->lock (nested)\n            spin_lock(&rs->lock);    // Lock #3: rs->lock (TRIPLE nested!)\n            spin_unlock(&rs->lock);\n        spin_unlo",
        "spin_lock_bh(&pns->lock);           // Lock pns FIRST\n    spin_lock(&rs->lock);            // Then rs\n    spin_unlock(&rs->lock);\nspin_unlock_bh(&pns->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_timer.c` **Lines**: 933-955",
    "fix_suggestion": "Standardize ALL uses of `rs->lock` and `pns->lock` to use `spin_lock_bh` / `spin_unlock_bh` consistently, since they are accessed from both timer/softirq context and process context.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: CRITICAL-4."
  },
  {
    "id": "F-580",
    "title": "Bonding State Machine Drop-Relock Without Re-validation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_bonding.c` **Lines**: 456-483",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [
        "tquic_bonding_destroy",
        "synchronize_rcu"
      ],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bonding.c:174-174"
      ],
      "snippets": [
        "spin_lock_bh(&bc->state_lock);\n    // ... state transition logic ...\n    if (new_state == TQUIC_BOND_SINGLE_PATH && bc->reorder) {\n        spin_unlock_bh(&bc->state_lock);     // DROP LOCK\n        tquic_bonding_free_reorder(bc);       // Calls synchronize_rcu()!\n        spin_lock_bh(&bc->state_lock)"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_bonding.c` **Lines**: 456-483",
    "fix_suggestion": "Add a \"destroying\" flag to `bc` checked after relock, or use refcounting on `bc`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-1."
  },
  {
    "id": "F-581",
    "title": "GRO Flush Unlock-Relock Loop Without Re-validation",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "Between `spin_unlock` (line 2306) and `spin_lock` (line 2309), `tquic_gro_receive_internal()` could add new packets and increment `gro->held_count`. After the loop finishes, `gro->held_count = 0` blindly resets the count, losing track of any packets added during the unlock window. Those packets will sit in the queue without being properly tracked.",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [
        "tquic_gro_receive_internal"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:2306-2306",
        "net/quic/tquic/tquic_input.c:2309-2309"
      ],
      "snippets": [
        "spin_lock(&gro->lock);\nwhile ((skb = __skb_dequeue(&gro->hold_queue)) != NULL) {\n    spin_unlock(&gro->lock);\n    deliver(skb);               // Arbitrary callback!\n    flushed++;\n    spin_lock(&gro->lock);     // New packets may have been added\n}\ngro->held_count = 0;           // Resets to 0, but n"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines**: 2303-2314",
    "fix_suggestion": "After the loop, set `gro->held_count = skb_queue_len(&gro->hold_queue)` instead of hard-coding 0.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-2."
  },
  {
    "id": "F-582",
    "title": "accept() Uses spin_lock_bh on sk_lock.slock While lock_sock() Is Held",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines**: 451-481",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [
        "lock_sock",
        "tquic_accept"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:562-562"
      ],
      "snippets": [
        "lock_sock(sk);\n// ...\nfor (;;) {\n    spin_lock_bh(&sk->sk_lock.slock);    // Takes the backing spinlock!\n    if (!list_empty(&tsk->accept_queue)) {\n        // ...\n        spin_unlock_bh(&sk->sk_lock.slock);\n        goto out_unlock;\n    }\n    spin_unlock_bh(&sk->sk_lock.slock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines**: 451-481",
    "fix_suggestion": "Remove the inner `spin_lock_bh(&sk->sk_lock.slock)` calls in `tquic_accept()`. The `lock_sock()` already provides sufficient serialization. If the accept queue needs to be accessed from softirq context, use a dedicated spinlock instead of the socket's backing slock.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-3."
  },
  {
    "id": "F-583",
    "title": "smartnic.c Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/offload/smartnic.c` **Lines**: 193, 232, 251, 278, 737, 830 (and more)",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/offload/smartnic.c` **Lines**: 193, 232, 251, 278, 737, 830 (and more)",
    "fix_suggestion": "Audit all call sites. If any are reachable from softirq context, change to `spin_lock_bh`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-4. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-584",
    "title": "http3_stream.c Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` **Lines**: 362, 435, 499, 555, 793, 888, 945, 985, 1024",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_stream.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_stream.c` **Lines**: 362, 435, 499, 555, 793, 888, 945, 985, 1024",
    "fix_suggestion": "Use `spin_lock_bh` consistently.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-5. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-585",
    "title": "Security Hardening Pre-HS Atomic TOCTOU",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/security_hardening.c` **Lines**: 255-289",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/security_hardening.c"
      ],
      "symbols": [
        "atomic_inc_return"
      ],
      "line_ranges": [
        "net/quic/tquic/security_hardening.c:280-280",
        "net/quic/tquic/security_hardening.c:289-289"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/security_hardening.c` **Lines**: 255-289",
    "fix_suggestion": "Use `atomic_inc_return()` and check the result instead of separate read + increment.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: HIGH-6. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-586",
    "title": "Error Ring Uses Atomics Under Spinlock Unnecessarily",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Lines**: 198-248",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_proc.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_proc.c:572-589"
      ],
      "snippets": [
        "spin_lock(&ring->lock);\nidx = atomic_read(&ring->head) & (TQUIC_ERROR_RING_SIZE - 1);\natomic_inc(&ring->head);\n\nif (atomic_read(&ring->count) < TQUIC_ERROR_RING_SIZE)\n    atomic_set(&ring->count, ...);\n// ...\nspin_unlock(&ring->lock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Lines**: 198-248",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: MEDIUM-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-587",
    "title": "FEC Encoder Triple-Nested Locking",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_encoder.c` **Lines**: 246-298, 434-486",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/fec/fec_encoder.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/fec/fec_encoder.c:576-576",
        "net/quic/tquic/fec/fec_encoder.c:576-576"
      ],
      "snippets": [
        "spin_lock_bh(&enc->lock);           // Outer lock\n    spin_lock(&block->lock);         // Inner lock (nested)\n    // ... operations ...\n    spin_unlock(&block->lock);\nspin_unlock_bh(&enc->lock);",
        "spin_lock(&block->lock);   // Line 576 -- no enc->lock held!"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/fec/fec_encoder.c` **Lines**: 246-298, 434-486",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: MEDIUM-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-588",
    "title": "poll() Accesses Connection/Stream Without Any Lock",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines**: 562-598",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (sk->sk_state == TCP_LISTEN) {\n    if (tsk->accept_queue_len > 0)      // No lock!\n        mask |= EPOLLIN | EPOLLRDNORM;\n} else if (sk->sk_state == TCP_ESTABLISHED) {\n    conn = READ_ONCE(tsk->conn);\n    stream = READ_ONCE(tsk->default_stream);\n\n    if (conn && stream) {\n        if (!skb_queue_e"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines**: 562-598",
    "fix_suggestion": "Use `READ_ONCE(tsk->accept_queue_len)`.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: MEDIUM-3."
  },
  {
    "id": "F-589",
    "title": "Coupled Congestion Control Division by Zero",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/cong_coupled.c` **Lines**: 941-943",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bond/cong_coupled.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/bond/cong_coupled.c:897-897",
        "net/quic/tquic/bond/cong_coupled.c:897-897",
        "net/quic/tquic/bond/cong_coupled.c:949-949"
      ],
      "snippets": [
        "spin_lock_bh(&ctx->lock);\n// ... ctx->total_cwnd checked != 0 at line 897 ...\nincrease = div64_u64(ctx->alpha * acked_bytes * mss,\n                     ctx->total_cwnd * COUPLED_ALPHA_SCALE);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/cong_coupled.c` **Lines**: 941-943",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: MEDIUM-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-590",
    "title": "rcu_dereference Outside Explicit RCU Section",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_udp.c` **Line**: 1271",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_udp.c"
      ],
      "symbols": [
        "sk_buff",
        "sock"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_udp.c:1303-1303"
      ],
      "snippets": [
        "static struct sk_buff *tquic_udp_gro_receive(struct sock *sk, ...)\n{\n    us = rcu_dereference_sk_user_data(sk);",
        "us = rcu_dereference_sk_user_data(sk);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_udp.c` **Line**: 1271",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: MEDIUM-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-591",
    "title": "Inconsistent Lock Variant for conn->lock in tquic_input.c",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines**: 1015, 1306, 1776",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines**: 1015, 1306, 1776",
    "fix_suggestion": "Add a comment explaining why `_bh` is not needed in the receive path.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: LOW-1. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-592",
    "title": "Scheduler Lock Uses spin_lock Without _bh",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/sched/scheduler.c` **Lines**: 39, 54, 179",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/sched/scheduler.c"
      ],
      "symbols": [
        "spin_lock"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/sched/scheduler.c` **Lines**: 39, 54, 179",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: LOW-2. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-593",
    "title": "Redundant Lock in tquic_bonding_get_state",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_bonding.c` **Lines**: 526, 899, 932",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bond/tquic_bonding.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/bond/tquic_bonding.c:526-526",
        "net/quic/tquic/bond/tquic_bonding.c:899-899"
      ],
      "snippets": [
        "return READ_ONCE(bc->state);   // Line 526 -- lockless read\n// ...\nif (READ_ONCE(bc->state) == TQUIC_BOND_SINGLE_PATH)   // Line 899"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File**: `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bond/tquic_bonding.c` **Lines**: 526, 899, 932",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: LOW-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-594",
    "title": "Missing lockdep Annotations",
    "category": "concurrency",
    "severity": "S3",
    "confidence": "medium",
    "impact": "The codebase does not use `lockdep_assert_held()` or lock class annotations (`lock_set_class()`, `lock_set_subclass()`). Adding these would catch lock ordering violations at runtime during testing.",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "lockdep_assert_held",
        "lock_set_subclass",
        "lock_set_class"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "The codebase does not use `lockdep_assert_held()` or lock class annotations (`lock_set_class()`, `lock_set_subclass()`). Adding these would catch lock ordering violations at runtime during testing.",
    "fix_suggestion": "Add `lockdep_assert_held(&conn->lock)` at the beginning of functions that require `conn->lock` to be held.",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_LOCKING_AUDIT.md. Original finding ID: LOW-4. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding."
  },
  {
    "id": "F-595",
    "title": "GSO Segment Accumulation Can Overflow SKB Tailroom",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1505-1521",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [
        "tquic_gso_ctx"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:1487-1487"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1505-1521",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-1. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-596",
    "title": "Slab Cache Decryption Buffer May Be Too Small for Payload",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines:** 2585-2589",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_input.c:49-49",
        "net/quic/tquic/tquic_input.c:2618-2618"
      ],
      "snippets": [
        "if (likely(payload_len <= TQUIC_RX_BUF_SIZE)) {\n    decrypted = kmem_cache_alloc(tquic_rx_buf_cache, GFP_ATOMIC);\n    decrypted_from_slab = true;\n} else {\n    decrypted = kmalloc(payload_len, GFP_ATOMIC);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines:** 2585-2589",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-597",
    "title": "Stream Data Delivery Uses u64 Length with u32 alloc_skb",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 226-251",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [
        "tquic_stream"
      ],
      "line_ranges": [
        "net/quic/tquic/core/quic_packet.c:1198-1198"
      ],
      "snippets": [
        "static void quic_packet_deliver_stream_data(struct tquic_stream *stream, u64 offset,\n                                            const u8 *data, u64 len, bool fin)\n{\n    if (!stream || !data || len == 0)\n        return;\n\n    if (len > U32_MAX)\n        return;\n\n    skb = alloc_skb((unsigned int)len, "
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 226-251",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-598",
    "title": "Missing SKB Tailroom Check in Coalesced Packet Output",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1919-1922 and 1986-1989",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (header_len > 0)\n    skb_put_data(skb, header, header_len);\n\nskb_put_data(skb, buf_stack, ctx.offset);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 1919-1922 and 1986-1989",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-599",
    "title": "quic_packet.c Stream Frame - Uncapped Stream Creation",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 1172-1176",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/core/quic_packet.c:158-158",
        "net/quic/tquic/core/quic_packet.c:938-938"
      ],
      "snippets": [
        "stream = tquic_stream_lookup_internal(conn, stream_id);\nif (!stream) {\n    stream = tquic_stream_create_internal(conn, stream_id);\n    if (!stream)\n        return -ENOMEM;\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 1172-1176",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-5. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-600",
    "title": "Recursive Coalesced Packet Processing - Stack Exhaustion",
    "category": "correctness",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 736-738",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/core/quic_packet.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "/* Process any remaining coalesced packets */\nif (next_skb)\n    return tquic_packet_process(conn, next_skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/core/quic_packet.c` **Lines:** 736-738",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: C-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-601",
    "title": "qlog TOCTOU Race Between Length Check and copy_to_user",
    "category": "concurrency",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/diag/qlog.c` **Lines:** 1237-1254",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "while (tail != head && total < count) {\n    ...\n    json_len = tquic_qlog_emit_json(qlog, entry, json_buf, 1024);\n    ...\n    if (total + json_len > count)\n        break;\n\n    spin_unlock_irqrestore(&qlog->lock, flags);\n\n    if (copy_to_user(buf + total, json_buf, json_len)) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/diag/qlog.c` **Lines:** 1237-1254",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-602",
    "title": "copy_from_user with User-Controlled Size in Socket Options",
    "category": "api",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 840-844",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "case TQUIC_SCHEDULER: {\n    char name[TQUIC_SCHED_NAME_MAX];\n    ...\n    if (optlen < 1 || optlen >= TQUIC_SCHED_NAME_MAX)\n        return -EINVAL;\n\n    if (copy_from_sockptr(name, optval, optlen))\n        return -EFAULT;\n    name[optlen] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 840-844",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-603",
    "title": "getsockopt PSK Identity - Missing Length Validation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1474-1487",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:1317-1317"
      ],
      "snippets": [
        "if (copy_to_user(optval, tsk->psk_identity, identity_len)) {\n    ...\n}\nif (put_user(identity_len, optlen))"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1474-1487",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-604",
    "title": "getsockopt Hostname - Same Missing Length Check",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1744-1750",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (copy_to_user(optval, hostname, hostname_len)) {\n    ...\n}\nif (put_user(hostname_len, optlen))"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1744-1750",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-605",
    "title": "ALPN Name getsockopt - Same Pattern",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1411-1413 and 1446-1448",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 1411-1413 and 1446-1448",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-606",
    "title": "Netfilter Short Header DCID Parsing Uses Arbitrary Length",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_nf.c` **Lines:** 365-369",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_nf.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "info->dcid.len = 8;\nif (len < info->dcid.len)\n    info->dcid.len = len;\nmemcpy(info->dcid.id, p, info->dcid.len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_nf.c` **Lines:** 365-369",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-607",
    "title": "tquic_output.c Payload Buffer Size Calculation",
    "category": "correctness",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 993-999",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_output.c:981-981"
      ],
      "snippets": [
        "payload_buf = skb_put(skb, max_payload + 16);\n\nctx.buf_len = max_payload - 128 - 16;  /* room for header + tag */"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 993-999",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-608",
    "title": "Zero-RTT Session Ticket Deserialization Trusts Length Fields",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/zero_rtt.c` **Lines:** 1164-1207",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/zero_rtt.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/crypto/zero_rtt.c:1140-1160"
      ],
      "snippets": [
        "memcpy(out->psk, p, out->psk_len);\n...\nmemcpy(out->alpn, p, out->alpn_len);\n...\nmemcpy(out->transport_params, p, out->transport_params_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/zero_rtt.c` **Lines:** 1164-1207",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: H-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-609",
    "title": "snprintf Return Value Not Checked in qlog.c",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/diag/qlog.c` **Lines:** 913-1103",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/diag/qlog.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "len = snprintf(buf, buflen, ...);     // Returns 1500 if buflen is 1024\nlen += snprintf(buf + len, buflen - len, ...);  // buflen - len underflows!"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/diag/qlog.c` **Lines:** 913-1103",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-1. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-610",
    "title": "connect_ip.c Datagram Buffer Allocation from Attacker Data",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/connect_ip.c` **Lines:** 1157-1162",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_ip.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "datagram_len = context_id_size + skb->len;\n\nif (datagram_len > conn->datagram.max_send_size)\n    return -EMSGSIZE;\n\ndatagram_buf = kmalloc(datagram_len, GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/connect_ip.c` **Lines:** 1157-1162",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-611",
    "title": "cert_verify.c - kmalloc(count + 1) Integer Overflow",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/cert_verify.c` **Lines:** 2782-2790",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/crypto/cert_verify.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (count > TQUIC_MAX_CERT_SIZE)\n    return -EINVAL;\n\nkbuf = kmalloc(count + 1, GFP_KERNEL);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/crypto/cert_verify.c` **Lines:** 2782-2790",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-612",
    "title": "Benchmark write() Handler - Stack Buffer for User Input",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/benchmark.c` **Lines:** 901-918",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/bench/benchmark.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "char cmd[64];\n...\nif (count >= sizeof(cmd))\n    return -EINVAL;\n\nif (copy_from_user(cmd, buf, count))\n    return -EFAULT;\n\ncmd[count] = '\\0';"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/bench/benchmark.c` **Lines:** 901-918",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-4. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-613",
    "title": "Interop Framework - Same Pattern",
    "category": "tests",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/test/interop/interop_framework.c` **Lines:** 982",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/test/interop/interop_framework.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/test/interop/interop_framework.c` **Lines:** 982",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-614",
    "title": "tquic_proc.c - snprintf for SCID Hex Without Bounds Check",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Line:** 600",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_proc.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "snprintf(scid_hex + i * 2, 3, \"%02x\", entry->scid[i]);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_proc.c` **Line:** 600",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-615",
    "title": "smartnic.c - kmalloc_array with Attacker-Influenced Count",
    "category": "concurrency",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/offload/smartnic.c` **Lines:** 646, 697",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/offload/smartnic.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pns = kmalloc_array(count, sizeof(u64), GFP_ATOMIC);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/offload/smartnic.c` **Lines:** 646, 697",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-616",
    "title": "tquic_output.c - CRYPTO Frame Output Without Tailroom Check",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 2318-2321",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "skb_put_data(send_skb, frame_hdr, hdr_len);\nskb_put_data(send_skb, crypto_skb->data, data_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_output.c` **Lines:** 2318-2321",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-8. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-617",
    "title": "http3_priority.c snprintf Priority Field Truncation",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_priority.c` **Lines:** 805-811",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/http3/http3_priority.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "written = snprintf(buf, buf_len, \"u=%u\", priority->urgency);\n...\nint added = snprintf(buf + written, buf_len - written, \", i\");"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/http3/http3_priority.c` **Lines:** 805-811",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-618",
    "title": "connect_udp.c URL Encoding Can Exceed Buffer",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/connect_udp.c` **Lines:** 254-266",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "snprintf(p, remaining, \"%%%02X\", (u8)*src);\n...\nwritten = snprintf(p, remaining, \"/%u/\", port);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/masque/connect_udp.c` **Lines:** 254-266",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-619",
    "title": "Multiple getsockopt Handlers Copy Fixed Structs Without Size Check",
    "category": "correctness",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c`",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/quic/tquic/tquic_socket.c:1334-1334"
      ],
      "snippets": [
        "if (copy_to_user(optval, &info, sizeof(info)))\n    return -EFAULT;\nif (put_user(sizeof(info), optlen))\n    return -EFAULT;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: M-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-620",
    "title": "memzero_explicit Used Correctly for Key Material",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**Files:** `tquic_retry.c` lines 471, 478, 518, 579, 586, 623; `tquic_token.c` line 578",
    "evidence": {
      "file_paths": [],
      "symbols": [],
      "line_ranges": [
        ":471-471",
        ":578-578"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**Files:** `tquic_retry.c` lines 471, 478, 518, 579, 586, 623; `tquic_token.c` line 578",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-1. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-621",
    "title": "Constant-Time Comparison Used for Integrity Tags",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Line:** 375",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "return crypto_memneq(computed_tag, received_tag,\n                     TQUIC_RETRY_INTEGRITY_TAG_LEN) == 0;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Line:** 375",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-2. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-622",
    "title": "tquic_retry_rate_limit Potential Token Bucket Underflow",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Lines:** 136-141",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_retry.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "refill = (elapsed_ms / TQUIC_RETRY_RATE_LIMIT_REFILL_MS) *\n         TQUIC_RETRY_RATE_LIMIT_REFILL_AMOUNT;\ntquic_retry_rate_tokens = min_t(u32,\n                                tquic_retry_rate_tokens + refill,\n                                TQUIC_RETRY_RATE_LIMIT_TOKENS);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_retry.c` **Lines:** 136-141",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-3. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-623",
    "title": "nla_put Operations in Netlink Properly Handle Failure",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_netlink.c` **Lines:** 472-510",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_netlink.c` **Lines:** 472-510",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-4. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-624",
    "title": "copy_from_sockptr in setsockopt Always Uses sizeof",
    "category": "api",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 676, 739, 786, 809",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_socket.c` **Lines:** 676, 739, 786, 809",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-5. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-625",
    "title": "Version Negotiation Response - dcid/scid_len Not Capped",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines:** 513-538",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_input.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pkt_len = 7 + dcid_len + scid_len + sizeof(supported_versions);\n...\nmemcpy(p, scid, scid_len);\n...\nmemcpy(p, dcid, dcid_len);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_input.c` **Lines:** 513-538",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-6. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-626",
    "title": "quic_exfil.c Decoy Packet Size Controlled by MTU",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/security/quic_exfil.c` **Lines:** 519-530",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/security/quic_exfil.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "decoy_size = 64 + (rand_val % (shaper->mtu - 64 + 1));\n...\nmemset(skb_put(skb, decoy_size), 0x00, decoy_size);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/security/quic_exfil.c` **Lines:** 519-530",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-7. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-627",
    "title": "io_uring.c getsockopt Same len Validation Pattern",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/io_uring.c` **Lines:** 1203-1225",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/io_uring.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/io_uring.c` **Lines:** 1203-1225",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-8. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-628",
    "title": "tquic_ipv6.c MTU Info getsockopt",
    "category": "correctness",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_ipv6.c` **Lines:** 705-707",
    "evidence": {
      "file_paths": [
        "net/quic/tquic/tquic_ipv6.c"
      ],
      "symbols": [
        "copies"
      ],
      "line_ranges": [
        "net/quic/tquic/tquic_ipv6.c:171-211",
        "net/quic/tquic/tquic_ipv6.c:226-227",
        "net/quic/tquic/tquic_ipv6.c:285-286",
        "net/quic/tquic/tquic_ipv6.c:267-268",
        "net/quic/tquic/tquic_ipv6.c:339-339"
      ],
      "snippets": [
        "if (copy_to_user(optval, &mtuinfo, sizeof(mtuinfo)))\n    return -EFAULT;\nif (put_user(sizeof(mtuinfo), optlen))\n    return -EFAULT;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/quic/tquic/tquic_ipv6.c` **Lines:** 705-707",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_MEMORY_BOUNDS_AUDIT.md. Original finding ID: L-9. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-629",
    "title": "Tunnel Socket Creation Uses init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Line:** 332",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "net",
        "should"
      ],
      "line_ranges": [],
      "snippets": [
        "err = sock_create_kern(&init_net, family, SOCK_STREAM, IPPROTO_TCP,\n                       &sock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Line:** 332",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-01. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-630",
    "title": "MASQUE CONNECT-UDP Proxy Creates Sockets in init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Line:** 459",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = sock_create_kern(&init_net, family, SOCK_DGRAM, IPPROTO_UDP, &sock);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` **Line:** 459",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-02. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-631",
    "title": "QUIC-over-TCP Client and Server Sockets Use init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/transport/quic_over_tcp.c` **Lines:** 1225, 1446",
    "evidence": {
      "file_paths": [
        "net/tquic/transport/quic_over_tcp.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/transport/quic_over_tcp.c:1225-1225",
        "net/tquic/transport/quic_over_tcp.c:1446-1446"
      ],
      "snippets": [
        "// Client socket (line 1225):\nret = sock_create_kern(&init_net, addr->sa_family, SOCK_STREAM,\n                       IPPROTO_TCP, &conn->tcp_sk);\n\n// Server listener (line 1446):\nret = sock_create_kern(&init_net, AF_INET6, SOCK_STREAM,\n                       IPPROTO_TCP, &listener->tcp_sk);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/transport/quic_over_tcp.c` **Lines:** 1225, 1446",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-03. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-632",
    "title": "AF_XDP Socket and Device Lookup Use init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c` **Lines:** 367, 1096, 1117",
    "evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c"
      ],
      "symbols": [
        "tquic_xsk_create"
      ],
      "line_ranges": [
        "net/tquic/af_xdp.c:367-367",
        "net/tquic/af_xdp.c:1096-1096",
        "net/tquic/af_xdp.c:300-300",
        "net/tquic/af_xdp.c:367-367",
        "net/tquic/af_xdp.c:1096-1096"
      ],
      "snippets": [
        "// Socket creation (line 367):\nerr = sock_create_kern(&init_net, AF_XDP, SOCK_RAW, 0, &xsk->sock);\n\n// Device lookup (line 1096 and 1117):\ndev = dev_get_by_name(&init_net, ifname);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c` **Lines:** 367, 1096, 1117",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-04. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-633",
    "title": "Netfilter Hooks Registered Only in init_net",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_nf.c` **Lines:** 800, 813, 839",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_nf.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = nf_register_net_hooks(&init_net, tquic_nf_hooks,\n                            ARRAY_SIZE(tquic_nf_hooks));\n\ntquic_nf_proc_entry = proc_create(\"tquic_conntrack\", 0444,\n                                   init_net.proc_net, &tquic_nf_proc_ops);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_nf.c` **Lines:** 800, 813, 839",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-05. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-634",
    "title": "IPv4/IPv6 Address Discovery Enumerates Host Interfaces",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` **Line:** 424",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_ipv6.c",
        "net/tquic/pm/path_manager.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "for_each_netdev(&init_net, dev) {",
        "for_each_netdev_rcu(&init_net, dev) {"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/pm/path_manager.c` **Line:** 424",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-06. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-635",
    "title": "ip_local_out Uses init_net for Packet Transmission",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Line:** 1730",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1681-1681"
      ],
      "snippets": [
        "ret = ip_local_out(&init_net, NULL, skb);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Line:** 1730",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-07. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-636",
    "title": "Route Lookup Fallback to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Line:** 1681",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_output.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_output.c:1714-1714"
      ],
      "snippets": [
        "rt = ip_route_output_key(net ?: &init_net, &fl4);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_output.c` **Line:** 1681",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-08. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-637",
    "title": "BPM Path Manager Falls Back to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` **Line:** 1005",
    "evidence": {
      "file_paths": [
        "net/tquic/bond/tquic_bpm.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "dev = dev_get_by_index_rcu(path->pm ? path->pm->net : &init_net, ifindex);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/bond/tquic_bpm.c` **Line:** 1005",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-09. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-638",
    "title": "Stateless Reset Falls Back to init_net",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Line:** 370",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_stateless_reset.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "net = sk ? sock_net(sk) : &init_net;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_stateless_reset.c` **Line:** 370",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-10. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-639",
    "title": "Security Hardening MIB Stats Always Go to init_net",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security_hardening.c` **Lines:** 848-860",
    "evidence": {
      "file_paths": [
        "net/tquic/security_hardening.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "TQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_PRE_HS_LIMIT);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_RETIRE_CID_FLOOD);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_NEW_CID_RATE_LIMIT);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_OPTIMISTIC_ACK);\nTQUIC_INC_STATS(&init_net, TQUIC_MIB_SEC_INVALID_ACK);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/security_hardening.c` **Lines:** 848-860",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-11. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-640",
    "title": "Sysctl and Proc Entries Registered in init_net Only",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_sysctl.c` **Line:** 2077",
    "evidence": {
      "file_paths": [
        "net/tquic/transport/tcp_fallback.c",
        "net/tquic/tquic_sysctl.c",
        "net/tquic/tquic_ratelimit.c",
        "net/tquic/cong/persistent_cong.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/transport/tcp_fallback.c:843-843",
        "net/tquic/transport/tcp_fallback.c:272-272",
        "net/tquic/transport/tcp_fallback.c:2077-2077"
      ],
      "snippets": [
        "tquic_sysctl_header = register_net_sysctl_sz(&init_net, \"net/tquic\", ...);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_sysctl.c` **Line:** 2077",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-12. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-641",
    "title": "Proc Entries Hardcoded to init_net.proc_net",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c` **Line:** 1071",
    "evidence": {
      "file_paths": [
        "net/tquic/crypto/cert_verify.c",
        "net/tquic/crypto/hw_offload.c",
        "net/tquic/napi.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "pde = proc_create(\"tquic_napi\", 0444, init_net.proc_net, ...);",
        "tquic_cert_proc_dir = proc_mkdir(\"tquic_cert\", init_net.proc_net);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/napi.c` **Line:** 1071",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-13. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-642",
    "title": "Diag/Tracepoints Initialize in init_net",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/tracepoints.c` **Lines:** 707, 718",
    "evidence": {
      "file_paths": [
        "net/tquic/diag/tracepoints.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "ret = tquic_path_metrics_init(&init_net);\n// ...\ntquic_path_metrics_exit(&init_net);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/diag/tracepoints.c` **Lines:** 707, 718",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-14. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-643",
    "title": "No Privilege Check for TQUIC Socket Creation",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_proto.c` **Lines:** 554-577 (proto_ops registration)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_proto.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_proto.c` **Lines:** 554-577 (proto_ops registration)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-15. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-644",
    "title": "No Privilege Checks for Security-Sensitive Socket Options",
    "category": "security",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 726-1300 (tquic_sock_setsockopt)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_socket.c:771-771",
        "net/tquic/tquic_socket.c:780-780",
        "net/tquic/tquic_socket.c:803-803",
        "net/tquic/tquic_socket.c:823-823",
        "net/tquic/tquic_socket.c:830-830"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` **Lines:** 726-1300 (tquic_sock_setsockopt)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-16. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-645",
    "title": "MASQUE Proxy Has No Access Control",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` (entire file)",
    "evidence": {
      "file_paths": [
        "net/tquic/masque/connect_udp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/masque/connect_udp.c` (entire file)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-17. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-646",
    "title": "Load Balancer Has No Privilege Checks",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/lb/quic_lb.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/lb/quic_lb.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/lb/quic_lb.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-18. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-647",
    "title": "Tunnel Creation Has Insufficient Privilege Checks",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 373-378",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (capable(CAP_NET_ADMIN)) {\n    tquic_err(\"IP_TRANSPARENT failed despite CAP_NET_ADMIN: %d\\n\", err);\n} else {\n    tquic_info(\"IP_TRANSPARENT requires CAP_NET_ADMIN, using normal mode\\n\");\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 373-378",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-19. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-648",
    "title": "Packet Forwarding Has No Privilege Checks",
    "category": "security",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_forward.c`",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_forward.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_forward.c`",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: HIGH-20. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-649",
    "title": "Sysctl Permissions Are Overly Permissive",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_sysctl.c` **Lines:** 842-938",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_sysctl.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_sysctl.c` **Lines:** 842-938",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-21. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-650",
    "title": "XDP Uses capable",
    "category": "security",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c` **Lines:** 296, 752, 950",
    "evidence": {
      "file_paths": [
        "net/tquic/af_xdp.c"
      ],
      "symbols": [],
      "line_ranges": [],
      "snippets": [
        "if (!capable(CAP_NET_ADMIN))\n    return -EPERM;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/af_xdp.c` **Lines:** 296, 752, 950",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: MEDIUM-22. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-651",
    "title": "Netlink Operations All Require GENL_ADMIN_PERM",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 1571-1617",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_netlink.c:274-274"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Lines:** 1571-1617",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: LOW-23. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-652",
    "title": "Netlink Correctly Uses sock_net for Namespace Scoping",
    "category": "security",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Line:** 985",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_netlink.c"
      ],
      "symbols": [
        "net"
      ],
      "line_ranges": [],
      "snippets": [
        "struct net *net = sock_net(skb->sk);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_netlink.c` **Line:** 985",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: LOW-24. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-653",
    "title": "No security_socket_* Hook Invocations",
    "category": "concurrency",
    "severity": "S0",
    "confidence": "high",
    "impact": "A grep for `security_socket` across the entire TQUIC codebase returns **zero results**.",
    "evidence": {
      "file_paths": [],
      "symbols": [
        "tquic_sock_bind",
        "security_socket_create",
        "sock_net",
        "tquic_sock_create",
        "security_socket_bind",
        "tquic_connect_socket",
        "security_socket_sendmsg",
        "security_socket_connect",
        "security_socket_recvmsg"
      ],
      "line_ranges": [],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "A grep for `security_socket` across the entire TQUIC codebase returns **zero results**.",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_NAMESPACE_PRIVILEGE_AUDIT.md. Original finding ID: CRITICAL-25. Note: file paths not explicitly specified in finding. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-654",
    "title": "UAF-P1-01: - SmartNIC tquic_nic_find() returns pointer without reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c` **Lines:** 271-288",
    "evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "tquic_offload_key_install",
        "tquic_offload_encrypt",
        "net_device",
        "tquic_nic_device",
        "tquic_nic_find",
        "tquic_nic_unregister",
        "tquic_offload_decrypt"
      ],
      "line_ranges": [
        "net/tquic/offload/smartnic.c:264-264",
        "net/tquic/offload/smartnic.c:300-300"
      ],
      "snippets": [
        "struct tquic_nic_device *tquic_nic_find(struct net_device *netdev)\n{\n    struct tquic_nic_device *dev;\n\n    spin_lock(&tquic_nic_lock);\n    list_for_each_entry(dev, &tquic_nic_devices, list) {\n        if (dev->netdev == netdev) {\n            spin_unlock(&tquic_nic_lock);  // <-- UNLOCK\n            r"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c` **Lines:** 271-288",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-655",
    "title": "UAF-P1-02: - tquic_diag.c accesses conn->sk without reference",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_diag.c` **Lines:** 153, 171, 235",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_diag.c"
      ],
      "symbols": [
        "tquic_net_close_connection",
        "refcount_inc_not_zero"
      ],
      "line_ranges": [
        "net/tquic/tquic_diag.c:153-153",
        "net/tquic/tquic_diag.c:1019-1019"
      ],
      "snippets": [
        "sk = conn->sk;          // line 153 -- no reference taken\nif (!sk || !net_eq(sock_net(sk), net))  // sk could be freed between these two lines\n    continue;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_diag.c` **Lines:** 153, 171, 235",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-656",
    "title": "UAF-P1-03: - conn->sk dereference in congestion control without locking",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Lines:** 83-84, 474-475, 589-590",
    "evidence": {
      "file_paths": [
        "net/tquic/cong/tquic_cong.c"
      ],
      "symbols": [
        "sock_net"
      ],
      "line_ranges": [],
      "snippets": [
        "if (path && path->conn && path->conn->sk)\n    net = sock_net(path->conn->sk);  // UAF: sk can be freed between check and use"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/cong/tquic_cong.c` **Lines:** 83-84, 474-475, 589-590",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-657",
    "title": "UAF-P2-01: - SKB accessed after udp_tunnel_xmit_skb",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_udp.c` **Lines:** 1356-1367",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_udp.c"
      ],
      "symbols": [
        "udp_tunnel_xmit_skb"
      ],
      "line_ranges": [],
      "snippets": [
        "TQUIC_UDP_TUNNEL_XMIT_SKB(rt, sk, skb,\n                  saddr, daddr,\n                  0, ip4_dst_hoplimit(&rt->dst),\n                  0, us->local_port, us->remote_port,\n                  false, !us->csum_offload);\n\nus->stats.tx_packets++;\nus->stats.tx_bytes += skb->len;  // <-- UAF: skb was con",
        "int pkt_len = skb->len;\nTQUIC_UDP_TUNNEL_XMIT_SKB(...);\nus->stats.tx_bytes += pkt_len;"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_udp.c` **Lines:** 1356-1367",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-658",
    "title": "UAF-P3-01: - retransmit_work_fn accesses ts->conn without connection reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1473-1518",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "cancel_work_sync",
        "tquic_timer_state_free",
        "tquic_detect_lost_packets",
        "tquic_conn_get",
        "tquic_conn_put",
        "tquic_timer_state",
        "work_struct"
      ],
      "line_ranges": [
        "net/tquic/tquic_timer.c:848-848",
        "net/tquic/tquic_timer.c:1422-1422",
        "net/tquic/tquic_timer.c:848-848"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1473-1518",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: CRITICAL. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-659",
    "title": "UAF-P3-02: - path_work_fn accesses ts->conn without reference",
    "category": "memory",
    "severity": "S0",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1524-1537",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_timer_state",
        "work_struct"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_path_work_fn(struct work_struct *work)\n{\n    struct tquic_timer_state *ts = container_of(work, ...);\n\n    spin_lock_bh(&ts->lock);\n    if (!ts->active || ts->shutting_down) {\n        spin_unlock_bh(&ts->lock);\n        return;\n    }\n    spin_unlock_bh(&ts->lock);\n    // <-- ts and c"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1524-1537",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: CRITICAL. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-660",
    "title": "UAF-P3-03: - Tunnel close races with connect_work and forward_work",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 615-646 (close) vs 420-469 (connect_work)",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "cancel_work_sync",
        "tquic_tunnel",
        "tquic_tunnel_close",
        "tquic_tunnel_put"
      ],
      "line_ranges": [
        "net/tquic/tquic_tunnel.c:469-469",
        "net/tquic/tquic_tunnel.c:429-429",
        "net/tquic/tquic_tunnel.c:440-440",
        "net/tquic/tquic_tunnel.c:451-451"
      ],
      "snippets": [
        "void tquic_tunnel_close(struct tquic_tunnel *tunnel)\n{\n    // ... sets state to CLOSING\n    // Removes from client list\n    // Shuts down TCP socket\n    tunnel->state = TQUIC_TUNNEL_CLOSED;\n    tquic_tunnel_put(tunnel);  // May free tunnel\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 615-646 (close) vs 420-469 (connect_work)",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-661",
    "title": "UAF-P3-04: - Path validation timer callback accesses path after potential free",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1307-1338",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_timer.c"
      ],
      "symbols": [
        "tquic_path",
        "timer_setup",
        "timer_list",
        "tquic_timer_start_path_validation",
        "tquic_path_free",
        "tquic_connection",
        "del_timer_sync"
      ],
      "line_ranges": [
        "net/tquic/tquic_timer.c:483-483",
        "net/tquic/tquic_timer.c:1345-1345",
        "net/tquic/tquic_timer.c:1359-1361"
      ],
      "snippets": [
        "static void tquic_path_validation_expired(struct timer_list *t)\n{\n    struct tquic_path *path = from_timer(path, t, validation_timer);\n    struct tquic_connection *conn;\n\n    conn = path->conn;  // <-- path may already be freed\n    if (!conn)\n        return;\n\n    spin_lock_bh(&conn->lock);\n    // .."
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_timer.c` **Lines:** 1307-1338",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-662",
    "title": "UAF-P3-05: - GRO flush_timer can fire after kfree",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 2224-2232",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_input.c"
      ],
      "symbols": [
        "hrtimer_cancel",
        "tquic_gro_state"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_gro_cleanup(struct tquic_gro_state *gro)\n{\n    if (!gro)\n        return;\n\n    hrtimer_cancel(&gro->flush_timer);\n    skb_queue_purge(&gro->hold_queue);\n    kfree(gro);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_input.c` **Lines:** 2224-2232",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-663",
    "title": "UAF-P4-01: - tquic_zc_entry uses atomic_t instead of refcount_t",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c` **Lines:** 58, 198-207",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "refcount_set",
        "refcount_inc",
        "tquic_zc_entry",
        "refcount_dec_and_test"
      ],
      "line_ranges": [],
      "snippets": [
        "struct tquic_zc_entry {\n    // ...\n    atomic_t refcnt;   // <-- Should be refcount_t\n};\n\nstatic void tquic_zc_entry_put(struct tquic_zc_entry *entry)\n{\n    if (atomic_dec_and_test(&entry->refcnt))  // No UAF protection\n        tquic_zc_entry_free(entry);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c` **Lines:** 58, 198-207",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-664",
    "title": "UAF-P4-02: - Paths lack reference counting entirely",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 480-507",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "tquic_path",
        "tquic_path_free"
      ],
      "line_ranges": [],
      "snippets": [
        "void tquic_path_free(struct tquic_path *path)\n{\n    // ... cleanup\n    kfree(path);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 480-507",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-665",
    "title": "UAF-P4-03: - Double destruction path for connections",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` line 171 **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_proto.c` lines 1082-1160",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_proto.c",
        "net/tquic/tquic_socket.c"
      ],
      "symbols": [
        "tquic_net_close_all_connections",
        "tquic_conn_destroy",
        "tquic_destroy_sock",
        "tquic_conn_put"
      ],
      "line_ranges": [
        "net/tquic/tquic_proto.c:171-171",
        "net/tquic/tquic_proto.c:1082-1160",
        "net/tquic/tquic_proto.c:171-171",
        "net/tquic/tquic_proto.c:1073-1073"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_socket.c` line 171 **File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_proto.c` lines 1082-1160",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-666",
    "title": "UAF-P5-01: - Correct RCU usage in tquic_nf.c",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_nf.c` **Lines:** 197-203",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_nf.c"
      ],
      "symbols": [
        "call_rcu",
        "hash_for_each_possible_rcu",
        "tquic_nf_conn",
        "rcu_read_lock"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_nf_conn_put(struct tquic_nf_conn *conn)\n{\n    if (refcount_dec_and_test(&conn->refcnt)) {\n        atomic64_dec(&tquic_nf_conn_count);\n        call_rcu(&conn->rcu, tquic_nf_conn_free_rcu);\n    }\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_nf.c` **Lines:** 197-203",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-667",
    "title": "UAF-P5-02: - Path list uses RCU but active_path does not",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 496-504",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_migration.c"
      ],
      "symbols": [
        "rcu_assign_pointer",
        "synchronize_rcu",
        "rcu_dereference"
      ],
      "line_ranges": [
        "net/tquic/tquic_migration.c:848-848"
      ],
      "snippets": [
        "spin_lock_bh(&conn->paths_lock);\nlist_del_rcu(&path->list);\nconn->num_paths--;\nspin_unlock_bh(&conn->paths_lock);\n\nsynchronize_rcu();  // Wait for RCU readers\n\nkfree(path);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_migration.c` **Lines:** 496-504",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-668",
    "title": "UAF-P6-01: - SmartNIC ops dereference after device could be freed",
    "category": "memory",
    "severity": "S1",
    "confidence": "high",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c` **Lines:** 256-257, 312, 327, 833-834",
    "evidence": {
      "file_paths": [
        "net/tquic/offload/smartnic.c"
      ],
      "symbols": [
        "tquic_nic_unregister"
      ],
      "line_ranges": [
        "net/tquic/offload/smartnic.c:253-253",
        "net/tquic/offload/smartnic.c:256-256",
        "net/tquic/offload/smartnic.c:257-257",
        "net/tquic/offload/smartnic.c:312-312"
      ],
      "snippets": [
        "// In tquic_nic_unregister:\nspin_unlock(&tquic_nic_lock);     // line 253\nif (dev->ops && dev->ops->cleanup)  // line 256 -- ok, still valid\n    dev->ops->cleanup(dev);         // line 257\n\n// But callers of tquic_nic_find get dev without refcount:\nif (!dev->ops->add_key)            // line 312 -- d"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/offload/smartnic.c` **Lines:** 256-257, 312, 327, 833-834",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: HIGH. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-669",
    "title": "UAF-P6-02: - tquic_zerocopy_complete callback chain",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c` **Lines:** 224-231",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_zerocopy.c"
      ],
      "symbols": [
        "sk_buff",
        "ubuf_info"
      ],
      "line_ranges": [],
      "snippets": [
        "static void tquic_zerocopy_complete(struct sk_buff *skb,\n                                   struct ubuf_info *uarg,\n                                   bool success)\n{\n    if (uarg && uarg->ops && uarg->ops->complete)\n        uarg->ops->complete(skb, uarg, success);\n}"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_zerocopy.c` **Lines:** 224-231",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-670",
    "title": "UAF-ADD-01: - tquic_tunnel_close does not cancel forward_work for tproxy tunnels",
    "category": "memory",
    "severity": "S2",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 592-593",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_tunnel.c"
      ],
      "symbols": [
        "tquic_tunnel_create_tproxy",
        "tquic_tunnel_close"
      ],
      "line_ranges": [
        "net/tquic/tquic_tunnel.c:592-592"
      ],
      "snippets": [],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_tunnel.c` **Lines:** 592-593",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: MEDIUM. Note: no code snippets provided in original finding. Note: no explicit fix suggestion in original finding."
  },
  {
    "id": "F-671",
    "title": "UAF-ADD-02: - CID pool rotation_work vs pool destruction race window",
    "category": "memory",
    "severity": "S3",
    "confidence": "medium",
    "impact": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 349-350",
    "evidence": {
      "file_paths": [
        "net/tquic/tquic_cid.c"
      ],
      "symbols": [],
      "line_ranges": [
        "net/tquic/tquic_cid.c:980-1180",
        "net/tquic/tquic_cid.c:480-1170",
        "net/tquic/tquic_cid.c:180-375",
        "net/tquic/tquic_cid.c:320-420",
        "net/tquic/tquic_cid.c:1-200"
      ],
      "snippets": [
        "del_timer_sync(&pool->rotation_timer);\ncancel_work_sync(&pool->rotation_work);"
      ],
      "logs_or_errors": []
    },
    "repro": {
      "steps": [],
      "expected": "",
      "actual": ""
    },
    "root_cause_hypothesis": "**File:** `/Users/justinadams/Downloads/tquic-kernel/net/tquic/tquic_cid.c` **Lines:** 349-350",
    "fix_suggestion": "See original report for recommendation",
    "tests_to_add": [],
    "dependencies": [],
    "notes": "Source: ULTRA_UAF_AUDIT.md. Original finding ID: LOW. Note: no explicit fix suggestion in original finding."
  }
]